<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:webfeeds="http://webfeeds.org/rss/1.0" xmlns:content="http://purl.org/rss/1.0/modules/content/"><channel><title>ChenSoul</title><link>https://blog.chensoul.com/</link><description>Recent content on ChenSoul</description><generator>Hugo -- gohugo.io</generator><language>zh</language><lastBuildDate>Mon, 30 Jan 2023 09:47:03 +0800</lastBuildDate><atom:link href="https://blog.chensoul.com/index.xml" rel="self" type="application/rss+xml"/><item><title>å‘¨æŠ¥ #4ï½œè¿‡å¹´ã€å‘ä¸Šç®¡ç†ã€å·¥ä½œå‘¨æ€»ç»“</title><link>https://blog.chensoul.com/posts/2023/01/30/weekly_review_4/</link><pubDate>Mon, 30 Jan 2023 09:47:03 +0800</pubDate><guid>https://blog.chensoul.com/posts/2023/01/30/weekly_review_4/</guid><description>å‰è¨€ æœ¬ç¯‡æ˜¯å¯¹ 2023-01-23 åˆ° 2023-01-29 è¿™å‘¨ç”Ÿæ´»çš„è®°å½•ä¸æ€è€ƒã€‚ è¿‡å¹´ è¿™å‘¨å¤„äºè¿‡å¹´åƒå–æ‹œå¹´æ¨¡å¼ï¼Œé™¤äº†è…ŠæœˆäºŒåä¹å’Œæ­£æœˆåˆä¸€ï¼Œå…¶ä»–æ—¶é—´éƒ½æ˜¯å’Œè€å©†åœ¨è·¯ä¸Šã€‚å› ä¸ºæ˜¯ç»“å©šç¬¬ä¸€ä¸ªæ–°</description><content:encoded><![CDATA[<h2 id="å‰è¨€">å‰è¨€</h2>
<p>æœ¬ç¯‡æ˜¯å¯¹ <code>2023-01-23</code> åˆ° <code>2023-01-29</code> è¿™å‘¨ç”Ÿæ´»çš„è®°å½•ä¸æ€è€ƒã€‚</p>
<h2 id="è¿‡å¹´">è¿‡å¹´</h2>
<p>è¿™å‘¨å¤„äºè¿‡å¹´åƒå–æ‹œå¹´æ¨¡å¼ï¼Œé™¤äº†è…ŠæœˆäºŒåä¹å’Œæ­£æœˆåˆä¸€ï¼Œå…¶ä»–æ—¶é—´éƒ½æ˜¯å’Œè€å©†åœ¨è·¯ä¸Šã€‚å› ä¸ºæ˜¯ç»“å©šç¬¬ä¸€ä¸ªæ–°å¹´ï¼Œéœ€è¦å¸¦ç€è€å©†å»å„ä¸ªäº²æˆšå®¶æ‹œå¹´ã€‚å› ä¸ºæ˜¯ç¬¬ä¸€æ¬¡åœ¨æ–°æˆ¿è¿‡å¹´ï¼Œå°±æŠŠè€çˆ¸ä»å†œæ‘æ¥è¿‡æ¥ä¸€èµ·è¿‡å¹´ã€‚å› ä¸ºå¹´å‰æ²¡æœ‰æ¥å¾—åŠä¹°è½¦ï¼Œå»å“ªé‡Œéƒ½ä¸æ–¹ä¾¿ï¼Œéƒ½è¦éœ€è¦æ»´æ»´æ‰“è½¦ã€‚ä¸ºæ­¤ï¼Œæ‰“è½¦èŠ±äº†ä¸å°‘é’±ï¼Œå½“ç„¶ï¼Œç»™çº¢åŒ…ä¹Ÿç»™äº†ä¸å°‘é’±ã€‚è¶åˆä¸€ä¸ç”¨æ‹œå¹´çš„ç¼éš™æ—¶é—´ï¼Œå¸¦è€å©†å’Œè€çˆ¸å»çœ‹äº†ä¸¤åœºç”µå½±ã€Šæ— åã€‹å’Œã€Šäº¤æ¢äººç”Ÿã€‹ã€‚è€çˆ¸å¾ˆå°‘å»çœ‹ç”µå½±é™¢çœ‹ç”µå½±ï¼Œå¬åˆ°è¦å»çœ‹ç”µå½±ï¼Œåƒä¸ªå°å­©ä¼¼çš„ï¼Œé¥­è¿˜åƒå®Œï¼Œå°±è·‘å»ç”µæ¢¯é—¨å£ç­‰ç”µæ¢¯ã€‚è¿™ä¸¤åœºç”µå½±ï¼Œçœ‹çš„æˆ‘çŒç¡æ¥äº†ï¼Œå€’æ˜¯åˆäºŒæ™šä¸Šçœ‹ã€Šæ»¡æ±Ÿçº¢ã€‹ç¡æ„å…¨æ— ã€‚</p>
<p>æ€»ç»“ä¸‹æ¥ï¼Œè¿™ä¸ªå¹´è¿‡çš„ä¸è½»æ¾ï¼Œèº«ä½“å¿™ç¢Œï¼Œå¿ƒé‡Œå¹¸ç¦ğŸ¥°ã€‚</p>
<h2 id="å‘ä¸Šç®¡ç†">å‘ä¸Šç®¡ç†</h2>
<p>å¹´å‰ï¼Œéƒ¨é—¨é¢†å¯¼æ‰¾æˆ‘è°ˆ 2022 å¹´ç»©æ•ˆç»“æœæ—¶å€™ï¼Œæåˆ°æˆ‘å¯ä»¥â€œå‘ä¸Šç®¡ç†â€ä»–ã€‚æœ€è¿‘ä» <a href="https://www.duyidong.com/">æœå±¹ä¸œ</a> çš„åšå®¢ <a href="https://www.duyidong.com/2020/01/01/2019-learn-from-alibaba/">è¿™ä¸€å¹´æˆ‘åœ¨é˜¿é‡Œå­¦åˆ°çš„</a> ä¹Ÿçœ‹åˆ°äº†ä»–åœ¨é˜¿é‡Œå·¥ä½œä¸€å¹´åæ‚Ÿåˆ°å¯¹å‘ä¸Šç®¡ç†çš„ç†è§£ã€‚</p>
<ul>
<li>åŠæ—¶å’Œè€æ¿è¡¨è¾¾æƒ³æ³•</li>
<li>è®©è€æ¿çŸ¥é“ä½ åœ¨å¿™ä»€ä¹ˆ</li>
<li>ä¸»åŠ¨å¸®è€æ¿åšä¸€äº›è„æ´»ç´¯æ´»</li>
</ul>
<p>å‰ä¸¤æ¡æ˜¯è€æ¿çŸ¥é“ä½ çš„æƒ³æ³•ï¼Œåé¢ä¸€æ¡æ˜¯å¸®è€æ¿è§£å†³é—®é¢˜ã€‚æ­¤å¤–ï¼Œè¿˜å¯ä»¥å¸®è€æ¿è§„é¿é£é™©ã€‚</p>
<h2 id="æœ¬å‘¨å·¥ä½œ">æœ¬å‘¨å·¥ä½œ</h2>
<p>è¿™æ˜¯å¹´åçš„ç¬¬ä¸€å‘¨ï¼Œä¸»è¦æ˜¯å¤„ç†å¹´å‰æ²¡æœ‰å®Œæˆçš„é¡¹ç›®è¿­ä»£ã€‚</p>
<h3 id="feign-é›†æˆ-micometer">Feign é›†æˆ Micometer</h3>
<p>OpenFeign å®˜æ–¹æä¾›äº† feign-micrometer æ¥æ”¯æŒ feign é›†æˆ micrometerã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">GitHub</span> <span class="n">github</span> <span class="o">=</span> <span class="n">Feign</span><span class="o">.</span><span class="na">builder</span><span class="o">()</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="na">addCapability</span><span class="o">(</span><span class="k">new</span> <span class="n">MicrometerCapability</span><span class="o">())</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="na">target</span><span class="o">(</span><span class="n">GitHub</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="s">&#34;https://api.github.com&#34;</span><span class="o">);</span>
</span></span></code></pre></div><p>å…¶æœ¬è´¨æ˜¯å¯¹ feign æ‹¦æˆªå™¨ã€clientã€encoderã€decoder è¿›è¡Œå°è£…ï¼Œæµ‹è¯•è¿‡ç¨‹ä¸­åœ¨æ²¡æœ‰è·å–åˆ°æŒ‡æ ‡ã€‚æ•…ï¼Œæ”¹ä¸ºä½¿ç”¨zè‡ªå®šä¹‰æ‹¦æˆªå™¨å’Œ ErrorCoder æ¥è®°å½•è¯·æ±‚æ¬¡æ•°å’Œå¤±è´¥æ¬¡æ•°ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@Bean</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="n">GitHub</span> <span class="nf">gihhub</span><span class="o">(</span><span class="n">MetricsInterceptor</span> <span class="n">metricsInterceptor</span><span class="o">){</span>
</span></span><span class="line"><span class="cl">  <span class="n">GitHub</span> <span class="n">github</span> <span class="o">=</span> <span class="n">Feign</span><span class="o">.</span><span class="na">builder</span><span class="o">()</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="na">requestInterceptor</span><span class="o">(</span><span class="n">metricsInterceptor</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="na">errorDecoder</span><span class="o">(</span><span class="k">new</span> <span class="n">MetricsErrorDecoder</span><span class="o">())</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="na">target</span><span class="o">(</span><span class="n">GitHub</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="s">&#34;https://api.github.com&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><p>MetricsInterceptor ä»£ç å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MetricsInterceptor</span> <span class="kd">implements</span> <span class="n">RequestInterceptor</span><span class="o">,</span> <span class="n">MeterBinder</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="kd">static</span> <span class="n">MeterRegistry</span> <span class="n">meterRegistry</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">FEIGN_REQUEST</span> <span class="o">=</span> <span class="s">&#34;feign.requests&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">FEIGN_REQUEST_ERROR</span> <span class="o">=</span> <span class="s">&#34;feign.requests.error&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="nf">MetricsInterceptor</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">apply</span><span class="o">(</span><span class="n">RequestTemplate</span> <span class="n">template</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">Micrometers</span><span class="o">.</span><span class="na">async</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">String</span> <span class="n">methodKey</span> <span class="o">=</span> <span class="n">template</span><span class="o">.</span><span class="na">methodMetadata</span><span class="o">().</span><span class="na">configKey</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">            <span class="n">Counter</span> <span class="n">counter</span> <span class="o">=</span> <span class="n">Counter</span><span class="o">.</span><span class="na">builder</span><span class="o">(</span><span class="s">&#34;feign.requests&#34;</span><span class="o">).</span><span class="na">tags</span><span class="o">(</span><span class="k">new</span> <span class="n">String</span><span class="o">[]{</span><span class="s">&#34;method&#34;</span><span class="o">,</span> <span class="n">StringUtils</span><span class="o">.</span><span class="na">substringBefore</span><span class="o">(</span><span class="n">methodKey</span><span class="o">,</span> <span class="s">&#34;(&#34;</span><span class="o">)}).</span><span class="na">register</span><span class="o">(</span><span class="n">meterRegistry</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">counter</span><span class="o">.</span><span class="na">increment</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="o">});</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">bindTo</span><span class="o">(</span><span class="n">MeterRegistry</span> <span class="n">registry</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">meterRegistry</span> <span class="o">=</span> <span class="n">registry</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><p>MetricsErrorDecoder ä»£ç å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MetricsErrorDecoder</span> <span class="kd">implements</span> <span class="n">ErrorDecoder</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">Logger</span> <span class="n">log</span> <span class="o">=</span> <span class="n">LoggerFactory</span><span class="o">.</span><span class="na">getLogger</span><span class="o">(</span><span class="n">MetricsErrorDecoder</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="kd">static</span> <span class="n">MeterRegistry</span> <span class="n">registry</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SimpleMeterRegistry</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="nf">MetricsErrorDecoder</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">metrics</span><span class="o">(</span><span class="n">String</span> <span class="n">methodKey</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">Micrometers</span><span class="o">.</span><span class="na">async</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">Metrics</span><span class="o">.</span><span class="na">counter</span><span class="o">(</span><span class="s">&#34;feign.requests.error&#34;</span><span class="o">,</span> <span class="k">new</span> <span class="n">String</span><span class="o">[]{</span><span class="s">&#34;method&#34;</span><span class="o">,</span> <span class="n">StringUtils</span><span class="o">.</span><span class="na">substringBefore</span><span class="o">(</span><span class="n">methodKey</span><span class="o">,</span> <span class="s">&#34;(&#34;</span><span class="o">)}).</span><span class="na">increment</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="o">});</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">Exception</span> <span class="nf">decode</span><span class="o">(</span><span class="n">String</span> <span class="n">methodKey</span><span class="o">,</span> <span class="n">Response</span> <span class="n">response</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">this</span><span class="o">.</span><span class="na">metrics</span><span class="o">(</span><span class="n">methodKey</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">FeignException</span> <span class="n">exception</span> <span class="o">=</span> <span class="n">FeignException</span><span class="o">.</span><span class="na">errorStatus</span><span class="o">(</span><span class="n">methodKey</span><span class="o">,</span> <span class="n">response</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">exception</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">static</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">Counter</span><span class="o">.</span><span class="na">builder</span><span class="o">(</span><span class="s">&#34;feign.requests.error&#34;</span><span class="o">).</span><span class="na">register</span><span class="o">(</span><span class="n">registry</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><h3 id="sentry-é›†æˆé£ä¹¦é€šçŸ¥">Sentry é›†æˆé£ä¹¦é€šçŸ¥</h3>
<p>å‚è€ƒ <a href="https://www.ytjia.xyz/blog/2022/05/20/sentry-webhook.html">é€šè¿‡Webhookå®ç°Sentryé”™è¯¯è‡ªåŠ¨åŒ–é£ä¹¦æœºå™¨äººæŠ¥è­¦</a> è¿™ç¯‡æ–‡ç« ï¼Œä½¿ç”¨ fastapi éƒ¨ç½²ä¸€ä¸ª http æœåŠ¡å°† sentry çš„å›è°ƒè½¬å‘åˆ°é£ä¹¦ç¾¤çš„æœºå™¨äººã€‚ç”±äºï¼Œfastapi éœ€è¦åœ¨æœåŠ¡å™¨ä¸Šå®‰è£… python3ï¼Œ ä¸ºäº†ä¸æ±¡æŸ“æˆ‘çš„ vpsï¼Œæˆ‘åˆ›å»ºä¸€ä¸ª docker é•œåƒ <a href="https://github.com/chensoul/dockerfiles/tree/master/sentry-feishu-hook">sentry-feishu-hook</a>ï¼Œä¿®æ”¹äº† python è„šæœ¬ä¸­çš„ç¼–è¯‘é”™è¯¯ï¼Œå¹¶åœ¨ vps ä¸Šé€šè¿‡ docker å¯åŠ¨è¯¥æœåŠ¡ã€‚</p>
<p>å…ˆç¼–è¯‘é•œåƒï¼Œå†è¿è¡Œï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker build -t sentry-feishu-hook .
</span></span><span class="line"><span class="cl">docker run -d --name sentry-feishu-hook -p 3080:3080 sentry-feishu-hook
</span></span></code></pre></div><p>æ¥ä¸‹æ¥åœ¨ sentry é¡¹ç›®çš„ WebHooks é‡Œæ·»åŠ  http://ip:3080/hook</p>
<p><img src="http://chensoul.oss-cn-hangzhou.aliyuncs.com/images/sentry-feishu-webhooks-test.png" alt="sentry-feishu-webhooks-test"></p>
<p>ç‚¹å‡» Test Plugin ï¼Œé£ä¹¦ç¾¤ç»„å¯ä»¥æ”¶åˆ°æ¶ˆæ¯ï¼š</p>
<img src="http://chensoul.oss-cn-hangzhou.aliyuncs.com/images/sentry-feishu-webhooks-test-message.png" alt="sentry-feishu-webhooks-test-message" style="width: 50%"/>
<h2 id="å¥½ç‰©åˆ†äº«">å¥½ç‰©åˆ†äº«</h2>
<ul>
<li><a href="https://www.warp.dev/">https://www.warp.dev/</a>ï¼šä¸€ä¸ª Rust ç¼–å†™ï¼Œä½¿ç”¨ GPU æ¸²æŸ“çš„ç»ˆç«¯åº”ç”¨ã€‚ç›®æ ‡æ˜¯æå‡å¼€å‘è€…çš„æ•ˆç‡ã€‚</li>
<li><a href="https://strrl.dev/post/before-2022/restful-api-mock-%E5%B7%A5%E5%85%B7-jsonplaceholder/">Restful API Mock å·¥å…·: JSONPlaceholder</a></li>
<li><a href="https://netnewswire.com/">NetNewsWire</a>ã€‚Inoreader æœ€è¿‘æ€»æ˜¯æŠ½é£ï¼Œå°±æ”¹ä¸ºä½¿ç”¨ NetNewsWire äº†ã€‚ä½¿ç”¨èµ·æ¥ï¼Œè¿˜æ˜¯æ¯”è¾ƒé¡ºæ»‘ï¼Œé—æ†¾çš„æ˜¯æ²¡æœ‰å®‰å“ Appã€‚</li>
<li><a href="https://cubox.pro/">Cubox</a>ã€‚æœ€è¿‘çœ‹åˆ°è¿™ä¸ªæ”¶è—å·¥å…·ï¼Œä¸‹è½½äº†ä½¿ç”¨èµ·æ¥ã€‚</li>
</ul>
<img src="http://chensoul.oss-cn-hangzhou.aliyuncs.com/images/cubox-screen.png" alt="cubox-screen" style="width: 50%"/>
]]></content:encoded></item><item><title>æˆ‘çš„VPSæœåŠ¡éƒ¨ç½²è®°å½•</title><link>https://blog.chensoul.com/posts/2023/01/25/notes-about-deploy-services-in-vps/</link><pubDate>Wed, 25 Jan 2023 10:38:34 +0800</pubDate><guid>https://blog.chensoul.com/posts/2023/01/25/notes-about-deploy-services-in-vps/</guid><description>Docker å®‰è£…å’Œé…ç½® Docker å®‰è£… å…·ä½“è¿‡ç¨‹å¯ä»¥å‚è€ƒç½‘ä¸Šæ–‡ç« ã€‚ è‡ªå®šä¹‰ç½‘ç»œ å‚è€ƒ Best Practice: Use a Docker network ï¼Œåˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰çš„ç½‘ç»œï¼š docker network create custom æŸ¥çœ‹ docker ç½‘ç»œï¼š [root@vps ~]# docker network ls NETWORK ID NAME DRIVER SCOPE 68f4aeaa57bd bridge bridge</description><content:encoded><![CDATA[<h2 id="docker-å®‰è£…å’Œé…ç½®">Docker å®‰è£…å’Œé…ç½®</h2>
<h3 id="docker-å®‰è£…">Docker å®‰è£…</h3>
<p>å…·ä½“è¿‡ç¨‹å¯ä»¥å‚è€ƒç½‘ä¸Šæ–‡ç« ã€‚</p>
<h3 id="è‡ªå®šä¹‰ç½‘ç»œ">è‡ªå®šä¹‰ç½‘ç»œ</h3>
<p>å‚è€ƒ <a href="https://nginxproxymanager.com/advanced-config/#best-practice-use-a-docker-network">Best Practice: Use a Docker network </a> ï¼Œåˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰çš„ç½‘ç»œï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker network create custom
</span></span></code></pre></div><p>æŸ¥çœ‹ docker ç½‘ç»œï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@vps ~<span class="o">]</span><span class="c1"># docker network ls</span>
</span></span><span class="line"><span class="cl">NETWORK ID     NAME            DRIVER    SCOPE
</span></span><span class="line"><span class="cl">68f4aeaa57bd   bridge          bridge    <span class="nb">local</span>
</span></span><span class="line"><span class="cl">6a96b9d8617e   custom          bridge    <span class="nb">local</span>
</span></span><span class="line"><span class="cl">4a8679e35f4d   host            host      <span class="nb">local</span>
</span></span><span class="line"><span class="cl">ba21bef23b04   none            null      <span class="nb">local</span>
</span></span></code></pre></div><blockquote>
<p>æ³¨æ„ï¼šbridgeã€hostã€none æ˜¯å†…éƒ¨é¢„å…ˆåˆ›å»ºçš„ç½‘ç»œã€‚</p>
</blockquote>
<p>ç„¶åï¼Œåœ¨å…¶ä»–æœåŠ¡çš„ docker-compose.yml æ–‡ä»¶æ·»åŠ ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">networks</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">default</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">external</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">custom</span><span class="w">
</span></span></span></code></pre></div><p>ä¾‹å¦‚ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;3&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">services</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">pgsql</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">postgres:13</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="l">always</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">ports</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="m">5433</span><span class="p">:</span><span class="m">5432</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">environment</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">POSTGRES_USER=chenzj</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">POSTGRES_PASSWORD=chenzj@vps2021</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">volumes</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">/data/postgres:/var/lib/postgresql/data</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">networks</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">default</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">external</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">custom</span><span class="w">
</span></span></span></code></pre></div><h2 id="æœåŠ¡éƒ¨ç½²">æœåŠ¡éƒ¨ç½²</h2>
<h3 id="rsshub">Rsshub</h3>
<p>ç›´æ¥é€šè¿‡ Docker å®‰è£…è¿è¡Œï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker run -d --name rsshub -p 1200:1200 diygod/rsshub
</span></span></code></pre></div><p>é…ç½® nginx ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">server</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kn">listen</span> <span class="mi">80</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">listen</span> <span class="s">[::]:80</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">server_name</span> <span class="s">rsshub.chensoul.com</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kn">return</span> <span class="mi">301</span> <span class="s">https://</span><span class="nv">$host$request_uri</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">server</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kn">listen</span>          <span class="mi">443</span> <span class="s">ssl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">server_name</span>     <span class="s">rsshub.chensoul.com</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kn">ssl_certificate</span>      <span class="s">/usr/local/nginx/ssl/fullchain.cer</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">ssl_certificate_key</span>  <span class="s">/usr/local/nginx/ssl/chensoul.com.key</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kn">ssl_session_cache</span>    <span class="s">shared:SSL:1m</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">ssl_session_timeout</span>  <span class="mi">5m</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kn">ssl_ciphers</span>  <span class="s">HIGH:!aNULL:!MD5</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">ssl_prefer_server_ciphers</span>  <span class="no">on</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kn">location</span> <span class="s">/</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kn">proxy_pass</span> <span class="s">http://127.0.0.1:1200</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h3 id="kuma">Kuma</h3>
<p>å‚è€ƒ <a href="https://uptime.kuma.pet/">kuma</a>ï¼Œä½¿ç”¨ Docker éƒ¨ç½²ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker run -d --restart<span class="o">=</span>always -p 3001:3001 -v uptime-kuma:/app/data --name uptime-kuma louislam/uptime-kuma:1
</span></span></code></pre></div><p>é…ç½® nginx ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">server</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kn">listen</span> <span class="mi">80</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">listen</span> <span class="s">[::]:80</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">server_name</span> <span class="s">uptime.chensoul.com</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kn">return</span> <span class="mi">301</span> <span class="s">https://</span><span class="nv">$host$request_uri</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">server</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kn">listen</span>          <span class="mi">443</span> <span class="s">ssl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">server_name</span>     <span class="s">uptime.chensoul.com</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kn">ssl_certificate</span>      <span class="s">/usr/local/nginx/ssl/fullchain.cer</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">ssl_certificate_key</span>  <span class="s">/usr/local/nginx/ssl/chensoul.com.key</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kn">ssl_session_cache</span>    <span class="s">shared:SSL:1m</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">ssl_session_timeout</span>  <span class="mi">5m</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kn">ssl_ciphers</span>  <span class="s">HIGH:!aNULL:!MD5</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">ssl_prefer_server_ciphers</span>  <span class="no">on</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kn">location</span> <span class="s">/</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kn">proxy_pass</span> <span class="s">http://127.0.0.1:3001</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="kn">proxy_http_version</span> <span class="mi">1</span><span class="s">.1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="kn">proxy_set_header</span>   <span class="s">X-Real-IP</span> <span class="nv">$remote_addr</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kn">proxy_set_header</span>   <span class="s">X-Forwarded-For</span> <span class="nv">$proxy_add_x_forwarded_for</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kn">proxy_set_header</span>   <span class="s">Host</span> <span class="nv">$host</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kn">proxy_set_header</span>   <span class="s">Upgrade</span> <span class="nv">$http_upgrade</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kn">proxy_set_header</span>   <span class="s">Connection</span> <span class="s">&#34;upgrade&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kn">proxy_set_header</span>   <span class="s">Host</span> <span class="nv">$host</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h3 id="postgresql">Postgresql</h3>
<p>1ã€å‚è€ƒ <a href="/posts/2022/08/19/postgresql-install-deploy/">PostgreSqlå®‰è£…å’Œéƒ¨ç½²</a> ï¼Œé€šè¿‡ docker-compose å®‰è£…ï¼Œåˆ›å»º postgresql.yamlï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;3&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">services</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">pgsql</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">postgres:13-alpine</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">container_name</span><span class="p">:</span><span class="w"> </span><span class="l">pgsql</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="l">always</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">ports</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="m">5432</span><span class="p">:</span><span class="m">5432</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">environment</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">POSTGRES_USER=postgres</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">POSTGRES_PASSWORD=admin@pg!</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">networks</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">custom</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">volumes</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">/data/postgres:/var/lib/postgresql/data</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">networks</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">custom</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">external</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span></code></pre></div><p>2ã€å¯åŠ¨</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker-compose -f postgresql.yaml up 
</span></span></code></pre></div><h3 id="umami">Umami</h3>
<p>å‚è€ƒ <a href="https://github.com/umami-software/umami/blob/master/docker-compose.yml">umami docker-compose.yml</a> ï¼Œä½¿ç”¨ docker é•œåƒ umami:postgresql-latest æ¥å®‰è£… umamiã€‚</p>
<p>1ã€åœ¨ pqsql å®¹å™¨åˆ›å»º umami æ•°æ®åº“å’Œç”¨æˆ·ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker <span class="nb">exec</span> -it pgsql psql -U postgres -c <span class="s2">&#34;CREATE USER umami WITH PASSWORD &#39;umami@pg&#39;;&#34;</span>
</span></span><span class="line"><span class="cl">docker <span class="nb">exec</span> -it pgsql psql -U postgres -c <span class="s2">&#34;CREATE DATABASE umami owner=umami;&#34;</span>
</span></span><span class="line"><span class="cl">docker <span class="nb">exec</span> -it pgsql psql -U postgres -c <span class="s2">&#34;GRANT ALL privileges ON DATABASE umami TO umami;&#34;</span>
</span></span></code></pre></div><p>ç„¶åï¼Œåˆå§‹åŒ–æ•° umami æ•°æ®ã€‚å…ˆè¿›å…¥å®¹å™¨ï¼š</p>
<pre tabindex="0"><code>docker exec -it pgsql bash
</code></pre><p>è¿›å…¥ umami æ•°æ®åº“ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">psql -U umami -d umami
</span></span><span class="line"><span class="cl"><span class="nv">umami</span><span class="o">=</span>&gt;
</span></span></code></pre></div><p>æ‰§è¡Œ <a href="https://github.com/umami-software/umami/blob/master/sql/schema.postgresql.sql"><strong>schema.postgresql.sql</strong></a> æ–‡ä»¶å†…å®¹ã€‚</p>
<p>2ã€é€šè¿‡ docker-compose å®‰è£…ï¼Œåˆ›å»º umami.yamlï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;3&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">services</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">umami</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">ghcr.io/umami-software/umami:postgresql-latest</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">container_name</span><span class="p">:</span><span class="w"> </span><span class="l">umami</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">ports</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="s2">&#34;3000:3000&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">environment</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">DATABASE_URL</span><span class="p">:</span><span class="w"> </span><span class="l">postgresql://umami:umami@pg@pgsql:5432/umami</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">DATABASE_TYPE</span><span class="p">:</span><span class="w"> </span><span class="l">postgresql</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">HASH_SALT</span><span class="p">:</span><span class="w"> </span><span class="l">vps@2023</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">networks</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">custom</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="l">always</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">networks</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">custom</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">external</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span></code></pre></div><p>å¯åŠ¨ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker-compose -f umami.yaml up 
</span></span></code></pre></div><p>3ã€è®¾ç½®è‡ªå®šä¹‰åŸŸå</p>
<p>umami.chensoul.com</p>
<p>4ã€é…ç½® nginx</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">server</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kn">listen</span> <span class="mi">80</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">listen</span> <span class="s">[::]:80</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">server_name</span> <span class="s">umami.chensoul.com</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kn">return</span> <span class="mi">301</span> <span class="s">https://</span><span class="nv">$host$request_uri</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">server</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kn">listen</span>          <span class="mi">443</span> <span class="s">ssl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">server_name</span>     <span class="s">umami.chensoul.com</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kn">ssl_certificate</span>      <span class="s">/usr/local/nginx/ssl/fullchain.cer</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">ssl_certificate_key</span>  <span class="s">/usr/local/nginx/ssl/chensoul.com.key</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kn">ssl_session_cache</span>    <span class="s">shared:SSL:1m</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">ssl_session_timeout</span>  <span class="mi">5m</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kn">ssl_ciphers</span>  <span class="s">HIGH:!aNULL:!MD5</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">ssl_prefer_server_ciphers</span>  <span class="no">on</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kn">location</span> <span class="s">/</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kn">proxy_pass</span> <span class="s">http://127.0.0.1:3000</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>5ã€æ·»åŠ ç½‘ç«™</p>
<p>è®¿é—® <a href="https://umami.chensoul.com/">https://umami.chensoul.com/</a>ï¼Œé»˜è®¤ç”¨æˆ·åå’Œå¯†ç ä¸º admin/umamiã€‚ç™»é™†ä¹‹åï¼Œä¿®æ”¹å¯†ç ï¼Œå¹¶æ·»åŠ ç½‘ç«™ã€‚</p>
<h3 id="cusdis">Cusdis</h3>
<p>1ã€åœ¨ pqsql å®¹å™¨åˆ›å»º cusdis æ•°æ®åº“å’Œç”¨æˆ·ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker <span class="nb">exec</span> -it pgsql psql -U postgres -c <span class="s2">&#34;CREATE USER cusdis WITH PASSWORD &#39;cusdis@pg&#39;;&#34;</span>
</span></span><span class="line"><span class="cl">docker <span class="nb">exec</span> -it pgsql psql -U postgres -c <span class="s2">&#34;CREATE DATABASE cusdis owner=cusdis;&#34;</span>
</span></span><span class="line"><span class="cl">docker <span class="nb">exec</span> -it pgsql psql -U postgres -c <span class="s2">&#34;GRANT ALL privileges ON DATABASE cusdis TO cusdis;&#34;</span>
</span></span></code></pre></div><p>2ã€é€šè¿‡ docker-compose å®‰è£…ï¼Œåˆ›å»º cusdis.yamlï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;3&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">services</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">cusdis</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">djyde/cusdis:latest</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">container_name</span><span class="p">:</span><span class="w"> </span><span class="l">cusdis</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">ports</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="s2">&#34;3010:3000&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">environment</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">USERNAME=admin</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">PASSWORD=cusdis</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">JWT_SECRET=vps@2023</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">NEXTAUTH_URL=https://cusdis.chensoul.com</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">DB_TYPE=pgsql</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">DB_URL=postgresql://cusdis:cusdis@pg@pgsql:5432/cusdis</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">networks</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">custom  </span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="l">always</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">networks</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">custom</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">external</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">    
</span></span></span></code></pre></div><p>ä»¥ä¸‹é…ç½®ä¸º EMAIL é…ç½®å¯é€‰ï¼Œä¸‹é¢æ˜¯ä½¿ç”¨ <a href="https://cusdis.com/doc#/features/notification?id=gmail">Gmail</a> è¿›è¡Œé…ç½®ï¼Œéœ€è¦é¦–å…ˆå¼€å¯ä¸¤é˜¶æ®µéªŒè¯å¹¶åˆ›å»ºä¸€ä¸ªåº”ç”¨å¯†ç ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-properties" data-lang="properties"><span class="line"><span class="cl"><span class="na">SMTP_HOST</span><span class="o">=</span><span class="s">smtp.gmail.com</span>
</span></span><span class="line"><span class="cl"><span class="na">SMTP_PORT</span><span class="o">=</span><span class="s">465</span>
</span></span><span class="line"><span class="cl"><span class="na">SMTP_SECURE</span><span class="o">=</span><span class="s">true</span>
</span></span><span class="line"><span class="cl"><span class="na">SMTP_USER</span><span class="o">=</span><span class="s">your gmail email</span>
</span></span><span class="line"><span class="cl"><span class="na">SMTP_PASSWORD</span><span class="o">=</span><span class="s">&lt;app password&gt;</span>
</span></span><span class="line"><span class="cl"><span class="na">SMTP_SENDER</span><span class="o">=</span><span class="s">your gmail email</span>
</span></span></code></pre></div><p>3ã€å¯åŠ¨</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker-compose -f cusdis.yaml up -d
</span></span></code></pre></div><p>4ã€é…ç½® nginx</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">server</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kn">listen</span> <span class="mi">80</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">listen</span> <span class="s">[::]:80</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">server_name</span> <span class="s">cusdis.chensoul.com</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kn">return</span> <span class="mi">301</span> <span class="s">https://</span><span class="nv">$host$request_uri</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">server</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kn">listen</span>          <span class="mi">443</span> <span class="s">ssl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">server_name</span>     <span class="s">cusdis.chensoul.com</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kn">ssl_certificate</span>      <span class="s">/usr/local/nginx/ssl/fullchain.cer</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">ssl_certificate_key</span>  <span class="s">/usr/local/nginx/ssl/chensoul.com.key</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kn">ssl_session_cache</span>    <span class="s">shared:SSL:1m</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">ssl_session_timeout</span>  <span class="mi">5m</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kn">ssl_ciphers</span>  <span class="s">HIGH:!aNULL:!MD5</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">ssl_prefer_server_ciphers</span>  <span class="no">on</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kn">location</span> <span class="s">/</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kn">proxy_pass</span> <span class="s">http://127.0.0.1:3010</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="kn">proxy_pass_header</span> <span class="s">Authorization</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="kn">proxy_pass_header</span> <span class="s">WWW-Authenticate</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kn">proxy_set_header</span> <span class="s">Host</span> <span class="nv">$host</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kn">proxy_set_header</span> <span class="s">X-Real-IP</span> <span class="nv">$remote_addr</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kn">proxy_set_header</span> <span class="s">X-Forwarded-For</span> <span class="nv">$proxy_add_x_forwarded_for</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="kn">if</span> <span class="s">(</span><span class="nv">$uri</span> <span class="p">=</span> <span class="s">&#39;/js/iframe.umd.js&#39;)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        	<span class="kn">add_header</span> <span class="s">&#39;Access-Control-Allow-Origin&#39;</span> <span class="s">&#39;*&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        	<span class="c1">#add_header &#39;Access-Control-Allow-Origin&#39; &#39;http://localhost:1313&#39;;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    	<span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h3 id="memos">memos</h3>
<p>docker éƒ¨ç½²ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker run -d --name memos -p 5230:5230 -v ~/.memos/:/var/opt/memos neosmemo/memos:latest
</span></span></code></pre></div><p>é…ç½® nginx</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">server</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kn">listen</span> <span class="mi">80</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">listen</span> <span class="s">[::]:80</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">server_name</span> <span class="s">memos.chensoul.com</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kn">return</span> <span class="mi">301</span> <span class="s">https://</span><span class="nv">$host$request_uri</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">server</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kn">listen</span>          <span class="mi">443</span> <span class="s">ssl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">server_name</span>     <span class="s">memos.chensoul.com</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kn">ssl_certificate</span>      <span class="s">/usr/local/nginx/ssl/fullchain.cer</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">ssl_certificate_key</span>  <span class="s">/usr/local/nginx/ssl/chensoul.com.key</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kn">ssl_session_cache</span>    <span class="s">shared:SSL:1m</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">ssl_session_timeout</span>  <span class="mi">5m</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kn">ssl_ciphers</span>  <span class="s">HIGH:!aNULL:!MD5</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">ssl_prefer_server_ciphers</span>  <span class="no">on</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kn">location</span> <span class="s">/</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kn">proxy_pass</span> <span class="s">http://127.0.0.1:5230</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h3 id="n8n">n8n</h3>
<p>1ã€åœ¨ pqsql å®¹å™¨åˆ›å»º n8n æ•°æ®åº“å’Œç”¨æˆ·ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker <span class="nb">exec</span> -it pgsql psql -U postgres -c <span class="s2">&#34;CREATE USER n8n WITH PASSWORD &#39;n8n@pg&#39;;&#34;</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">docker <span class="nb">exec</span> -it pgsql psql -U postgres -c <span class="s2">&#34;CREATE DATABASE n8n owner=n8n;&#34;</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">docker <span class="nb">exec</span> -it pgsql psql -U postgres -c <span class="s2">&#34;GRANT ALL privileges ON DATABASE n8n TO n8n;&#34;</span> <span class="p">;</span>
</span></span></code></pre></div><p>2ã€é€šè¿‡ docker-compose å®‰è£…ï¼Œåˆ›å»º n8n.yamlï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;3.8&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">services</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">n8n</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">n8nio/n8n</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">container_name</span><span class="p">:</span><span class="w"> </span><span class="l">n8n</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="l">always</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">environment</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">DB_TYPE=postgresdb</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">DB_POSTGRESDB_HOST=pgsql</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">DB_POSTGRESDB_PORT=5432</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">DB_POSTGRESDB_DATABASE=n8n</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">DB_POSTGRESDB_USER=n8n</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">DB_POSTGRESDB_PASSWORD=n8n@pg</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">N8N_BASIC_AUTH_ACTIVE=true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">N8N_BASIC_AUTH_USER=admin</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">N8N_BASIC_AUTH_PASSWORD=chenzj</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">TZ=&#34;Asia/Shanghai&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">ports</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="m">5678</span><span class="p">:</span><span class="m">5678</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">volumes</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">/data/n8n:/home/node/.n8n</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="l">/bin/sh -c &#34;n8n start --tunnel&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">networks</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">custom  </span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">networks</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">custom</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">external</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w"> 
</span></span></span></code></pre></div><p>3ã€å¯åŠ¨</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker-compose -f n8n.yaml up -d
</span></span></code></pre></div><p>4ã€è®¾ç½® nginx è½¬å‘</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">location</span> <span class="s">/</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kn">proxy_pass</span> <span class="s">http://127.0.0.1:5678/</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">proxy_set_header</span> <span class="s">Connection</span> <span class="s">&#39;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">proxy_http_version</span> <span class="mi">1</span><span class="s">.1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">chunked_transfer_encoding</span> <span class="no">off</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">proxy_buffering</span> <span class="no">off</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">proxy_cache</span> <span class="no">off</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">access_log</span> <span class="s">/var/log/nginx/forward.log</span> <span class="s">combined</span> <span class="s">buffer=128k</span> <span class="s">flush=5s</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>è¿™é‡Œé¢çš„è½¬å‘é…ç½®ä¸å¯¹çš„è¯ï¼Œä¼šå¯¼è‡´ç›´æ¥è®¿é—® 5678 ç«¯å£æ­£å¸¸ï¼Œä½†æ˜¯è®¿é—® nginx çš„è¯ï¼Œworkflow ä¼šä¸€ç›´å¤„äºæ‰§è¡Œã€‚</p>
<p>5ã€æ·»åŠ  workflow</p>
<p>å‚è€ƒè¿™ç¯‡æ–‡ç«  <a href="http://stiles.cc/archives/237/">http://stiles.cc/archives/237/</a> ï¼Œç›®å‰æˆ‘é…ç½®äº†ä»¥ä¸‹ workflowsï¼Œå®ç°äº† githubã€doubanã€rssã€memos åŒæ­¥åˆ° Telegramã€‚</p>
<p><img src="http://chensoul.oss-cn-hangzhou.aliyuncs.com/images/my-n8n-workflows.png" alt="my-n8n-workflows"></p>
]]></content:encoded></item><item><title>å‘¨æŠ¥ #3ï½œåšå®¢å®šåˆ¶ã€VPSéƒ¨ç½²æœåŠ¡</title><link>https://blog.chensoul.com/posts/2023/01/25/weekly_review_3/</link><pubDate>Wed, 25 Jan 2023 09:47:03 +0800</pubDate><guid>https://blog.chensoul.com/posts/2023/01/25/weekly_review_3/</guid><description>å‰è¨€ æœ¬ç¯‡æ˜¯å¯¹ 2023-01-16 åˆ° 2023-01-22 è¿™å‘¨ç”Ÿæ´»çš„è®°å½•ä¸æ€è€ƒã€‚ è¿™æ˜¯è¿‡å¹´å‰çš„æœ€åä¸€å‘¨ï¼Œä¸Šäº†ä¸‰å¤©ç­ï¼Œè¯·äº†ä¸¤å¤©å‡å›å»å‡†å¤‡å¹´è´§ã€å»äº²æˆšå®¶åƒå¹´é¥­ã€‚è¶æ”¾å‡ä¹‹å‰ï¼Œç»§ç»­å¯¹åšå®¢åšäº†</description><content:encoded><![CDATA[<h2 id="å‰è¨€">å‰è¨€</h2>
<p>æœ¬ç¯‡æ˜¯å¯¹ <code>2023-01-16</code> åˆ° <code>2023-01-22</code> è¿™å‘¨ç”Ÿæ´»çš„è®°å½•ä¸æ€è€ƒã€‚</p>
<p>è¿™æ˜¯è¿‡å¹´å‰çš„æœ€åä¸€å‘¨ï¼Œä¸Šäº†ä¸‰å¤©ç­ï¼Œè¯·äº†ä¸¤å¤©å‡å›å»å‡†å¤‡å¹´è´§ã€å»äº²æˆšå®¶åƒå¹´é¥­ã€‚è¶æ”¾å‡ä¹‹å‰ï¼Œç»§ç»­å¯¹åšå®¢åšäº†ä¸€äº›å®šåˆ¶ï¼Œä¹Ÿåœ¨æˆ‘çš„ VPS ä¸Šé€šè¿‡ Docker éƒ¨ç½²äº†ä¸€äº›æœåŠ¡ã€‚</p>
<h2 id="å®šåˆ¶åšå®¢">å®šåˆ¶åšå®¢</h2>
<p>åŸºäº <a href="https://www.pseudoyu.com/">pseudoyu</a> çš„åšå®¢å’Œä¸»é¢˜å®šåˆ¶åšå®¢ï¼Œå‘ç°å¹¶ä¿®å¤äº†bugï¼Œè¿˜åšäº†ä¸€äº›æ”¹è¿›ï¼Œå¹¶åœ¨ä»–çš„ github æäº¤ <a href="https://github.com/pseudoyu/pseudoyu/issues/2">issue</a> å’Œ merge requestã€‚</p>
<img src="https://chensoul.oss-cn-hangzhou.aliyuncs.com/images/github-issue-build-aboutme-py.png" alt="github-issue-build-aboutme-py" style="width: 70%"/>
<p>æ¥ç€åœ¨ä»–åšå®¢ä¸»é¡µç•™è¨€ï¼Œå‡ ä¸ªæ¥å›ä¸‹æ¥ï¼Œæ”¶è·ä¸å°‘ã€‚ä¸€æ˜¯è§£å†³äº†æˆ‘æå‡ºçš„é—®é¢˜ï¼ŒäºŒæ˜¯ç»™æˆ‘åˆ†äº«äº†ä¸€ä¸ªæ¬ç“¦å·¥çš„ the plan ä¼˜æƒ ç ã€‚è¿™æ—¶å€™å»çœ‹äº†ä¸‹æˆ‘åŸæ¥çš„ vps åˆšå¥½è¿˜æœ‰ä¸€å¤©è¦åˆ°æœŸï¼Œå°±ç«‹å³èŠ±äº†92 ç¾å…ƒï¼ˆåŸä»·æ˜¯ 99 ç¾å…ƒï¼‰è´­ä¹°äº†ä¸€å° 2G å†…å­˜æ‰˜ç®¡åœ¨é¦™æ¸¯çš„æœåŠ¡å™¨ã€‚</p>
<p><img src="http://chensoul.oss-cn-hangzhou.aliyuncs.com/images/vps-main-controlls.png" alt="vps-main-controlls"></p>
<p>ç¼˜åˆ†å°±æ˜¯è¿™ä¹ˆå¥‡å¦™ï¼Œå¦‚æœæˆ‘ä¸ä¸»åŠ¨å’Œè¿™ä¸ªåšä¸»è”ç³»ï¼Œå°±ä¸ä¼šçŸ¥é“æ¬ç“¦å·¥è¿˜æœ‰è¿™ä¸ªä¼˜æƒ ï¼Œå°±ä¸ä¼šå¸®åŠ©æˆ‘è§£å†³äº†åšå®¢å®šåˆ¶è¿‡ç¨‹ä¸­é‡åˆ°çš„ç–‘æƒ‘ã€‚</p>
<blockquote>
<p>å½“ä½ æƒ³è¦ä»€çš„æ—¶å€™ï¼Œå…ˆç»™å‡ºå»ï¼Œä½ å°±ä¼šæ”¶è·æ›´ã€‚æœ‰èˆæ‰æœ‰å¾—ã€‚</p>
</blockquote>
<h2 id="åšå®¢ä¸ªäººä»‹ç»">åšå®¢ä¸ªäººä»‹ç»</h2>
<p>æˆ‘çš„åšå®¢æºæ–‡ä»¶æ‰˜ç®¡åœ¨ <a href="https://github.com/chensoul/chensoul.github.io">gihub</a>ï¼Œåœ¨è¿™ä¸ªä»“åº“å¯ä»¥çœ‹åˆ°æˆ‘çš„ä¸€äº›ä¸ªäººä»‹ç»ï¼Œå½“ç„¶ï¼Œæˆ‘çš„åšå®¢ä¹Ÿæœ‰ä¸ªäººä»‹ç»ï¼ˆåœ¨<a href="https://blog.chensoul.com/about/">å…³äº</a>é¡µé¢ï¼‰ï¼Œå¦‚æœä½ ä»”ç»†è§‚å¯Ÿï¼Œå¯ä»¥å‘ç°ä»–ä»¬åŸºæœ¬ä¸Šæ˜¯ä¸€æ ·çš„ï¼Œè¿™ä¸ªæ˜¯æ€ä¹ˆå®ç°çš„å‘¢ï¼Ÿ</p>
<img src="http://chensoul.oss-cn-hangzhou.aliyuncs.com/images/chensoul-github-io-readme.png" alt="chensoul-github-io-readme" style="width: 70%"/>
<p>é¦–å…ˆï¼Œgithub é‡Œé¢å¯ä»¥åˆ›å»ºä¸€ä¸ªä»¥ github è´¦å·ä¸ºåç§°çš„ä»“åº“ï¼Œç„¶åç¼–è¾‘å¥½ README.md æ–‡ä»¶ï¼ŒREADME.md æ–‡ä»¶å†…å®¹å°±ä¼šæ¸²æŸ“æˆ html æ˜¾ç¤ºåˆ°ä¸ªäºº github ä¸»é¡µã€‚ä¾‹å¦‚ï¼Œæˆ‘çš„ github ä¸»é¡µæ˜¯ <a href="https://github.com/chensoul">https://github.com/chensoul</a>ï¼Œæˆ‘çš„ä¸ªäººä»“åº“åœ°å€ä¸º <a href="https://github.com/chensoul/chensoul">https://github.com/chensoul/chensoul</a>ï¼Œè¿™ä¸ªä»“åº“æ˜¯é€šè¿‡ github actions æ¥æ„å»º README.mdï¼Œæ„å»ºæ–‡ä»¶æŸ¥çœ‹ä»“åº“çš„ workflows æ–‡ä»¶ï¼Œä¸»è¦æœ‰ä¸¤ä¸ªæ–‡ä»¶ï¼š</p>
<ul>
<li>build.ymlï¼šå‘¨æœŸæ€§çš„è°ƒç”¨ <a href="https://github.com/chensoul/chensoul/blob/main/build_readme.py">build_readme.py</a> æ¥ç”Ÿæˆ README.md æ–‡ä»¶ï¼ˆåŒ…æ‹¬ï¼šè·å–æœ€è¿‘ 5 ç¯‡åšå®¢æ–‡ç« ã€æˆ–è€… è±†ç“£ä¸Šæœ€è¿‘ 5 ä¸ªç”µå½±ä¹¦ç±åŠ¨æ€ã€è·å– github ä¸Šå‘å¸ƒçš„é¡¹ç›®ã€æ˜¾ç¤º wakatime æŠ¥è¡¨ï¼‰</li>
<li>waketime.ymlï¼šç”Ÿæˆ wakatime-charts</li>
</ul>
<p>å½“ README.md ç”Ÿæˆä¹‹åï¼Œåªéœ€è¦å°†è¯¥æ–‡ä»¶å†…å®¹åŒæ­¥åˆ°åšå®¢çš„ about.md æ–‡ä»¶å³å¯ã€‚æ€ä¹ˆå®ç°å‘¢ï¼Ÿå‚è€ƒåšå®¢æºæ–‡ä»¶é‡Œçš„ <a href="https://github.com/chensoul/chensoul.github.io/blob/main/build_about.py">build_about.py</a>ã€‚è¿™æ ·å°±å¯ä»¥å®ç°ä¸€ä¸ªè‡ªæˆ‘ä»‹ç»åŒæ­¥åˆ°å¤šä¸ªå¹³å°ï¼ˆé™¤äº†åšå®¢ï¼Œè¿˜å¯ä»¥é€šè¿‡ api æ¥å£åŒæ­¥åˆ°è¯­é›€ç­‰å…¶ä»–å¹³å°ï¼‰ã€‚</p>
<h2 id="vps-ä¸ŠæœåŠ¡éƒ¨ç½²">vps ä¸ŠæœåŠ¡éƒ¨ç½²</h2>
<p>è´­ä¹°äº†æ–°çš„ VPS ä¹‹åï¼Œå°±å°†åŸæ¥çš„ VPS å¯¼å‡ºé•œåƒï¼Œç„¶åå¯¼å…¥åˆ°æ–°çš„ VPSï¼Œæœ€åå†å®‰è£…äº†ä»¥ä¸‹æœåŠ¡ï¼š</p>
<ul>
<li><a href="https://github.com/indes/flowerss-bot">flowerss-bot</a>ï¼šä¸€ä¸ªæ”¯æŒåº”ç”¨å†…é˜…è¯»çš„ Telegram RSS Botã€‚</li>
<li><a href="https://n8n.io/">n8n</a>ï¼šä¸€æ¬¾å¼€æºçš„è‡ªåŠ¨å·¥ä½œæµæœåŠ¡ï¼Œç±»ä¼¼ IFTTTã€Zapierï¼Œå¯ä»¥äº’è”äº’é€šåŒ…æ‹¬ GitHubã€Dropboxã€Googleã€NextCLoudã€RSSã€Slackã€Telegram åœ¨å†…çš„å‡ åæ¬¾åœ¨çº¿æœåŠ¡ã€‚</li>
<li>memosï¼šä¸€ä¸ªå¼€æºä¸”å…è´¹çš„è‡ªæ‰˜ç®¡çŸ¥è¯†åº“</li>
<li>cusdisï¼šä¸€ä¸ªç•Œé¢æ¸…çˆ½ã€æ³¨é‡éšç§çš„è½»é‡çº§ (~5kb gzip) è¯„è®ºç³»ç»Ÿï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿åœ°ä¸ Reactã€Vue æˆ–å…¶ä»–åšå®¢ç³»ç»Ÿç»“åˆï¼Œå¹¶ä¸”è¿˜æä¾›äº†ä¸€ä¸ªåå°æ¥ç®¡ç†æ‰€æœ‰çš„è¯„è®º</li>
<li>umamiï¼šä¸€ä¸ªç®€å•æ˜“ç”¨ã€è‡ªæ‰˜ç®¡çš„å¼€æºç½‘ç«™è®¿é—®æµé‡<em>ç»Ÿè®¡</em>åˆ†æå·¥å…·</li>
<li>pgsql</li>
<li>uptime-kumaï¼šä¸€ä¸ªå¼€æºå…è´¹çš„ç›‘æ§å·¥å…·</li>
<li>rsshubï¼šä¸€ä¸ªå¼€æºã€ç®€å•æ˜“ç”¨ã€æ˜“äºæ‰©å±•çš„RSS ç”Ÿæˆå™¨ï¼Œå¯ä»¥ç»™ä»»ä½•å¥‡å¥‡æ€ªæ€ªçš„å†…å®¹ç”ŸæˆRSS è®¢é˜…æº</li>
</ul>
<p><img src="http://chensoul.oss-cn-hangzhou.aliyuncs.com/images/vps-docker-service.png" alt="vps-docker-service"></p>
<p>é€šè¿‡ Docker éƒ¨ç½²è¿™äº›æœåŠ¡éå¸¸ç®€å•ï¼Œä¸»è¦æ˜¯éœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼šå°†è¿™äº›æœåŠ¡éƒ¨ç½²åˆ°åŒä¸€ä¸ªç½‘è·¯ï¼Œè¿™æ ·å„ä¸ªæœåŠ¡ä¹‹é—´å¯ä»¥äº’ç›¸é€šä¿¡ã€‚æ¯”å¦‚ï¼šå¾ˆå¤šæœåŠ¡éƒ½éœ€è¦ä¾èµ–æ•°æ®åº“ postgresqlï¼Œå¯ä»¥ä½¿ç”¨ docker-compose æ¥ç¼–æ’æœåŠ¡ã€‚å®‰è£…éƒ¨ç½²è¿‡ç¨‹å‚è€ƒï¼š<a href="/posts/2023/01/25/notes-about-deploy-services-in-vps/">æˆ‘çš„VPSæœåŠ¡éƒ¨ç½²è®°å½•</a></p>
]]></content:encoded></item><item><title>å‘¨æŠ¥ #2ï½œåšå®¢é‡æ„</title><link>https://blog.chensoul.com/posts/2023/01/15/weekly_review_2/</link><pubDate>Sun, 15 Jan 2023 09:47:03 +0800</pubDate><guid>https://blog.chensoul.com/posts/2023/01/15/weekly_review_2/</guid><description>å‰è¨€ æœ¬ç¯‡æ˜¯å¯¹ 2023-01-09 åˆ° 2023-01-15 è¿™å‘¨ç”Ÿæ´»çš„è®°å½•ä¸æ€è€ƒã€‚ è¿™æ˜¯å¹´å‰å€’æ•°ç¬¬äºŒä¸ªå·¥ä½œå‘¨ï¼Œå·¥ä½œä¸Šä¸»è¦æ˜¯å®Œæˆé¡¹ç›®ä¸€ä¸ªç‰ˆæœ¬çš„æµ‹è¯•å’Œå‘å¸ƒã€‚è¿™ä¸ªåšå®¢ä¸»è¦æ˜¯åˆ†äº«ä¸€äº›æŠ€æœ¯ç›¸å…³ç¬”</description><content:encoded><![CDATA[<h2 id="å‰è¨€">å‰è¨€</h2>
<p>æœ¬ç¯‡æ˜¯å¯¹ <code>2023-01-09</code> åˆ° <code>2023-01-15</code> è¿™å‘¨ç”Ÿæ´»çš„è®°å½•ä¸æ€è€ƒã€‚</p>
<p>è¿™æ˜¯å¹´å‰å€’æ•°ç¬¬äºŒä¸ªå·¥ä½œå‘¨ï¼Œå·¥ä½œä¸Šä¸»è¦æ˜¯å®Œæˆé¡¹ç›®ä¸€ä¸ªç‰ˆæœ¬çš„æµ‹è¯•å’Œå‘å¸ƒã€‚è¿™ä¸ªåšå®¢ä¸»è¦æ˜¯åˆ†äº«ä¸€äº›æŠ€æœ¯ç›¸å…³ç¬”è®°å’Œä¸ªäººçš„ç”Ÿæ´»è®°å½•ä¸æ€è€ƒï¼Œæ‰€ä»¥ä¸ä¼šæ¶‰åŠå…·ä½“çš„å·¥ä½œå†…å®¹ã€‚</p>
<p>å‘¨ä¸‰æ™šä¸Šæ˜¯éƒ¨é—¨å¹´ä¼šï¼Œé¢†å¯¼æå‡ºäº† 2023 å¹´æ”¶å…¥ 6.2 äº¿çš„ç›®æ ‡ï¼Œæ¯” 2022 å¹´æ”¶å…¥å¢é•¿ 140%ã€‚ä»å…¬å¸é¢†å¯¼å±‚è¿™ä¹è§‚çš„å¹´åº¦è§„åˆ’ï¼Œçœ‹å¾—å‡ºæ¥å…¬å¸çš„å‘å±•å±äºä¸Šå‡è¶‹åŠ¿ï¼ŒåŒæ—¶æ„å‘³ç€ 2023 å¹´åˆæ˜¯å¿™ç¢Œå’Œå‹åŠ›å·¨å¤§çš„ä¸€å¹´ã€‚</p>
<p>å·¥ä½œé—²æš‡ä¹‹ä½™ï¼Œçœ‹åˆ°äº†ä¸€äº›ç‹¬ç«‹å¼€å‘è€…çš„åšå®¢ï¼Œå¹¶å—ä»–ä»¬åšå®¢æ–‡ç« çš„å½±å“ï¼Œç«‹å³å†³å®šé‡æ–°æ£é¼“åšå®¢ã€‚äºæ˜¯ï¼Œåœ¨ä¸€è…”çƒ­æƒ…ä¹‹ä¸‹ï¼ŒèŠ±äº†ä¸‰å¤©æ—¶é—´é‡æ„äº†åšå®¢ï¼Œä¹Ÿå¯¹åšå®¢ä»¥åçš„æ–¹å‘åšäº†ä¸€äº›è§„åˆ’ã€‚</p>
<p>å‘¨æœ«æ˜¯è¿‡å°å¹´ï¼Œå°å¹´ä¼Šå§‹ï¼Œå¹´å‘³æ¸æµ“ã€‚å‘¨å…­æ™šä¸Šï¼Œå ‚å“¥å®¶åƒå¹´é¥­ã€‚å‘¨æ—¥ä¸­åˆï¼Œè‡ªå·±å®¶åƒå¹´é¥­ã€‚è¿™æ˜¯æ–°å©šåç¬¬ä¸€æ¬¡ä¸¤è¾¹çš„å®¶äººä¸€èµ·åƒå¹´é¥­ã€‚è™½ç„¶å¾ˆæ—©å°±ç¡®å®šäº†å¹´é¥­æ—¶é—´å¤§å®¶éƒ½æœ‰æ—¶é—´çš„å‘¨æœ«ã€é¢„å®šäº†å¯ä»¥åä¸‹ 20 å¤šäººçš„å¤§æ¡Œï¼Œä½†è¿˜æ˜¯é—æ†¾äººæ²¡æœ‰åˆ°é½ã€‚</p>
<p><img src="http://chensoul.oss-cn-hangzhou.aliyuncs.com/images/new-year-dinner-20230115.png" alt="new-year-dinner-20230115"></p>
<h2 id="åšå®¢é‡æ„">åšå®¢é‡æ„</h2>
<h3 id="åšå®¢ä¸»é¢˜">åšå®¢ä¸»é¢˜</h3>
<p>ä»¥å‰çš„åšå®¢ä¸»è¦æ˜¯çº¯ç²¹åˆ†äº«æŠ€æœ¯ï¼Œå¾ˆå°‘æœ‰è‡ªå·±çš„æ€è€ƒï¼ŒåŸºæœ¬ä¸Šå°±æ˜¯ä»£ç æ¯”æ±‰å­—è¦å¤šä¸å°‘ã€‚åšå®¢æ²¡æœ‰åšä¸»çš„æ€è€ƒï¼Œæ— æ³•è®©è¯»è€…è®¤è¯†ã€äº†è§£åšä¸»ï¼Œå¹¶å’Œåšä¸»äº§ç”Ÿæ·±å…¥çš„é“¾æ¥ã€‚è¿™æ ·çš„åšå®¢æ²¡æœ‰çµé­‚ï¼Œå°±ä»…ä»…æ˜¯ä¸€ä¸ªçº¯åˆ†äº«çš„ wikiã€‚</p>
<p>è¿™æ¬¡é‡æ–°å¼€å§‹å†™åšå®¢ä¹‹åï¼Œè§„åˆ’çš„åšå®¢ä¸»é¢˜æ˜¯åˆ†äº«æŠ€æœ¯ã€è®°å½•ç”Ÿæ´»ã€å¯å‘æ€è€ƒã€‚æŠ€æœ¯ä¸Šçš„æ–‡ç« ï¼Œè¦æœ‰æ·±åº¦ï¼›ç”Ÿæ´»çš„ç‚¹æ»´ï¼Œè¦æœ‰å¤ç›˜ï¼›æ€è€ƒçš„å†…å®¹ï¼Œè¦æœ‰å…±é¸£ã€‚</p>
<p><img src="http://chensoul.oss-cn-hangzhou.aliyuncs.com/images/blog-homepage-den-theme.png" alt="blog-homepage-den-theme"></p>
<h3 id="åšå®¢è§„åˆ’">åšå®¢è§„åˆ’</h3>
<p>ä»¥å‰åšå®¢æ–‡ç« çš„åˆ†ç±»æœ‰ javaã€databaseã€devopsã€webï¼Œåœ¨åˆ äº†ä¸€äº›æ–‡ç« ä¹‹åï¼Œå°†åšå®¢çš„åˆ†ç±»è°ƒæ•´ä¸ºæƒ³æ³•ï¼ˆIdeasï¼‰ã€ç¬”è®°ï¼ˆNotesï¼‰ä¸¤ç±»ï¼Œåé¢å†æ ¹æ®å®é™…æƒ…å†µæ·»åŠ æˆ–è€…è°ƒæ•´åˆ†ç±»ã€‚</p>
<blockquote>
<p>å¥åº·ï¼Œçˆ±æƒ…å’Œä½¿å‘½ï¼ŒæŒ‰ç…§è¿™ä¸ªé¡ºåºï¼Œå…¶å®ƒçš„éƒ½ä¸é‡è¦</p>
</blockquote>
<h3 id="æ–‡ç« é“¾æ¥">æ–‡ç« é“¾æ¥</h3>
<p>ä»¥å‰çš„åšå®¢é“¾æ¥æ ¼å¼æ˜¯ <code>posts/:slug</code>ï¼Œç°åœ¨è°ƒæ•´ä¸º <code>posts/:year/:month/:day/:slug</code>ã€‚å› ä¸ºç°åœ¨åšå®¢åªæœ‰å‡ ç¯‡æ–‡ç« ï¼Œæ‰€ä»¥æš‚æ—¶ä¸æ‰“ç®—åšåŸæœ‰é“¾æ¥è·¯å¾„åˆ°æ–°è·¯å¾„çš„é‡å®šå‘å·¥ä½œã€‚</p>
<h3 id="åšå®¢éƒ¨ç½²">åšå®¢éƒ¨ç½²</h3>
<p>ç›®å‰æœ‰ä¸‰ç§æ–¹æ¡ˆéƒ¨ç½²æ–¹æ¡ˆï¼š</p>
<ul>
<li>github pagesã€‚å›½å†…è®¿é—®é€Ÿåº¦å—å½±å“ã€‚</li>
<li>cloudflare pagesã€‚å¯ä»¥ä½¿ç”¨ cdn åŠ é€Ÿã€‚</li>
<li>Self hostedã€‚éœ€è¦è´­ä¹°äº‘ä¸»æœºå’Œæ‰‹åŠ¨è¿ç»´ã€‚</li>
</ul>
<p>ç›®å‰ï¼Œæ˜¯å€¾å‘äºä½¿ç”¨ç¬¬äºŒç§æ–¹æ¡ˆã€‚æºç ä¿å­˜åˆ° github ä¸Šï¼Œgithub actions ç¼–è¯‘å’Œéƒ¨ç½²é™æ€æ–‡ä»¶åˆ° cf-pages åˆ†æ”¯ï¼Œé€šè¿‡ cloudflare pages é“¾æ¥ github ä»“åº“ã€è‡ªåŠ¨åŒ–éƒ¨ç½²é™æ€æ–‡ä»¶å¹¶è®¾ç½®è‡ªå®šä¹‰åŸŸå <code>blog.chensoul.com</code>ã€‚</p>
<h3 id="å‘å¸ƒæµç¨‹">å‘å¸ƒæµç¨‹</h3>
<p>æœ¬åœ°ç¼–å†™ markdown æ–‡ä»¶ï¼Œå›¾ç‰‡ä¿å­˜åˆ°å…¬æœ‰äº‘ï¼Œé€šè¿‡ git æäº¤åˆ° github ä»“åº“ï¼Œä½¿ç”¨ github actions é€šè¿‡ n8n è‡ªåŠ¨å‘å¸ƒåˆ°å¤šå¹³å°ï¼Œæ¯”å¦‚ï¼šå…¬ä¼—å·ï¼Œè¯­é›€ç­‰ã€‚</p>
<h3 id="å¾…åŠäº‹é¡¹">å¾…åŠäº‹é¡¹</h3>
<p>æœ¬å‘¨å¯¹åšå®¢é‡æ„ï¼Œè®¡åˆ’å®Œæˆä»¥ä¸‹åŠŸèƒ½ï¼š</p>
<ul>
<li><input checked="" disabled="" type="checkbox"> åœ¨ä¸ä¿®æ”¹åŸä¸»é¢˜çš„å‰æä¸‹ï¼Œé€šè¿‡ git log è®°å½•å¯¹ä¸»é¢˜çš„æ”¹åŠ¨</li>
<li><input checked="" disabled="" type="checkbox"> æ·»åŠ  <a href="https://cusdis.com/">Cusdis </a>è¯„è®ºç³»ç»Ÿ</li>
<li><input checked="" disabled="" type="checkbox"> æ·»åŠ  <a href="https://umami.is/">Umami</a> ç»Ÿè®¡åˆ†æ</li>
<li><input checked="" disabled="" type="checkbox"> æ·»åŠ  <a href="https://uptime.kuma.pet/">Kuma</a> æœåŠ¡ç›‘æ§</li>
<li><input checked="" disabled="" type="checkbox"> æ·»åŠ æœç´¢ã€å›åˆ°é¡¶éƒ¨åŠŸèƒ½</li>
<li><input checked="" disabled="" type="checkbox"> ä½¿ç”¨ <a href="https://oss.console.aliyun.com/overview">é˜¿é‡Œäº‘å¯¹è±¡å­˜å‚¨</a> ä½œä¸ºå›¾åºŠ</li>
<li><input disabled="" type="checkbox"> github actions é›†æˆ <a href="https://n8n.io/">n8n</a></li>
<li><input disabled="" type="checkbox"> åŸŸå dns è§£æè¿ç§»åˆ° cloudflare</li>
</ul>
<p>ä»¥ä¸‹æ˜¯ä½¿ç”¨ kuma ç›‘æ§æˆ‘çš„ VPS ä¸Šçš„æœåŠ¡ã€‚</p>
<p><img src="http://chensoul.oss-cn-hangzhou.aliyuncs.com/images/chensoul-uptime.png" alt="chensoul-uptime"></p>
]]></content:encoded></item><item><title>å‘¨æŠ¥ #1ï½œå¼€å§‹å†™å‘¨æŠ¥ã€å†¥æƒ³</title><link>https://blog.chensoul.com/posts/2023/01/08/weekly_review_1/</link><pubDate>Sun, 08 Jan 2023 09:47:03 +0800</pubDate><guid>https://blog.chensoul.com/posts/2023/01/08/weekly_review_1/</guid><description>å‰è¨€ æœ¬ç¯‡æ˜¯å¯¹ 2023-01-02 åˆ° 2023-01-08 è¿™å‘¨ç”Ÿæ´»çš„è®°å½•ä¸æ€è€ƒã€‚ è¿™æ˜¯ 2023 å¹´çš„ç¬¬ä¸€å‘¨ï¼Œå…ƒæ—¦æ”¾äº†ä¸‰å¤©å‡ä¹‹åï¼Œå°±ç”¨æŠ•å…¥äº†å·¥ä½œä¹‹ä¸­ã€‚å…ƒæ—¦å·²è¿‡ï¼Œè¿‡å¹´å°±æ²¡å¤šè¿œäº†ï¼Œå¾ˆå¤šå…¬å¸ä¹Ÿå¼€å§‹å‡†</description><content:encoded><![CDATA[<h2 id="å‰è¨€">å‰è¨€</h2>
<p>æœ¬ç¯‡æ˜¯å¯¹ <code>2023-01-02</code> åˆ° <code>2023-01-08</code> è¿™å‘¨ç”Ÿæ´»çš„è®°å½•ä¸æ€è€ƒã€‚</p>
<p>è¿™æ˜¯ 2023 å¹´çš„ç¬¬ä¸€å‘¨ï¼Œå…ƒæ—¦æ”¾äº†ä¸‰å¤©å‡ä¹‹åï¼Œå°±ç”¨æŠ•å…¥äº†å·¥ä½œä¹‹ä¸­ã€‚å…ƒæ—¦å·²è¿‡ï¼Œè¿‡å¹´å°±æ²¡å¤šè¿œäº†ï¼Œå¾ˆå¤šå…¬å¸ä¹Ÿå¼€å§‹å‡†å¤‡å¹´ä¼šäº†ã€‚å› ä¸ºç–«æƒ…ï¼Œè¿™ä¸ªå¹´æ³¨å®šä¸å¥½è¿‡ã€‚ç°åœ¨ç–«æƒ…æ”¾å¼€ï¼Œä¸çŸ¥é“æœ‰å¤šå°‘å…¬å¸èƒ½å¤Ÿç†¬è¿‡è¿™ä¸ªå¹´ï¼Œè¿›å…¥ç™¾åºŸå¾…å…´çš„èŠ‚å¥ã€‚</p>
<p>æœ€è¿‘æŠŠ rss é˜…è¯»å™¨åˆç”¨èµ·æ¥ï¼Œæ¯å¤©é˜…è¯»è®¢é˜…çš„æœªè¯»æ–‡ç« ï¼Œå…³æ³¨åˆ°å¥½å‡ ä¸ªç‹¬ç«‹å¼€å‘è€…ã€‚ä»–ä»¬æ¯å‘¨éƒ½åœ¨åšæŒå†™åšå®¢ã€åˆ†äº«æŠ€æœ¯æ–‡ç« ã€‚ä»ä»–ä»¬çš„åˆ†äº«é‡Œé¢ï¼Œå¯ä»¥çœ‹åˆ°ä»–ä»¬æœ‰åœ¨åšè‡ªå·±çš„ side projectsï¼Œä¹Ÿæœ‰åœ¨å¼€æºé¡¹ç›®æäº¤ä»£ç ã€‚çœ‹ç€ä»–ä»¬çš„ github ä¸»é¡µæ¯å¤©éƒ½æœ‰æäº¤ä»£ç ï¼Œå†çœ‹çœ‹æˆ‘çš„ github ä¸»é¡µå¾ˆä¹…æ²¡æœ‰æäº¤è¿‡ä»£ç ï¼Œé¡¿æ„Ÿæƒ­æ„§ã€‚ç›®å‰ï¼Œå…¬å¸ä½¿ç”¨çš„æ˜¯è‡ªå»ºçš„ gitlab ä»“åº“æ‰˜ç®¡ä»£ç ï¼Œå¾ˆå¤šä»£ç ä¸æ–¹ä¾¿å…¬å¼€åˆ†äº«ï¼Œè‡ªå·±å¤œå¾ˆå°‘èŠ±æ—¶é—´å†™ä¸€äº›å°é¡¹ç›®å…¬å¼€åˆ†äº«åˆ° githubã€‚å¹²è„†å°±æ¸…ç†ä¸€äº› github é•¿æœŸæ²¡æœ‰ç»´æŠ¤çš„ä»“åº“ï¼Œå–å…³äº†ä¸€äº›å¥½å‹ï¼Œæ›´æ–°äº† github ä¸»é¡µï¼Œæœ€åçœ‹äº†ä¸€ä¸‹ç²‰ä¸è¿˜æœ‰ 574 äººï¼Œç›¸å¯¹è€Œè¨€ä¹Ÿæ˜¯å°‘çš„å¯æ€œğŸ¥ºã€‚</p>
<h2 id="å¼€å§‹å†™å‘¨æŠ¥">å¼€å§‹å†™å‘¨æŠ¥</h2>
<p>å‰æ®µæ—¶é—´ï¼Œå¼€å§‹å°è¯•åœ¨ <a href="https://www.yuque.com/chensoul">è¯­é›€</a> ä¸Šæ¯å¤©å†™æ—¥è®°ï¼Œå†™äº†å‡ å¤©ä¹‹åï¼Œæ²¡æœ‰åšæŒä¸‹æ¥ã€‚</p>
<img src="http://chensoul.oss-cn-hangzhou.aliyuncs.com/images/yuque-life-note.png" alt="yuque-life-note" style="width: 50%"/>
<p>æ€»ç»“äº†ä¸€ä¸‹ï¼Œæ²¡æœ‰åšæŒä¸‹æ¥çš„åŸå› ä¸»è¦æ˜¯åœ¨äºæ¯å¤©æ²¡æœ‰ç§¯ç´¯è¶³å¤Ÿçš„åˆ†äº«å†…å®¹ï¼Œä¹Ÿå°±æ˜¯è¾“å…¥ä¸å¤Ÿï¼›å¦å¤–ï¼Œè¾“å‡ºä¹‹åçš„åé¦ˆä¸å¤Ÿï¼Œè¿™å’Œè§‚ä¼—æµé‡æœ‰å…³ã€‚ä½œä¸ºä¸€ä¸ªç¨‹åºå‘˜ï¼Œæ›´å–œæ¬¢è‡ªåŠ¨åŒ–å·¥ä½œçš„å¿«æ„Ÿå’Œæ»¡è¶³æ„Ÿã€‚å“Ÿè¿˜æ˜¯æ›´å€¾å‘äºå°†åšå®¢ä»¥ markdown æ–‡ä»¶ä¿å­˜åˆ°æœ¬åœ°æˆ–è€… git ä»“åº“ï¼Œç„¶åé€šè¿‡è‡ªåŠ¨åŒ–è„šæœ¬ç¼–è¯‘éƒ¨ç½²åˆ°å¤šå¹³å°ã€‚åœ¨å…³æ³¨äº†ä¸€äº›ç‹¬ç«‹å¼€å‘è€…çš„åšå®¢ä¹‹åï¼Œæ›´æ˜¯åšå®šäº†è¿™ç§æƒ³æ³•ã€‚äºæ˜¯æœ‰äº†è¿™ç¯‡å†™å‘¨æŠ¥çš„æ–‡ç« ï¼Œä»¥å‘¨ä¸ºå•ä½è®°å½•æ¯ä¸€å‘¨çš„æ‰€çœ‹æ‰€æ€æ‰€æ„Ÿã€‚</p>
<p>å…³äºå†™åšå®¢çš„æµç¨‹ï¼Œç”µè„‘ä¸Šä½¿ç”¨ typora ç¼–è¾‘å™¨æœ‰ç€å¾ˆå¥½çš„ç”¨æˆ·ä½“éªŒã€‚å¦‚æœä¹Ÿèƒ½åœ¨æ‰‹æœºä¸Šç”¨ markdown å†™æ–‡ç« å¹¶æäº¤åˆ° github ä¸Šå°±æ›´å®Œç¾äº†ã€‚åˆšå¼€å§‹æˆ‘ä½¿ç”¨çš„æ˜¯ mweb è¿™ä¸ª appï¼Œæœ€è¿‘åœ¨ ios ä¸Šåˆå‘ç°äº† metion è¿™ä¸ª app å°±å¯ä»¥æ”¯æŒå’Œ git åŒæ­¥ã€‚</p>
<img src="http://chensoul.oss-cn-hangzhou.aliyuncs.com/images/ios-app-metion.png" alt="ios-app-metion" style="width: 50%"/>
<p>è¿™ç¯‡æ–‡ç« å°±æ˜¯é€šè¿‡ metion ç¼–å†™å’Œæäº¤çš„ã€‚å›¾ç‰‡æ˜¯æœ¬åœ°ä¸Šä¼ çš„ï¼Œå›¾ç‰‡åç§°åº”è¯¥æ˜¯ä¸€ä¸²éšæœºæ•°ï¼Œå¾…æ–‡ç« å‘å¸ƒä¹‹åï¼Œéœ€è¦å°†å›¾ç‰‡é‡å‘½åä¸ºæœ‰æ„ä¹‰çš„åç§°ï¼Œè¿™æ ·æ–¹ä¾¿åœ¨å›¾åºŠé‡ŒæŸ¥é˜…å’Œç®¡ç†ã€‚</p>
<img src="http://chensoul.oss-cn-hangzhou.aliyuncs.com/images/metion-writing-first-blog.png" alt="metion-writing-first-blog" style="width: 50%"/>
<p>å…³äºå›¾ç‰‡çš„å®½åº¦è®¾ç½®ï¼Œç‰¹åˆ«æ˜¯ç«–å½¢å›¾ï¼Œå»ºè®®å°†å®½åº¦è®¾ç½®ä¸ºä¸€åŠã€‚è®¾ç½®æ–¹æ³•æ˜¯ï¼šåœ¨ md æ–‡ä»¶é‡Œä½¿ç”¨ <code>img</code> æ ‡ç­¾å¼•å…¥å›¾ç‰‡ï¼Œè¿™æ ·å°±å¯ä»¥æ·»åŠ ä¸€ä¸ª <code>sytle=&quot;width: 50%&quot;</code> æ¥è®¾ç½®å®½åº¦ã€‚ä¾‹å¦‚ï¼Œä¸Šé¢å›¾ç‰‡å°±æ˜¯è¿™æ ·è®¾ç½®çš„ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;http://chensoul.oss-cn-hangzhou.aliyuncs.com/images/ios-app-metion.png&#34;</span> <span class="na">alt</span><span class="o">=</span><span class="s">&#34;ios-app-metion&#34;</span> <span class="na">style</span><span class="o">=</span><span class="s">&#34;width: 50%&#34;</span><span class="p">&gt;</span>
</span></span></code></pre></div><h2 id="å†…è§‚å†¥æƒ³">å†…è§‚å†¥æƒ³</h2>
<p>è¿™ä¸ªæœˆå‚åŠ äº†ä¸€ä¸ªå†…è§‚å†¥æƒ³ 21 å¤©è®­ç»ƒè¥ï¼Œæ¯å¤©æ—©ä¸Š 7 ç‚¹åˆ° 8 ç‚¹æ˜¯ä¸Šè¯¾æ—¶é—´ï¼Œæ­£å¥½ä¹Ÿæ˜¯æˆ‘ä¸Šç­æ—¶é—´ã€‚åœ¨å¬äº†å‡ å¤©è¯¾ç¨‹å¹¶æ‰“å¡ä¹‹åï¼Œå°±æ”¾å¼ƒäº†ã€‚</p>
<p>21 å¤©è¯¾ç¨‹å†…å®¹ï¼Œæ¯å¤©çš„ä¸»é¢˜åˆ†åˆ«æ˜¯ï¼š</p>
<ul>
<li>ç›®æ ‡</li>
<li>è®¡åˆ’</li>
<li>ç»“æœ</li>
<li>æ¯”è¾ƒ</li>
<li>æŠ±æ€¨</li>
<li>åæ‚”</li>
<li>ä»–åº”è¯¥çŸ¥é“è‡ªå·±é”™äº†</li>
<li>ä¸å¯èƒ½</li>
</ul>
<h3 id="ç›®æ ‡">ç›®æ ‡</h3>
<blockquote>
<p>ä»Šæ—¥å†…è§‚å†¥æƒ³ä¸»é¢˜æ˜¯ç›®æ ‡</p>
<p>é™é™åœ°æ”¾ç©ºè‡ªå·±ï¼Œå›æƒ³è‡ªå·±å…³æ³¨ç›®æ ‡çš„è®°å¿†ã€‚å¥½åƒè‡ªå·±æ›¾ç»è®¾ç«‹è¿‡å¾ˆå¤šç›®æ ‡ï¼Œåˆå¥½åƒä»€ä¹ˆéƒ½æ²¡æœ‰ã€‚ç›®æ ‡æ˜¯ä»€ä¹ˆï¼Œå¥½åƒæè¿°ä¸å‡ºæ¥ï¼Œåˆç¢ç£¨ä¸é€ã€‚</p>
<p>æ›¾ç»ç«‹ä¸‹çš„é‚£äº›ç›®æ ‡ç®—æ˜¯ç›®æ ‡å—ï¼Ÿä»–ä»¬å¯ä»¥å®ç°å—ï¼Ÿä»–ä»¬å®ç°äº†å—ï¼Ÿä¸ºä»€ä¹ˆæ²¡æœ‰å®ç°å‘¢ï¼Ÿæ— å¿—ä¹‹äººå¸¸ç«‹å¿—ï¼Œæœ‰å¿—ä¹‹äººç«‹å¸¸å¿—ã€‚è¿œçš„ä¸è¯´ï¼Œå…ˆçœ‹çœ‹ 2022 å¹´å®ç°äº†å“ªäº›ç›®æ ‡ã€‚è¯»ä¹¦ï¼Œæ˜¯å½»åº•æ”¾ä¸‹äº†ï¼›å¥èº«ï¼Œå…ƒæ—¦å‰å‡åˆ° 130 æ–¤çš„ç›®æ ‡åœ¨â€œé˜³åº·åä¸è¦å‰§çƒˆè¿åŠ¨â€çš„è¯´è¾ä¸‹è€½è¯¯äº†ï¼›å®šæŠ•ï¼Œä¹Ÿæ˜¯ç»ˆæ­¢äº†ï¼›ä¹°è½¦ï¼Œè½¦æ˜¯æ¶ˆè€—å“ï¼›ç»“å©šï¼Œå®ç°äº†ã€‚</p>
<p>ç®—äº†ä¸‹ï¼Œå®ç°äº†çš„ç›®æ ‡ä¹Ÿå°±æ˜¯ç»“å©šäº†ã€‚å°‘çš„å¯æ€œã€‚ä¸ºä»€ä¹ˆä¼šè¿™æ ·å‘¢ï¼Ÿå¤§æŠµæ˜¯è‡ªå·±ä¸å¤Ÿè‡ªå¾‹ï¼Œæ²¡æœ‰æŒç»­çš„åšæŒï¼Œä¹Ÿæ²¡æœ‰åŠæ—¶çš„åæ€å’Œè°ƒæ•´ã€‚ä¹Ÿå°±æ˜¯è‡ªæˆ‘å¯Ÿè§‰ä¸å¤Ÿå§ï¼æˆ–è€…è¯´æ²¡æœ‰å…»æˆè‡ªæˆ‘å¯Ÿè§‰çš„æ–¹æ³•å’Œä¹ æƒ¯ã€‚è¿™ä¹Ÿå°±æ˜¯ä¸ºä»€ä¹ˆè¦å‚åŠ  21 å¤©å†…è§‚è®­ç»ƒè¥çš„åŸå› å§ã€‚</p>
<p>ä¸€ä¸ªäººå¾ˆéš¾è®¤æ¸…è‡ªèº«çš„å±€é™æ€§ï¼Œå¾ˆéš¾æ‰©å¤§è‡ªå·±çš„è®¤çŸ¥ï¼Œå¤šä¸èº«è¾¹çš„äººäº¤æµå’Œå­¦ä¹ ï¼Œé€šè¿‡è§‚ä»–äººï¼Œå†æ¥æ€è‡ªå·±ï¼Œåº”è¯¥å¯ä»¥æå‡è‡ªå·±çš„å¯Ÿè§‰æ„è¯†ã€‚</p>
</blockquote>
<h3 id="è®¡åˆ’">è®¡åˆ’</h3>
<blockquote>
<p>ä»Šæ—¥å†…è§‚å†¥æƒ³ä¸»é¢˜æ˜¯è®¡åˆ’ã€‚</p>
<p>æ—©ä¸Šå†¥æƒ³æ˜¯åœ¨åœ°é“ï¼Œå†¥æƒ³çš„æ—¶å€™æ”¾ç©ºè‡ªå·±ï¼Œæ„Ÿå—è‡ªå·±çš„æ€ç»ªã€æƒ…ç»ªå’Œèº«ä½“çš„æ³¨æ„åŠ›ã€‚å› ä¸ºæ˜¯ç«™ç€ï¼Œæ³¨æ„åŠ›ä¸€ä¼šå„¿åœ¨è„šä¸Šï¼Œä¸€ä¼šå„¿åœ¨æ‰‹ä¸Šï¼Œä¸èƒ½å®Œå…¨åœ°æ”¾ç©ºè‡ªå·±ã€‚æƒ³å¿…è¦æ˜¯å®Œå…¨æ”¾æ¾ï¼Œä¼°è®¡å°±ç«™ä¸ä½äº†å§ã€‚</p>
<p>å†¥æƒ³åœ°è¿‡ç¨‹ä¸­ï¼Œé‡è¦çš„æ˜¯æ„Ÿå—å’Œè§‚å¯Ÿã€‚æ„Ÿå—å½“ä¸‹çš„æ„Ÿå—ï¼Œè§‚å¯Ÿè‡ªå·±çš„è§‚å¯Ÿï¼Œä»»æœ‰ä»–ä»¬æµåŠ¨å’Œå‘å±•ã€‚æ‰€è°“æ²¡æœ‰ç»å¯¹çš„å¯¹ä¸é”™ï¼Œå†¥æƒ³çš„è¿‡ç¨‹ä¸­ï¼Œé‡è¦çš„æ˜¯ä½œä¸ºä¸€ä¸ªæ—è§‚è€…ï¼Œä¸è¦æœ‰è¿‡å¤šçš„ä¸»è§‚æ„è¯†ã€‚</p>
</blockquote>
<h3 id="ç»“æœ">ç»“æœ</h3>
<blockquote>
<p>ä»Šå¤©çš„å†…è§‚å†¥æƒ³ä¸»é¢˜æ˜¯ç»“æœã€‚</p>
<p>æŠŠèº«ä½“æŒ‚åœ¨é’©å­ä¸Šï¼Œé™é™åœ°è§‚å¯Ÿå’Œæ„Ÿå—ã€‚ä¸€æ–¹é¢æ„Ÿå—èº«ä½“ï¼Œä¸€æ–¹é¢ä¼šæ€è€ƒè‡ªå·±å¯¹ç»“æœçš„ç†è§£ã€‚ä»€ä¹ˆæ˜¯ç»“æœï¼Ÿè‡ªå·±è¿‡å»ä¸€å¹´å–å¾—äº†ä»€ä¹ˆæ ·çš„ç»“æœï¼Ÿä¸ºä»€ä¹ˆæ²¡æœ‰å–å¾—ï¼Ÿ</p>
</blockquote>
<h3 id="æ¯”è¾ƒ">æ¯”è¾ƒ</h3>
<blockquote>
<p>ä»Šæ—¥å†…è§‚å†¥æƒ³ä¸»é¢˜æ˜¯æ¯”è¾ƒã€‚å†¥æƒ³æ—¶ï¼Œè§‚å¯Ÿè‡ªå·±çš„æ„Ÿå—ã€æƒ…ç»ªã€æƒ³æ³•ï¼Œä»–ä»¬å¯èƒ½æ˜¯ä»»ä½•æ ·å­çš„ã€‚ä¸ç®¡æ˜¯æ€æ ·çš„ï¼Œä»–ä»¬éƒ½æ˜¯æ­£å¸¸çš„ï¼Œéƒ½æ˜¯ä»–ä»¬æœ¬æ¥çš„æ ·å­ï¼Œä¹Ÿå°±æ˜¯ç©ºæ€§ã€‚</p>
<p>æŠŠæ¯”è¾ƒè¿™ä¸ªå¿µå¤´æŒ‚èµ·æ¥ï¼Œé™é™åœ°çœ‹æ¯”è¾ƒè¿™ä¸¤ä¸ªå­—ã€‚ç„¶åå¼€å§‹è§‰å¯Ÿæ¯”è¾ƒè¿™ä¸¤ä¸ªå­—ã€‚è¿™ä¸ªæ—¶å€™ï¼Œå¤§è„‘å¼€å§‹åœ¨æ€è€ƒæ¯”è¾ƒè¿™ä¸ªå¿µå¤´æ˜¯ä»€ä¹ˆã€‚æ€ç»ªåœ¨å˜åŒ–çš„æ—¶å€™ï¼Œå¯¹å¯¹æ¯”è¾ƒè¿™ä¸ªå¿µå¤´çš„æ„Ÿå—ä¹Ÿåœ¨å˜åŒ–ã€‚æ— è®ºå¦‚ä½•å˜åŒ–ï¼Œè‡ªå·±éƒ½ä¸è¦å¹²é¢„ã€‚å½“è‡ªå·±æœ‰äº†æ¯”è¾ƒè¿™ä¸ªå¿µå¤´ï¼Œè‡ªå·±çš„æ„Ÿå—æ˜¯å¤±æœ›çš„ã€‚å¤±æœ›è‡ªå·±ä¸å¦‚åˆ«äººï¼Œä¸å¦‚è¿‡å»ã€‚å¤±æœ›è¿‡åï¼Œåˆä¸æœæ°”ï¼Œåˆæš—ä¸‹å†³å¿ƒè¦å¥½å¥½åŠªåŠ›ã€‚è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œæˆ‘æ˜¯æˆ‘çš„ä¸»äººï¼Œæ˜¯æˆ‘åœ¨æœ‰ç€å„ç§å„æ ·çš„æ„Ÿå—ã€‚å¦‚æœæˆ‘èƒ½æ§åˆ¶è‡ªå·±çš„æƒ…ç»ªï¼Œå°±èƒ½æ§åˆ¶è‡ªå·±çš„è¡Œä¸ºã€‚</p>
</blockquote>
<h3 id="æŠ±æ€¨">æŠ±æ€¨</h3>
<blockquote>
<p>ä»Šæ—¥å†¥æƒ³ä¸»é¢˜æ˜¯æŠ±æ€¨ã€‚</p>
<p>ç”Ÿæ´»ä¸­æœ‰ä»€ä¹ˆæŠ±æ€¨çš„ï¼ŸæŠ±æ€¨åˆè§£å†³ä¸äº†é—®é¢˜ï¼Ÿé—®é¢˜åˆä¸æ˜¯è‡ªå·±é€ æˆçš„ï¼Œå¯èƒ½æ˜¯åˆ«äººé€ æˆçš„ï¼åˆ«äººçš„äº‹æƒ…æ˜¯åˆ«äººçš„äº‹æƒ…ï¼Œè‡ªå·±çš„äº‹æƒ…æ˜¯è‡ªå·±é€ æˆã€‚åˆ«äººçš„äº‹æƒ…ï¼Œä½ ç®¡ä¸äº†ï¼Œä½ èƒ½ç®¡ç†çš„æ˜¯ä½ è‡ªå·±çš„ã€‚ç®¡å¥½è‡ªå·±çš„å¿ƒæ€æƒ…ç»ªå’Œè¡Œä¸ºï¼Œå› ä¸ºæŠ±æ€¨è§£å†³ä¸äº†åˆ«äººçš„é—®é¢˜ï¼Œä¹Ÿè§£å†³ä¸äº†è‡ªå·±çš„äº‹æƒ…ã€‚ç”šè‡³ä½ çš„æŠ±æ€¨è¿˜ä¼šç»™åˆ«äººå¸¦æ¥è´Ÿèƒ½é‡ï¼Œç»™ä½ ä»¬å¸¦æ¥äº‰åµï¼Œç»™è‡ªå·±å¸¦æ¥è›®çƒ¦ï¼Œç»™è‡ªå·±åœ°èƒ½åŠ›å’Œæƒ…ç»ªå¸¦æ¥æ¶ˆè€—ã€‚ä¸å…¶æ¶ˆè€—è‡ªå·±ï¼Œè¿˜ä¸å¦‚æå‡è‡ªå·±ã€‚æœ‰æ—¶å€™ä¸è¦å±€é™åœ¨è‡ªå·±çš„æ€ç»´é‡Œï¼Œæ¢ä¸ªè§’åº¦ï¼Œæå‡æ ¼å±€ï¼Œä¸€åˆ‡äº‹æƒ…éƒ½ä¸æ˜¯äº‹æƒ…äº†ã€‚è¿™ä¸ªä¸–ç•Œå“ªæœ‰é‚£ä¹ˆå¤šæ‰€è°“é‡è¦çš„äº‹æƒ…ã€‚é‚£äº›ä»Šå¤©ä½ çœ‹æ¥å¾ˆé‡è¦çš„äº‹å„¿ï¼Œåœ¨åå¹´äºŒåå¹´ä¹‹åï¼Œæ ¹æœ¬å°±ä¸å€¼å¾—ä¸€æã€‚æ‰€ä»¥å¾ˆå¤šæ—¶å€™ï¼Œè¦ç”¨å‘å±•çš„çœ¼å…‰çœ‹é—®é¢˜ã€‚ä¸€åˆ‡éƒ½ä¼šè¿‡å»ï¼Œä¸€åˆ‡éƒ½ä¼šå¥½èµ·æ¥ã€‚å½“ä½ è¿™æ ·æƒ³çš„æ—¶å€™ï¼Œåœ¨ä½ å¿ƒé‡Œåœ¨ä½ çœ¼å‰ï¼Œå°±æ²¡æœ‰ä»€ä¹ˆçƒ¦æ¼äº†ï¼Œä¹Ÿå°±ä¸ä¼šæŠ±æ€¨äº†ã€‚</p>
</blockquote>
<h2 id="å¥½ç‰©åˆ†äº«">å¥½ç‰©åˆ†äº«</h2>
<p>å‡ ä¸ªæˆªå›¾è½¯ä»¶ï¼š</p>
<ul>
<li>
<p><a href="https://immmmm.com/chrome-extensions-tinysnap/">TinySnap</a> Chrome æˆªå›¾æ’ä»¶ï¼Œæ”¯æŒè®¾ç½®èƒŒæ™¯</p>
</li>
<li>
<p>Snipaste æˆªå›¾</p>
</li>
</ul>
<p>EOF</p>
]]></content:encoded></item><item><title>Greenplum CC Webå®‰è£…å’Œéƒ¨ç½²</title><link>https://blog.chensoul.com/posts/2022/08/19/greenplum-cc-web-install-deploy/</link><pubDate>Fri, 19 Aug 2022 17:16:56 +0800</pubDate><guid>https://blog.chensoul.com/posts/2022/08/19/greenplum-cc-web-install-deploy/</guid><description>å®‰è£… 1ã€ä¸‹è½½å®‰è£…æ–‡ä»¶ ä» https://network.pivotal.io/products/pivotal-gpdb ä¸‹è½½ï¼Œå½“å‰æœ€æ–°ç‰ˆæœ¬ä¸º 6.3.0ã€‚ 2ã€è§£å‹å®‰è£…æ–‡ä»¶ unzip greenplum-cc-web-6.3.0-gp6-rhel7-x86_64.zip 3ã€è¿›å…¥å®‰è£…ç›®å½• cd greenplum-cc-web-6.3.0-gp6-rhel7-x86_64 4ã€åˆ›å»ºé…ç½®æ–‡ä»¶ install.confï¼Œç”¨</description><content:encoded><![CDATA[<h2 id="å®‰è£…">å®‰è£…</h2>
<p>1ã€ä¸‹è½½å®‰è£…æ–‡ä»¶</p>
<p>ä» <a href="https://network.pivotal.io/products/pivotal-gpdb">https://network.pivotal.io/products/pivotal-gpdb</a> ä¸‹è½½ï¼Œå½“å‰æœ€æ–°ç‰ˆæœ¬ä¸º 6.3.0ã€‚</p>
<p>2ã€è§£å‹å®‰è£…æ–‡ä»¶</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">unzip greenplum-cc-web-6.3.0-gp6-rhel7-x86_64.zip
</span></span></code></pre></div><p>3ã€è¿›å…¥å®‰è£…ç›®å½•</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">cd</span> greenplum-cc-web-6.3.0-gp6-rhel7-x86_64
</span></span></code></pre></div><p>4ã€åˆ›å»ºé…ç½®æ–‡ä»¶ install.confï¼Œç”¨äºè®¾ç½®å®‰è£…å‚æ•°</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">cat &gt;&gt; install.conf <span class="s">&lt;&lt; EOF 
</span></span></span><span class="line"><span class="cl"><span class="s">path = /usr/local
</span></span></span><span class="line"><span class="cl"><span class="s"># Set the display_name param to the string to display in the GPCC UI.
</span></span></span><span class="line"><span class="cl"><span class="s"># The default is &#34;gpcc&#34;
</span></span></span><span class="line"><span class="cl"><span class="s"># display_name = gpcc
</span></span></span><span class="line"><span class="cl"><span class="s">
</span></span></span><span class="line"><span class="cl"><span class="s">master_port = 5432
</span></span></span><span class="line"><span class="cl"><span class="s">web_port = 28080
</span></span></span><span class="line"><span class="cl"><span class="s">rpc_port = 8899
</span></span></span><span class="line"><span class="cl"><span class="s">enable_ssl = false
</span></span></span><span class="line"><span class="cl"><span class="s"># Uncomment and set the ssl_cert_file if you set enable_ssl to true.
</span></span></span><span class="line"><span class="cl"><span class="s"># ssl_cert_file = /etc/certs/mycert
</span></span></span><span class="line"><span class="cl"><span class="s">enable_kerberos = false
</span></span></span><span class="line"><span class="cl"><span class="s"># Uncomment and set the following parameters if you set enable_kerberos to true.
</span></span></span><span class="line"><span class="cl"><span class="s"># webserver_url = &lt;webserver_service_url&gt;
</span></span></span><span class="line"><span class="cl"><span class="s"># krb_mode = 1
</span></span></span><span class="line"><span class="cl"><span class="s"># keytab = &lt;path_to_keytab&gt;
</span></span></span><span class="line"><span class="cl"><span class="s"># krb_service_name = postgres
</span></span></span><span class="line"><span class="cl"><span class="s"># User interface language: 1=English, 2=Chinese, 3=Korean, 4=Russian, 5=Japanese
</span></span></span><span class="line"><span class="cl"><span class="s">language = 1
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span></code></pre></div><p>6ã€æ‰§è¡Œå®‰è£…å‘½ä»¤</p>
<p>é€šè¿‡é…ç½®æ–‡ä»¶å®‰è£…ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># -W è®¾ç½®å¯†ç ï¼Œè¾“å…¥gpmon</span>
</span></span><span class="line"><span class="cl">./gpccinstall-6.3.0 -auto -W
</span></span></code></pre></div><p>æ‰§è¡Œå®Œä¹‹åï¼Œä¼šå‘ç°åˆ›å»ºäº†gpperfmonæ•°æ®åº“ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">CREATING SUPERUSER <span class="s1">&#39;gpmon&#39;</span>...
</span></span><span class="line"><span class="cl">CREATING COMMAND CENTER DATABASE <span class="s1">&#39;gpperfmon&#39;</span>...
</span></span><span class="line"><span class="cl">RELOADING pg_hba.conf. PLEASE WAIT ...
</span></span></code></pre></div><p>7ã€è®¾ç½®ç¯å¢ƒå˜é‡</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;source /usr/local/greenplum-cc/gpcc_path.sh&#34;</span> &gt;&gt; ~/.bashrc
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">source</span>  ~/.bashrc
</span></span></code></pre></div><p>8ã€åŒæ­¥é…ç½®æ–‡ä»¶</p>
<p>æŸ¥çœ‹ç”Ÿæˆçš„æ–‡ä»¶ .pgpass</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">cat ~/.pgpass
</span></span><span class="line"><span class="cl">*:5432:gpperfmon:gpmon:gpmon
</span></span></code></pre></div><blockquote>
<p>å¯ä»¥çœ‹åˆ°åˆ›å»ºäº†gpmonç”¨æˆ·ï¼Œå¯†ç ä¸ºchangemeã€‚</p>
</blockquote>
<p>å¯ä»¥ä¿®æ”¹è¯¥æ–‡ä»¶ä¸­å¯†ç ä¸ºgpmonï¼Œæˆ–è€…é€šè¿‡ç¯å¢ƒå˜é‡è®¾ç½®ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">PGPASSWORD</span><span class="o">=</span>gpmon
</span></span></code></pre></div><p>ä¹Ÿå¯ä»¥ä¿®æ”¹æ•°æ®åº“ä¸­å¯†ç å’Œ~/.pgpassä¸€è‡´ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">alter user gpmon encrypted password <span class="s1">&#39;gpmon&#39;</span>
</span></span></code></pre></div><p>å°†è¯¥æ–‡ä»¶åŒæ­¥åˆ°Standby MasterèŠ‚ç‚¹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">scp ~/.pgpass gpadmin@dw-test-node002:~
</span></span><span class="line"><span class="cl">ssh dw-prod-node001 <span class="s2">&#34;chmod 600 ~/.pgpass&#34;</span>
</span></span></code></pre></div><p>9ã€æŸ¥çœ‹é…ç½®æ–‡ä»¶</p>
<ul>
<li><code>$MASTER_DATA_DIRECTORY/gpperfmon/conf/gpperfmon.conf</code></li>
<li><code>$GPCC_HOME/conf/app.conf</code></li>
<li><code>$MASTER_DATA_DIRECTORY/gpmetrics/gpcc.conf</code></li>
<li><code>$MASTER_DATA_DIRECTORY/postgresql.conf</code></li>
</ul>
<p>æŸ¥çœ‹$GPCC_HOME/conf/app.conf</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ cat <span class="nv">$GPCC_HOME</span>/conf/app.conf
</span></span><span class="line"><span class="cl"><span class="nv">appname</span>         <span class="o">=</span> gpccws
</span></span><span class="line"><span class="cl"><span class="nv">listentcp4</span>      <span class="o">=</span> <span class="nb">true</span>
</span></span><span class="line"><span class="cl"><span class="nv">runmode</span>         <span class="o">=</span> prod
</span></span><span class="line"><span class="cl"><span class="nv">session</span>         <span class="o">=</span> <span class="nb">true</span>
</span></span><span class="line"><span class="cl"><span class="nv">enablexsrf</span>      <span class="o">=</span> <span class="nb">true</span>
</span></span><span class="line"><span class="cl"><span class="nv">xsrfexpire</span>      <span class="o">=</span> <span class="m">2592000</span>
</span></span><span class="line"><span class="cl"><span class="nv">xsrfkey</span>         <span class="o">=</span> 61oETzKXQAGaYdkL5gEmGeJJFuYh7EQnp2XdTP1o
</span></span><span class="line"><span class="cl"><span class="nv">rendertype</span>      <span class="o">=</span> json
</span></span><span class="line"><span class="cl"><span class="nv">printallsqls</span>    <span class="o">=</span> <span class="nb">false</span>
</span></span><span class="line"><span class="cl"><span class="nv">master_port</span>     <span class="o">=</span> <span class="m">5432</span>
</span></span><span class="line"><span class="cl"><span class="nv">master_host</span>     <span class="o">=</span> dw-test-node001
</span></span><span class="line"><span class="cl"><span class="nv">path</span>            <span class="o">=</span> /usr/local
</span></span><span class="line"><span class="cl"><span class="nv">display_name</span>    <span class="o">=</span> gpcc
</span></span><span class="line"><span class="cl"><span class="nv">enable_kerberos</span> <span class="o">=</span> <span class="nb">false</span>
</span></span><span class="line"><span class="cl"><span class="nv">EnableHTTPS</span>     <span class="o">=</span> <span class="nb">false</span>
</span></span><span class="line"><span class="cl"><span class="nv">EnableHTTP</span>      <span class="o">=</span> <span class="nb">true</span>
</span></span><span class="line"><span class="cl"><span class="nv">httpport</span>        <span class="o">=</span> <span class="m">28080</span>
</span></span><span class="line"><span class="cl"><span class="nv">rpc_port</span>        <span class="o">=</span> <span class="m">8899</span>
</span></span><span class="line"><span class="cl"><span class="nv">language</span>        <span class="o">=</span> English
</span></span><span class="line"><span class="cl"><span class="nv">log_level</span>       <span class="o">=</span> INFO
</span></span><span class="line"><span class="cl"><span class="nv">ws_perf_port</span>    <span class="o">=</span> <span class="m">6162</span>
</span></span><span class="line"><span class="cl"><span class="nv">agent_perf_port</span> <span class="o">=</span> <span class="m">616</span>
</span></span></code></pre></div><p>ä¿®æ”¹ $MASTER_DATA_DIRECTORY/pg_hba.confï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">local</span>   gpperfmon       gpmon   md5
</span></span><span class="line"><span class="cl">host    gpperfmon       gpmon   0.0.0.0/0     md5
</span></span><span class="line"><span class="cl">host    gpperfmon       gpmon   ::1/128       md5
</span></span></code></pre></div><blockquote>
<p>éœ€è¦é‡å¯gpæ•°æ®åº“ï¼šgpstop -r</p>
</blockquote>
<p>ç™»é™†æµ‹è¯•ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">psql -d gpperfmon -U gpmon -h -W
</span></span></code></pre></div><p>10ã€å¯åŠ¨</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ <span class="nv">PGPASSWORD</span><span class="o">=</span>gpmon gpcc start
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ä¹Ÿå¯ä»¥è¾“å…¥å¯†ç ç™»é™†</span>
</span></span><span class="line"><span class="cl">$ gpcc start -W
</span></span></code></pre></div><p>æŸ¥çœ‹çŠ¶æ€ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ gpcc status
</span></span><span class="line"><span class="cl">2019-12-16 18:37:19 GPCC webserver: running
</span></span><span class="line"><span class="cl">2019-12-16 18:37:19 GPCC agents: 3/3 agents running
</span></span></code></pre></div><p>æŸ¥çœ‹æ—¥å¿—ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">tailf <span class="nv">$GPCC_HOME</span>/logs/gpccws.log
</span></span></code></pre></div><p>11ã€è®¿é—®æµè§ˆå™¨ http://192.168.56.141:28080 ï¼Œç”¨æˆ·åå’Œå¯†ç ä¸º gpmon</p>
<p><img src="https://tva1.sinaimg.cn/large/006tNbRwgy1g9zl5upkvbj316u0u00xe.jpg" alt="image-20191217120230168"></p>
<p>12ã€æŸ¥çœ‹é…ç½®å‚æ•°</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ gpcc --settings
</span></span><span class="line"><span class="cl">Install path:   /usr/local
</span></span><span class="line"><span class="cl">Display Name:   gpcc
</span></span><span class="line"><span class="cl">GPCC port:      <span class="m">28080</span>
</span></span><span class="line"><span class="cl">Kerberos:       disabled
</span></span><span class="line"><span class="cl">SSL:            disabled
</span></span></code></pre></div><h2 id="ç¦ç”¨gpperfmon">ç¦ç”¨gpperfmon</h2>
<p>1ã€å®‰è£…</p>
<p>ä½¿ç”¨gpperfmon_installå‘½ä»¤å¯ä»¥åˆ›å»ºåç§°ä¸ºgpperfmonçš„æ•°æ®åº“ï¼Œé»˜è®¤ä½¿ç”¨gpmonç”¨æˆ·ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">gpperfmon_install --enable --password gpmon --port <span class="m">5432</span>
</span></span></code></pre></div><p>å½“ç„¶ï¼Œåœ¨å‰é¢è¿è¡Œgpccinstall-6.1.0çš„æ—¶å€™ï¼Œå·²ç»åˆ›å»ºäº†è¯¥æ•°æ®åº“ã€‚</p>
<p>2ã€æŸ¥çœ‹gpperfmonæ˜¯å¦å¼€å¯</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">gpconfig -s gp_enable_gpperfmon
</span></span></code></pre></div><p>3ã€ Greenplum Command Centerä¸å†éœ€è¦gpperfmon agentæœé›†çš„å†å²æ•°æ®ï¼Œæ‰€ä»¥éœ€è¦ç¦ç”¨gp_enable_gpperfmon</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">gpconfig -c gp_enable_perform -v off
</span></span></code></pre></div><p>4ã€ç„¶åé‡å¯æ•°æ®åº“</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">gpstop -ar 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#å¼ºåˆ¶é‡å¯</span>
</span></span><span class="line"><span class="cl">gpstop -Ma immediate
</span></span></code></pre></div><h2 id="è®¾ç½®gpmonè§’è‰²æ—¥å¿—å‚æ•°">è®¾ç½®gpmonè§’è‰²æ—¥å¿—å‚æ•°</h2>
<p>è¿æ¥gpperfmonæ•°æ®åº“ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">psql -d gpperfmon -p <span class="m">5432</span> -U gpadmin
</span></span></code></pre></div><p>ä¿®æ”¹è§’è‰²ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">psql -d gpperfmon -U gpmon
</span></span><span class="line"><span class="cl">psql <span class="o">(</span>9.4.24<span class="o">)</span>
</span></span><span class="line"><span class="cl">Type <span class="s2">&#34;help&#34;</span> <span class="k">for</span> help.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">gpperfmon</span><span class="o">=</span><span class="c1"># ALTER ROLE gpmon SET log_statement TO DDL;</span>
</span></span><span class="line"><span class="cl">ALTER ROLE
</span></span><span class="line"><span class="cl"><span class="nv">gpperfmon</span><span class="o">=</span><span class="c1"># ALTER ROLE gpmon SET log_min_messages to FATAL;</span>
</span></span><span class="line"><span class="cl">ALTER ROLE
</span></span></code></pre></div><h2 id="å¸è½½">å¸è½½</h2>
<p>1ã€åœæ­¢</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">gpcc stop
</span></span></code></pre></div><p>2ã€åˆ é™¤å®‰è£…ç›®å½•</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">rm -rf /usr/local/greenplum-cc-web-6.1.0
</span></span></code></pre></div><p>3ã€ç¦ç”¨é‡‡é›†æ•°æ®agent</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">su - gpadmin
</span></span><span class="line"><span class="cl">gpconfig -c gp_enable_gpperfmon -v off
</span></span></code></pre></div><p>4ã€åˆ é™¤pg_hba.confä¸­gpmonæ¡ç›®</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1">#local     gpperfmon     gpmon     md5  </span>
</span></span><span class="line"><span class="cl"><span class="c1">#host      gpperfmon     gpmon    0.0.0.0/0    md5</span>
</span></span></code></pre></div><p>5ã€åˆ é™¤è§’è‰²</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">psql template1 -c <span class="s1">&#39;DROP ROLE gpmon;&#39;</span>
</span></span></code></pre></div><p>6ã€é‡å¯æ•°æ®åº“</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">gpstop -r
</span></span></code></pre></div><p>7ã€åˆ é™¤æœªæäº¤çš„çš„æ•°æ®å’Œæ—¥å¿—</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">rm -rf <span class="nv">$MASTER_DATA_DIRECTORY</span>/gpperfmon/data/* 
</span></span><span class="line"><span class="cl">rm -rf <span class="nv">$MASTER_DATA_DIRECTORY</span>/gpperfmon/logs/*
</span></span></code></pre></div><p>8ã€åˆ é™¤æ•°æ®åº“</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">dropdb gpperfmon
</span></span></code></pre></div>]]></content:encoded></item><item><title>Greenplumå®‰è£…å’Œéƒ¨ç½²</title><link>https://blog.chensoul.com/posts/2022/08/19/greenplum-install-deploy/</link><pubDate>Fri, 19 Aug 2022 17:14:18 +0800</pubDate><guid>https://blog.chensoul.com/posts/2022/08/19/greenplum-install-deploy/</guid><description>æœ¬æ–‡ä¸»è¦ä»‹ç»å¦‚ä½•å¿«é€Ÿå®‰è£…éƒ¨ç½²å•èŠ‚ç‚¹çš„ Greenplumè¿‡ç¨‹ï¼Œä»¥åŠGreenplumçš„ä¸€äº›å¸¸ç”¨å‘½ä»¤åŠå·¥å…·ã€‚ ç¯å¢ƒå‡†å¤‡ ç¯å¢ƒè¯´æ˜ æ“ä½œç³»ç»Ÿï¼šCento</description><content:encoded><![CDATA[<p>æœ¬æ–‡ä¸»è¦ä»‹ç»å¦‚ä½•å¿«é€Ÿå®‰è£…éƒ¨ç½²å•èŠ‚ç‚¹çš„ Greenplumè¿‡ç¨‹ï¼Œä»¥åŠGreenplumçš„ä¸€äº›å¸¸ç”¨å‘½ä»¤åŠå·¥å…·ã€‚</p>
<h2 id="ç¯å¢ƒå‡†å¤‡">ç¯å¢ƒå‡†å¤‡</h2>
<h3 id="ç¯å¢ƒè¯´æ˜">ç¯å¢ƒè¯´æ˜</h3>
<p>æ“ä½œç³»ç»Ÿï¼šCentos7</p>
<p>èŠ‚ç‚¹ç¯å¢ƒï¼š</p>
<table>
<thead>
<tr>
<th>ip</th>
<th>hostname</th>
<th>è§’è‰²</th>
</tr>
</thead>
<tbody>
<tr>
<td>192.168.56.141</td>
<td>dw-test-node001</td>
<td>master</td>
</tr>
<tr>
<td>192.168.56.142</td>
<td>dw-test-node002</td>
<td>segment</td>
</tr>
<tr>
<td>192.168.56.143</td>
<td>dw-test-node003</td>
<td>segment</td>
</tr>
</tbody>
</table>
<p>å®‰è£…ç”¨æˆ·ï¼šroot</p>
<h3 id="é…ç½®ç³»ç»Ÿå‚æ•°">é…ç½®ç³»ç»Ÿå‚æ•°</h3>
<p>åœ¨æ¯å°æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»¥ä¸‹æ“ä½œã€‚</p>
<h4 id="é…ç½®hostsæ–‡ä»¶">é…ç½®hostsæ–‡ä»¶</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">cat &gt; /etc/hosts <span class="s">&lt;&lt;EOF
</span></span></span><span class="line"><span class="cl"><span class="s">192.168.56.141 dw-test-node001
</span></span></span><span class="line"><span class="cl"><span class="s">192.168.56.142 dw-test-node002
</span></span></span><span class="line"><span class="cl"><span class="s">192.168.56.143 dw-test-node003
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span></code></pre></div><h4 id="å…³é—­selinux">å…³é—­selinux</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">setenforce <span class="m">0</span>  &gt;/dev/null 2&gt;<span class="p">&amp;</span><span class="m">1</span>
</span></span><span class="line"><span class="cl">sed -i -e <span class="s1">&#39;s/^SELINUX=enforcing/SELINUX=disabled/g&#39;</span> /etc/sysconfig/selinux
</span></span><span class="line"><span class="cl">sed -i -e <span class="s1">&#39;s/^SELINUX=enforcing/SELINUX=disabled/g&#39;</span> /etc/selinux/config
</span></span></code></pre></div><h4 id="å…³é—­é˜²ç«å¢™">å…³é—­é˜²ç«å¢™</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">systemctl stop firewalld.service <span class="o">&amp;&amp;</span> systemctl disable firewalld.service
</span></span></code></pre></div><h4 id="è®¾ç½®æ—¶é’ŸåŒæ­¥">è®¾ç½®æ—¶é’ŸåŒæ­¥</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">yum install ntp -y
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">cat &gt; /etc/ntp.conf <span class="s">&lt;&lt; EOF
</span></span></span><span class="line"><span class="cl"><span class="s">#åœ¨ä¸ä¸Šçº§æ—¶é—´æœåŠ¡å™¨è”ç³»æ—¶æ‰€èŠ±è´¹çš„æ—¶é—´ï¼Œè®°å½•åœ¨driftfileå‚æ•°åé¢çš„æ–‡ä»¶
</span></span></span><span class="line"><span class="cl"><span class="s">driftfile /var/lib/ntp/drift
</span></span></span><span class="line"><span class="cl"><span class="s">#é»˜è®¤å…³é—­æ‰€æœ‰çš„ NTP è”æœºæœåŠ¡
</span></span></span><span class="line"><span class="cl"><span class="s">restrict default ignore
</span></span></span><span class="line"><span class="cl"><span class="s">restrict -6 default ignore
</span></span></span><span class="line"><span class="cl"><span class="s">#å¦‚ä»loopbackç½‘å£è¯·æ±‚ï¼Œåˆ™å…è®¸NTPçš„æ‰€æœ‰æ“ä½œ
</span></span></span><span class="line"><span class="cl"><span class="s">restrict 127.0.0.1
</span></span></span><span class="line"><span class="cl"><span class="s">restrict -6 ::1
</span></span></span><span class="line"><span class="cl"><span class="s">#ä½¿ç”¨æŒ‡å®šçš„æ—¶é—´æœåŠ¡å™¨
</span></span></span><span class="line"><span class="cl"><span class="s">server ntp1.aliyun.com
</span></span></span><span class="line"><span class="cl"><span class="s">server ntp2.aliyun.com
</span></span></span><span class="line"><span class="cl"><span class="s">server ntp3.aliyun.com
</span></span></span><span class="line"><span class="cl"><span class="s">#å…è®¸æŒ‡å®šçš„æ—¶é—´æœåŠ¡å™¨æŸ¥è¯¢æœ¬æ—¶é—´æœåŠ¡å™¨çš„ä¿¡æ¯
</span></span></span><span class="line"><span class="cl"><span class="s">restrict ntp1.aliyun.com nomodify notrap nopeer noquery
</span></span></span><span class="line"><span class="cl"><span class="s">#å…¶å®ƒè®¤è¯ä¿¡æ¯
</span></span></span><span class="line"><span class="cl"><span class="s">includefile /etc/ntp/crypto/pw
</span></span></span><span class="line"><span class="cl"><span class="s">keys /etc/ntp/keys
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">systemctl start ntpd <span class="o">&amp;&amp;</span> systemctl <span class="nb">enable</span> ntpd
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s1">&#39;* */6 * * * /usr/sbin/ntpdate -u ntp1.aliyun.com &amp;&amp; /sbin/hwclock --systohc &gt; /dev/null 2&gt;&amp;1&#39;</span> &gt;&gt; /var/spool/cron/<span class="sb">`</span>whoami<span class="sb">`</span>
</span></span></code></pre></div><h4 id="é…ç½®å†…æ ¸å‚æ•°">é…ç½®å†…æ ¸å‚æ•°</h4>
<p>å‚è€ƒ <a href="https://segmentfault.com/a/1190000020654036?utm_source=tag-newest">https://segmentfault.com/a/1190000020654036?utm_source=tag-newest</a></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1">#è®¾ç½®å†…æ ¸å‚æ•°</span>
</span></span><span class="line"><span class="cl">cat &gt; greenplum.conf <span class="s">&lt;&lt;EOF
</span></span></span><span class="line"><span class="cl"><span class="s">kernel.shmall = 2033299
</span></span></span><span class="line"><span class="cl"><span class="s">kernel.shmmax = 8328392704
</span></span></span><span class="line"><span class="cl"><span class="s">kernel.shmmni = 4096
</span></span></span><span class="line"><span class="cl"><span class="s">kernel.sem = 500 1024000 200 4096
</span></span></span><span class="line"><span class="cl"><span class="s">kernel.sysrq = 1
</span></span></span><span class="line"><span class="cl"><span class="s">kernel.core_uses_pid = 1
</span></span></span><span class="line"><span class="cl"><span class="s">kernel.msgmnb = 65536
</span></span></span><span class="line"><span class="cl"><span class="s">kernel.msgmax = 65536
</span></span></span><span class="line"><span class="cl"><span class="s">kernel.msgmni = 31764
</span></span></span><span class="line"><span class="cl"><span class="s">net.ipv4.tcp_syncookies = 1
</span></span></span><span class="line"><span class="cl"><span class="s">net.ipv4.conf.default.accept_source_route = 0
</span></span></span><span class="line"><span class="cl"><span class="s">net.ipv4.tcp_tw_recycle = 1
</span></span></span><span class="line"><span class="cl"><span class="s">net.ipv4.tcp_max_syn_backlog = 4096
</span></span></span><span class="line"><span class="cl"><span class="s">net.ipv4.conf.all.arp_filter = 1
</span></span></span><span class="line"><span class="cl"><span class="s">net.ipv4.ip_local_port_range = 10000 65535
</span></span></span><span class="line"><span class="cl"><span class="s">net.core.netdev_max_backlog = 10000
</span></span></span><span class="line"><span class="cl"><span class="s">net.core.rmem_max = 2097152
</span></span></span><span class="line"><span class="cl"><span class="s">net.core.wmem_max = 2097152
</span></span></span><span class="line"><span class="cl"><span class="s">vm.overcommit_memory = 2
</span></span></span><span class="line"><span class="cl"><span class="s">vm.overcommit_ratio = 95 
</span></span></span><span class="line"><span class="cl"><span class="s">vm.swappiness = 0
</span></span></span><span class="line"><span class="cl"><span class="s">vm.zone_reclaim_mode = 0
</span></span></span><span class="line"><span class="cl"><span class="s">#è¿™ä¸ªæ—¶å€™ï¼Œåå°è¿›è¡Œåœ¨è„æ•°æ®è¾¾åˆ°3%æ—¶å°±å¼€å§‹å¼‚æ­¥æ¸…ç†ï¼Œä½†åœ¨10%ä¹‹å‰ç³»ç»Ÿä¸ä¼šå¼ºåˆ¶åŒæ­¥å†™ç£ç›˜ã€‚åˆ·è„è¿›ç¨‹3ç§’èµ·æ¥ä¸€æ¬¡ï¼Œè„æ•°æ®å­˜æ´»è¶…è¿‡10ç§’å°±ä¼šå¼€å§‹åˆ·ã€‚
</span></span></span><span class="line"><span class="cl"><span class="s">vm.dirty_expire_centisecs = 500
</span></span></span><span class="line"><span class="cl"><span class="s">vm.dirty_writeback_centisecs = 100
</span></span></span><span class="line"><span class="cl"><span class="s">vm.dirty_background_ratio = 3
</span></span></span><span class="line"><span class="cl"><span class="s">vm.dirty_ratio = 10
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">mv greenplum.conf /etc/sysctl.d/greenplum.conf
</span></span><span class="line"><span class="cl">sysctl -p /etc/sysctl.d/greenplum.conf
</span></span></code></pre></div><p>ç”Ÿäº§ç¯å¢ƒçš„é…ç½®ï¼Œéœ€è¦è¯¦ç»†å‚è€ƒå®˜æ–¹æ–‡æ¡£çš„è¯´æ˜ï¼šhttps://gpdb.docs.pivotal.io/6-1/install_guide/prep_os.html#topic3__sysctl_file</p>
<p>kernel.shmallï¼ˆå…±äº«å†…å­˜é¡µæ€»æ•°ï¼‰
kernel.shmmax (å…±äº«å†…å­˜æ®µçš„æœ€å¤§å€¼)
ä¸€èˆ¬æ¥è®²ï¼Œè¿™ä¸¤ä¸ªå‚æ•°çš„å€¼åº”è¯¥æ˜¯ç‰©ç†å†…å­˜çš„ä¸€åŠï¼Œå¯ä»¥é€šè¿‡æ“ä½œç³»ç»Ÿçš„å€¼_PHYS_PAGESå’ŒPAGE_SIZEè®¡ç®—å¾—å‡ºã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">kernel.shmall <span class="o">=</span> <span class="o">(</span> _PHYS_PAGES / 2<span class="o">)</span>
</span></span><span class="line"><span class="cl">kernel.shmmax <span class="o">=</span> <span class="o">(</span> _PHYS_PAGES / 2<span class="o">)</span> * PAGE_SIZE
</span></span></code></pre></div><p>ä¹Ÿå¯ä»¥é€šè¿‡ä»¥ä¸‹ä¸¤ä¸ªå‘½ä»¤å¾—å‡ºè¿™ä¸¤ä¸ªå‚æ•°çš„å€¼ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">echo</span> <span class="k">$(</span>expr <span class="k">$(</span>getconf _PHYS_PAGES<span class="k">)</span> / 2<span class="k">)</span> 
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="k">$(</span>expr <span class="k">$(</span>getconf _PHYS_PAGES<span class="k">)</span> / <span class="m">2</span> <span class="se">\*</span> <span class="k">$(</span>getconf PAGE_SIZE<span class="k">))</span>
</span></span></code></pre></div><p>å¦‚æœå¾—å‡ºçš„kernel.shmmaxå€¼å°äºç³»ç»Ÿçš„é»˜è®¤å€¼ï¼Œåˆ™å¼•ç”¨ç³»ç»Ÿé»˜è®¤å€¼å³å¯</p>
<p>å¯¹äº64Gå†…å­˜çš„æ“ä½œç³»ç»Ÿï¼Œå»ºè®®é…ç½®å¦‚ä¸‹å€¼ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">vm.dirty_background_ratio <span class="o">=</span> <span class="m">0</span>
</span></span><span class="line"><span class="cl">vm.dirty_ratio <span class="o">=</span> <span class="m">0</span>
</span></span><span class="line"><span class="cl">vm.dirty_background_bytes <span class="o">=</span> <span class="m">1610612736</span> <span class="c1"># 1.5GB</span>
</span></span><span class="line"><span class="cl">vm.dirty_bytes <span class="o">=</span> <span class="m">4294967296</span> <span class="c1"># 4GB</span>
</span></span></code></pre></div><p>å¯¹äºå°äº64Gå†…å­˜çš„æ“ä½œç³»ç»Ÿï¼Œå»ºè®®é…ç½®å¦‚ä¸‹å€¼ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">vm.dirty_background_ratio <span class="o">=</span> <span class="m">3</span>
</span></span><span class="line"><span class="cl">vm.dirty_ratio <span class="o">=</span> <span class="m">10</span>
</span></span></code></pre></div><h4 id="è®¾ç½®æ–‡ä»¶å¥æŸ„æ•°">è®¾ç½®æ–‡ä»¶å¥æŸ„æ•°</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">cat &gt;/etc/security/limits.d/file.conf<span class="s">&lt;&lt;EOF
</span></span></span><span class="line"><span class="cl"><span class="s">*       soft    nproc   131072
</span></span></span><span class="line"><span class="cl"><span class="s">*       hard    nproc   131072
</span></span></span><span class="line"><span class="cl"><span class="s">*       soft    nofile  131072
</span></span></span><span class="line"><span class="cl"><span class="s">*       hard    nofile  131072
</span></span></span><span class="line"><span class="cl"><span class="s">root    soft    nproc   131072
</span></span></span><span class="line"><span class="cl"><span class="s">root    hard    nproc   131072
</span></span></span><span class="line"><span class="cl"><span class="s">root    soft    nofile  131072
</span></span></span><span class="line"><span class="cl"><span class="s">root    hard    nofile  131072
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span></code></pre></div><h4 id="è®¾ç½®sshè¿æ¥">è®¾ç½®SSHè¿æ¥</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sed -i <span class="s1">&#39;s/#MaxStartups 10:30:100/MaxStartups 10:30:200/g&#39;</span> /etc/ssh/sshd_config
</span></span><span class="line"><span class="cl">service sshd restart
</span></span></code></pre></div><h3 id="é…ç½®-greenplum-è¦æ±‚çš„å‚æ•°">é…ç½® Greenplum è¦æ±‚çš„å‚æ•°</h3>
<h4 id="ç£ç›˜ioè®¾ç½®">ç£ç›˜IOè®¾ç½®</h4>
<p>è®¾ç½®ç£ç›˜é¢„è¯»</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">fdisk -l
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/sbin/blockdev --setra <span class="m">16384</span> /dev/sdb
</span></span></code></pre></div><p>è°ƒæ•´IOè°ƒåº¦ç®—æ³•</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">echo</span> deadline &gt; /sys/block/sdb/queue/scheduler
</span></span><span class="line"><span class="cl">grubby --update-kernel<span class="o">=</span>ALL --args<span class="o">=</span><span class="s2">&#34;elevator=deadline&#34;</span>
</span></span></code></pre></div><h4 id="è®¾ç½®transparent-huge-pages">è®¾ç½®Transparent Huge Pages</h4>
<p>ç¦æ­¢é€æ˜å¤§é¡µï¼ŒRedhat 6ä»¥åŠæ›´é«˜ç‰ˆæœ¬é»˜è®¤æ¿€æ´»THPï¼ŒTHPä¼šé™ä½GP databaseæ€§èƒ½ï¼Œé€šè¿‡ä¿®æ”¹æ–‡ä»¶/boot/grub/grub.confæ·»åŠ å‚æ•°transparent_hugepage=neverç¦æ­¢THPçš„åº”ç”¨ï¼Œä½†éœ€è¦é‡æ–°å¯åŠ¨ç³»ç»Ÿ</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;echo never &gt; /sys/kernel/mm/*transparent_hugepage/defrag&#34;</span> &gt;/etc/rc.local
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;echo never &gt; /sys/kernel/mm/*transparent_hugepage/enabled&#34;</span> &gt;/etc/rc.local
</span></span><span class="line"><span class="cl">grubby --update-kernel<span class="o">=</span>ALL --args<span class="o">=</span><span class="s2">&#34;transparent_hugepage=never&#34;</span>
</span></span></code></pre></div><blockquote>
<p>éœ€è¦é‡å¯ç³»ç»Ÿ</p>
</blockquote>
<p>æŸ¥çœ‹æ˜¯å¦ç¦ç”¨ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ cat /sys/kernel/mm/*transparent_hugepage/enabled
</span></span><span class="line"><span class="cl">always madvise <span class="o">[</span>never<span class="o">]</span>
</span></span></code></pre></div><p>æ£€æŸ¥å†…æ ¸å‚æ•°ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ grubby --info<span class="o">=</span>ALL
</span></span><span class="line"><span class="cl"><span class="nv">index</span><span class="o">=</span><span class="m">0</span>
</span></span><span class="line"><span class="cl"><span class="nv">kernel</span><span class="o">=</span>/boot/vmlinuz-4.4.202-1.el7.elrepo.x86_64
</span></span><span class="line"><span class="cl"><span class="nv">args</span><span class="o">=</span><span class="s2">&#34;ro elevator=deadline no_timer_check crashkernel=auto rd.lvm.lv=centos_centos7/root rd.lvm.lv=centos_centos7/swap biosdevname=0 net.ifnames=0 rhgb quiet numa=off transparent_hugepage=never&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nv">root</span><span class="o">=</span>/dev/mapper/centos_centos7-root
</span></span><span class="line"><span class="cl"><span class="nv">initrd</span><span class="o">=</span>/boot/initramfs-4.4.202-1.el7.elrepo.x86_64.img
</span></span><span class="line"><span class="cl"><span class="nv">title</span><span class="o">=</span>CentOS Linux <span class="o">(</span>4.4.202-1.el7.elrepo.x86_64<span class="o">)</span> <span class="m">7</span> <span class="o">(</span>Core<span class="o">)</span>
</span></span></code></pre></div><h4 id="å…³é—­removeipc">å…³é—­RemoveIPC</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sed -i <span class="s1">&#39;s/#RemoveIPC=no/RemoveIPC=no/g&#39;</span> /etc/systemd/logind.conf
</span></span><span class="line"><span class="cl">service systemd-logind restart
</span></span></code></pre></div><h4 id="æŒ‚è½½ç£ç›˜">æŒ‚è½½ç£ç›˜</h4>
<p>å…ˆæŸ¥çœ‹ç£ç›˜æŒ‚è½½ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">fdisk -l
</span></span></code></pre></div><p>å¦‚æœæ²¡æœ‰ç£ç›˜ï¼Œåˆ™éœ€è¦æŒ‚è½½ç£ç›˜ã€‚å®˜æ–¹å»ºè®®ä½¿ç”¨XFSç£ç›˜ç±»å‹ï¼Œå½“ç„¶å…¶ä»–ç£ç›˜ç±»å‹ä¹Ÿæ˜¯å¯ä»¥ã€‚</p>
<p>é…ç½®/etc/fstabæ–‡ä»¶ä»¥ä½¿Linuxç³»ç»Ÿå¯åŠ¨é»˜è®¤æŒ‚è½½ç£ç›˜ï¼Œå¦‚ä¸‹é…ç½®æ·»åŠ åˆ°æ–‡ä»¶/etc/fstabï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">mkfs.xfs -f /dev/sdb
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">mkdir /data
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;/dev/sdb /data xfs  nodev,noatime,nobarrier,inode64 0 0&#34;</span> &gt;&gt; /etc/fstab
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">mount -a
</span></span></code></pre></div><h3 id="åˆ›å»ºgreenplumç®¡ç†å‘˜ç”¨æˆ·">åˆ›å»ºGreenplumç®¡ç†å‘˜ç”¨æˆ·</h3>
<p>ä½¿ç”¨rootç”¨æˆ·åˆ›å»ºç”¨æˆ· gpadminï¼Œè¿™é‡Œå¯†ç ä¹Ÿè®¾ç½®ä¸º gpadmin</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">USER</span><span class="o">=</span>gpadmin
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">groupadd <span class="nv">$USER</span>
</span></span><span class="line"><span class="cl">useradd <span class="nv">$USER</span> -r -m -g <span class="nv">$USER</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="nv">$USER</span><span class="p">|</span>passwd <span class="nv">$USER</span> --stdin &gt;/dev/null 2&gt;<span class="p">&amp;</span><span class="m">1</span>
</span></span></code></pre></div><p>æ·»åŠ sudoæƒé™ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$USER</span><span class="s2"> ALL = (root) NOPASSWD:ALL&#34;</span> <span class="p">|</span> sudo tee /etc/sudoers.d/<span class="nv">$USER</span>
</span></span></code></pre></div><p>åˆ‡æ¢åˆ° gpadmin ç”¨æˆ·ï¼Œç”Ÿæˆsshå¯†é’¥ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">su gpadmin
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span> ! -f ~/.ssh/id_rsa.pub <span class="o">]</span> <span class="o">&amp;&amp;</span> <span class="o">(</span>yes<span class="p">|</span>ssh-keygen -f ~/.ssh/id_rsa -t rsa -N <span class="s2">&#34;&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="o">(</span> chmod <span class="m">600</span> ~/.ssh/id_rsa.pub <span class="o">)</span> <span class="o">&amp;&amp;</span> cat ~/.ssh/id_rsa.pub &gt;&gt; ~/.ssh/authorized_keys
</span></span></code></pre></div><h2 id="å®‰è£…æ•°æ®åº“">å®‰è£…æ•°æ®åº“</h2>
<h3 id="å®‰è£…">å®‰è£…</h3>
<p>1ã€ä¸‹è½½é¡µé¢ï¼šhttps://network.pivotal.io/products/pivotal-gpdb/ ï¼Œå½“å‰æœ€æ–°ç‰ˆæœ¬ä¸º6.21.2ï¼Œå¯¹åº”çš„rpmæ–‡ä»¶ greenplum-db-6.21.2-rhel7-x86_64.rpmã€‚</p>
<p>æ‹·è´åˆ°æ¯ä¸ªèŠ‚ç‚¹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">scp greenplum-db-6.21.2-rhel7-x86_64.rpm gpadmin@dw-test-node001:~
</span></span><span class="line"><span class="cl">scp greenplum-db-6.21.2-rhel7-x86_64.rpm gpadmin@dw-test-node002:~
</span></span><span class="line"><span class="cl">scp greenplum-db-6.21.2-rhel7-x86_64.rpm gpadmin@dw-test-node003:~
</span></span></code></pre></div><p>2ã€æ¯ä¸ªèŠ‚ç‚¹å®‰è£…RPM</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ssh dw-test-node001 <span class="s2">&#34;sudo yum install greenplum-db-6.21.2-rhel7-x86_64.rpm -y&#34;</span>
</span></span><span class="line"><span class="cl">ssh dw-test-node002 <span class="s2">&#34;sudo yum install greenplum-db-6.21.2-rhel7-x86_64.rpm -y&#34;</span>
</span></span><span class="line"><span class="cl">ssh dw-test-node003 <span class="s2">&#34;sudo yum install greenplum-db-6.21.2-rhel7-x86_64.rpm -y&#34;</span>
</span></span></code></pre></div><p>3ã€ä¿®æ”¹å®‰è£…ç›®å½•æƒé™</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ssh dw-test-node001 <span class="s2">&#34;sudo chown -R gpadmin:gpadmin /usr/local/greenplum*&#34;</span>
</span></span><span class="line"><span class="cl">ssh dw-test-node002 <span class="s2">&#34;sudo chown -R gpadmin:gpadmin /usr/local/greenplum*&#34;</span>
</span></span><span class="line"><span class="cl">ssh dw-test-node003 <span class="s2">&#34;sudo chown -R gpadmin:gpadmin /usr/local/greenplum*&#34;</span>
</span></span></code></pre></div><h3 id="ç¡®ä¿æ— å¯†ç ç™»é™†">ç¡®ä¿æ— å¯†ç ç™»é™†</h3>
<p>1ã€dw-test-node001èŠ‚ç‚¹ä¸Šé…ç½®gpadminç”¨æˆ·æ— å¯†ç ç™»é™†åˆ°å…¶ä»–èŠ‚ç‚¹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">su gpadmin
</span></span><span class="line"><span class="cl">ssh-copy-id dw-test-node001
</span></span><span class="line"><span class="cl">ssh-copy-id dw-test-node002
</span></span><span class="line"><span class="cl">ssh-copy-id dw-test-node003
</span></span></code></pre></div><p>2ã€è®¾ç½®greenplumç¯å¢ƒå˜é‡ä½¿å…¶ç”Ÿæ•ˆ</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">source</span> /usr/local/greenplum-db/greenplum_path.sh
</span></span></code></pre></div><p>3ã€é…ç½®hostfile_allæ–‡ä»¶ï¼Œå°†æ‰€æœ‰çš„æœåŠ¡å™¨åè®°å½•åœ¨é‡Œé¢ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">cat &gt; hostfile_all <span class="s">&lt;&lt; EOF
</span></span></span><span class="line"><span class="cl"><span class="s">dw-test-node001
</span></span></span><span class="line"><span class="cl"><span class="s">dw-test-node002
</span></span></span><span class="line"><span class="cl"><span class="s">dw-test-node003
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span></code></pre></div><p>hostfile_segmentåªä¿å­˜segmentèŠ‚ç‚¹çš„hostname</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">cat &gt; hostfile_segment <span class="s">&lt;&lt; EOF
</span></span></span><span class="line"><span class="cl"><span class="s">dw-test-node002
</span></span></span><span class="line"><span class="cl"><span class="s">dw-test-node003
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span></code></pre></div><p>4ã€ä½¿ç”¨gpssh-exkeysæ‰“é€šæ‰€æœ‰æœåŠ¡å™¨ï¼Œé…ç½®æ‰€æœ‰GPèŠ‚ç‚¹ä¹‹é—´sshäº’ä¿¡ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ gpssh-exkeys -f hostfile_all 
</span></span><span class="line"><span class="cl"><span class="o">[</span>STEP <span class="m">1</span> of 5<span class="o">]</span> create <span class="nb">local</span> ID and authorize on <span class="nb">local</span> host
</span></span><span class="line"><span class="cl">  ... /home/gpadmin/.ssh/id_rsa file exists ... key generation skipped
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>STEP <span class="m">2</span> of 5<span class="o">]</span> keyscan all hosts and update known_hosts file
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>STEP <span class="m">3</span> of 5<span class="o">]</span> retrieving credentials from remote hosts
</span></span><span class="line"><span class="cl">  ... send to dw-test-node001
</span></span><span class="line"><span class="cl">  ... send to dw-test-node002
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>STEP <span class="m">4</span> of 5<span class="o">]</span> determine common authentication file content
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>STEP <span class="m">5</span> of 5<span class="o">]</span> copy authentication files to all remote hosts
</span></span><span class="line"><span class="cl">  ... finished key exchange with dw-test-node001
</span></span><span class="line"><span class="cl">  ... finished key exchange with dw-test-node002
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>INFO<span class="o">]</span> completed successfully
</span></span></code></pre></div><p>åœ¨æ‰“é€šæ‰€æœ‰æœºå™¨é€šé“ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨gpsshå‘½ä»¤å¯¹æ‰€æœ‰æœºå™¨è¿›è¡Œæ‰¹é‡æ“ä½œäº†ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">gpssh -f hostfile_all <span class="s2">&#34;ls -l /usr/local/greenplum-db&#34;</span>
</span></span></code></pre></div><h3 id="åˆ›å»ºå­˜å‚¨">åˆ›å»ºå­˜å‚¨</h3>
<p>masterä¸Šåˆ›å»ºç›®å½•ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">gpssh -h dw-test-node001 -e <span class="s1">&#39;sudo mkdir -p /gpdata/master &amp;&amp; sudo chown gpadmin:gpadmin /gpdata/master&#39;</span> 
</span></span></code></pre></div><p>æ•°æ®èŠ‚ç‚¹åˆ›å»ºç›®å½•ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">gpssh -f hostfile_segment -e <span class="s1">&#39;sudo mkdir -p /gpdata/primary{0,1} /gpdata/mirror{0,1} &amp;&amp; sudo chown -R gpadmin:gpadmin /gpdata/*&#39;</span>
</span></span></code></pre></div><h3 id="åˆå§‹åŒ–æ•°æ®åº“">åˆå§‹åŒ–æ•°æ®åº“</h3>
<h4 id="åˆ›å»ºæ¨¡æ¿">åˆ›å»ºæ¨¡æ¿</h4>
<p>é…ç½®æ–‡ä»¶çš„æ¨¡æ¿å¯ä»¥åœ¨ $GPHOME/docs/cli_help/gpconfigs/ ç›®å½•ä¸‹æ‰¾åˆ°ã€‚gpinitsystem_configæ–‡ä»¶æ˜¯åˆå§‹åŒ–Greenplumçš„æ¨¡æ¿ï¼Œåœ¨è¿™ä¸ªæ¨¡æ¿ä¸­ï¼ŒMirror Segmentçš„é…ç½®éƒ½è¢«æ³¨é‡Šæ‰äº†ï¼Œæ¨¡æ¿ä¸­åŸºæœ¬åˆå§‹åŒ–æ•°æ®åº“çš„å‚æ•°éƒ½æ˜¯æœ‰çš„ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">cat &gt; gpinitsystem_config <span class="s">&lt;&lt;EOF
</span></span></span><span class="line"><span class="cl"><span class="s">#æ•°æ®åº“çš„ä»£å·
</span></span></span><span class="line"><span class="cl"><span class="s">ARRAY_NAME=&#34;Greenplum Data Platform&#34;
</span></span></span><span class="line"><span class="cl"><span class="s">#Segmentçš„åç§°å‰ç¼€
</span></span></span><span class="line"><span class="cl"><span class="s">SEG_PREFIX=gpseg
</span></span></span><span class="line"><span class="cl"><span class="s">#Primary Segmentèµ·å§‹çš„ç«¯å£å·
</span></span></span><span class="line"><span class="cl"><span class="s">PORT_BASE=40000
</span></span></span><span class="line"><span class="cl"><span class="s">#æŒ‡å®šPrimary Segmentçš„æ•°æ®ç›®å½•ï¼Œé…ç½®å‡ æ¬¡èµ„æºç›®å½•å°±æ˜¯æ¯ä¸ªå­èŠ‚ç‚¹æœ‰å‡ ä¸ªå®ä¾‹ï¼ˆæ¨è4-8ä¸ªï¼Œè¿™é‡Œé…ç½®äº†4ä¸ªï¼Œprimaryä¸mirroræ–‡ä»¶å¤¹ä¸ªæ•°å¯¹åº”ï¼‰
</span></span></span><span class="line"><span class="cl"><span class="s">declare -a DATA_DIRECTORY=(/gpdata/primary0 /gpdata/primary1)
</span></span></span><span class="line"><span class="cl"><span class="s">#Masteræ‰€åœ¨æœºå™¨çš„Hostname
</span></span></span><span class="line"><span class="cl"><span class="s">MASTER_HOSTNAME=dw-test-node001
</span></span></span><span class="line"><span class="cl"><span class="s">#æŒ‡å®šMasterçš„æ•°æ®ç›®å½•
</span></span></span><span class="line"><span class="cl"><span class="s">MASTER_DIRECTORY=/gpdata/master
</span></span></span><span class="line"><span class="cl"><span class="s">#Masterçš„ç«¯å£
</span></span></span><span class="line"><span class="cl"><span class="s">MASTER_PORT=5432
</span></span></span><span class="line"><span class="cl"><span class="s">#æŒ‡å®šBashçš„ç‰ˆæœ¬
</span></span></span><span class="line"><span class="cl"><span class="s">TRUSTED_SHELL=ssh
</span></span></span><span class="line"><span class="cl"><span class="s">#è®¾ç½®çš„æ˜¯æ£€æŸ¥ç‚¹æ®µçš„å¤§å°ï¼Œè¾ƒå¤§çš„æ£€æŸ¥ç‚¹æ®µå¯ä»¥æ”¹å–„å¤§æ•°æ®é‡è£…è½½çš„æ€§èƒ½ï¼ŒåŒæ—¶ä¼šåŠ é•¿ç¾éš¾äº‹åŠ¡æ¢å¤çš„æ—¶é—´ã€‚
</span></span></span><span class="line"><span class="cl"><span class="s">CHECK_POINT_SEGMENTS=8
</span></span></span><span class="line"><span class="cl"><span class="s">#å­—ç¬¦é›†
</span></span></span><span class="line"><span class="cl"><span class="s">ENCODING=utf-8
</span></span></span><span class="line"><span class="cl"><span class="s">
</span></span></span><span class="line"><span class="cl"><span class="s">#Mirror Segmentèµ·å§‹çš„ç«¯å£å·
</span></span></span><span class="line"><span class="cl"><span class="s">MIRROR_PORT_BASE=41000
</span></span></span><span class="line"><span class="cl"><span class="s">#Primary Segmentä¸»å¤‡åŒæ­¥çš„èµ·å§‹ç«¯å£å·
</span></span></span><span class="line"><span class="cl"><span class="s">REPLICATION_PORT_BASE=42000
</span></span></span><span class="line"><span class="cl"><span class="s">#Mirror Segmentä¸»å¤‡åŒæ­¥çš„èµ·å§‹ç«¯å£å·
</span></span></span><span class="line"><span class="cl"><span class="s">MIRROR_REPLICATION_PORT_BASE=43000
</span></span></span><span class="line"><span class="cl"><span class="s">#Mirror Segmentçš„æ•°æ®ç›®å½•,é…ç½®å‡ æ¬¡èµ„æºç›®å½•å°±æ˜¯æ¯ä¸ªå­èŠ‚ç‚¹æœ‰å‡ ä¸ªå®ä¾‹ï¼ˆæ¨è4-8ä¸ªï¼Œè¿™é‡Œé…ç½®äº†4ä¸ªï¼Œprimaryä¸mirroræ–‡ä»¶å¤¹ä¸ªæ•°å¯¹åº”ï¼‰
</span></span></span><span class="line"><span class="cl"><span class="s">declare -a MIRROR_DATA_DIRECTORY=(/gpdata/mirror0 /gpdata/mirror1)
</span></span></span><span class="line"><span class="cl"><span class="s">
</span></span></span><span class="line"><span class="cl"><span class="s">MASTER_MAX_CONNECT=250
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span></code></pre></div><blockquote>
<p>å¦‚æœæ˜¯æŒ‚è½½äº†å¤šä¸ªç£ç›˜ï¼Œåˆ™æ•°æ®è·¯å¾„éœ€è¦ä½¿ç”¨ç‹¬ç«‹çš„è·¯å¾„ã€‚</p>
</blockquote>
<h4 id="åˆå§‹åŒ–æ•°æ®åº“-1">åˆå§‹åŒ–æ•°æ®åº“</h4>
<p>ä½¿ç”¨gpinitsystemè„šæœ¬æ¥åˆå§‹åŒ–æ•°æ®åº“ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">gpinitsystem -c gpinitsystem_config -h hostfile_segment
</span></span></code></pre></div><p>ä¹Ÿå¯ä»¥æŒ‡å®šstandby master ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-BASH" data-lang="BASH"><span class="line"><span class="cl">gpinitsystem -c gpinitsystem_config -h hostfile_segment -s dw-test-node002
</span></span></code></pre></div><blockquote>
<p>å¦‚æœä¸æƒ³æ‰‹åŠ¨ç¡®è®¤ï¼Œå¯ä»¥æ·»åŠ  <code>-a</code> å‚æ•°ã€‚</p>
</blockquote>
<p>åæœŸæ·»åŠ standby masterï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1">#åœ¨ä¸åŒæœºå™¨å¢åŠ standby masterèŠ‚ç‚¹</span>
</span></span><span class="line"><span class="cl">gpinitstandby -S /gdata/master/gpseg1 -s dw-test-node001
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#åœ¨åŒä¸€æœºå™¨å¢åŠ standby masterèŠ‚ç‚¹</span>
</span></span><span class="line"><span class="cl">gpinitstandby -S /gdata/master/gpseg1 -P <span class="m">5433</span> -s dw-test-node001
</span></span></code></pre></div><h4 id="è®¾ç½®ç¯å¢ƒå˜é‡">è®¾ç½®ç¯å¢ƒå˜é‡</h4>
<p>åˆ‡æ¢åˆ°gpadminç”¨æˆ·ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">su - gpadmin 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">cat &gt;&gt;  ~/.bashrc <span class="s">&lt;&lt;EOF
</span></span></span><span class="line"><span class="cl"><span class="s">source /usr/local/greenplum-db/greenplum_path.sh
</span></span></span><span class="line"><span class="cl"><span class="s">export GPHOME=/usr/local/greenplum-db
</span></span></span><span class="line"><span class="cl"><span class="s">export MASTER_DATA_DIRECTORY=/gpdata/master/gpseg1
</span></span></span><span class="line"><span class="cl"><span class="s">export PGPORT=5432
</span></span></span><span class="line"><span class="cl"><span class="s">export PGUSER=gpadmin
</span></span></span><span class="line"><span class="cl"><span class="s">export PGDATABASE=postgres
</span></span></span><span class="line"><span class="cl"><span class="s">export LD_PRELOAD=/lib64/libz.so.1
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">source</span> ~/.bashrc
</span></span></code></pre></div><p>å¦‚æœé…ç½®äº† standby masterèŠ‚ç‚¹ï¼Œåˆ™æ‹·è´åˆ°standby masterèŠ‚ç‚¹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">scp ~/.bashrc dw-test-node002:~
</span></span><span class="line"><span class="cl">ssh dw-test-node002 <span class="s2">&#34;source ~/.bashrc&#34;</span>
</span></span></code></pre></div><h4 id="è®¾ç½®æ•°æ®åº“æ—¶åŒº">è®¾ç½®æ•°æ®åº“æ—¶åŒº</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">gpconfig -s TimeZone
</span></span><span class="line"><span class="cl">gpconfig -c TimeZone -v <span class="s1">&#39;Asia/Shanghai&#39;</span>
</span></span></code></pre></div><h3 id="ä¿®æ”¹é…ç½®">ä¿®æ”¹é…ç½®</h3>
<h4 id="è®¾ç½®è¿œç¨‹ç”¨æˆ·è®¿é—®">è®¾ç½®è¿œç¨‹ç”¨æˆ·è®¿é—®</h4>
<p>æŸ¥çœ‹/gpdata/master/gpseg1/pg_hba.confï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">local</span>    all         gpadmin         ident
</span></span><span class="line"><span class="cl">host     all         gpadmin         127.0.0.1/28    trust
</span></span><span class="line"><span class="cl">host     all         gpadmin         192.168.56.141/32       trust
</span></span><span class="line"><span class="cl"><span class="nb">local</span>    replication gpadmin         ident
</span></span><span class="line"><span class="cl">host     replication gpadmin         samehost       trust
</span></span><span class="line"><span class="cl">host     replication gpadmin         192.168.56.141/32       trust
</span></span></code></pre></div><p>ä¿®æ”¹ä¸ºï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">local</span>    all         gpadmin         ident
</span></span><span class="line"><span class="cl">host     all         gpadmin         127.0.0.1/28    trust
</span></span><span class="line"><span class="cl">host     all         gpadmin         192.168.56.141/32       trust
</span></span><span class="line"><span class="cl"><span class="nb">local</span>    replication gpadmin         ident
</span></span><span class="line"><span class="cl">host     replication gpadmin         samehost       trust
</span></span><span class="line"><span class="cl">host     replication gpadmin         192.168.56.141/32       trust
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">host     all         all		         192.168.56.141/32       trust  <span class="c1">#add this</span>
</span></span></code></pre></div><blockquote>
<p>æ·»åŠ ä¸€è¡Œï¼Œè®¾ç½®192.168.56.141/32å¯ä»¥è®¿é—®æ‰€æœ‰æ•°æ®åº“</p>
</blockquote>
<h4 id="è®¾ç½®ç›‘å¬ipå’Œport">è®¾ç½®ç›‘å¬IPå’ŒPort</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">vi /gpdata/master/gpseg1/postgresql.conf
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è®¾ç½®ç›‘å¬IP (* ç”Ÿäº§ç¯å¢ƒæ…ç”¨)</span>
</span></span><span class="line"><span class="cl"><span class="nv">listen_addresses</span> <span class="o">=</span> <span class="s1">&#39;${ host ip address } &#39;</span>
</span></span><span class="line"><span class="cl"><span class="nv">port</span> <span class="o">=</span> <span class="m">5432</span>
</span></span></code></pre></div><h3 id="å¯åŠ¨ä¸å…³é—­">å¯åŠ¨ä¸å…³é—­</h3>
<p>å¯åŠ¨æ•°æ®åº“ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">gpstart -a
</span></span></code></pre></div><p>å…³é—­æ•°æ®åº“ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">gpstop -a
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">gpstop -M fast
</span></span></code></pre></div><p>é‡å¯æ•°æ®åº“ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">gpstop -ar
</span></span></code></pre></div><p>é‡æ–°åŠ è½½é…ç½®æ–‡ä»¶ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"> gpstop -u
</span></span></code></pre></div><p>è®¾ç½®å¼€æœºå¯åŠ¨ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">cat &gt; greenplum.service <span class="s">&lt;&lt;EOF 
</span></span></span><span class="line"><span class="cl"><span class="s">[Unit]
</span></span></span><span class="line"><span class="cl"><span class="s">Description=greenplum server daemon
</span></span></span><span class="line"><span class="cl"><span class="s">
</span></span></span><span class="line"><span class="cl"><span class="s">[Service]
</span></span></span><span class="line"><span class="cl"><span class="s">Restart=on-failure
</span></span></span><span class="line"><span class="cl"><span class="s">ExecStart=/usr/local/greenplum-db/bin/gpstart -a
</span></span></span><span class="line"><span class="cl"><span class="s"> 
</span></span></span><span class="line"><span class="cl"><span class="s">[Install]
</span></span></span><span class="line"><span class="cl"><span class="s">WantedBy=multi-user.target
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">sudo mv greenplum.service /usr/lib/systemd/system/
</span></span></code></pre></div><h3 id="æµ‹è¯•">æµ‹è¯•</h3>
<h4 id="å®¢æˆ·ç«¯è®¿é—®">å®¢æˆ·ç«¯è®¿é—®</h4>
<p>åœ¨æœ¬åœ°è®¿é—®ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">psql -p <span class="m">5432</span> -U gpadmin -d postgres
</span></span></code></pre></div><p>åœ¨å…¶ä»–æœºå™¨è®¿é—®ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">psql -p <span class="m">5432</span> -h 192.168.56.141 -U gpadmin -d postgres
</span></span></code></pre></div><h3 id="æ¸…ç©ºæ•°æ®">æ¸…ç©ºæ•°æ®</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1">#å¦‚æœ‰æŠ¥é”™éœ€é‡æ–°åˆå§‹åŒ–ï¼Œæ¸…ç†ä»¥ä¸‹å†…å®¹ï¼š</span>
</span></span><span class="line"><span class="cl"><span class="nb">kill</span> -9 <span class="k">$(</span>ps -ef <span class="p">|</span>grep greenplum<span class="p">|</span>awk <span class="s1">&#39;{print $2}&#39;</span><span class="k">)</span>
</span></span><span class="line"><span class="cl">gpssh -f hostfile_all -e <span class="s2">&#34;rm -rf /gpdata/master/*&#34;</span>
</span></span><span class="line"><span class="cl">gpssh -f hostfile_segment -e <span class="s2">&#34;rm -rf /gpdata/{mirror*,primary*}/*&#34;</span>
</span></span><span class="line"><span class="cl">rm  -f /tmp/.s.PGSQL*.lock
</span></span></code></pre></div><h3 id="å‡çº§">å‡çº§</h3>
<p>1ã€ç™»é™†ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">su - gpadmin
</span></span></code></pre></div><p>2ã€åœæ­¢æ•°æ®åº“</p>
<p>masterèŠ‚ç‚¹æ‰§è¡Œï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">gpstop -a
</span></span></code></pre></div><p>3ã€å®‰è£…æ–°ç‰ˆæœ¬</p>
<p>ä»https://github.com/greenplum-db/gpdb/releases ä¸‹è½½æœ€æ–°ç‰ˆæœ¬ï¼Œå¹¶æ‹·è´åˆ°æ¯ä¸ªé˜¶æ®µã€‚åœ¨æ¯ä¸ªèŠ‚ç‚¹è¿è¡Œä¸‹é¢å‘½ä»¤ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo yum install greenplum-db-6.21.2-rhel7-x86_64.rpm -y
</span></span></code></pre></div><p>4ã€è®¾ç½®ç›®å½•æƒé™</p>
<p>æ¯ä¸ªèŠ‚ç‚¹æ‰§è¡Œï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo chown -R gpadmin:gpadmin /usr/local/greenplum*
</span></span></code></pre></div><p>5ã€è®¾ç½®ç¯å¢ƒå˜é‡</p>
<p>é‡æ–°è®¾ç½®è½¯è¿æ¥ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">rm /usr/local/greenplum-db
</span></span><span class="line"><span class="cl">ln -s /usr/local/greenplum-db-6.21.2 /usr/local/greenplum-db
</span></span><span class="line"><span class="cl"><span class="nb">source</span> ~/.bashrc
</span></span></code></pre></div><p>6ã€å¯åŠ¨æ•°æ®åº“</p>
<p>masterèŠ‚ç‚¹æ‰§è¡Œï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">gpstart -a
</span></span></code></pre></div><h3 id="å¸¸ç”¨å‘½ä»¤">å¸¸ç”¨å‘½ä»¤</h3>
<h4 id="æŸ¥çœ‹æ•°æ®åº“çŠ¶æ€">æŸ¥çœ‹æ•°æ®åº“çŠ¶æ€</h4>
<p>1ã€æŸ¥çœ‹segment</p>
<p>åˆ—å‡ºå½“å‰çŠ¶æ€ä¸ºdownçš„Segmentï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">gp_segment_configuration</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="o">&lt;&gt;</span><span class="w"> </span><span class="s1">&#39;u&#39;</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><p>æ£€æŸ¥å½“å‰å¤„äºæ”¹å˜è·Ÿè¸ªæ¨¡å¼çš„Segmentã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">gp_segment_configuration</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="k">mode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;c&#39;</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><p>æ£€æŸ¥å½“å‰åœ¨é‡æ–°åŒæ­¥çš„Segmentã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">gp_segment_configuration</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="k">mode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;r&#39;</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><p>æ£€æŸ¥æ²¡æœ‰ä»¥å…¶æœ€ä¼˜è§’è‰²è¿è½¬çš„Segmentã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">gp_segment_configuration</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">preferred_role</span><span class="w"> </span><span class="o">&lt;&gt;</span><span class="w"> </span><span class="k">role</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><p>è¿è¡Œä¸€ä¸ªåˆ†å¸ƒå¼æŸ¥è¯¢æ¥æµ‹è¯•å®ƒè¿è¡Œåœ¨æ‰€æœ‰Segmentä¸Šã€‚å¯¹æ¯ä¸ªä¸»Segmentéƒ½åº”è¿”å›ä¸€è¡Œã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="n">gp_segment_id</span><span class="p">,</span><span class="w"> </span><span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">gp_dist_random</span><span class="p">(</span><span class="s1">&#39;pg_class&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><p>2ã€æŸ¥çœ‹æ•°æ®åº“è¿æ¥</p>
<p>æŸ¥çœ‹åˆ°å½“å‰æ•°æ®åº“è¿æ¥çš„IP åœ°å€ï¼Œç”¨æˆ·åï¼Œæäº¤çš„æŸ¥è¯¢ç­‰ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">pg_stat_activity</span><span class="w"> 
</span></span></span></code></pre></div><p>3ã€æŸ¥çœ‹è¡¨å­˜å‚¨ç»“æ„</p>
<p>æŸ¥çœ‹è¡¨çš„å­˜å‚¨ç»“æ„:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">select</span><span class="w"> </span><span class="k">distinct</span><span class="w"> </span><span class="n">relstorage</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">pg_class</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><p>æŸ¥è¯¢å½“å‰æ•°æ®åº“æœ‰å“ªäº›AOè¡¨ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">select</span><span class="w"> </span><span class="n">t2</span><span class="p">.</span><span class="n">nspname</span><span class="p">,</span><span class="w"> </span><span class="n">t1</span><span class="p">.</span><span class="n">relname</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">pg_class</span><span class="w"> </span><span class="n">t1</span><span class="p">,</span><span class="w"> </span><span class="n">pg_namespace</span><span class="w"> </span><span class="n">t2</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">t1</span><span class="p">.</span><span class="n">relnamespace</span><span class="o">=</span><span class="n">t2</span><span class="p">.</span><span class="n">oid</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">relstorage</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;a&#39;</span><span class="p">);</span><span class="w">
</span></span></span></code></pre></div><p>æŸ¥è¯¢å½“å‰æ•°æ®åº“æœ‰å“ªäº›å †è¡¨ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">select</span><span class="w"> </span><span class="n">t2</span><span class="p">.</span><span class="n">nspname</span><span class="p">,</span><span class="w"> </span><span class="n">t1</span><span class="p">.</span><span class="n">relname</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">pg_class</span><span class="w"> </span><span class="n">t1</span><span class="p">,</span><span class="w"> </span><span class="n">pg_namespace</span><span class="w"> </span><span class="n">t2</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">t1</span><span class="p">.</span><span class="n">relnamespace</span><span class="o">=</span><span class="n">t2</span><span class="p">.</span><span class="n">oid</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">relstorage</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">)</span><span class="w">  </span><span class="k">and</span><span class="w"> </span><span class="n">relkind</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">;</span><span class="w"> 
</span></span></span></code></pre></div><h4 id="ç»´æŠ¤æ•°æ®åº“">ç»´æŠ¤æ•°æ®åº“</h4>
<p>æ£€æŸ¥è¡¨ä¸Šç¼ºå¤±çš„ç»Ÿè®¡ä¿¡æ¯ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">gp_toolkit</span><span class="p">.</span><span class="n">gp_stats_missing</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><p>æ£€æŸ¥æ•°æ®æ–‡ä»¶ä¸­å‡ºç°è†¨èƒ€ï¼ˆæ­»äº¡ç©ºé—´ï¼‰ä¸”æ— æ³•ç”¨å¸¸è§„VACUUMå‘½ä»¤æ¢å¤çš„è¡¨ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">gp_toolkit</span><span class="p">.</span><span class="n">gp_bloat_diag</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><p>æ¸…ç†ç”¨æˆ·è¡¨</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">VACUUM</span><span class="w"> </span><span class="o">&lt;</span><span class="k">table</span><span class="o">&gt;</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><p>åˆ†æç”¨æˆ·è¡¨ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="n">analyzedb</span><span class="w"> </span><span class="o">-</span><span class="n">d</span><span class="w"> </span><span class="o">&lt;</span><span class="k">database</span><span class="o">&gt;</span><span class="w"> </span><span class="o">-</span><span class="n">a</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">analyzedb</span><span class="w"> </span><span class="o">-</span><span class="n">s</span><span class="w"> </span><span class="n">pg_catalog</span><span class="w"> </span><span class="o">-</span><span class="n">d</span><span class="w"> </span><span class="o">&lt;</span><span class="k">database</span><span class="o">&gt;</span><span class="w">
</span></span></span></code></pre></div><p>æ¨èå‘¨æœŸæ€§åœ°åœ¨ç³»ç»Ÿç›®å½•ä¸Šè¿è¡ŒVACUUMå’ŒREINDEXæ¥æ¸…ç†ç³»ç»Ÿè¡¨å’Œç´¢å¼•ä¸­å·²åˆ é™¤å¯¹è±¡æ‰€å ç”¨çš„ç©ºé—´ï¼š</p>
<p>ä¸‹é¢çš„ç¤ºä¾‹è„šæœ¬åœ¨ä¸€ä¸ªGreenplumæ•°æ®åº“ç³»ç»Ÿç›®å½•ä¸Šæ‰§è¡Œä¸€æ¬¡VACUUMã€REINDEXä»¥åŠANALYZEï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="cp">#!/bin/bash
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="nv">DBNAME</span><span class="o">=</span><span class="s2">&#34;&lt;database-name&gt;&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nv">SYSTABLES</span><span class="o">=</span><span class="s2">&#34;&#39; pg_catalog.&#39; || relname || &#39;;&#39; from pg_class a, pg_namespace b 
</span></span></span><span class="line"><span class="cl"><span class="s2">where a.relnamespace=b.oid and b.nspname=&#39;pg_catalog&#39; and a.relkind=&#39;r&#39;&#34;</span>
</span></span><span class="line"><span class="cl">psql -tc <span class="s2">&#34;SELECT &#39;VACUUM&#39; || </span><span class="nv">$SYSTABLES</span><span class="s2">&#34;</span> <span class="nv">$DBNAME</span> <span class="p">|</span> psql -a <span class="nv">$DBNAME</span>
</span></span><span class="line"><span class="cl">reindexdb --system -d <span class="nv">$DBNAME</span>
</span></span><span class="line"><span class="cl">analyzedb -s pg_catalog -d <span class="nv">$DBNAME</span>
</span></span></code></pre></div><h4 id="æŸ¥çœ‹ç£ç›˜ç©ºé—´">æŸ¥çœ‹ç£ç›˜ç©ºé—´</h4>
<p>1ã€æ£€æŸ¥ç£ç›˜ç©ºé—´ä½¿ç”¨</p>
<p>ä»¥ä½¿ç”¨gp_toolkitç®¡ç†æ–¹æ¡ˆä¸­çš„gp_disk_freeå¤–éƒ¨è¡¨æ¥æ£€æŸ¥Segmentä¸»æœºæ–‡ä»¶ç³»ç»Ÿä¸­çš„å‰©ä½™ç©ºé—²ç©ºé—´ï¼ˆä»¥åƒå­—èŠ‚è®¡ï¼‰ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="n">dw_lps</span><span class="o">=#</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">gp_toolkit</span><span class="p">.</span><span class="n">gp_disk_free</span><span class="w"> </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">dfsegment</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="n">dfsegment</span><span class="w"> </span><span class="o">|</span><span class="w">    </span><span class="n">dfhostname</span><span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="n">dfdevice</span><span class="w">  </span><span class="o">|</span><span class="w">  </span><span class="n">dfspace</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-----------+------------------+-----------+-----------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">         </span><span class="mi">0</span><span class="w"> </span><span class="o">|</span><span class="w">  </span><span class="n">dw</span><span class="o">-</span><span class="n">test</span><span class="o">-</span><span class="n">node001</span><span class="w"> </span><span class="o">|</span><span class="w">  </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">sdb</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mi">472594712</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">         </span><span class="mi">1</span><span class="w"> </span><span class="o">|</span><span class="w">  </span><span class="n">dw</span><span class="o">-</span><span class="n">test</span><span class="o">-</span><span class="n">node001</span><span class="w"> </span><span class="o">|</span><span class="w">  </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">sdb</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mi">472594712</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">(</span><span class="mi">2</span><span class="w"> </span><span class="k">rows</span><span class="p">)</span><span class="w">
</span></span></span></code></pre></div><p>2ã€æŸ¥çœ‹æ•°æ®åº“çš„ç£ç›˜ç©ºé—´ä½¿ç”¨</p>
<p>è¦æŸ¥çœ‹ä¸€ä¸ªæ•°æ®åº“çš„æ€»å°ºå¯¸ï¼ˆä»¥å­—èŠ‚è®¡ï¼‰ï¼Œä½¿ç”¨<em>gp_toolkit</em>ç®¡ç†æ–¹æ¡ˆä¸­çš„<em>gp_size_of_database</em>è§†å›¾ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="n">dw_lps</span><span class="o">=#</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">gp_toolkit</span><span class="p">.</span><span class="n">gp_size_of_database</span><span class="w"> </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">sodddatname</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="n">sodddatname</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">sodddatsize</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-------------+-------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w"> </span><span class="n">dw_lps</span><span class="w">      </span><span class="o">|</span><span class="w">  </span><span class="mi">3833874988</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="n">gpperfmon</span><span class="w">   </span><span class="o">|</span><span class="w">    </span><span class="mi">63310532</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">(</span><span class="mi">2</span><span class="w"> </span><span class="k">rows</span><span class="p">)</span><span class="w">
</span></span></span></code></pre></div><p>æŸ¥çœ‹æŸä¸ªæ•°æ®åº“å ç”¨ç©ºé—´ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="n">dw_lps</span><span class="o">=#</span><span class="w"> </span><span class="k">select</span><span class="w"> </span><span class="n">pg_size_pretty</span><span class="p">(</span><span class="n">pg_database_size</span><span class="p">(</span><span class="s1">&#39;dw_lps&#39;</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="n">pg_size_pretty</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">----------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w"> </span><span class="mi">3656</span><span class="w"> </span><span class="n">MB</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="k">row</span><span class="p">)</span><span class="w">
</span></span></span></code></pre></div><p>3ã€æŸ¥çœ‹ä¸€ä¸ªè¡¨çš„ç£ç›˜ç©ºé—´ä½¿ç”¨</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="n">relname</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">sotdsize</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="k">size</span><span class="p">,</span><span class="w"> </span><span class="n">sotdtoastsize</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="k">AS</span><span class="w"> </span><span class="k">toast</span><span class="p">,</span><span class="w"> </span><span class="n">sotdadditionalsize</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">other</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="k">FROM</span><span class="w"> </span><span class="n">gp_toolkit</span><span class="p">.</span><span class="n">gp_size_of_table_disk</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">sotd</span><span class="p">,</span><span class="w"> </span><span class="n">pg_class</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="k">WHERE</span><span class="w"> </span><span class="n">sotd</span><span class="p">.</span><span class="n">sotdoid</span><span class="o">=</span><span class="n">pg_class</span><span class="p">.</span><span class="n">oid</span><span class="w"> </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">relname</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><p>4ã€æŸ¥çœ‹ç´¢å¼•çš„ç£ç›˜ç©ºé—´ä½¿ç”¨</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="n">soisize</span><span class="p">,</span><span class="w"> </span><span class="n">relname</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">indexname</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="k">FROM</span><span class="w"> </span><span class="n">pg_class</span><span class="p">,</span><span class="w"> </span><span class="n">gp_toolkit</span><span class="p">.</span><span class="n">gp_size_of_index</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="k">WHERE</span><span class="w"> </span><span class="n">pg_class</span><span class="p">.</span><span class="n">oid</span><span class="o">=</span><span class="n">gp_size_of_index</span><span class="p">.</span><span class="n">soioid</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="k">AND</span><span class="w"> </span><span class="n">pg_class</span><span class="p">.</span><span class="n">relkind</span><span class="o">=</span><span class="s1">&#39;i&#39;</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><h4 id="æŸ¥çœ‹æ•°æ®åˆ†å¸ƒ">æŸ¥çœ‹æ•°æ®åˆ†å¸ƒ</h4>
<p>1ã€æŸ¥çœ‹æŸä¸ªè¡¨çš„æ•°æ®åˆ†å¸ƒï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="n">dw_lps</span><span class="o">=#</span><span class="w"> </span><span class="k">select</span><span class="w"> </span><span class="n">gp_segment_id</span><span class="p">,</span><span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">ods_lps_bill</span><span class="w"> </span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">gp_segment_id</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="n">gp_segment_id</span><span class="w"> </span><span class="o">|</span><span class="w">  </span><span class="k">count</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">---------------+---------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">             </span><span class="mi">0</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mi">1440129</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">             </span><span class="mi">1</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mi">1439143</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">(</span><span class="mi">2</span><span class="w"> </span><span class="k">rows</span><span class="p">)</span><span class="w">
</span></span></span></code></pre></div><p>2ã€æŸ¥è¯¢å‹ç¼©ç‡ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">select</span><span class="w"> </span><span class="n">get_ao_compression_ratio</span><span class="p">(</span><span class="s1">&#39;ods_lps_bill&#39;</span><span class="p">);</span><span class="w">
</span></span></span></code></pre></div><p>3ã€æŸ¥çœ‹AOè¡¨çš„è†¨èƒ€ç‡</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">gp_toolkit</span><span class="p">.</span><span class="n">__gp_aovisimap_compaction_info</span><span class="p">(</span><span class="s1">&#39;ods_lps_bill&#39;</span><span class="p">::</span><span class="n">regclass</span><span class="p">);</span><span class="w">
</span></span></span></code></pre></div><p>è†¨èƒ€ç‡è¶…è¿‡åƒåˆ†ä¹‹2çš„AOè¡¨ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="p">(</span><span class="w">  
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">select</span><span class="w"> </span><span class="n">t2</span><span class="p">.</span><span class="n">nspname</span><span class="p">,</span><span class="w"> </span><span class="n">t1</span><span class="p">.</span><span class="n">relname</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">gp_toolkit</span><span class="p">.</span><span class="n">__gp_aovisimap_compaction_info</span><span class="p">(</span><span class="n">t1</span><span class="p">.</span><span class="n">oid</span><span class="p">)).</span><span class="o">*</span><span class="w">   
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">from</span><span class="w"> </span><span class="n">pg_class</span><span class="w"> </span><span class="n">t1</span><span class="p">,</span><span class="w"> </span><span class="n">pg_namespace</span><span class="w"> </span><span class="n">t2</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">t1</span><span class="p">.</span><span class="n">relnamespace</span><span class="o">=</span><span class="n">t2</span><span class="p">.</span><span class="n">oid</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">relstorage</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="w">   
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">)</span><span class="w"> </span><span class="n">t</span><span class="w">   
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="n">t</span><span class="p">.</span><span class="n">percent_hidden</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">2</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><h4 id="æŸ¥çœ‹å…ƒæ•°æ®">æŸ¥çœ‹å…ƒæ•°æ®</h4>
<p>1ã€æŸ¥çœ‹è¡¨å…ƒæ•°æ®</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="err">\</span><span class="n">d</span><span class="o">+</span><span class="w"> </span><span class="n">ods_lps_bill</span><span class="w">
</span></span></span></code></pre></div><p>2ã€æŸ¥çœ‹æŸä¸€ä¸ªè¡¨ä¸Šæ‰§è¡Œçš„æ“ä½œ</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="n">schemaname</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="k">schema</span><span class="p">,</span><span class="w"> </span><span class="n">objname</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="k">table</span><span class="p">,</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="n">usename</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="k">role</span><span class="p">,</span><span class="w"> </span><span class="n">actionname</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">action</span><span class="p">,</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="n">subtype</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="k">type</span><span class="p">,</span><span class="w"> </span><span class="n">statime</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">time</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="k">FROM</span><span class="w"> </span><span class="n">pg_stat_operations</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="k">WHERE</span><span class="w"> </span><span class="n">objname</span><span class="o">=</span><span class="s1">&#39;ods_lps_bill&#39;</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><h3 id="å‚è€ƒæ–‡ç« ">å‚è€ƒæ–‡ç« </h3>
<ul>
<li><a href="https://blog.csdn.net/q936889811/article/details/85603814">greenplumé›†ç¾¤çš„rpmï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰éƒ¨ç½²åŠå‚æ•°ä¼˜åŒ–</a></li>
<li><a href="https://gpdb.docs.pivotal.io/6-1/install_guide/install_gpdb.html">Installing the Greenplum Database Software</a></li>
</ul>
]]></content:encoded></item><item><title>PostgreSqlå®‰è£…å’Œéƒ¨ç½²</title><link>https://blog.chensoul.com/posts/2022/08/19/postgresql-install-deploy/</link><pubDate>Fri, 19 Aug 2022 17:11:19 +0800</pubDate><guid>https://blog.chensoul.com/posts/2022/08/19/postgresql-install-deploy/</guid><description>yumå®‰è£… å®‰è£…PostgreSQL 12 yum install https://download.postgresql.org/pub/repos/yum/reporpms/EL-7-x86_64/pgdg-redhat-repo-latest.noarch.rpm yum install postgresql12 postgresql12-server -y å®‰è£…è·¯å¾„åœ¨ /usr/pgsql-12/ å®‰è£…å®Œä¹‹åï¼Œåˆå§‹åŒ–æ•°æ®åº“å¹¶è®¾ç½®å¼€æœºå¯åŠ¨ï¼š /usr/pgsql-12/bin/postgresql-12-setup initdb systemctl enable postgresql-12 systemctl start postgresql-12 å®‰è£…PostgreS</description><content:encoded><![CDATA[<h2 id="yumå®‰è£…">yumå®‰è£…</h2>
<h3 id="å®‰è£…postgresql-12">å®‰è£…PostgreSQL 12</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">yum install https://download.postgresql.org/pub/repos/yum/reporpms/EL-7-x86_64/pgdg-redhat-repo-latest.noarch.rpm
</span></span><span class="line"><span class="cl">yum install postgresql12 postgresql12-server -y
</span></span></code></pre></div><p>å®‰è£…è·¯å¾„åœ¨ /usr/pgsql-12/</p>
<p>å®‰è£…å®Œä¹‹åï¼Œåˆå§‹åŒ–æ•°æ®åº“å¹¶è®¾ç½®å¼€æœºå¯åŠ¨ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">/usr/pgsql-12/bin/postgresql-12-setup initdb 
</span></span><span class="line"><span class="cl">systemctl <span class="nb">enable</span> postgresql-12 
</span></span><span class="line"><span class="cl">systemctl start postgresql-12
</span></span></code></pre></div><h3 id="å®‰è£…postgresql-96">å®‰è£…PostgreSQL 9.6</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo yum install https://download.postgresql.org/pub/repos/yum/reporpms/EL-7-x86_64/pgdg-redhat-repo-latest.noarch.rpm
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">sudo yum install postgresql96 postgresql96-server -y
</span></span></code></pre></div><p>å®‰è£…è·¯å¾„åœ¨ /usr/pgsql-9/</p>
<p>å®‰è£…å®Œä¹‹åï¼Œåˆå§‹åŒ–æ•°æ®åº“å¹¶è®¾ç½®å¼€æœºå¯åŠ¨ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">/usr/pgsql-9.6/bin/postgresql96-setup initdb
</span></span><span class="line"><span class="cl">systemctl <span class="nb">enable</span> postgresql-9.6
</span></span><span class="line"><span class="cl">systemctl start postgresql-9.6
</span></span></code></pre></div><h3 id="é…ç½®æ•°æ®åº“">é…ç½®æ•°æ®åº“</h3>
<p>æŸ¥æ‰¾è·¯å¾„ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">find / -name pg_hba.conf /var/lib/pgsql/12/data/pg_hba.conf
</span></span></code></pre></div><p>ä¿®æ”¹ <code>pg_hba.conf</code>ï¼Œè®¾ç½®è¿œç¨‹ç”¨æˆ·è®¿é—®æƒé™ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sed -i <span class="s2">&#34;s/127.0.0.1\/32/0.0.0.0\/0/&#34;</span> /var/lib/pgsql/12/data/pg_hba.conf
</span></span><span class="line"><span class="cl">sed -i <span class="s2">&#34;s/ident/trust/&#34;</span> /var/lib/pgsql/12/data/pg_hba.conf
</span></span><span class="line"><span class="cl">sed -i <span class="s2">&#34;s/peer/trust/&#34;</span> /var/lib/pgsql/12/data/pg_hba.conf
</span></span></code></pre></div><ul>
<li>md5å¹¶æä¾›åŠ å¯†çš„å¯†ç éªŒè¯</li>
<li>trustæ„æ€ä¸ç”¨å¯†ç éªŒè¯</li>
</ul>
<p>ä¿®æ”¹postgresql.confï¼Œé…ç½®ç›‘å¬åœ°å€ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">CONF_FILE</span><span class="o">=</span>/var/lib/pgsql/12/data/postgresql.conf
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">sudo sed -i <span class="s2">&#34;s/#port = 5432/port = 5432/&#34;</span> <span class="nv">$CONF_FILE</span>
</span></span><span class="line"><span class="cl">sudo sed -i <span class="s2">&#34;s/max_connections = 100/max_connections = 600/&#34;</span> <span class="nv">$CONF_FILE</span>
</span></span><span class="line"><span class="cl">sudo sed -i <span class="s2">&#34;s/#listen_addresses = &#39;localhost&#39;/listen_addresses = &#39;*&#39;/&#34;</span> <span class="nv">$CONF_FILE</span>
</span></span><span class="line"><span class="cl">sudo sed -i <span class="s2">&#34;s/shared_buffers = 32MB/shared_buffers = 256MB/&#34;</span> <span class="nv">$CONF_FILE</span>
</span></span></code></pre></div><p>é‡å¯æ•°æ®åº“ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">systemctl restart postgresql-12
</span></span></code></pre></div><h3 id="åˆ›å»ºæ•°æ®åº“">åˆ›å»ºæ•°æ®åº“</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">CREATE USER <span class="nb">test</span> WITH PASSWORD <span class="s1">&#39;test&#39;</span><span class="p">;</span> 
</span></span><span class="line"><span class="cl">CREATE DATABASE dataware <span class="nv">owner</span><span class="o">=</span>test<span class="p">;</span> 
</span></span><span class="line"><span class="cl">GRANT ALL privileges ON DATABASE dataware TO test<span class="p">;</span>
</span></span></code></pre></div><h3 id="è‡ªåŠ¨åŒ–è¿è¡Œè„šæœ¬">è‡ªåŠ¨åŒ–è¿è¡Œè„šæœ¬</h3>
<p>ä»¥ä¸‹æ˜¯æŒ‰ç…§hiveæ—¶ï¼Œé…ç½®hiveå…ƒæ•°æ®çš„æ•°æ®åº“æ—¶çš„è‡ªåŠ¨åŒ–å®‰è£…è„šæœ¬ï¼Œä»…ä¾›å‚è€ƒï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="cp">#!/bin/bash
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="nb">readonly</span> <span class="nv">PROGNAME</span><span class="o">=</span><span class="k">$(</span>basename <span class="nv">$0</span><span class="k">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">readonly</span> <span class="nv">PROGDIR</span><span class="o">=</span><span class="k">$(</span>readlink -m <span class="k">$(</span>dirname <span class="nv">$0</span><span class="k">))</span>
</span></span><span class="line"><span class="cl"><span class="nb">readonly</span> <span class="nv">ARGS</span><span class="o">=</span><span class="s2">&#34;</span><span class="nv">$@</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="o">[</span> <span class="sb">`</span>id -u<span class="sb">`</span> -ne <span class="m">0</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">    <span class="nb">echo</span> <span class="s2">&#34;must run as root&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="nb">exit</span> <span class="m">1</span>
</span></span><span class="line"><span class="cl"><span class="k">fi</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">get_postgresql_major_version<span class="o">(){</span>
</span></span><span class="line"><span class="cl">    <span class="nb">local</span> <span class="nv">psql_output</span><span class="o">=</span><span class="sb">`</span>psql --version<span class="sb">`</span>
</span></span><span class="line"><span class="cl">    <span class="nb">local</span> <span class="nv">regex</span><span class="o">=</span><span class="s2">&#34;^psql \(PostgreSQL\) ([[:digit:]]+)\..*&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="o">[[</span> <span class="nv">$psql_output</span> <span class="o">=</span>~ <span class="nv">$regex</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">      <span class="nb">echo</span> <span class="si">${</span><span class="nv">BASH_REMATCH</span><span class="p">[1]</span><span class="si">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">fi</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">get_standard_conforming_strings<span class="o">(){</span>
</span></span><span class="line"><span class="cl">    <span class="nb">local</span> <span class="nv">psql_version</span><span class="o">=</span><span class="k">$(</span>get_postgresql_major_version<span class="k">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="o">[[</span> <span class="nv">$psql_version</span> -gt <span class="m">8</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">        <span class="nb">echo</span> <span class="s2">&#34;# This is needed to make Hive work with Postgresql 9.1 and above&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nb">echo</span> <span class="s2">&#34;# See OPSAPS-11795&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nb">echo</span> <span class="s2">&#34;standard_conforming_strings=off&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">fi</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">check_postgresql_installed<span class="o">(){</span>
</span></span><span class="line"><span class="cl">  <span class="nb">echo</span> -e <span class="s2">&#34;Install postgresql-server&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span> ! rpm -q postgresql-server &gt;/dev/null <span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">	    yum install postgresql-server postgresql-jdbc -y &gt;/dev/null 2&gt;<span class="p">&amp;</span><span class="m">1</span>
</span></span><span class="line"><span class="cl">        ln -s /usr/share/java/postgresql-jdbc.jar /usr/lib/hive/lib/postgresql-jdbc.jar
</span></span><span class="line"><span class="cl">		chkconfig postgresql on
</span></span><span class="line"><span class="cl">	<span class="k">fi</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	pkill -9 postgres
</span></span><span class="line"><span class="cl">	rm -rf /var/lib/pgsql/data /var/run/postgresql/.s.PGSQL.<span class="nv">$DB_PORT</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nb">echo</span> -e <span class="s2">&#34;Init postgresql database&#34;</span>
</span></span><span class="line"><span class="cl">	postgresql-setup initdb
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">configure_postgresql_conf<span class="o">(){</span>
</span></span><span class="line"><span class="cl">  <span class="nb">echo</span> -e <span class="s2">&#34;Configure postgresql conf&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	sed -i <span class="s2">&#34;s/#port = 5432/port = </span><span class="nv">$DB_PORT</span><span class="s2">/&#34;</span> <span class="nv">$CONF_FILE</span>
</span></span><span class="line"><span class="cl">	sed -i <span class="s2">&#34;s/max_connections = 100/max_connections = 600/&#34;</span> <span class="nv">$CONF_FILE</span>
</span></span><span class="line"><span class="cl">	sed -i <span class="s2">&#34;s/#listen_addresses = &#39;localhost&#39;/listen_addresses = &#39;*&#39;/&#34;</span> <span class="nv">$CONF_FILE</span>
</span></span><span class="line"><span class="cl">	sed -i <span class="s2">&#34;s/shared_buffers = 32MB/shared_buffers = 256MB/&#34;</span> <span class="nv">$CONF_FILE</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nb">local</span> <span class="nv">SCS</span><span class="o">=</span><span class="k">$(</span>get_standard_conforming_strings<span class="k">)</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$SCS</span><span class="s2">&#34;</span> !<span class="o">=</span> <span class="s2">&#34;&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">		<span class="nb">echo</span> -e <span class="nv">$SCS</span>
</span></span><span class="line"><span class="cl">		sed -i <span class="s2">&#34;s/#standard_conforming_strings = on/standard_conforming_strings = off/&#34;</span> <span class="nv">$CONF_FILE</span>
</span></span><span class="line"><span class="cl">	<span class="k">fi</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">enable_remote_connections<span class="o">(){</span>
</span></span><span class="line"><span class="cl">  <span class="nb">echo</span> -e <span class="s2">&#34;Enable remote connections&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	sed -i <span class="s2">&#34;s/127.0.0.1\/32/0.0.0.0\/0/&#34;</span> /var/lib/pgsql/data/pg_hba.conf
</span></span><span class="line"><span class="cl">	sed -i <span class="s2">&#34;s/ident/trust/&#34;</span> /var/lib/pgsql/data/pg_hba.conf
</span></span><span class="line"><span class="cl">  sed -i <span class="s2">&#34;s/peer/trust/&#34;</span> /var/lib/pgsql/data/pg_hba.conf
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">create_db<span class="o">(){</span>
</span></span><span class="line"><span class="cl">	<span class="nv">DB_NAME</span><span class="o">=</span><span class="nv">$1</span>
</span></span><span class="line"><span class="cl">	<span class="nv">DB_USER</span><span class="o">=</span><span class="nv">$2</span>
</span></span><span class="line"><span class="cl">	<span class="nv">DB_PASSWORD</span><span class="o">=</span><span class="nv">$3</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nb">echo</span> -e <span class="s2">&#34;Create database </span><span class="nv">$DB_NAME</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nb">cd</span> /var/lib/pgsql/data
</span></span><span class="line"><span class="cl">	su -c <span class="s2">&#34;/usr/bin/pg_ctl start -w -m fast -D /var/lib/pgsql/data&#34;</span> postgres
</span></span><span class="line"><span class="cl">	su -c <span class="s2">&#34;/usr/bin/psql --command \&#34;CREATE USER </span><span class="nv">$DB_USER</span><span class="s2"> WITH PASSWORD &#39;</span><span class="nv">$DB_PASSWORD</span><span class="s2">&#39;; \&#34; &#34;</span> postgres
</span></span><span class="line"><span class="cl">	su -c <span class="s2">&#34;/usr/bin/psql --command \&#34;CREATE DATABASE </span><span class="nv">$DB_NAME</span><span class="s2"> owner=</span><span class="nv">$DB_USER</span><span class="s2">;\&#34; &#34;</span> postgres
</span></span><span class="line"><span class="cl">	su -c <span class="s2">&#34;/usr/bin/psql --command \&#34;GRANT ALL privileges ON DATABASE </span><span class="nv">$DB_NAME</span><span class="s2"> TO </span><span class="nv">$DB_USER</span><span class="s2">;\&#34; &#34;</span> postgres
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">init_hive_metastore<span class="o">(){</span>
</span></span><span class="line"><span class="cl">	<span class="nv">DB_NAME</span><span class="o">=</span><span class="nv">$1</span>
</span></span><span class="line"><span class="cl">	<span class="nv">DB_USER</span><span class="o">=</span><span class="nv">$2</span>
</span></span><span class="line"><span class="cl">	<span class="nv">DB_FILE</span><span class="o">=</span><span class="nv">$3</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nb">echo</span> -e <span class="s2">&#34;Init hive metastore using </span><span class="nv">$DB_FILE</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">	su -c <span class="s2">&#34;/usr/bin/psql -U </span><span class="nv">$DB_USER</span><span class="s2"> -d </span><span class="nv">$DB_NAME</span><span class="s2"> -f </span><span class="nv">$DB_FILE</span><span class="s2">&#34;</span> postgres
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">manager_db<span class="o">(){</span>
</span></span><span class="line"><span class="cl">  <span class="nb">echo</span> -e <span class="s2">&#34;</span><span class="nv">$1</span><span class="s2"> postgres&#34;</span>
</span></span><span class="line"><span class="cl">	su -c <span class="s2">&#34;/usr/bin/pg_ctl </span><span class="nv">$1</span><span class="s2"> -w -m fast -D /var/lib/pgsql/data&#34;</span> postgres
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">readonly</span> <span class="nv">DB_HOST</span><span class="o">=</span><span class="k">$(</span>hostname -f<span class="k">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">readonly</span> <span class="nv">DB_PORT</span><span class="o">=</span><span class="si">${</span><span class="nv">DB_PORT</span><span class="k">:-</span><span class="nv">5432</span><span class="si">}</span>
</span></span><span class="line"><span class="cl"><span class="nb">readonly</span> <span class="nv">DB_HOSTPORT</span><span class="o">=</span><span class="s2">&#34;</span><span class="nv">$DB_HOST</span><span class="s2">:</span><span class="nv">$DB_PORT</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nv">CONF_FILE</span><span class="o">=</span><span class="s2">&#34;/var/lib/pgsql/data/postgresql.conf&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">check_postgresql_installed
</span></span><span class="line"><span class="cl">configure_postgresql_conf
</span></span><span class="line"><span class="cl">enable_remote_connections
</span></span><span class="line"><span class="cl">create_db metastore hive hive
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">manager_db restart
</span></span><span class="line"><span class="cl">init_hive_metastore metastore hive <span class="sb">`</span>ls /usr/lib/hive/scripts/metastore/upgrade/postgres/hive-schema-* <span class="p">|</span>tail -n 1<span class="sb">`</span>
</span></span></code></pre></div><h2 id="dockerå®‰è£…">dockerå®‰è£…</h2>
<p>ä½¿ç”¨docker-composeå®‰è£…ï¼Œpostgresql.yaml</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;3&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">services</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">pgsql</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">postgres:13-alpine</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">container_name</span><span class="p">:</span><span class="w"> </span><span class="l">pgsql</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="l">always</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">ports</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="m">5432</span><span class="p">:</span><span class="m">5432</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">environment</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="c">#- POSTGRES_DB: postgres</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">POSTGRES_USER=postgres</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">POSTGRES_PASSWORD=admin@pg!</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">volumes</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="c">#- ./sql/schema.postgresql.sql:/docker-entrypoint-initdb.d/schema.postgresql.sql:ro</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">/data/postgres:/var/lib/postgresql/data</span><span class="w">
</span></span></span></code></pre></div><p>è¿è¡Œå®¹å™¨ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker-compose -f postgresql.yaml up -d
</span></span></code></pre></div><p>è¿›å…¥å®¹å™¨å¹¶åˆ›å»ºæ•°æ®åº“å’Œç”¨æˆ·ï¼Œä¾‹å¦‚ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker <span class="nb">exec</span> -it pgsql psql -U postgres -c <span class="s2">&#34;CREATE USER cusdis WITH PASSWORD &#39;123456&#39;;&#34;</span>
</span></span><span class="line"><span class="cl">docker <span class="nb">exec</span> -it pgsql psql -U postgres -c <span class="s2">&#34;CREATE DATABASE cusdis owner=cusdis;&#34;</span>
</span></span><span class="line"><span class="cl">docker <span class="nb">exec</span> -it pgsql psql -U postgres -c <span class="s2">&#34;GRANT ALL privileges ON DATABASE cusdis TO cusdis;&#34;</span>
</span></span></code></pre></div>]]></content:encoded></item><item><title>MySqlå®‰è£…å’Œéƒ¨ç½²</title><link>https://blog.chensoul.com/posts/2022/08/19/mysql-install-deploy/</link><pubDate>Fri, 19 Aug 2022 17:03:40 +0800</pubDate><guid>https://blog.chensoul.com/posts/2022/08/19/mysql-install-deploy/</guid><description>yumå®‰è£… 1ã€å®‰è£… wget https://dev.mysql.com/get/mysql80-community-release-el7-1.noarch.rpm yum localinstall mysql80-community-release-el7-1.noarch.rpm æŸ¥çœ‹ä»“åº“ä¸­ mysql ç‰ˆæœ¬ï¼š yum repolist all | grep mysql yum repolist enabled | grep mysql ç¦ç”¨ mysql8 ä»“åº“ï¼Œå¯ç”¨ mysql5 ä»“åº“ï¼š yum install yum-utils -y yum-config-manager --disable mysql80-community yum-config-manager --enable mysql57-community å®‰è£… mysql æ•°æ®åº“å’Œå®¢æˆ·ç«¯ï¼š yum install</description><content:encoded><![CDATA[<h2 id="yumå®‰è£…">yumå®‰è£…</h2>
<h3 id="1å®‰è£…">1ã€å®‰è£…</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">wget https://dev.mysql.com/get/mysql80-community-release-el7-1.noarch.rpm
</span></span><span class="line"><span class="cl">yum localinstall mysql80-community-release-el7-1.noarch.rpm
</span></span></code></pre></div><p>æŸ¥çœ‹ä»“åº“ä¸­ mysql ç‰ˆæœ¬ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">yum repolist all <span class="p">|</span> grep mysql
</span></span><span class="line"><span class="cl">yum repolist enabled <span class="p">|</span> grep mysql
</span></span></code></pre></div><p>ç¦ç”¨ mysql8 ä»“åº“ï¼Œå¯ç”¨ mysql5 ä»“åº“ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">yum install yum-utils -y
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">yum-config-manager --disable mysql80-community
</span></span><span class="line"><span class="cl">yum-config-manager --enable mysql57-community
</span></span></code></pre></div><p>å®‰è£… mysql æ•°æ®åº“å’Œå®¢æˆ·ç«¯ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">yum install mysql-community-server -y  
</span></span></code></pre></div><p>å¯åŠ¨æ•°æ®åº“å¹¶è®¾ç½®å¼€æœºå¯åŠ¨ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">systemctl start mysqld
</span></span><span class="line"><span class="cl">systemctl <span class="nb">enable</span> mysqld
</span></span></code></pre></div><h3 id="2æŸ¥çœ‹å¯†ç ">2ã€æŸ¥çœ‹å¯†ç </h3>
<p>åœ¨ MySQL æœåŠ¡å™¨åˆå§‹å¯åŠ¨æ—¶ï¼Œå¦‚æœæœåŠ¡å™¨çš„æ•°æ®ç›®å½•ä¸ºç©ºï¼Œåˆ™ä¼šå‘ç”Ÿä»¥ä¸‹æƒ…å†µï¼š</p>
<ul>
<li>
<p>MySQL æœåŠ¡å™¨å·²åˆå§‹åŒ–ã€‚</p>
</li>
<li>
<p>åœ¨æ•°æ®ç›®å½•ä¸­ç”ŸæˆSSLè¯ä¹¦å’Œå¯†é’¥æ–‡ä»¶ã€‚</p>
</li>
<li>
<p>è¯¥<a href="https://dev.mysql.com/doc/refman/8.0/en/validate-password.html">validate_passwordæ’ä»¶</a>å®‰è£…å¹¶å¯ç”¨ã€‚</p>
</li>
<li>
<p>å°†åˆ›å»ºä¸€ä¸ªè¶…çº§ç”¨æˆ· å¸æˆ·<code>'root'@'localhost'</code>ã€‚å¹¶ä¼šè®¾ç½®è¶…çº§ç”¨æˆ·çš„å¯†ç ï¼Œå°†å…¶å­˜å‚¨åœ¨é”™è¯¯æ—¥å¿—æ–‡ä»¶ä¸­ã€‚è¦æ˜¾ç¤ºå®ƒï¼Œè¯·ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ grep <span class="s1">&#39;temporary password&#39;</span> /var/log/mysqld.log 
</span></span><span class="line"><span class="cl">2019-11-21T06:26:36.414908Z <span class="m">1</span> <span class="o">[</span>Note<span class="o">]</span> A temporary password is generated <span class="k">for</span> root@localhost: -*mN,epg4N<span class="o">)</span>F
</span></span></code></pre></div><h3 id="3å–æ¶ˆå¯†ç å¤æ‚åº¦">3ã€å–æ¶ˆå¯†ç å¤æ‚åº¦</h3>
<p>ç¼–è¾‘ /etc/my.cnfé…ç½®æ–‡ä»¶, åœ¨ [mysqld]é…ç½®å—å„¿ä¸­æ·»åŠ å¦‚ä¸‹å†…å®¹</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">plugin-load<span class="o">=</span>validate_password.so  
</span></span><span class="line"><span class="cl">validate-password<span class="o">=</span>OFF
</span></span></code></pre></div><p>ä¿å­˜é€€å‡ºåï¼Œé‡å¯æœåŠ¡ã€‚</p>
<h3 id="4ä¿®æ”¹å¯†ç ">4ã€ä¿®æ”¹å¯†ç </h3>
<p>é€šè¿‡ä¸Šé¢æ—¥å¿—ä¸­çš„ä¸´æ—¶å¯†ç ç™»å½•å¹¶ä¸ºè¶…çº§ç”¨æˆ·å¸æˆ·è®¾ç½®è‡ªå®šä¹‰å¯†ç ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">mysqladmin -u root -p<span class="s1">&#39;-*mN,epg4N)F&#39;</span> password <span class="s1">&#39;1q2w3e4r&#39;</span>
</span></span></code></pre></div><p>æ³¨æ„: MySQLçš„ validate_password æ’ä»¶é»˜è®¤å®‰è£…ã€‚è¿™å°†è¦æ±‚å¯†ç åŒ…å«è‡³å°‘ä¸€ä¸ªå¤§å†™å­—æ¯ï¼Œä¸€ä¸ªå°å†™å­—æ¯ï¼Œä¸€ä¸ªæ•°å­—å’Œä¸€ä¸ªç‰¹æ®Šå­—ç¬¦ï¼Œå¹¶ä¸”å¯†ç æ€»é•¿åº¦è‡³å°‘ä¸º8ä¸ªå­—ç¬¦ã€‚</p>
<p>å¦‚æœä¸è¡Œçš„è¯ï¼Œåˆ™å…ˆä¿®æ”¹é…ç½®æ–‡ä»¶è®¾ç½®ä¸ä½¿ç”¨å¯†ç ï¼Œç™»é™†è¿›å»ä¹‹åå†ä¿®æ”¹å¯†ç ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">mysql -u root -p 
</span></span><span class="line"><span class="cl">mysql&gt; update mysql.user <span class="nb">set</span> <span class="nv">authentication_string</span><span class="o">=</span>PASSWORD<span class="o">(</span><span class="s1">&#39;123456&#39;</span><span class="o">)</span> where <span class="nv">user</span><span class="o">=</span><span class="s1">&#39;root&#39;</span><span class="p">;</span>
</span></span></code></pre></div><p>é€€å‡ºmysqlï¼Œæ³¨é‡Šæ‰/etc/my.cnfä¸­çš„ skip-grant-tables=true è¿™ä¸€è¡Œåï¼Œä¿å­˜å¹¶é‡å¯mysqlï¼Œä½¿ç”¨æ–°å¯†ç ç™»å½•å³å¯</p>
<h3 id="5ä¸ä½¿ç”¨å¯†ç ">5ã€ä¸ä½¿ç”¨å¯†ç </h3>
<p>ä¿®æ”¹ /etc/my.cnf æ–‡ä»¶ï¼Œæ·»åŠ å¦‚ä¸‹å†…å®¹ï¼Œä¹‹åé‡å¯æœåŠ¡</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">skip-grant-tables<span class="o">=</span><span class="nb">true</span>
</span></span></code></pre></div><h3 id="6é…ç½®é»˜è®¤ç¼–ç ä¸º-utf8">6ã€é…ç½®é»˜è®¤ç¼–ç ä¸º utf8</h3>
<p>MySQL é»˜è®¤ä¸º latin1, ä¸€èˆ¬ä¿®æ”¹ä¸º UTF-8</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">shell&gt; vi /etc/my.cnf 
</span></span><span class="line"><span class="cl"><span class="o">[</span>mysqld<span class="o">]</span> 
</span></span><span class="line"><span class="cl"><span class="c1"># åœ¨myslqdä¸‹æ·»åŠ å¦‚ä¸‹é”®å€¼å¯¹ </span>
</span></span><span class="line"><span class="cl"><span class="nv">character_set_server</span><span class="o">=</span>utf8 
</span></span><span class="line"><span class="cl"><span class="nv">init_connect</span><span class="o">=</span><span class="s1">&#39;SET NAMES utf8&#39;</span>
</span></span></code></pre></div><p>é‡å¯ MySQL æœåŠ¡ï¼Œä½¿é…ç½®ç”Ÿæ•ˆ</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">systemctl restart mysqld
</span></span></code></pre></div><h3 id="7æŸ¥çœ‹å­—ç¬¦é›†">7ã€æŸ¥çœ‹å­—ç¬¦é›†</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="n">mysql</span><span class="o">&gt;</span><span class="w"> </span><span class="k">SHOW</span><span class="w"> </span><span class="n">VARIABLES</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="s1">&#39;character%&#39;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">+</span><span class="c1">--------------------------+----------------------------+
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w"> </span><span class="n">Variable_name</span><span class="w">            </span><span class="o">|</span><span class="w"> </span><span class="n">Value</span><span class="w">                      </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">+</span><span class="c1">--------------------------+----------------------------+
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">|</span><span class="w"> </span><span class="n">character_set_client</span><span class="w">     </span><span class="o">|</span><span class="w"> </span><span class="n">utf8</span><span class="w">                       </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w"> </span><span class="n">character_set_connection</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">utf8</span><span class="w">                       </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w"> </span><span class="n">character_set_database</span><span class="w">   </span><span class="o">|</span><span class="w"> </span><span class="n">utf8</span><span class="w">                       </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w"> </span><span class="n">character_set_filesystem</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nb">binary</span><span class="w">                     </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w"> </span><span class="n">character_set_results</span><span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="n">utf8</span><span class="w">                       </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w"> </span><span class="n">character_set_server</span><span class="w">     </span><span class="o">|</span><span class="w"> </span><span class="n">utf8</span><span class="w">                       </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w"> </span><span class="n">character_set_system</span><span class="w">     </span><span class="o">|</span><span class="w"> </span><span class="n">utf8</span><span class="w">                       </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">|</span><span class="w"> </span><span class="n">character_sets_dir</span><span class="w">       </span><span class="o">|</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="k">share</span><span class="o">/</span><span class="n">mysql</span><span class="o">/</span><span class="n">charsets</span><span class="o">/</span><span class="w"> </span><span class="o">|</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">+</span><span class="c1">--------------------------+----------------------------+
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="mi">8</span><span class="w"> </span><span class="k">rows</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="k">set</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">00</span><span class="w"> </span><span class="n">sec</span><span class="w">
</span></span></span></code></pre></div><h2 id="dockerå®‰è£…">dockerå®‰è£…</h2>
<h3 id="1ä¸‹è½½é•œåƒ">1ã€ä¸‹è½½é•œåƒ</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker pull mysql
</span></span></code></pre></div><h3 id="2è¿è¡Œå®¹å™¨">2ã€è¿è¡Œå®¹å™¨</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker run -d -p 3306:3306  <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  -v /data/docker/mysql/conf:/etc/mysql <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  -v /data/docker/mysql/logs:/var/log/mysql <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  -v /data/docker/mysql/data:/var/lib/mysql <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  -e <span class="nv">MYSQL_ROOT_PASSWORD</span><span class="o">=</span><span class="m">123456</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  --name mysql mysql
</span></span></code></pre></div><p>å‘½ä»¤å‚æ•°ï¼š</p>
<ul>
<li><code>-p 3306:3306</code>ï¼šå°†å®¹å™¨çš„3306ç«¯å£æ˜ å°„åˆ°ä¸»æœºçš„3306ç«¯å£</li>
<li><code>-v /data/docker/mysql/conf:/etc/mysql</code>ï¼šå°†ä¸»æœºå½“å‰ç›®å½•ä¸‹çš„ conf æŒ‚è½½åˆ°å®¹å™¨çš„ /etc/mysql</li>
<li><code>-v /data/docker/mysql/logs:/var/log/mysql</code>ï¼šå°†ä¸»æœºå½“å‰ç›®å½•ä¸‹çš„ logs ç›®å½•æŒ‚è½½åˆ°å®¹å™¨çš„ /var/log/mysql</li>
<li><code>-v /data/docker/mysql/data:/var/lib/mysql</code>ï¼šå°†ä¸»æœºå½“å‰ç›®å½•ä¸‹çš„ data ç›®å½•æŒ‚è½½åˆ°å®¹å™¨çš„ /var/lib/mysql</li>
<li><code>-e MYSQL_ROOT_PASSWORD=123456</code>ï¼šåˆå§‹åŒ–rootç”¨æˆ·çš„å¯†ç </li>
</ul>
<h3 id="3æŸ¥çœ‹å®¹å™¨å¯åŠ¨æƒ…å†µ">3ã€æŸ¥çœ‹å®¹å™¨å¯åŠ¨æƒ…å†µ</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker ps
</span></span></code></pre></div><h3 id="4é…ç½®é˜²ç«å¢™">4ã€é…ç½®é˜²ç«å¢™</h3>
<p>é˜²ç«å¢™å¼€å¯3306ç«¯å£</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">firewall-cmd --add-port<span class="o">=</span>3306/tcp
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">firewall-cmd --zone<span class="o">=</span>public --add-port<span class="o">=</span>3306/tcp --permanent
</span></span></code></pre></div><h3 id="5ä¿®æ”¹å­—ç¬¦é›†">5ã€ä¿®æ”¹å­—ç¬¦é›†</h3>
<p>/data/docker/mysql/confä¸‹åˆ›å»ºmy.cnf</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>client<span class="o">]</span>
</span></span><span class="line"><span class="cl">default-character-set<span class="o">=</span>utf8mb4
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>mysqld<span class="o">]</span>
</span></span><span class="line"><span class="cl">character-set-client-handshake <span class="o">=</span> FALSE
</span></span><span class="line"><span class="cl">character-set-server <span class="o">=</span> utf8mb4
</span></span><span class="line"><span class="cl">collation-server <span class="o">=</span> utf8mb4_unicode_ci
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>mysql<span class="o">]</span>
</span></span><span class="line"><span class="cl">default-character-set<span class="o">=</span>utf8mb4
</span></span></code></pre></div><p>é‡æ–°å¯åŠ¨å®¹å™¨</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker restart mysql
</span></span></code></pre></div><h3 id="6è®¿é—®æ•°æ®åº“">6ã€è®¿é—®æ•°æ®åº“</h3>
<p>è¿›å…¥å®¹å™¨ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker <span class="nb">exec</span> -it mysql bash
</span></span></code></pre></div><p>åœ¨å®¿ä¸»æœºä¸Šç™»é™†mysqlï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1">#ç™»å½•mysql</span>
</span></span><span class="line"><span class="cl">mysql -h192.168.56.100 -p3306 -uroot -p123456
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#æ·»åŠ è¿œç¨‹ç™»å½•ç”¨æˆ·</span>
</span></span><span class="line"><span class="cl">CREATE USER <span class="s1">&#39;test&#39;</span>@<span class="s1">&#39;%&#39;</span> IDENTIFIED WITH mysql_native_password BY <span class="s1">&#39;123456&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">GRANT ALL PRIVILEGES ON *.* TO <span class="s1">&#39;test&#39;</span>@<span class="s1">&#39;%&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#æŸ¥çœ‹ç¼–ç </span>
</span></span><span class="line"><span class="cl">showvariables like <span class="s2">&#34;%char%&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">flush privileges<span class="p">;</span>
</span></span></code></pre></div><h2 id="docker-composeå®‰è£…">docker-composeå®‰è£…</h2>
<p>docker-compose.ymlé…ç½®æ–‡ä»¶å¦‚ä¸‹</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yml" data-lang="yml"><span class="line"><span class="cl"><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;3.1&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">services</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">db</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">mysql</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">container_name</span><span class="p">:</span><span class="w"> </span><span class="l">mysql </span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="l">always</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">environment</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">MYSQL_ROOT_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="m">123456</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>--<span class="l">default-authentication-plugin=mysql_native_password</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>--<span class="l">character-set-server=utf8mb4</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>--<span class="l">collation-server=utf8mb4_general_ci</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>--<span class="l">explicit_defaults_for_timestamp=true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>--<span class="l">lower_case_table_names=1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">ports</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="m">3306</span><span class="p">:</span><span class="m">3306</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">volumes</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">/data/docker/mysql/conf:/etc/mysql</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">/data/docker/mysql/logs:/var/log/mysql </span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">/data/docker/mysql/data:/var/lib/mysql</span><span class="w">
</span></span></span></code></pre></div>]]></content:encoded></item><item><title>åšå®¢ä¸­å¦‚ä½•ä½¿ç”¨å›¾åºŠæœåŠ¡</title><link>https://blog.chensoul.com/posts/2022/08/19/using-images-in-blog/</link><pubDate>Fri, 19 Aug 2022 12:15:54 +0800</pubDate><guid>https://blog.chensoul.com/posts/2022/08/19/using-images-in-blog/</guid><description>æœ€è¿‘ç¼–å†™æ–‡æ¡£æˆ–è€…å†™åšå®¢ï¼Œå–œæ¬¢ç”¨ Typora ç¼–è¾‘å™¨é€šè¿‡ Markdown è¯­æ³•å®Œæˆç¼–å†™æ‰€æœ‰å†…å®¹ã€‚ä¸ºæ­¤ï¼Œè¿˜ä»˜è´¹è´­ä¹°äº†è®¸å¯è¯ã€‚ å–œæ¬¢ Typora çš„ç†ç”±ï¼š æ‰€è§å³æ‰€å¾—çš„ç¼–è¾‘ï¼ŒMarkdown</description><content:encoded><![CDATA[<p>æœ€è¿‘ç¼–å†™æ–‡æ¡£æˆ–è€…å†™åšå®¢ï¼Œå–œæ¬¢ç”¨ Typora ç¼–è¾‘å™¨é€šè¿‡ Markdown è¯­æ³•å®Œæˆç¼–å†™æ‰€æœ‰å†…å®¹ã€‚ä¸ºæ­¤ï¼Œè¿˜ä»˜è´¹è´­ä¹°äº†è®¸å¯è¯ã€‚</p>
<p><img src="https://chensoul.oss-cn-hangzhou.aliyuncs.com/images/my-typora-license.png" alt="my-typora-license"></p>
<p>å–œæ¬¢ Typora çš„ç†ç”±ï¼š</p>
<ul>
<li>
<p>æ‰€è§å³æ‰€å¾—çš„ç¼–è¾‘ï¼ŒMarkdownçš„è¯­æ³•éƒ½æ”¯æŒå¿«æ·é”®æ“ä½œï¼Œéå¸¸æ–¹ä¾¿</p>
</li>
<li>
<p>å¯ä»¥è‡ªå®šä¹‰ä¸»é¢˜çš„ CSSï¼ŒåŒ…æ‹¬æ–‡ç« å†…å®¹å°±å¯ä»¥ç²˜è´´åˆ°å…¬ä¼—å·é‡Œ</p>
</li>
<li>
<p>ä¸Šä¼ å›¾ç‰‡ï¼Œæ”¯æŒå›¾åºŠæœåŠ¡ã€‚å¯ä»¥å°†å›¾ç‰‡ä¸Šä¼ åˆ°æŒ‡å®šçš„å›¾åºŠï¼Œå‰ææ˜¯éœ€è¦å…ˆå®‰è£…ä¸€ä¸ªå®¢æˆ·ç«¯ï¼Œè¿™é‡Œæˆ‘ä½¿ç”¨çš„æ˜¯ PicGoã€‚ç„¶åï¼ŒPicGoæ”¯æŒå¸¸è§çš„ä¸€äº›å›¾åºŠæœåŠ¡ã€‚</p>
<p><img src="https://chensoul.oss-cn-hangzhou.aliyuncs.com/images/picgo-setting-image-server.png" alt="picgo-setting-image-server"></p>
</li>
<li>
<p>æ”¯æŒå¯¼å‡º</p>
</li>
</ul>
<h2 id="typora-å›¾ç‰‡å¤åˆ¶åˆ°æœ¬åœ°">Typora å›¾ç‰‡å¤åˆ¶åˆ°æœ¬åœ°</h2>
<p>æ¥ä¸‹æ¥ï¼ŒèŠèŠ Typora çš„å›¾ç‰‡ä¸Šä¼ è®¾ç½®ï¼š</p>
<p><img src="https://chensoul.oss-cn-hangzhou.aliyuncs.com/images/typora-setting-image.png" alt="typora-setting-image"></p>
<p>å½“ä½ æ’å…¥å›¾ç‰‡æ—¶ï¼Œä½ å¯ä»¥åˆ†æƒ…å†µå¯¹å›¾ç‰‡è¿›è¡Œè®¾ç½®ã€‚æ¯”å¦‚ï¼š</p>
<p>1ã€å¯¹æœ¬åœ°ä½ç½®çš„å›¾ç‰‡ï¼Œå¯ä»¥è®¾ç½®ä¸€ä¸ªä¸Šä¼ è§„åˆ™ï¼šå¤åˆ¶åˆ°æŒ‡å®šè·¯å¾„æˆ–è€…æ˜¯å½“å‰è·¯å¾„ä¸‹çš„ä¸€ä¸ªæ–‡ä»¶å¤¹ã€ä¸Šä¼ å›¾ç‰‡ã€‚</p>
<ul>
<li>å¦‚æœæ˜¯ç¼–å†™ä¸€ä¸ªæ–‡æ¡£ï¼Œæˆ‘ä»¬å°±è®¾ç½®æŠŠå›¾ç‰‡ä¿å­˜åˆ°æœ¬åœ°çš„ assets æ–‡ä»¶å¤¹å†…ï¼Œè¿™æ ·æ–¹ä¾¿ç®¡ç†ã€‚</li>
<li>å¦‚æœæ˜¯ç¼–å†™åšå®¢ï¼Œå›¾ç‰‡ä¸€èˆ¬æ˜¯é›†ä¸­ç®¡ç†çš„ï¼Œæˆ‘ä»¬å¯ä»¥è®¾ç½®å¤åˆ¶åˆ°ä¸€ä¸ªæŒ‡å®šè·¯å¾„</li>
</ul>
<p>2ã€ç±»ä¼¼çš„ï¼Œå¯¹ç½‘ç»œä½ç½®çš„å›¾ç‰‡ä¹Ÿå¯ä»¥ä½¿ç”¨ä¸Šé¢çš„è§„åˆ™ã€‚</p>
<p>æ³¨æ„ï¼Œå¦‚æœå°†å›¾ç‰‡ä¿å­˜åˆ°æœ¬åœ°ç›®å½•ï¼Œåœ¨æ–‡ç« ä¸­å¼•ç”¨å›¾ç‰‡æ˜¯ä½¿ç”¨çš„ç›¸å¯¹æˆ–è€…ç»å¯¹è·¯å¾„ã€‚å¦‚æœåªæ˜¯åœ¨æœ¬åœ°æŸ¥çœ‹ï¼Œæ˜¯å¯ä»¥é¢„è§ˆå›¾ç‰‡çš„ã€‚ä½†æ˜¯ï¼Œå¦‚æœå°†åšå®¢ä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼Œåˆ™å› ä¸ºè·¯å¾„é—®é¢˜å¯èƒ½ä¼šå‡ºç°æ— æ³•é¢„è§ˆå›¾ç‰‡çš„æƒ…å†µã€‚</p>
<p>æ‰€ä»¥ï¼Œè¿™ç§æƒ…å†µæˆ‘ä»¬éœ€è¦åšä¸€äº›ä¿®æ”¹ã€‚é€šå¸¸æˆ‘ä¼šè®¾ç½®å›¾ç‰‡å¤åˆ¶åˆ°åšå®¢çš„é™æ€é¡µé¢ç›®å½•ä¸‹é¢ï¼Œæ¯”å¦‚ï¼Œæˆ‘ç°åœ¨ä½¿ç”¨çš„æ˜¯ Hugo æ„å»ºé™æ€åšå®¢ï¼Œä¼šå°†å›¾ç‰‡ä¿å­˜åˆ° static/img ç›®å½•ä¸‹ï¼Œå¹¶ä¸”ï¼Œè¿˜éœ€è¦ä¿®æ”¹å›¾ç‰‡çš„ markdown å¼•ç”¨è·¯å¾„ä¸º <code>/images/image-20220819124422239.png</code> ï¼Œä»¥è¡¨ç¤ºç»å¯¹è·¯å¾„æŸ¥æ‰¾å›¾ç‰‡ï¼Œåœ¨åšå®¢æœåŠ¡å™¨ä¸Šå°±æ˜¯ç›¸å¯¹æ ¹åŸŸåç›®å½•å» img è·¯å¾„ä¸‹æŸ¥æ‰¾å›¾ç‰‡ã€‚å¾…hugo ç¼–è¯‘å®Œæˆä¸Šä¼ é™æ€æ–‡ä»¶åˆ°æœåŠ¡å™¨ä¹‹åï¼Œå¯ä»¥é€šè¿‡ <a href="https://blog.chensoul.com/images/">https://blog.chensoul.com/images/</a> åŠ ä¸Šå›¾ç‰‡åç§°çš„æ–¹å¼è®¿é—®åˆ°å›¾ç‰‡ã€‚</p>
<p>ä½†æ˜¯ï¼Œæ˜¾ç„¶ï¼Œè¿™æ—¶å€™åœ¨ Typora æ˜¯æ— æ³•é¢„è§ˆå›¾ç‰‡çš„ï¼Œå› ä¸ºåœ¨æœ¬åœ°æŸ¥æ‰¾ä¸åˆ°è¿™ä¸ªç»å¯¹è·¯å¾„åœ°å€ã€‚è¿™æ—¶å€™å¯ä»¥åœ¨ Typora é‡Œé¢è®¾ç½®ä¸€ä¸ªç»å¯¹è·¯å¾„ï¼Œæ“ä½œæ–¹æ³•æ˜¯ï¼Œåœ¨ æ˜¾ç¤º -&gt; å›¾ç‰‡ -&gt; å›¾åƒ -&gt; è®¾ç½®å›¾ç‰‡æ ¹ç›®å½• é‡Œè¿›è¡Œè®¾ç½®ã€‚</p>
<p>è®¾ç½®å®Œæˆä¹‹åï¼Œåœ¨å½“å‰æ–‡ä»¶çš„ md æ–‡ä»¶çš„é¡¶éƒ¨å…ƒæ•°æ®ä»£ç é‡Œä¼šå¤šä¸€è¡Œä»£ç ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;åšå®¢ä¸­å¦‚ä½•ä½¿ç”¨å›¾åºŠæœåŠ¡&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">date</span><span class="p">:</span><span class="w"> </span><span class="ld">2022-08-19T12:15:54</span><span class="m">+08</span><span class="p">:</span><span class="m">00</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">slug</span><span class="p">:</span><span class="w"> </span><span class="l">using-images-in-blog</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">categories</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="l">æ—¥å¿—]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">tags</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="l">hugo]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">draft</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">typora-root-url</span><span class="p">:</span><span class="w"> </span><span class="l">../../static</span><span class="w">
</span></span></span></code></pre></div><p>è¿™æ ·åšå®¢é‡Œæ‰€æœ‰çš„å›¾ç‰‡éƒ½ä¼šä¿å­˜çš„åšå®¢æœåŠ¡å™¨ï¼Œå¦‚æœåšå®¢è®¿é—®é‡å¢å¤§ï¼Œåˆ™å›¾ç‰‡åŠ è½½æ—¶é—´ä¼šå˜æ…¢ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œéœ€è¦å°†å›¾ç‰‡è¿›è¡Œå‹ç¼©ï¼Œå¹¶ç»™åšå®¢è®¾ç½® CDN åŠ é€Ÿã€‚</p>
<h2 id="typora-å›¾ç‰‡ä¸Šä¼ åˆ°ç½‘ç»œ">Typora å›¾ç‰‡ä¸Šä¼ åˆ°ç½‘ç»œ</h2>
<p>å°†å›¾ç‰‡ä¿å­˜åˆ°æœ¬åœ°ï¼Œå¾…åšå®¢é™æ€é¡µé¢éƒ¨ç½²åˆ°æœåŠ¡å™¨ä¸Šä¹‹åï¼Œå¯ä»¥å®ç°æ­£å¸¸é¢„è§ˆæƒ…å†µã€‚ä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬æƒ³æŠŠ md æ–‡ä»¶æ‰“åŒ…ä¸Šä¼ åˆ°ä¸€äº›äº‘ç¬”è®°ï¼Œæ¯”å¦‚ï¼šè¯­é›€ï¼Œä½ ä¼šå‘ç°ä¸Šä¼ ä¹‹åä¼šå‡ºç°å›¾ç‰‡æ— æ³•é¢„è§ˆçš„æƒ…å†µã€‚</p>
<p>è¿™æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦å°†å›¾ç‰‡ä¸Šä¼ åˆ°ç½‘ç»œã€‚é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å®‰è£… PicGoï¼Œç„¶åè®¾ç½®å›¾åºŠæœåŠ¡ï¼Œè¿™é‡Œæˆ‘ä½¿ç”¨çš„æ˜¯ github ä½œä¸ºå›¾åºŠæ¥ä¿å­˜å›¾ç‰‡ï¼Œå¹¶ä½¿ç”¨  <a href="https://www.jsdelivr.com">jsDelivr</a> çš„ CDN æœåŠ¡è¿›è¡ŒåŠ é€Ÿè®¿é—®ã€‚</p>
<p>å¦‚ä½•åˆ©ç”¨ Github æ­å»ºè‡ªå·±çš„å…è´¹å›¾åºŠï¼Ÿå¯ä»¥å‚è€ƒè¿™ç¯‡ <a href="https://zhuanlan.zhihu.com/p/353775844">æ–‡ç« </a>ã€‚è¿™é‡Œï¼Œè®°å½•ä¸€ä¸‹æˆ‘çš„æ“ä½œæ­¥éª¤ã€‚</p>
<p>1ã€ä½¿ç”¨åšå®¢çš„<a href="https://github.com/chensoul/blog.chensoul.com">æ‰˜ç®¡ä»“åº“</a> çš„ static/img ç›®å½•æ¥ä¿å­˜å›¾ç‰‡ï¼Œè¿™æ ·æ–¹ä¾¿å›¾ç‰‡çš„ç®¡ç†ï¼ˆæ¯”å¦‚ï¼šå‹ç¼©ã€é‡å‘½åï¼Œåˆ é™¤æ— ç”¨å›¾ç‰‡ï¼‰ï¼Œå¦‚æœå›¾åºŠæœåŠ¡ä¸å¯ç”¨äº†ï¼Œæ‰€æœ‰åšå®¢å›¾ç‰‡è¿˜æœ‰ä¸€ä¸ªå¤‡ä»½ï¼Œåªéœ€è¦ä¿®æ”¹åšå®¢å†…å›¾ç‰‡çš„å¼•ç”¨åœ°å€ã€‚å‰ææ˜¯éœ€è¦å°†ä»“åº“è®¾ç½®ä¸º publicã€‚</p>
<p>2ã€åœ¨ github è®¾ç½®é‡Œé¢åˆ›å»ºä¸€ä¸ª Tokenã€‚ä»¥æ­¤æ‰“å¼€ <code>Settings -&gt; Developer settings -&gt; Personal access tokens</code>ï¼Œæœ€åç‚¹å‡» <code>generate new token</code></p>
<p>3ã€åœ¨ PicGo é‡Œè®¾ç½® github å›¾åºŠï¼š</p>
<ul>
<li>
<p>è®¾å®šä»“åº“åï¼šchensoul/blog.chensoul.com</p>
</li>
<li>
<p>è®¾å®šåˆ†æ”¯ï¼šmain</p>
</li>
<li>
<p>è®¾å®š Tokenï¼šXXXXXXXXXXXXXXXXX</p>
</li>
<li>
<p>æŒ‡å®šå­˜å‚¨è·¯å¾„ï¼šstatic/images/</p>
</li>
<li>
<p>è®¾ç½®è‡ªå®šä¹‰åŸŸåï¼šhttps://cdn.jsdelivr.net/gh/chensoul/blog.chensoul.com</p>
</li>
</ul>
<p>4ã€éœ€è¦ä¿®æ”¹åšå®¢æ–‡ç« å†…å¼•ç”¨çš„å›¾ç‰‡åœ°å€ï¼Œå°† /images/ æ›¿æ¢ä¸º <a href="https://cdn.jsdelivr.net/gh/chensoul/blog.chensoul.com/images/">https://cdn.jsdelivr.net/gh/chensoul/blog.chensoul.com/images/</a> ï¼Œå¯ä»¥ä½¿ç”¨<a href="https://dvel.me/posts/macos-replace-contents-multiple-files/">è„šæœ¬æ‰¹é‡æ›¿æ¢</a>ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">grep -lr --null <span class="s1">&#39;](\/img\/&#39;</span> <span class="p">|</span> xargs -0 sed -i <span class="s1">&#39;&#39;</span> <span class="s1">&#39;s/](\/img\//](https:\/\/cdn.jsdelivr.net\/gh\/chensoul\/blog.chensoul.com\/static\/img\//g&#39;</span>
</span></span></code></pre></div><blockquote>
<p>å‚æ•°è¯´æ˜ï¼š</p>
<ul>
<li>grep
<ul>
<li><code>-i, --ignore-case</code> æŸ¥æ‰¾æ–‡ä»¶æ—¶ä¸åŒºåˆ†å¤§å°å†™</li>
<li><code>-l, --files-with-matches</code> è¿”å›æ–‡ä»¶å</li>
<li><code>-R, -r, --recursive</code> é€’å½’æœç´¢å­ç›®å½•</li>
</ul>
</li>
<li>sed
<ul>
<li><code>-i</code> é»˜è®¤ <code>sed</code> ä¼šæ‰“å°åˆ°æ ‡å‡†è¾“å‡ºï¼Œä½¿ç”¨ <code>-i</code> å°†ç›´æ¥åœ¨æ–‡ä»¶å†…ç¼–è¾‘æ›¿æ¢</li>
<li><code>s</code> æ›¿æ¢</li>
<li><code>g</code> å…¨å±€æ›¿æ¢æ ‡å¿—</li>
<li><code>I</code> å¤§å°å†™ä¸æ•æ„Ÿæ ‡å¿—</li>
</ul>
</li>
</ul>
</blockquote>
<p>åè¿‡æ¥ï¼ŒæŸ¥è¯¢ <a href="https://cdn.jsdelivr.net/gh/chensoul/blog.chensoul.com/static/images/">https://cdn.jsdelivr.net/gh/chensoul/blog.chensoul.com/static/images/</a> ä¸‹çš„å›¾ç‰‡åœ°å€æ›¿æ¢ <code>/img</code></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">grep -lr --null <span class="s1">&#39;](https://cdn.jsdelivr.net/gh/chensoul/blog.chensoul.com/static/images/&#39;</span> <span class="p">|</span> xargs -0 sed -i <span class="s1">&#39;&#39;</span> <span class="s1">&#39;s/](https:\/\/cdn.jsdelivr.net\/gh\/chensoul\/blog.chensoul.com\/static\/img\//](\/img\//g&#39;</span>
</span></span></code></pre></div><p>å¦å¤–ï¼Œåœ¨åšå®¢ç¼–è¯‘éƒ¨ç½²çš„æµç¨‹ä¹‹ä¸­ï¼Œå¯ä»¥å®šåˆ¶åŒ–ä¸€äº›æ­¥éª¤å°†åšå®¢åŒæ­¥å‘å¸ƒåˆ°å…¶ä»–ç³»ç»Ÿã€‚å½“ç„¶ï¼Œåœ¨å‘å¸ƒä¹‹å‰ï¼Œä¹Ÿå¯ä»¥å…ˆå°†æœ¬åœ°å›¾ç‰‡çš„ url æ›¿æ¢æˆå›¾åºŠåœ°å€çš„ urlã€‚ç­‰åç»­å®ç°äº†ï¼Œå†å‘å¸ƒä¸€ç¯‡æ–‡ç« ã€‚</p>
<p>å¦‚æœ github æˆ–è€… jsdelivr æœåŠ¡ä¸ç¨³å®šï¼Œåˆ™éœ€è¦è€ƒè™‘ä½¿ç”¨å…¶ä»–å›¾åºŠäº†ã€‚</p>
<blockquote>
<p>å¯ä»¥é€šè¿‡è¿™ä¸ªåœ°å€ <a href="https://tcp.ping.pe/">https://tcp.ping.pe/</a> æ¥æ£€æµ‹ IP æˆ–è€…åŸŸåæ˜¯å¦å¯ä»¥è®¿é—®</p>
</blockquote>
]]></content:encoded></item><item><title>Dorisé›†ç¾¤å¼¹æ€§æ‰©ç¼©å®¹</title><link>https://blog.chensoul.com/posts/2022/08/18/doris-cluster-elastic-expansion/</link><pubDate>Thu, 18 Aug 2022 11:26:27 +0800</pubDate><guid>https://blog.chensoul.com/posts/2022/08/18/doris-cluster-elastic-expansion/</guid><description>Doris å¯ä»¥å¾ˆæ–¹ä¾¿çš„æ‰©å®¹å’Œç¼©å®¹ FEã€BEã€Broker å®ä¾‹ï¼Œæœ¬æ–‡ä¸»è¦æ˜¯å¯¹æ­¤åšä¸€äº›æµ‹è¯•ï¼Œè®°å½•ç¬”è®°ã€‚ é›†ç¾¤è¯´æ˜ åœ¨æµ‹è¯•ç¯å¢ƒå®‰è£…å’Œéƒ¨ç½²äº†ä¸‰ä¸ªèŠ‚ç‚¹çš„é›†ç¾¤ï¼Œæ¯ä¸ª</description><content:encoded><![CDATA[<p>Doris å¯ä»¥å¾ˆæ–¹ä¾¿çš„æ‰©å®¹å’Œç¼©å®¹ FEã€BEã€Broker å®ä¾‹ï¼Œæœ¬æ–‡ä¸»è¦æ˜¯å¯¹æ­¤åšä¸€äº›æµ‹è¯•ï¼Œè®°å½•ç¬”è®°ã€‚</p>
<h2 id="é›†ç¾¤è¯´æ˜">é›†ç¾¤è¯´æ˜</h2>
<p>åœ¨æµ‹è¯•ç¯å¢ƒå®‰è£…å’Œéƒ¨ç½²äº†ä¸‰ä¸ªèŠ‚ç‚¹çš„é›†ç¾¤ï¼Œæ¯ä¸ªèŠ‚ç‚¹æ··åˆéƒ¨ç½²äº† FE å’Œ BEï¼š</p>
<ul>
<li>192.168.1.107ï¼šéƒ¨ç½²äº† FEã€BE</li>
<li>192.168.1.108ï¼šéƒ¨ç½²äº† FEã€BE</li>
<li>192.168.1.109ï¼šéƒ¨ç½²äº† FEã€BE</li>
</ul>
<p>åœ¨æ“ä½œé›†ç¾¤ä¹‹å‰ï¼Œæœ‰å¿…è¦äº†è§£ doris çš„æ¶æ„ï¼š</p>
<p><img src="https://chensoul.oss-cn-hangzhou.aliyuncs.com/images/doris-overview.png" alt="dorisæ¶æ„"></p>
<p>Doris æœ‰ä¸¤ç§è¿›ç¨‹ï¼š</p>
<ul>
<li>FEï¼šä¸»è¦è´Ÿè´£ç”¨æˆ·è¯·æ±‚çš„æ¥å…¥ã€æŸ¥è¯¢è§£æè§„åˆ’ã€å…ƒæ•°æ®çš„ç®¡ç†ã€èŠ‚ç‚¹ç®¡ç†ç›¸å…³å·¥ä½œã€‚FE èŠ‚ç‚¹ä¸ªæ•°è‡³å°‘ä¸ºä¸º1ï¼Œæœ€å¥½å¿…é¡»ä¸ºå¥‡æ•°ï¼Œå› ä¸ºå¤šä¸ª FE éœ€è¦è¿›è¡Œé€‰ä¸¾ã€‚æ ¹æ®é€‰ä¸¾å‡ºæ¥çš„ç»“æœï¼Œåˆ†ä¸ºä¸¤ç§è§’è‰²ï¼š
<ul>
<li>Followerï¼šå¯ä»¥ä¸ºä¸€ä¸ªæˆ–è€…å¤šä¸ªã€‚å¦‚æœåªæœ‰ä¸€ä¸ªï¼Œåˆ™å½“å‰ Follower é»˜è®¤ä¸º Masterã€‚å¦‚æœå­˜åœ¨å¤šä¸ª FEï¼Œåˆ™è¿›è¡Œé€‰ä¸¾ä¹‹åï¼Œä¼šé€‰å‡ºä¸€ä¸ª FE ä½œä¸º Masterã€‚åŒä¸€ä¸ªæ—¶é—´ï¼Œæœ‰ä¸”åªæœ‰ä¸€ä¸ª Masterã€‚å½“ Master FE å®•æ‰ä¹‹åï¼Œä¼šé‡æ–°é€‰ä¸¾å‡ºä¸‹ä¸€ä¸ª Masterã€‚æ‰€ä»¥ï¼Œä¸ºäº†ä¿è¯ FE çš„é«˜å¯ç”¨ï¼Œä¸€èˆ¬å»ºè®® FE éƒ¨ç½²å¤šä¸ªèŠ‚ç‚¹ï¼ˆå¤§äºç­‰äº3ï¼‰ã€‚</li>
<li>Observerï¼šå¯ä»¥ä¸º0ä¸ªæˆ–è€…å¤šä¸ªã€‚Observer çš„å­˜åœ¨æ˜¯ä¸ºäº†ä¿è¯è¯»é«˜å¯ç”¨ã€‚</li>
</ul>
</li>
<li>BEï¼šä¸»è¦è´Ÿè´£æ•°æ®å­˜å‚¨ã€æŸ¥è¯¢è®¡åˆ’çš„æ‰§è¡Œã€‚</li>
</ul>
<h2 id="é›†ç¾¤çŠ¶æ€">é›†ç¾¤çŠ¶æ€</h2>
<p>é€šè¿‡ mysql å®¢æˆ·ç«¯è¿æ¥ FE masterï¼ŒæŸ¥è¯¢å½“å‰é›†ç¾¤çŠ¶æ€ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">mysql -h 192.168.1.107 -P <span class="m">9030</span> -uroot
</span></span></code></pre></div><p>æŸ¥è¯¢ BE çŠ¶æ€ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="n">mysql</span><span class="o">&gt;</span><span class="w"> </span><span class="k">SHOW</span><span class="w"> </span><span class="n">PROC</span><span class="w"> </span><span class="s1">&#39;/backends&#39;</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><p>ç»“æœå¦‚ä¸‹ï¼š</p>
<p><img src="https://chensoul.oss-cn-hangzhou.aliyuncs.com/images/doris-be-status.png.png" alt="doris-be-status"></p>
<p>æŸ¥è¯¢ FE çŠ¶æ€ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="n">mysql</span><span class="o">&gt;</span><span class="w"> </span><span class="k">SHOW</span><span class="w"> </span><span class="n">PROC</span><span class="w"> </span><span class="s1">&#39;/frontends&#39;</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><p>ç»“æœå¦‚ä¸‹ï¼š</p>
<p><img src="https://chensoul.oss-cn-hangzhou.aliyuncs.com/images/doris-fe-status.png" alt="doris-fe-status"></p>
<p>ä»ä¸Šé¢å¯ä»¥çœ‹åˆ°ï¼š</p>
<ul>
<li>IP</li>
<li>HostNameï¼šä¸»æœºåç§°</li>
<li>Roleï¼šè§’è‰²ï¼Œæ‰€æœ‰èŠ‚ç‚¹éƒ½æ˜¯ Follower è§’è‰²</li>
<li>IsMasterï¼š192.168.1.107 èŠ‚ç‚¹ä¸º Master Follower</li>
<li>Joinï¼šä¸‰ä¸ª FE æ˜¯å¦åŠ å…¥äº†é›†ç¾¤</li>
</ul>
<p>ä¹Ÿå¯ä»¥é€šè¿‡ http://192.168.1.107:8030/System?path=//frontends å’Œ http://192.168.1.107:8030/System?path=//backends æ¥æŸ¥çœ‹ FE å’Œ BE çŠ¶æ€ã€‚</p>
<h2 id="fe-æ‰©å®¹å’Œç¼©å®¹">FE æ‰©å®¹å’Œç¼©å®¹</h2>
<p>FE èŠ‚ç‚¹çš„æ‰©å®¹å’Œç¼©å®¹è¿‡ç¨‹ï¼Œä¸å½±å“å½“å‰ç³»ç»Ÿè¿è¡Œã€‚</p>
<p>FE åˆ†ä¸º Follower å’Œ Observer ä¸¤ç§è§’è‰²ã€‚ é»˜è®¤ä¸€ä¸ªé›†ç¾¤ï¼Œå¯ä»¥æœ‰å¤šä¸ª Follower å’Œ Observerã€‚å…¶ä¸­å¤šä¸ª Follower ç»„æˆä¸€ä¸ª Paxos é€‰æ‹©ç»„ï¼Œé›†ç¾¤å¯åŠ¨æ—¶ï¼ŒFollower ä¼šé€‰ä¸¾å‡ºä¸€ä¸ª Masterã€‚å¦‚æœ Master å®•æœºï¼Œåˆ™å‰©ä¸‹çš„ Follower ä¼šè‡ªåŠ¨é€‰å‡ºæ–°çš„ Masterï¼Œä¿è¯å†™å…¥é«˜å¯ç”¨ã€‚Observer åŒæ­¥ Master çš„æ•°æ®ï¼Œä½†æ˜¯ä¸å‚åŠ é€‰ä¸¾ã€‚å¦‚æœåªéƒ¨ç½²ä¸€ä¸ª FEï¼Œåˆ™ FE é»˜è®¤å°±æ˜¯ Masterã€‚</p>
<p>ç¬¬ä¸€ä¸ªå¯åŠ¨çš„ FE è‡ªåŠ¨æˆä¸º Masterã€‚åœ¨æ­¤åŸºç¡€ä¸Šï¼Œå¯ä»¥æ·»åŠ è‹¥å¹² Follower å’Œ Observerã€‚</p>
<h4 id="å¢åŠ -fe-èŠ‚ç‚¹">å¢åŠ  FE èŠ‚ç‚¹</h4>
<p><strong>1ã€é…ç½®åŠå¯åŠ¨ Follower æˆ– Observer</strong></p>
<p>Follower å’Œ Observer çš„é…ç½®æ˜¯ç›¸åŒçš„ï¼Œéƒ½æ˜¯é€šè¿‡  fe/conf/fe.conf è¿›è¡Œé…ç½®ã€‚</p>
<p>åœ¨æ–°æ·»åŠ çš„èŠ‚ç‚¹ä¸Šå¯åŠ¨ FEï¼Œä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">fe/bin/start_fe.sh --helper leader_fe_host:edit_log_port --daemon
</span></span></code></pre></div><blockquote>
<p>è¯´æ˜ï¼š</p>
<p>å…¶ä¸­ leader_fe_host ä¸º Leader æ‰€åœ¨èŠ‚ç‚¹ ipï¼Œedit_log_port åœ¨ Leader çš„é…ç½®æ–‡ä»¶ fe.conf ä¸­ã€‚<code>--helper</code> å‚æ•°ä»…åœ¨ follower å’Œ observer ç¬¬ä¸€æ¬¡å¯åŠ¨æ—¶æ‰éœ€è¦ã€‚</p>
</blockquote>
<p>æµ‹è¯•è¿‡ç¨‹ä¸­ï¼Œæˆ‘æ˜¯é€‰æ‹© 192.168.1.107 ä½œä¸º FE Masterï¼Œæ–°æ·»åŠ çš„èŠ‚ç‚¹ä¸º 192.168.1.110ï¼Œæ‰€ä»¥ï¼Œåœ¨ 192.168.1.110 èŠ‚ç‚¹ç¬¬ä¸€æ¬¡å¯åŠ¨ FE å‘½ä»¤å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">fe/bin/start_fe.sh --daemon --helper 192.168.1.107:9010 
</span></span></code></pre></div><p><strong>2ã€å°† Follower æˆ– Observer åŠ å…¥åˆ°é›†ç¾¤</strong></p>
<p>ä½¿ç”¨ mysql å®¢æˆ·ç«¯è¿æ¥ FE Masterï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">mysql -h 192.168.1.107 -P <span class="m">9030</span> -uroot
</span></span></code></pre></div><p>ç„¶åï¼Œæ‰§è¡Œä¸‹é¢å‘½ä»¤ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ALTER SYSTEM ADD FOLLOWER <span class="s2">&#34;192.168.1.110:9010&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># æˆ–è€…</span>
</span></span><span class="line"><span class="cl">ALTER SYSTEM ADD OBSERVER <span class="s2">&#34;192.168.1.110:9010&#34;</span><span class="p">;</span>
</span></span></code></pre></div><p>ä½¿ç”¨ä¸Šé¢å“ªä¸ªå‘½ä»¤ï¼Œå–å†³äºä½ æƒ³è®©æ–°èŠ‚ç‚¹ä»¥ FOLLOWER è§’è‰²è¿˜æ˜¯ OBSERVER è§’è‰²åŠ å…¥é›†ç¾¤ã€‚</p>
<blockquote>
<p><strong>FE æ‰©å®¹æ³¨æ„äº‹é¡¹ï¼š</strong></p>
<ol>
<li>Follower FEï¼ˆåŒ…æ‹¬ Masterï¼‰çš„æ•°é‡å¿…é¡»ä¸ºå¥‡æ•°ï¼Œå»ºè®®æœ€å¤šéƒ¨ç½² 3 ä¸ªç»„æˆé«˜å¯ç”¨ï¼ˆHAï¼‰æ¨¡å¼å³å¯ã€‚</li>
<li>å½“ FE å¤„äºé«˜å¯ç”¨éƒ¨ç½²æ—¶ï¼ˆ1ä¸ª Masterï¼Œ2ä¸ª Followerï¼‰ï¼Œæˆ‘ä»¬å»ºè®®é€šè¿‡å¢åŠ  Observer FE æ¥æ‰©å±• FE çš„è¯»æœåŠ¡èƒ½åŠ›ã€‚å½“ç„¶ä¹Ÿå¯ä»¥ç»§ç»­å¢åŠ  Follower FEï¼Œä½†å‡ ä¹æ˜¯ä¸å¿…è¦çš„ã€‚</li>
<li>é€šå¸¸ä¸€ä¸ª FE èŠ‚ç‚¹å¯ä»¥åº”å¯¹ 10-20 å° BE èŠ‚ç‚¹ã€‚å»ºè®®æ€»çš„ FE èŠ‚ç‚¹æ•°é‡åœ¨ 10 ä¸ªä»¥ä¸‹ã€‚è€Œé€šå¸¸ 3 ä¸ªå³å¯æ»¡è¶³ç»å¤§éƒ¨åˆ†éœ€æ±‚ã€‚</li>
<li>helper ä¸èƒ½æŒ‡å‘ FE è‡ªèº«ï¼Œå¿…é¡»æŒ‡å‘ä¸€ä¸ªæˆ–å¤šä¸ªå·²å­˜åœ¨å¹¶ä¸”æ­£å¸¸è¿è¡Œä¸­çš„ Master/Follower FEã€‚</li>
</ol>
</blockquote>
<h4 id="åˆ é™¤-fe-èŠ‚ç‚¹">åˆ é™¤ FE èŠ‚ç‚¹</h4>
<p>ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤åˆ é™¤å¯¹åº”çš„ FE èŠ‚ç‚¹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">ALTER</span><span class="w"> </span><span class="k">SYSTEM</span><span class="w"> </span><span class="k">DROP</span><span class="w"> </span><span class="n">FOLLOWER</span><span class="p">[</span><span class="n">OBSERVER</span><span class="p">]</span><span class="w"> </span><span class="s2">&#34;fe_host:edit_log_port&#34;</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><blockquote>
<p><strong>FE ç¼©å®¹æ³¨æ„äº‹é¡¹ï¼š</strong></p>
<ol>
<li>åˆ é™¤ Follower FE æ—¶ï¼Œç¡®ä¿æœ€ç»ˆå‰©ä½™çš„ Followerï¼ˆåŒ…æ‹¬ Masterï¼‰èŠ‚ç‚¹ä¸ºå¥‡æ•°ã€‚</li>
</ol>
</blockquote>
<h4 id="æµ‹è¯•å¢åŠ å’Œåˆ é™¤-fe-èŠ‚ç‚¹">æµ‹è¯•å¢åŠ å’Œåˆ é™¤ FE èŠ‚ç‚¹</h4>
<p><strong>1ã€æµ‹è¯• 3 ä¸ª FE èŠ‚ç‚¹æƒ…å†µä¸‹ï¼Œåˆ é™¤1ä¸ªFE</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="n">mysql</span><span class="w"> </span><span class="o">-</span><span class="n">h</span><span class="w"> </span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">107</span><span class="w"> </span><span class="o">-</span><span class="n">P</span><span class="w"> </span><span class="mi">9030</span><span class="w"> </span><span class="o">-</span><span class="n">uroot</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">mysql</span><span class="o">&gt;</span><span class="w"> </span><span class="k">ALTER</span><span class="w"> </span><span class="k">SYSTEM</span><span class="w"> </span><span class="k">drop</span><span class="w"> </span><span class="n">FOLLOWER</span><span class="w"> </span><span class="s2">&#34;192.168.1.109:9010&#34;</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><p>æŸ¥çœ‹ FE çŠ¶æ€ï¼Œå¯ä»¥çœ‹åˆ°è¿˜æœ‰ä¸¤ä¸ª FEï¼Œ192.168.1.107 è¿˜æ˜¯ä¸º Masterã€‚</p>
<p><img src="https://chensoul.oss-cn-hangzhou.aliyuncs.com/images/doris-fe-status-01.png" alt="doris-fe-status-01"></p>
<p>æ ¹æ®ä¸Šé¢çš„ <strong>FE ç¼©å®¹æ³¨æ„äº‹é¡¹</strong>ï¼Œå¦‚æœåˆ é™¤ FE èŠ‚ç‚¹ï¼Œéœ€è¦ä¿è¯æœ€ç»ˆå‰©ä½™çš„ FE çš„æ€»æ•°ä¸ºå¥‡æ•°ã€‚åœ¨åˆ é™¤ä¸€ä¸ªèŠ‚ç‚¹ä¹‹åï¼ŒFE ä¸ªæ•°ä¸º 2ï¼ŒFE çŠ¶æ€å‡ä¸ºæ­£å¸¸ã€‚</p>
<p>è¿™æ—¶å€™ï¼Œå¦‚æœ Master å®•æœºäº†ï¼Œå‰©ä¸‹ä¸€ä¸ª FE ä¼šæˆä¸º Master å—ï¼Ÿæˆ‘ä»¬æ¥åœæ­¢ 192.168.1.107 çš„ FEã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">fe/bin/stop_fe.sh
</span></span></code></pre></div><p>ç„¶åï¼Œå†æ¥è¿æ¥ FE Masterï¼ŒçŒœæµ‹è¿™æ—¶å€™çš„ Master åº”è¯¥ä¸º 192.168.1.108</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">mysql -h 192.168.1.108 -P <span class="m">9030</span> -uroot
</span></span></code></pre></div><p>æŸ¥çœ‹ FE çŠ¶æ€ï¼Œå´æç¤ºå¼‚å¸¸ï¼Œè¯´æ˜å‰©ä¸‹çš„2ä¸ªèŠ‚ç‚¹ï¼ˆå…¶ä¸­ä¸€ä¸ªèŠ‚ç‚¹ä¸ºå®•æœºçŠ¶æ€ï¼‰æ— æ³•é€‰ä¸¾å‡º Masterã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="n">mysql</span><span class="o">&gt;</span><span class="w"> </span><span class="k">SHOW</span><span class="w"> </span><span class="n">PROC</span><span class="w"> </span><span class="s1">&#39;/frontends&#39;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">ERROR</span><span class="w"> </span><span class="mi">1105</span><span class="w"> </span><span class="p">(</span><span class="n">HY000</span><span class="p">):</span><span class="w"> </span><span class="k">Exception</span><span class="p">,</span><span class="w"> </span><span class="n">msg</span><span class="p">:</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="k">get</span><span class="w"> </span><span class="n">master</span><span class="w"> </span><span class="n">client</span><span class="p">.</span><span class="w">
</span></span></span></code></pre></div><p>è¿™æ—¶å€™å†å°† 192.168.1.107 çš„ FE å¯åŠ¨èµ·æ¥ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">fe/bin/start_fe.sh --daemon
</span></span></code></pre></div><p>å†é€šè¿‡å®¢æˆ·ç«¯è¿æ¥ FEï¼ŒæŸ¥çœ‹ FE çŠ¶æ€ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">mysql -h 192.168.1.108 -P <span class="m">9030</span> -uroot
</span></span></code></pre></div><p>å¯ä»¥çœ‹åˆ° å˜æˆäº† Masterï¼š</p>
<p><img src="https://chensoul.oss-cn-hangzhou.aliyuncs.com/images/doris-fe-status-02.png" alt="doris-fe-status-02"></p>
<p>è¿™è¯´æ˜ï¼Œ<strong>å‰©ä½™å¶æ•°ä¸ª FE æ—¶ï¼Œè¿˜æ˜¯èƒ½é€‰ä¸¾å‡º Masterï¼Ÿ</strong></p>
<p>è¿™æ—¶å€™ï¼Œå¦‚æœæŠŠä¸æ˜¯ Master çš„ FE åœæ­¢ï¼Œä¼šå‡ºç°ä»€ä¹ˆæƒ…å†µå‘¢ï¼Ÿ</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">mysql -h 192.168.1.108 -P <span class="m">9030</span> -uroot
</span></span><span class="line"><span class="cl">mysql&gt; SHOW PROC <span class="s1">&#39;/frontends&#39;</span><span class="p">;</span>
</span></span></code></pre></div><p>å¯ä»¥çœ‹åˆ°å¦‚ä¸‹ç»“æœï¼š</p>
<p><img src="https://chensoul.oss-cn-hangzhou.aliyuncs.com/images/doris-fe-status-03.png" alt="doris-fe-status-03"></p>
<p>è¯´æ˜ï¼šé Master èŠ‚ç‚¹å®•æœºï¼Œä¸å½±å“ Master FE èŠ‚ç‚¹çš„è¿è¡Œï¼Œå®•æœºçš„ FE çš„ Alive çŠ¶æ€ä¸º falseï¼Œå¼‚å¸¸ä¿¡æ¯ä¸ä¸ºç©ºï¼Œè¿™é‡Œä¸ºï¼š<code>socket is closed by peer.</code></p>
<p>ç¨ç­‰ä¸€ä¼šï¼Œä¼šæç¤ºæ— æ³•è¿æ¥åˆ°æœåŠ¡ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">RROR <span class="m">2013</span> <span class="o">(</span>HY000<span class="o">)</span>: Lost connection to MySQL server during query
</span></span><span class="line"><span class="cl">No connection. Trying to reconnect...
</span></span><span class="line"><span class="cl">ERROR <span class="m">2003</span> <span class="o">(</span>HY000<span class="o">)</span>: Can<span class="s1">&#39;t connect to MySQL server on &#39;</span>192.168.1.108:9030<span class="s1">&#39; (111)
</span></span></span><span class="line"><span class="cl"><span class="s1">ERROR:
</span></span></span><span class="line"><span class="cl"><span class="s1">Can&#39;</span>t connect to the server
</span></span></code></pre></div><p>åŸå› æ˜¯ Master FE ä¹Ÿå°±æ˜¯ 192.168.1.108 èŠ‚ç‚¹ä¸Šçš„ FE å®•æœºäº†ï¼ŒæŸ¥çœ‹æ—¥å¿—ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">com.sleepycat.je.rep.InsufficientReplicasException: <span class="o">(</span>JE 18.3.12<span class="o">)</span> Commit policy: SIMPLE_MAJORITY required <span class="m">1</span> replica. But none were active with this master.
</span></span><span class="line"><span class="cl">at com.sleepycat.je.rep.impl.node.DurabilityQuorum.ensureReplicasForCommit<span class="o">(</span>DurabilityQuorum.java:116<span class="o">)</span> ~<span class="o">[</span>je-18.3.12.jar:18.3.12<span class="o">]</span>
</span></span><span class="line"><span class="cl">	at com.sleepycat.je.rep.impl.RepImpl.txnBeginHook<span class="o">(</span>RepImpl.java:1171<span class="o">)</span> ~<span class="o">[</span>je-18.3.12.jar:18.3.12<span class="o">]</span>
</span></span><span class="line"><span class="cl">	at com.sleepycat.je.rep.txn.MasterTxn.txnBeginHook<span class="o">(</span>MasterTxn.java:195<span class="o">)</span> ~<span class="o">[</span>je-18.3.12.jar:18.3.12<span class="o">]</span>
</span></span><span class="line"><span class="cl">	at com.sleepycat.je.txn.Txn.initTxn<span class="o">(</span>Txn.java:384<span class="o">)</span> ~<span class="o">[</span>je-18.3.12.jar:18.3.12<span class="o">]</span>
</span></span></code></pre></div><p>æ‰‹åŠ¨å¯åŠ¨ 192.168.1.108 çš„FE ä¹‹åï¼ŒæŸ¥çœ‹æ—¥å¿—ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">2022-08-18 18:22:54,958 INFO <span class="o">(</span>UNKNOWN 192.168.1.108_9010_1660793829444<span class="o">(</span>-1<span class="o">)</span><span class="p">|</span>1<span class="o">)</span> <span class="o">[</span>Catalog.waitForReady<span class="o">()</span>:876<span class="o">]</span> <span class="nb">wait</span> catalog to be ready. FE type: UNKNOWN. is ready: <span class="nb">false</span>
</span></span></code></pre></div><p>è¯´æ˜ï¼š192.168.1.108 çš„ FE è¿˜æ²¡æœ‰è·å¾—æ­£ç¡®çš„ FE ç±»å‹ã€‚åŸå› åº”è¯¥æ˜¯ï¼Œç›®å‰é›†ç¾¤åªæ³¨å†Œäº†ä¸¤ä¸ª FEï¼Œå´åªæœ‰ä¸€ä¸ª FE æ˜¯å­˜æ´»çŠ¶æ€ï¼Œæ— æ³•é€‰ä¸¾å‡º Master FEã€‚</p>
<p>åœ¨ 192.168.1.107 èŠ‚ç‚¹æŸ¥çœ‹ FE çŠ¶æ€ï¼Œå‘ç° FE ä¹ŸæŒ‚äº†ï¼Œè¿™æ—¶å€™æ‰‹åŠ¨å¯åŠ¨ FEã€‚å‘ç°ï¼Œå¯ä»¥å†æ¬¡è¿æ¥  FEã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">mysql -h 192.168.1.108 -P <span class="m">9030</span> -uroot
</span></span></code></pre></div><p><strong>æ€»ç»“ï¼š</strong></p>
<ul>
<li>1ã€åˆ é™¤ Follower FE æ—¶ï¼Œéœ€è¦ç¡®ä¿æœ€ç»ˆå‰©ä½™çš„ Followerï¼ˆåŒ…æ‹¬ Masterï¼‰èŠ‚ç‚¹ä¸ºå¥‡æ•°ã€‚</li>
<li>2ã€åˆ é™¤ Follower FE æ—¶ï¼Œå¦‚æœå‰©ä½™çš„ Follower ä¸ä¸ºå¥‡æ•°ï¼ˆç›®å‰æµ‹è¯•çš„æ˜¯å‰©ä½™ 2 ä¸ªæƒ…å†µä¸‹ï¼‰ï¼Œå¦‚æœæœ‰ä¸€ä¸ª FE å®•æ‰ï¼Œåˆ™å¦ä¸€ä¸ª FE ä¹Ÿä¼šå®•æ‰ã€‚æ‰€ä»¥ï¼Œ<strong>éœ€è¦åœ¨ FE å®•æ‰ä¹‹åï¼Œèƒ½å¤Ÿè‡ªåŠ¨å¯åŠ¨</strong>ã€‚ä¹Ÿå°±æ˜¯ï¼Œåœ¨é›†ç¾¤é‡Œï¼Œä¸ºäº†ä¿è¯é«˜å¯ç”¨ï¼Œéœ€è¦<strong>æ‰€æœ‰å®ä¾‹éƒ½åº”ä½¿ç”¨å®ˆæŠ¤è¿›ç¨‹å¯åŠ¨ï¼Œä»¥ä¿è¯è¿›ç¨‹é€€å‡ºåï¼Œä¼šè¢«è‡ªåŠ¨æ‹‰èµ·</strong>ã€‚</li>
</ul>
<p><strong>2ã€æµ‹è¯• 1 ä¸ª FE èŠ‚ç‚¹æƒ…å†µä¸‹ï¼Œæ·»åŠ  FE èŠ‚ç‚¹</strong></p>
<h2 id="be-æ‰©å®¹å’Œç¼©å®¹">BE æ‰©å®¹å’Œç¼©å®¹</h2>
<p>BE èŠ‚ç‚¹çš„æ‰©å®¹å’Œç¼©å®¹è¿‡ç¨‹ï¼Œä¸å½±å“å½“å‰ç³»ç»Ÿè¿è¡Œä»¥åŠæ­£åœ¨æ‰§è¡Œçš„ä»»åŠ¡ï¼Œå¹¶ä¸”ä¸ä¼šå½±å“å½“å‰ç³»ç»Ÿçš„æ€§èƒ½ã€‚æ•°æ®å‡è¡¡ä¼šè‡ªåŠ¨è¿›è¡Œã€‚æ ¹æ®é›†ç¾¤ç°æœ‰æ•°æ®é‡çš„å¤§å°ï¼Œé›†ç¾¤ä¼šåœ¨å‡ ä¸ªå°æ—¶åˆ°1å¤©ä¸ç­‰çš„æ—¶é—´å†…ï¼Œæ¢å¤åˆ°è´Ÿè½½å‡è¡¡çš„çŠ¶æ€ã€‚</p>
<h4 id="å¢åŠ -be-èŠ‚ç‚¹">å¢åŠ  BE èŠ‚ç‚¹</h4>
<p>BE èŠ‚ç‚¹çš„å¢åŠ æ–¹å¼åŒ <strong>BE éƒ¨ç½²</strong> ä¸€èŠ‚ä¸­çš„æ–¹å¼ï¼Œé€šè¿‡ <code>ALTER SYSTEM ADD BACKEND</code> å‘½ä»¤å¢åŠ  BE èŠ‚ç‚¹ã€‚</p>
<blockquote>
<p>BE æ‰©å®¹æ³¨æ„äº‹é¡¹ï¼š</p>
<ol>
<li>BE æ‰©å®¹åï¼ŒDoris ä¼šè‡ªåŠ¨æ ¹æ®è´Ÿè½½æƒ…å†µï¼Œè¿›è¡Œæ•°æ®å‡è¡¡ï¼ŒæœŸé—´ä¸å½±å“ä½¿ç”¨ã€‚</li>
</ol>
</blockquote>
<h4 id="åˆ é™¤-be-èŠ‚ç‚¹">åˆ é™¤ BE èŠ‚ç‚¹</h4>
<p>åˆ é™¤ BE èŠ‚ç‚¹æœ‰ä¸¤ç§æ–¹å¼ï¼šDROP å’Œ DECOMMISSION</p>
<p>DROP è¯­å¥å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">ALTER</span><span class="w"> </span><span class="k">SYSTEM</span><span class="w"> </span><span class="k">DROP</span><span class="w"> </span><span class="n">BACKEND</span><span class="w"> </span><span class="s2">&#34;be_host:be_heartbeat_service_port&#34;</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><p><strong>æ³¨æ„ï¼šDROP BACKEND ä¼šç›´æ¥åˆ é™¤è¯¥ BEï¼Œå¹¶ä¸”å…¶ä¸Šçš„æ•°æ®å°†ä¸èƒ½å†æ¢å¤ï¼ï¼ï¼æ‰€ä»¥æˆ‘ä»¬å¼ºçƒˆä¸æ¨èä½¿ç”¨ DROP BACKEND è¿™ç§æ–¹å¼åˆ é™¤ BE èŠ‚ç‚¹ã€‚å½“ä½ ä½¿ç”¨è¿™ä¸ªè¯­å¥æ—¶ï¼Œä¼šæœ‰å¯¹åº”çš„é˜²è¯¯æ“ä½œæç¤ºã€‚</strong></p>
<p>DECOMMISSION è¯­å¥å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">ALTER</span><span class="w"> </span><span class="k">SYSTEM</span><span class="w"> </span><span class="n">DECOMMISSION</span><span class="w"> </span><span class="n">BACKEND</span><span class="w"> </span><span class="s2">&#34;be_host:be_heartbeat_service_port&#34;</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><blockquote>
<p>DECOMMISSION å‘½ä»¤è¯´æ˜ï¼š</p>
<ol>
<li>è¯¥å‘½ä»¤ç”¨äºå®‰å…¨åˆ é™¤ BE èŠ‚ç‚¹ã€‚å‘½ä»¤ä¸‹å‘åï¼ŒDoris ä¼šå°è¯•å°†è¯¥ BE ä¸Šçš„æ•°æ®å‘å…¶ä»– BE èŠ‚ç‚¹è¿ç§»ï¼Œå½“æ‰€æœ‰æ•°æ®éƒ½è¿ç§»å®Œæˆåï¼ŒDoris ä¼šè‡ªåŠ¨åˆ é™¤è¯¥èŠ‚ç‚¹ã€‚</li>
<li>è¯¥å‘½ä»¤æ˜¯ä¸€ä¸ªå¼‚æ­¥æ“ä½œã€‚æ‰§è¡Œåï¼Œå¯ä»¥é€šè¿‡ <code>SHOW PROC '/backends';</code> çœ‹åˆ°è¯¥ BE èŠ‚ç‚¹çš„ <code>SystemDecommissioned</code> çŠ¶æ€ä¸º trueã€‚è¡¨ç¤ºè¯¥èŠ‚ç‚¹æ­£åœ¨è¿›è¡Œä¸‹çº¿ã€‚</li>
<li>è¯¥å‘½ä»¤<strong>ä¸ä¸€å®šæ‰§è¡ŒæˆåŠŸ</strong>ã€‚æ¯”å¦‚å‰©ä½™ BE å­˜å‚¨ç©ºé—´ä¸è¶³ä»¥å®¹çº³ä¸‹çº¿ BE ä¸Šçš„æ•°æ®ï¼Œæˆ–è€…å‰©ä½™æœºå™¨æ•°é‡ä¸æ»¡è¶³æœ€å°å‰¯æœ¬æ•°æ—¶ï¼Œè¯¥å‘½ä»¤éƒ½æ— æ³•å®Œæˆï¼Œå¹¶ä¸” BE ä¼šä¸€ç›´å¤„äº <code>SystemDecommissioned</code> ä¸º true çš„çŠ¶æ€ã€‚</li>
<li>DECOMMISSION çš„è¿›åº¦ï¼Œå¯ä»¥é€šè¿‡ <code>SHOW PROC '/backends';</code> ä¸­çš„ TabletNum æŸ¥çœ‹ï¼Œå¦‚æœæ­£åœ¨è¿›è¡Œï¼ŒTabletNum å°†ä¸æ–­å‡å°‘ã€‚</li>
<li>è¯¥æ“ä½œå¯ä»¥é€šè¿‡:
<code>CANCEL DECOMMISSION BACKEND &quot;be_host:be_heartbeat_service_port&quot;;</code>
å‘½ä»¤å–æ¶ˆã€‚å–æ¶ˆåï¼Œè¯¥ BE ä¸Šçš„æ•°æ®å°†ç»´æŒå½“å‰å‰©ä½™çš„æ•°æ®é‡ã€‚åç»­ Doris é‡æ–°è¿›è¡Œè´Ÿè½½å‡è¡¡</li>
</ol>
</blockquote>
<p><strong>å¯¹äºå¤šç§Ÿæˆ·éƒ¨ç½²ç¯å¢ƒä¸‹ï¼ŒBE èŠ‚ç‚¹çš„æ‰©å®¹å’Œç¼©å®¹ï¼Œè¯·å‚é˜… <a href="https://doris.apache.org/zh-CN/docs/admin-manual/multi-tenant">å¤šç§Ÿæˆ·è®¾è®¡æ–‡æ¡£</a>ã€‚</strong></p>
<h2 id="broker-æ‰©å®¹ç¼©å®¹">Broker æ‰©å®¹ç¼©å®¹</h2>
<p>Broker å®ä¾‹çš„æ•°é‡æ²¡æœ‰ç¡¬æ€§è¦æ±‚ã€‚é€šå¸¸æ¯å°ç‰©ç†æœºéƒ¨ç½²ä¸€ä¸ªå³å¯ã€‚Broker çš„æ·»åŠ å’Œåˆ é™¤å¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤å®Œæˆï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">ALTER</span><span class="w"> </span><span class="k">SYSTEM</span><span class="w"> </span><span class="k">ADD</span><span class="w"> </span><span class="n">BROKER</span><span class="w"> </span><span class="n">broker_name</span><span class="w"> </span><span class="s2">&#34;broker_host:broker_ipc_port&#34;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ALTER</span><span class="w"> </span><span class="k">SYSTEM</span><span class="w"> </span><span class="k">DROP</span><span class="w"> </span><span class="n">BROKER</span><span class="w"> </span><span class="n">broker_name</span><span class="w"> </span><span class="s2">&#34;broker_host:broker_ipc_port&#34;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ALTER</span><span class="w"> </span><span class="k">SYSTEM</span><span class="w"> </span><span class="k">DROP</span><span class="w"> </span><span class="k">ALL</span><span class="w"> </span><span class="n">BROKER</span><span class="w"> </span><span class="n">broker_name</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><p>Broker æ˜¯æ— çŠ¶æ€çš„è¿›ç¨‹ï¼Œå¯ä»¥éšæ„å¯åœã€‚å½“ç„¶ï¼Œåœæ­¢åï¼Œæ­£åœ¨å…¶ä¸Šè¿è¡Œçš„ä½œä¸šä¼šå¤±è´¥ï¼Œé‡è¯•å³å¯ã€‚</p>
]]></content:encoded></item><item><title>Dorisé€šè¿‡å¤–éƒ¨è¡¨åŒæ­¥æ•°æ®</title><link>https://blog.chensoul.com/posts/2022/08/18/doris-external-table-load/</link><pubDate>Thu, 18 Aug 2022 10:27:21 +0800</pubDate><guid>https://blog.chensoul.com/posts/2022/08/18/doris-external-table-load/</guid><description>Doris å¯ä»¥åˆ›å»ºé€šè¿‡ ODBC åè®®è®¿é—®çš„å¤–éƒ¨è¡¨ã€‚åˆ›å»ºå®Œæˆåï¼Œå¯ä»¥é€šè¿‡ SELECT è¯­å¥ç›´æ¥æŸ¥è¯¢å¤–éƒ¨è¡¨çš„æ•°æ®ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ INSERT INTO SELECT çš„æ–¹å¼å¯¼å…¥å¤–éƒ¨è¡¨çš„æ•°æ®ã€‚ ç›®å‰æ”¯æŒçš„æ•°æ®æºåŒ…</description><content:encoded><![CDATA[<p>Doris å¯ä»¥åˆ›å»ºé€šè¿‡ ODBC åè®®è®¿é—®çš„å¤–éƒ¨è¡¨ã€‚åˆ›å»ºå®Œæˆåï¼Œå¯ä»¥é€šè¿‡ SELECT è¯­å¥ç›´æ¥æŸ¥è¯¢å¤–éƒ¨è¡¨çš„æ•°æ®ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ <code>INSERT INTO SELECT</code> çš„æ–¹å¼å¯¼å…¥å¤–éƒ¨è¡¨çš„æ•°æ®ã€‚</p>
<p>ç›®å‰æ”¯æŒçš„æ•°æ®æºåŒ…æ‹¬ï¼š</p>
<ul>
<li>MySQL</li>
<li>Oracle</li>
<li>PostgreSQL</li>
<li>SQLServer</li>
<li>Hive(1.0ç‰ˆæœ¬æ”¯æŒ)</li>
</ul>
<p>å¼€å§‹ä¹‹å‰ï¼Œ<strong>ç‰¹åˆ«è¯´æ˜</strong>ï¼Œæœ¬æ–‡æ˜¯åœ¨ centos7.8 æ“ä½œç³»ç»Ÿå’Œ doris 1.1 ç‰ˆæœ¬ä¸‹è¿›è¡Œæµ‹è¯•ã€‚</p>
<h2 id="å®‰è£…-odbc-é©±åŠ¨">å®‰è£… ODBC é©±åŠ¨</h2>
<h3 id="å®‰è£…-mysql-odbc">å®‰è£… mysql odbc</h3>
<p><a href="https://doris.apache.org/zh-CN/docs/faq/install-faq">å®˜æ–¹æ–‡æ¡£è¿ç»´å¸¸è§é—®é¢˜</a>ä¸­æœ‰æåˆ°ï¼šDoris å‡çº§åˆ°1.0 ä»¥åç‰ˆæœ¬é€šè¿‡ODBCè®¿é—®MySQLå¤–è¡¨æŠ¥é”™ Failed to set ciphers to use (2026)ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ERROR <span class="m">1105</span> <span class="o">(</span>HY000<span class="o">)</span>: <span class="nv">errCode</span> <span class="o">=</span> 2, <span class="nv">detailMessage</span> <span class="o">=</span> driver connect Error: HY000 <span class="o">[</span>MySQL<span class="o">][</span>ODBC 8.0<span class="o">(</span>w<span class="o">)</span> Driver<span class="o">]</span>SSL connection error: Failed to <span class="nb">set</span> ciphers to use <span class="o">(</span>2026<span class="o">)</span>
</span></span></code></pre></div><p>è§£å†³æ–¹å¼æ˜¯ä½¿ç”¨<code>Connector/ODBC 8.0.28</code> ç‰ˆæœ¬çš„ ODBC Connectorï¼Œ å¹¶ä¸”åœ¨æ“ä½œç³»ç»Ÿå¤„é€‰æ‹© <code>Linux - Generic</code>, è¿™ä¸ªç‰ˆæœ¬çš„ ODBC Driver ä½¿ç”¨ openssl 1.1 ç‰ˆæœ¬ã€‚æˆ–è€…ä½¿ç”¨ä½ç‰ˆæœ¬çš„ ODBC Connectorï¼Œæ¯”å¦‚<a href="https://dev.mysql.com/downloads/connector/odbc/5.3.html">Connector/ODBC 5.3.14</a>ã€‚</p>
<p>å¯ä»¥é€šè¿‡å¦‚ä¸‹æ–¹å¼éªŒè¯ MySQL ODBC Driver ä½¿ç”¨çš„ openssl ç‰ˆæœ¬</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ldd /path/to/libmyodbc8w.so <span class="p">|</span>grep libssl.so
</span></span></code></pre></div><p>å¦‚æœè¾“å‡ºåŒ…å« <code>libssl.so.10</code> åˆ™ä½¿ç”¨è¿‡ç¨‹ä¸­å¯èƒ½å‡ºç°é—®é¢˜ï¼Œ å¦‚æœåŒ…å«<code>libssl.so.1.1</code> åˆ™ä¸doris 1.0 å…¼å®¹ã€‚</p>
<p>åœ¨è¿™é‡Œï¼Œå‚è€ƒ <a href="https://qq52o.me/2732.html">è§£å†³æŠ¥é”™libssl.so.1.1: cannot open shared object file: No such file or directory</a>ï¼Œç›´æ¥å°† openssl å‡çº§åˆ°1.1ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Bash" data-lang="Bash"><span class="line"><span class="cl">wget https://www.openssl.org/source/openssl-1.1.1q.tar.gz
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">tar -xvf openssl-1.1.1q.tar.gz 
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> openssl-1.1.1q 
</span></span><span class="line"><span class="cl">./config shared --openssldir<span class="o">=</span>/usr/local/openssl --prefix<span class="o">=</span>/usr/local/openssl 
</span></span><span class="line"><span class="cl">make <span class="o">&amp;&amp;</span> make install
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">mv /usr/bin/openssl /usr/bin/openssl.old 
</span></span><span class="line"><span class="cl">mv /usr/lib/openssl /usr/lib/openssl.old 
</span></span><span class="line"><span class="cl">ln -s /usr/local/openssl/bin/openssl /usr/bin/openssl 
</span></span><span class="line"><span class="cl">ln -s /usr/local/openssl/include/openssl /usr/include/openssl 
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;/usr/local/openssl/lib&#34;</span> &gt;&gt; /etc/ld.so.conf 
</span></span><span class="line"><span class="cl">ldconfig -v
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">openssl version 
</span></span></code></pre></div><p>æ¥ä¸‹æ¥ï¼Œä¸‹è½½ mysql-connector-odbc-8.0.28 ç‰ˆæœ¬çš„ odbc é©±åŠ¨ï¼Œå¹¶å®‰è£…ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Bash" data-lang="Bash"><span class="line"><span class="cl">wget https://dev.mysql.com/get/Downloads/Connector-ODBC/8.0/mysql-connector-odbc-8.0.28-1.el7.x86_64.rpm
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">rpm -ivh mysql-connector-odbc-8.0.28-1.el7.x86_64.rpm
</span></span></code></pre></div><p>åˆ›å»ºæµ‹è¯•æ–‡ä»¶:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Bash" data-lang="Bash"><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">[mysql]
</span></span></span><span class="line"><span class="cl"><span class="s2">Driver = MySQL ODBC 8.0 Unicode Driver
</span></span></span><span class="line"><span class="cl"><span class="s2">Description = MyODBC 8.0 Driver
</span></span></span><span class="line"><span class="cl"><span class="s2">SERVER = 127.0.0.1
</span></span></span><span class="line"><span class="cl"><span class="s2">PORT = 3306
</span></span></span><span class="line"><span class="cl"><span class="s2">USER = root
</span></span></span><span class="line"><span class="cl"><span class="s2">Password = 123456
</span></span></span><span class="line"><span class="cl"><span class="s2">Database = test
</span></span></span><span class="line"><span class="cl"><span class="s2">OPTION = 3
</span></span></span><span class="line"><span class="cl"><span class="s2">charset=UTF8
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;</span> &gt; /etc/odbc.ini
</span></span></code></pre></div><p>æ‰§è¡Œå‘½ä»¤ï¼Œçœ‹é©±åŠ¨æ˜¯å¦å®‰è£…æˆåŠŸï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Bash" data-lang="Bash"><span class="line"><span class="cl">isql -v mysql
</span></span></code></pre></div><p>æŸ¥çœ‹ doris ä¸­ MySQL ODBC Driver ä½¿ç”¨çš„ openssl ç‰ˆæœ¬ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Bash" data-lang="Bash"><span class="line"><span class="cl">cat /opt/doris/be/conf/odbcinst.ini
</span></span><span class="line"><span class="cl">ldd /usr/lib64/libmyodbc8w.so<span class="p">|</span>grep libssl
</span></span></code></pre></div><blockquote>
<p>**æ³¨æ„ï¼š**æˆ‘æ˜¯å°† doris å®‰è£…åœ¨ /opt/doris ç›®å½•ã€‚</p>
</blockquote>
<h3 id="å®‰è£…-postgresql-odbc">å®‰è£… postgresql odbc</h3>
<p>å®‰è£…é©±åŠ¨ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Bash" data-lang="Bash"><span class="line"><span class="cl">yum install -y unixODBC.x86_64 postgresql-odbc.x86_64
</span></span></code></pre></div><p>æŸ¥çœ‹odbcé…ç½®æ–‡ä»¶ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">odbcinst -j
</span></span></code></pre></div><p>åˆ›å»ºæµ‹è¯•æ–‡ä»¶ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">[postgresql]
</span></span></span><span class="line"><span class="cl"><span class="s2">Driver = PostgreSQL
</span></span></span><span class="line"><span class="cl"><span class="s2">Description = Test to gp
</span></span></span><span class="line"><span class="cl"><span class="s2">Servername = 127.0.0.1
</span></span></span><span class="line"><span class="cl"><span class="s2">Trace = Yes
</span></span></span><span class="line"><span class="cl"><span class="s2">TraceFile = /tmp/sql.log
</span></span></span><span class="line"><span class="cl"><span class="s2">Database = test
</span></span></span><span class="line"><span class="cl"><span class="s2">Username = pgadmin
</span></span></span><span class="line"><span class="cl"><span class="s2">Password = 123456
</span></span></span><span class="line"><span class="cl"><span class="s2">Port = 5432
</span></span></span><span class="line"><span class="cl"><span class="s2">ReadOnly = 0
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;</span> &gt; /etc/odbc.ini
</span></span></code></pre></div><p>æµ‹è¯•ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">isql -v postgresql
</span></span></code></pre></div><h2 id="åˆ›å»º-odbc-resource">åˆ›å»º ODBC Resource</h2>
<p>ODBC Resource çš„ç›®çš„æ˜¯ç”¨äºç»Ÿä¸€ç®¡ç†å¤–éƒ¨è¡¨çš„è¿æ¥ä¿¡æ¯ã€‚</p>
<p>åˆ›å»ºä¸€ä¸ª mysql çš„å¤–éƒ¨èµ„æºï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">CREATE EXTERNAL RESOURCE <span class="sb">`</span>mysql_odbc_test<span class="sb">`</span>
</span></span><span class="line"><span class="cl">PROPERTIES <span class="o">(</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;type&#34;</span> <span class="o">=</span> <span class="s2">&#34;odbc_catalog&#34;</span>,
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;host&#34;</span> <span class="o">=</span> <span class="s2">&#34;127.0.0.1&#34;</span>,
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;port&#34;</span> <span class="o">=</span> <span class="s2">&#34;3306&#34;</span>,
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;user&#34;</span> <span class="o">=</span> <span class="s2">&#34;root&#34;</span>,
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;password&#34;</span> <span class="o">=</span> <span class="s2">&#34;123456&#34;</span>,
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;database&#34;</span> <span class="o">=</span> <span class="s2">&#34;test&#34;</span>,
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;odbc_type&#34;</span> <span class="o">=</span> <span class="s2">&#34;mysql&#34;</span>,
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;driver&#34;</span> <span class="o">=</span> <span class="s2">&#34;MySQL ODBC 8.0 Unicode Driver&#34;</span>
</span></span><span class="line"><span class="cl"><span class="o">)</span><span class="p">;</span>
</span></span></code></pre></div><p>åˆ›å»ºä¸€ä¸ª postgresql çš„å¤–éƒ¨èµ„æºï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">CREATE EXTERNAL RESOURCE <span class="sb">`</span>postgresql_odbc_test<span class="sb">`</span>
</span></span><span class="line"><span class="cl"> PROPERTIES <span class="o">(</span>
</span></span><span class="line"><span class="cl"> <span class="s2">&#34;host&#34;</span> <span class="o">=</span> <span class="s2">&#34;127.0.0.1&#34;</span>,
</span></span><span class="line"><span class="cl"> <span class="s2">&#34;port&#34;</span> <span class="o">=</span> <span class="s2">&#34;5432&#34;</span>,
</span></span><span class="line"><span class="cl"> <span class="s2">&#34;user&#34;</span> <span class="o">=</span> <span class="s2">&#34;pgadmin&#34;</span>,
</span></span><span class="line"><span class="cl"> <span class="s2">&#34;password&#34;</span> <span class="o">=</span> <span class="s2">&#34;123456&#34;</span>,
</span></span><span class="line"><span class="cl"> <span class="s2">&#34;database&#34;</span> <span class="o">=</span> <span class="s2">&#34;test&#34;</span>,
</span></span><span class="line"><span class="cl"> <span class="s2">&#34;driver&#34;</span> <span class="o">=</span> <span class="s2">&#34;PostgreSQL&#34;</span>,  
</span></span><span class="line"><span class="cl"> <span class="s2">&#34;odbc_type&#34;</span> <span class="o">=</span> <span class="s2">&#34;postgresql&#34;</span>,
</span></span><span class="line"><span class="cl"> <span class="s2">&#34;type&#34;</span> <span class="o">=</span> <span class="s2">&#34;odbc_catalog&#34;</span>
</span></span><span class="line"><span class="cl"> <span class="o">)</span><span class="p">;</span>
</span></span></code></pre></div><h5 id="odbc-ç›¸å…³å‚æ•°å¦‚ä¸‹">ODBC ç›¸å…³å‚æ•°å¦‚ä¸‹ï¼š</h5>
<ul>
<li><code>type</code>: å¿…å¡«ï¼Œä¸”å¿…é¡»ä¸º<code>odbc_catalog</code>ã€‚ä½œä¸ºresourceçš„ç±»å‹æ ‡è¯†ã€‚</li>
<li><code>user</code>: å¤–éƒ¨è¡¨çš„è´¦å·ï¼Œå¿…å¡«ã€‚</li>
<li><code>password</code>: å¤–éƒ¨è¡¨çš„å¯†ç ï¼Œå¿…å¡«ã€‚</li>
<li><code>host</code>: å¤–éƒ¨è¡¨çš„è¿æ¥ipåœ°å€ï¼Œå¿…å¡«ã€‚</li>
<li><code>port</code>: å¤–éƒ¨è¡¨çš„è¿æ¥ç«¯å£ï¼Œå¿…å¡«ã€‚</li>
<li><code>odbc_type</code>: æ ‡ç¤ºå¤–éƒ¨è¡¨çš„ç±»å‹ï¼Œå½“å‰dorisæ”¯æŒ<code>mysql</code>ä¸<code>oracle</code>ï¼Œæœªæ¥å¯èƒ½æ”¯æŒæ›´å¤šçš„æ•°æ®åº“ã€‚å¼•ç”¨è¯¥resourceçš„ODBCå¤–è¡¨å¿…å¡«ï¼Œæ—§çš„mysqlå¤–è¡¨é€‰å¡«ã€‚</li>
<li><code>driver</code>: æ ‡ç¤ºå¤–éƒ¨è¡¨ä½¿ç”¨çš„ driver åŠ¨æ€åº“ï¼Œå¼•ç”¨è¯¥resourceçš„ODBCå¤–è¡¨å¿…å¡«ï¼Œæ—§çš„mysqlå¤–è¡¨é€‰å¡«ã€‚<strong>å¿…é¡»ä¸ <code>be/conf/odbcinst.ini</code> ä¸­ odbc çš„åç§°ä¿æŒä¸€è‡´ã€‚</strong></li>
</ul>
<p>èµ„æºç®¡ç†ä¸»è¦æœ‰ä¸‰ä¸ªå‘½ä»¤ï¼š</p>
<ul>
<li>CREATE RESOURCE</li>
<li>DROP RESOURCE</li>
<li>SHOW RESOURCES</li>
</ul>
<p>ä¾‹å¦‚ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">drop</span><span class="w"> </span><span class="n">resource</span><span class="w"> </span><span class="n">postgresql_odbc_lps</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">show</span><span class="w"> </span><span class="n">RESOURCES</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><h2 id="åˆ›å»ºå¤–éƒ¨è¡¨">åˆ›å»ºå¤–éƒ¨è¡¨</h2>
<p>doris ç›®å‰æ”¯æŒçš„å¤–éƒ¨è¡¨æœ‰ MYSQLã€POSTGRESQLã€BROKERã€HIVEã€ICEBERG ã€HUDI ç­‰ã€‚</p>
<p>åˆ›å»º mysql çš„å¤–éƒ¨è¡¨ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">CREATE EXTERNAL TABLE <span class="sb">`</span>ext_sys_shop<span class="sb">`</span> <span class="o">(</span>
</span></span><span class="line"><span class="cl">  <span class="sb">`</span>id<span class="sb">`</span> bigint NOT NULL COMMENT <span class="s2">&#34;&#34;</span>,
</span></span><span class="line"><span class="cl">  <span class="sb">`</span>name<span class="sb">`</span> varchar<span class="o">(</span>32<span class="o">)</span> NOT NULL COMMENT <span class="s2">&#34;&#34;</span>,
</span></span><span class="line"><span class="cl">  <span class="sb">`</span>code<span class="sb">`</span> varchar<span class="o">(</span>32<span class="o">)</span> NOT NULL COMMENT <span class="s2">&#34;&#34;</span>,
</span></span><span class="line"><span class="cl">  <span class="sb">`</span>tenant_id<span class="sb">`</span> varchar<span class="o">(</span>10<span class="o">)</span> NOT NULL COMMENT <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl"><span class="o">)</span> <span class="nv">ENGINE</span><span class="o">=</span>ODBC
</span></span><span class="line"><span class="cl">COMMENT <span class="s2">&#34;ODBC&#34;</span>
</span></span><span class="line"><span class="cl">PROPERTIES <span class="o">(</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;odbc_catalog_resource&#34;</span> <span class="o">=</span> <span class="s2">&#34;mysql_odbc_test&#34;</span>,
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;database&#34;</span> <span class="o">=</span> <span class="s2">&#34;test&#34;</span>,
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;table&#34;</span> <span class="o">=</span> <span class="s2">&#34;sys_shop&#34;</span>
</span></span><span class="line"><span class="cl"><span class="o">)</span><span class="p">;</span>
</span></span></code></pre></div><h2 id="åˆ›å»º-doris-è¡¨">åˆ›å»º Doris è¡¨</h2>
<p>åˆ›å»º doris è¡¨ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-SQL" data-lang="SQL"><span class="line"><span class="cl"><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="o">`</span><span class="n">doris_sys_shop</span><span class="o">`</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="o">`</span><span class="n">id</span><span class="o">`</span><span class="w"> </span><span class="nb">bigint</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="k">COMMENT</span><span class="w"> </span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="o">`</span><span class="n">name</span><span class="o">`</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="k">COMMENT</span><span class="w"> </span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="o">`</span><span class="n">code</span><span class="o">`</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="k">COMMENT</span><span class="w"> </span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="o">`</span><span class="n">tenant_id</span><span class="o">`</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="k">COMMENT</span><span class="w"> </span><span class="s2">&#34;&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">COMMENT</span><span class="w"> </span><span class="s2">&#34;Doris Table&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">DISTRIBUTED</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">HASH</span><span class="p">(</span><span class="n">id</span><span class="p">)</span><span class="w"> </span><span class="n">BUCKETS</span><span class="w"> </span><span class="mi">10</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">PROPERTIES</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="s2">&#34;replication_num&#34;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&#34;1&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">);</span><span class="w">
</span></span></span></code></pre></div><p>ä»å¤–éƒ¨è¡¨å¯¼å…¥æ•°æ®åˆ° doris è¡¨ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-SQL" data-lang="SQL"><span class="line"><span class="cl"><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">doris_sys_shop</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">code</span><span class="p">,</span><span class="n">tenant_id</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">ext_sys_shop</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><p>INSERT å‘½ä»¤æ˜¯åŒæ­¥å‘½ä»¤ï¼Œè¿”å›æˆåŠŸï¼Œå³è¡¨ç¤ºå¯¼å…¥æˆåŠŸã€‚</p>
<h2 id="æ³¨æ„äº‹é¡¹">æ³¨æ„äº‹é¡¹</h2>
<ol>
<li>å¿…é¡»ä¿è¯å¤–éƒ¨ ODBC æ•°æ®æºä¸ Doris é›†ç¾¤æ˜¯å¯ä»¥äº’é€šï¼ŒåŒ…æ‹¬BEèŠ‚ç‚¹å’Œå¤–éƒ¨æ•°æ®æºçš„ç½‘ç»œæ˜¯äº’é€šçš„ã€‚</li>
<li>ODBC å¤–éƒ¨è¡¨æœ¬è´¨ä¸Šæ˜¯é€šè¿‡å•ä¸€ ODBC å®¢æˆ·ç«¯è®¿é—®æ•°æ®æºï¼Œå› æ­¤å¹¶ä¸åˆé€‚ä¸€æ¬¡æ€§å¯¼å…¥å¤§é‡çš„æ•°æ®ï¼Œå»ºè®®åˆ†æ‰¹å¤šæ¬¡å¯¼å…¥ã€‚</li>
</ol>
]]></content:encoded></item><item><title>Doriså®‰è£…å’Œéƒ¨ç½²</title><link>https://blog.chensoul.com/posts/2022/08/18/doris-install-deploy/</link><pubDate>Thu, 18 Aug 2022 09:47:03 +0800</pubDate><guid>https://blog.chensoul.com/posts/2022/08/18/doris-install-deploy/</guid><description>ã€Šåæ¥çš„æˆ‘ä»¬ - äº”æœˆå¤©ã€‹ ä¸€ã€ç¯å¢ƒå‡†å¤‡ 1ã€å®‰è£…è¦æ±‚ CPUï¼š2Cï¼ˆæœ€ä½ï¼‰8Cï¼ˆæ¨èï¼‰ å†…å­˜ï¼š4Gï¼ˆæœ€ä½ï¼‰48Gï¼ˆæ¨èï¼‰ ç¡¬ç›˜ï¼š100Gï¼ˆæœ€ä½ï¼‰400G</description><content:encoded><![CDATA[<figure >
    <audio controls preload="metadata">
        
        <source src="/audios/here_after_us.mp3" type="audio/mpeg">
    </audio>
    <p><figcaption>ã€Šåæ¥çš„æˆ‘ä»¬ - äº”æœˆå¤©ã€‹</figcaption></p>
</figure>
<h2 id="ä¸€ç¯å¢ƒå‡†å¤‡">ä¸€ã€ç¯å¢ƒå‡†å¤‡</h2>
<h3 id="1å®‰è£…è¦æ±‚">1ã€å®‰è£…è¦æ±‚</h3>
<ul>
<li>CPUï¼š2Cï¼ˆæœ€ä½ï¼‰8Cï¼ˆæ¨èï¼‰</li>
<li>å†…å­˜ï¼š4Gï¼ˆæœ€ä½ï¼‰48Gï¼ˆæ¨èï¼‰</li>
<li>ç¡¬ç›˜ï¼š100Gï¼ˆæœ€ä½ï¼‰400Gï¼ˆæ¨èï¼‰</li>
<li>å¹³å°ï¼šMacOSï¼ˆIntelï¼‰ã€LinuxOSã€Windows è™šæ‹Ÿæœº</li>
<li>ç³»ç»Ÿï¼šCentOSï¼ˆ7.1åŠä»¥ä¸Šï¼‰ã€Ubuntuï¼ˆ16.04 åŠä»¥ä¸Šï¼‰</li>
<li>è½¯ä»¶ï¼šJDKï¼ˆ1.8åŠä»¥ä¸Šï¼‰ã€GCCï¼ˆ4.8.2 åŠä»¥ä¸Šï¼‰</li>
</ul>
<h3 id="2ç¯å¢ƒè§„åˆ’">2ã€ç¯å¢ƒè§„åˆ’</h3>
<p>å¼€å‘æµ‹è¯•ç¯å¢ƒ</p>
<table>
<thead>
<tr>
<th>æ¨¡å—</th>
<th>CPU</th>
<th>å†…å­˜</th>
<th>ç£ç›˜</th>
<th>ç½‘ç»œ</th>
<th>å®ä¾‹æ•°é‡</th>
</tr>
</thead>
<tbody>
<tr>
<td>Frontend</td>
<td>8æ ¸+</td>
<td>8GB+</td>
<td>SSD æˆ– SATAï¼Œ10GB+ *</td>
<td>åƒå…†ç½‘å¡</td>
<td>1</td>
</tr>
<tr>
<td>Backend</td>
<td>8æ ¸+</td>
<td>16GB+</td>
<td>SSD æˆ– SATAï¼Œ50GB+ *</td>
<td>åƒå…†ç½‘å¡</td>
<td>1-3 *</td>
</tr>
</tbody>
</table>
<p>ç”Ÿäº§ç¯å¢ƒ</p>
<table>
<thead>
<tr>
<th>æ¨¡å—</th>
<th>CPU</th>
<th>å†…å­˜</th>
<th>ç£ç›˜</th>
<th>ç½‘ç»œ</th>
<th>å®ä¾‹æ•°é‡ï¼ˆæœ€ä½è¦æ±‚ï¼‰</th>
</tr>
</thead>
<tbody>
<tr>
<td>Frontend</td>
<td>16æ ¸+</td>
<td>64GB+</td>
<td>SSD æˆ– RAID å¡ï¼Œ100GB+ *</td>
<td>ä¸‡å…†ç½‘å¡</td>
<td>1-5 *</td>
</tr>
<tr>
<td>Backend</td>
<td>16æ ¸+</td>
<td>64GB+</td>
<td>SSD æˆ– SATAï¼Œ100G+ *</td>
<td>ä¸‡å…†ç½‘å¡</td>
<td>10-100 *</td>
</tr>
</tbody>
</table>
<blockquote>
<p>è¯´æ˜ï¼š</p>
<ul>
<li>FE çš„ç£ç›˜ç©ºé—´ä¸»è¦ç”¨äºå­˜å‚¨å…ƒæ•°æ®ï¼ŒåŒ…æ‹¬æ—¥å¿—å’Œ imageã€‚é€šå¸¸ä»å‡ ç™¾ MB åˆ°å‡ ä¸ª GB ä¸ç­‰ã€‚</li>
<li>BE çš„ç£ç›˜ç©ºé—´ä¸»è¦ç”¨äºå­˜æ”¾ç”¨æˆ·æ•°æ®ï¼Œæ€»ç£ç›˜ç©ºé—´æŒ‰ç”¨æˆ·æ€»æ•°æ®é‡ * 3ï¼ˆ3å‰¯æœ¬ï¼‰è®¡ç®—ï¼Œç„¶åå†é¢„ç•™é¢å¤– 40% çš„ç©ºé—´ç”¨ä½œåå°å‹ç¼©ä»¥åŠä¸€äº›ä¸­é—´æ•°æ®çš„å­˜æ”¾ã€‚</li>
<li>ä¸€å°æœºå™¨ä¸Šå¯ä»¥éƒ¨ç½²å¤šä¸ª BE å®ä¾‹ï¼Œä½†æ˜¯<strong>åªèƒ½éƒ¨ç½²ä¸€ä¸ª FE</strong>ã€‚å¦‚æœéœ€è¦ 3 å‰¯æœ¬æ•°æ®ï¼Œé‚£ä¹ˆè‡³å°‘éœ€è¦ 3 å°æœºå™¨å„éƒ¨ç½²ä¸€ä¸ª BE å®ä¾‹ï¼ˆè€Œä¸æ˜¯1å°æœºå™¨éƒ¨ç½²3ä¸ªBEå®ä¾‹ï¼‰ã€‚<strong>å¤šä¸ªFEæ‰€åœ¨æœåŠ¡å™¨çš„æ—¶é’Ÿå¿…é¡»ä¿æŒä¸€è‡´ï¼ˆå…è®¸æœ€å¤š5</strong>ç§’çš„æ—¶é’Ÿåå·®ï¼‰</li>
<li>æµ‹è¯•ç¯å¢ƒä¹Ÿå¯ä»¥ä»…é€‚ç”¨ä¸€ä¸ª BE è¿›è¡Œæµ‹è¯•ã€‚å®é™…ç”Ÿäº§ç¯å¢ƒï¼ŒBE å®ä¾‹æ•°é‡ç›´æ¥å†³å®šäº†æ•´ä½“æŸ¥è¯¢å»¶è¿Ÿã€‚</li>
<li>æ‰€æœ‰éƒ¨ç½²èŠ‚ç‚¹å…³é—­ Swapã€‚</li>
<li>Follower çš„æ•°é‡<strong>å¿…é¡»</strong>ä¸ºå¥‡æ•°ï¼Œè‡³å°‘ä¸º1ï¼ŒObserver æ•°é‡éšæ„ã€‚</li>
<li><strong>å¦‚æœ FE å’Œ BE æ··éƒ¨ï¼Œéœ€æ³¨æ„èµ„æºç«äº‰é—®é¢˜ï¼Œå¹¶ä¿è¯å…ƒæ•°æ®ç›®å½•å’Œæ•°æ®ç›®å½•åˆ†å±ä¸åŒç£ç›˜ã€‚</strong></li>
</ul>
</blockquote>
<h3 id="3ç½‘ç»œè§„åˆ’">3ã€ç½‘ç»œè§„åˆ’</h3>
<p>Doris å„ä¸ªå®ä¾‹ç›´æ¥é€šè¿‡ç½‘ç»œè¿›è¡Œé€šè®¯ã€‚</p>
<table>
<thead>
<tr>
<th>å®ä¾‹</th>
<th>ç«¯å£åç§°</th>
<th>ç«¯å£</th>
<th>é€šè®¯æ–¹å‘</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>BE</td>
<td>be_port</td>
<td>9060</td>
<td>FE &ndash;&gt; BE</td>
<td>BE ä¸Š thrift server çš„ç«¯å£ï¼Œç”¨äºæ¥æ”¶æ¥è‡ª FE çš„è¯·æ±‚</td>
</tr>
<tr>
<td>BE</td>
<td>webserver_port</td>
<td>8040</td>
<td>BE &lt;&ndash;&gt; BE</td>
<td>BE ä¸Šçš„ http server çš„ç«¯å£</td>
</tr>
<tr>
<td>BE</td>
<td>heartbeatport</td>
<td>9050</td>
<td>FE &ndash;&gt; BE</td>
<td>BE ä¸Šå¿ƒè·³æœåŠ¡ç«¯å£ï¼ˆthriftï¼‰ï¼Œç”¨äºæ¥æ”¶æ¥è‡ª FE çš„å¿ƒè·³</td>
</tr>
<tr>
<td>BE</td>
<td>brpc_port</td>
<td>8060</td>
<td>FE &lt;&ndash;&gt; BE, BE &lt;&ndash;&gt; BE</td>
<td>BE ä¸Šçš„ brpc ç«¯å£ï¼Œç”¨äº BE ä¹‹é—´é€šè®¯</td>
</tr>
<tr>
<td>FE</td>
<td>http_port</td>
<td>8030</td>
<td>FE &lt;&ndash;&gt; FEï¼Œç”¨æˆ· &lt;&ndash;&gt; FE</td>
<td>FE ä¸Šçš„ http server ç«¯å£</td>
</tr>
<tr>
<td>FE</td>
<td>rpc_port</td>
<td>9020</td>
<td>BE &ndash;&gt; FE, FE &lt;&ndash;&gt; FE</td>
<td>FE ä¸Šçš„ thrift server ç«¯å£ï¼Œæ¯ä¸ªfeçš„é…ç½®éœ€è¦ä¿æŒä¸€è‡´</td>
</tr>
<tr>
<td>FE</td>
<td>query_port</td>
<td>9030</td>
<td>ç”¨æˆ· &lt;&ndash;&gt; FE</td>
<td>FE ä¸Šçš„ mysql server ç«¯å£</td>
</tr>
<tr>
<td>FE</td>
<td>edit_log_port</td>
<td>9010</td>
<td>FE &lt;&ndash;&gt; FE</td>
<td>FE ä¸Šçš„ bdbje ä¹‹é—´é€šä¿¡ç”¨çš„ç«¯å£</td>
</tr>
<tr>
<td>Broker</td>
<td>broker_ipc_port</td>
<td>8000</td>
<td>FE &ndash;&gt; Broker, BE &ndash;&gt; Broker</td>
<td>Broker ä¸Šçš„ thrift serverï¼Œç”¨äºæ¥æ”¶è¯·æ±‚</td>
</tr>
</tbody>
</table>
<h3 id="4æœåŠ¡å™¨é…ç½®">4ã€æœåŠ¡å™¨é…ç½®</h3>
<p>ä½œä¸ºæµ‹è¯•ï¼ŒæœåŠ¡å™¨ç›¸å…³é…ç½®å¦‚ä¸‹ï¼š</p>
<ul>
<li>æœåŠ¡å™¨ï¼š4C/8G</li>
<li>IPåœ°å€ï¼š192.168.1.107</li>
<li>æ“ä½œç³»ç»Ÿï¼šCentos 7.9</li>
<li>JDKç‰ˆæœ¬ï¼šOpenJDK 1.8</li>
<li>æ“ä½œç”¨æˆ·ï¼šroot</li>
</ul>
<h2 id="äºŒå•æœºéƒ¨ç½²">äºŒã€å•æœºéƒ¨ç½²</h2>
<h3 id="1ç³»ç»Ÿè®¾ç½®">1ã€ç³»ç»Ÿè®¾ç½®</h3>
<ul>
<li>è®¾ç½®ç³»ç»Ÿæœ€å¤§æ‰“å¼€æ–‡ä»¶å¥æŸ„æ•°</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Bash" data-lang="Bash"><span class="line"><span class="cl">cat &gt;&gt; /etc/security/limits.conf<span class="s">&lt;&lt;EOF
</span></span></span><span class="line"><span class="cl"><span class="s">*       soft    nproc   131072
</span></span></span><span class="line"><span class="cl"><span class="s">*       hard    nproc   131072
</span></span></span><span class="line"><span class="cl"><span class="s">*       soft    nofile  131072
</span></span></span><span class="line"><span class="cl"><span class="s">*       hard    nofile  131072
</span></span></span><span class="line"><span class="cl"><span class="s">root    soft    nproc   131072
</span></span></span><span class="line"><span class="cl"><span class="s">root    hard    nproc   131072
</span></span></span><span class="line"><span class="cl"><span class="s">root    soft    nofile  131072
</span></span></span><span class="line"><span class="cl"><span class="s">root    hard    nofile  131072
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span></code></pre></div><ul>
<li>è®¾ç½®æ—¶é’ŸåŒæ­¥</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Bash" data-lang="Bash"><span class="line"><span class="cl"><span class="c1"># è®¾ç½®æ—¶é’ŸåŒæ­¥</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">yum erase -y ntp
</span></span><span class="line"><span class="cl">yum install -y chrony
</span></span><span class="line"><span class="cl">sed -i -e <span class="s1">&#39;/^server/d&#39;</span> /etc/chrony.conf
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;server ntp1.aliyun.com iburst&#34;</span> &gt;&gt; /etc/chrony.conf
</span></span><span class="line"><span class="cl">egrep -v <span class="s2">&#34;^#|^</span>$<span class="s2">&#34;</span> /etc/chrony.conf 
</span></span><span class="line"><span class="cl">systemctl start chronyd <span class="o">&amp;&amp;</span> systemctl <span class="nb">enable</span> chronyd
</span></span><span class="line"><span class="cl">ss -tulp <span class="p">|</span> grep chronyd
</span></span><span class="line"><span class="cl">chronyc tracking
</span></span><span class="line"><span class="cl">chronyc sources
</span></span><span class="line"><span class="cl">chronyc sourcestats
</span></span></code></pre></div><ul>
<li>å…³é—­äº¤æ¢åˆ†åŒº</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Bash" data-lang="Bash"><span class="line"><span class="cl">sysctl -w vm.swappiness<span class="o">=</span><span class="m">0</span> &gt;/dev/null
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> vm.swappiness <span class="o">=</span> <span class="m">0</span> &gt;&gt; /etc/sysctl.conf
</span></span><span class="line"><span class="cl">swapoff -a <span class="o">&amp;&amp;</span> sed -i <span class="s1">&#39;/swap/s/^/#/&#39;</span> /etc/fstab
</span></span></code></pre></div><ul>
<li>Liunxæ–‡ä»¶ç³»ç»Ÿã€‚åœ¨å®‰è£…æ“ä½œç³»ç»Ÿçš„æ—¶å€™ï¼Œè¯·é€‰æ‹©ext4æ–‡ä»¶ç³»ç»Ÿ</li>
</ul>
<h3 id="2å®‰è£…jdk">2ã€å®‰è£…jdk</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Bash" data-lang="Bash"><span class="line"><span class="cl">yum install -y java-1.8.0-openjdk java-1.8.0-openjdk-devel
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">cat <span class="s">&lt;&lt; EOF | sudo tee -a /etc/profile
</span></span></span><span class="line"><span class="cl"><span class="s">export JAVA_HOME=/usr/lib/jvm/java
</span></span></span><span class="line"><span class="cl"><span class="s">export CLASSPATH=.:\$JAVA_HOME/lib:\$JAVA_HOME/jre/lib:\$CLASSPATH
</span></span></span><span class="line"><span class="cl"><span class="s">export PATH=\$JAVA_HOME/bin:\$JAVA_HOME/jre/bin:\$PATH
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">source</span> /etc/profile
</span></span></code></pre></div><h3 id="3ä¸‹è½½å®‰è£…åŒ…">3ã€ä¸‹è½½å®‰è£…åŒ…</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Bash" data-lang="Bash"><span class="line"><span class="cl">wget https://mirrors.aliyun.com/apache/doris/1.1/1.1.1-rc03/apache-doris-1.1.1-bin-x86.tar.gz
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">tar zxvf apache-doris-1.1.1-bin-x86.tar.gz
</span></span><span class="line"><span class="cl">mv apache-doris-1.1.1-bin-x86 /opt/doris
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> /opt/doris
</span></span></code></pre></div><h3 id="4é…ç½®-fe-å’Œ-be">4ã€é…ç½® FE å’Œ BE</h3>
<blockquote>
<p>æ³¨æ„ï¼š</p>
<p>FE å’Œ BE æ˜¯æ··åˆéƒ¨ç½²åœ¨ä¸€å°æœåŠ¡å™¨ä¸Šæ—¶ï¼Œæ•°æ®ç›®å½•éœ€è¦ä½¿ç”¨ä¸åŒçš„ç£ç›˜ã€‚</p>
</blockquote>
<p>ä¿®æ”¹ FEï¼Œåšå‡ºä»¥ä¸‹é…ç½®ï¼š</p>
<ul>
<li>è®¾ç½®ç½‘ç»œ</li>
<li>è®¾ç½®å…ƒæ•°æ®ç›®å½•<code>meta_dir</code>ã€‚é»˜è®¤å€¼ä¸º <code>${DORIS_HOME}/doris-meta</code>ï¼Œéœ€<strong>æ‰‹åŠ¨åˆ›å»º</strong>è¯¥ç›®å½•ã€‚<strong>æ³¨æ„ï¼šç”Ÿäº§ç¯å¢ƒå¼ºçƒˆå»ºè®®å•ç‹¬æŒ‡å®šç›®å½•ä¸è¦æ”¾åœ¨Doriså®‰è£…ç›®å½•ä¸‹ï¼Œæœ€å¥½æ˜¯</strong>å•ç‹¬çš„ç£ç›˜ï¼ˆå¦‚æœæœ‰SSDæœ€å¥½ï¼‰ï¼Œæµ‹è¯•<strong>å¼€å‘</strong>ç¯å¢ƒå¯ä»¥ä½¿ç”¨é»˜è®¤<strong>é…ç½®</strong>ã€‚</li>
<li>æ•°æ®åº“è¡¨åæ”¯æŒå°å†™</li>
<li>æ”¯æŒå¯¼å‡ºæ•°æ®åˆ°æœ¬åœ°ç›®å½•</li>
<li>fe.conf ä¸­ JAVA_OPTS é»˜è®¤ java æœ€å¤§å †å†…å­˜ä¸º 4GBï¼Œ<strong>å»ºè®®ç”Ÿäº§ç¯å¢ƒè°ƒæ•´è‡³ 8G ä»¥ä¸Š</strong></li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Bash" data-lang="Bash"><span class="line"><span class="cl">sed -i -e <span class="s1">&#39;/^priority_networks/d&#39;</span> fe/conf/fe.conf
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">mkdir /meta
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">cat &gt;&gt; fe/conf/fe.conf <span class="s">&lt;&lt;EOF
</span></span></span><span class="line"><span class="cl"><span class="s">priority_networks=192.168.1.0/24
</span></span></span><span class="line"><span class="cl"><span class="s">meta_dir=/meta
</span></span></span><span class="line"><span class="cl"><span class="s">lower_case_table_names=1
</span></span></span><span class="line"><span class="cl"><span class="s">enable_outfile_to_local=true
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span></code></pre></div><p>ä¿®æ”¹ BEï¼Œåšå‡ºä»¥ä¸‹é…ç½®ï¼š</p>
<ul>
<li>è®¾ç½®ç½‘ç»œã€‚</li>
<li>è®¾ç½®æ•°æ®å­˜å‚¨æ ¹ç›®å½•<code>storage_root_path</code>ã€‚é»˜è®¤åœ¨be/storageä¸‹ï¼Œéœ€è¦<strong>æ‰‹åŠ¨åˆ›å»º</strong>è¯¥ç›®å½•ã€‚å¤šä¸ªè·¯å¾„ä¹‹é—´ä½¿ç”¨è‹±æ–‡çŠ¶æ€çš„åˆ†å·åˆ†éš”ã€‚</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Bash" data-lang="Bash"><span class="line"><span class="cl">sed -i -e <span class="s1">&#39;/^priority_networks/d&#39;</span> be/conf/be.conf
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">mkdir /data/doris
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">cat &gt;&gt; be/conf/be.conf <span class="s">&lt;&lt;EOF
</span></span></span><span class="line"><span class="cl"><span class="s">priority_networks=192.168.1.0/24
</span></span></span><span class="line"><span class="cl"><span class="s">storage_root_path=/data/doris
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span></code></pre></div><h3 id="5å¯åŠ¨-fe-å’Œ-be">5ã€å¯åŠ¨ FE å’Œ BE</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Bash" data-lang="Bash"><span class="line"><span class="cl">fe/bin/start_fe.sh --daemon
</span></span><span class="line"><span class="cl">be/bin/start_be.sh --daemon
</span></span></code></pre></div><blockquote>
<p>æ³¨æ„ï¼š</p>
<p><strong>åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œæ‰€æœ‰å®ä¾‹éƒ½åº”ä½¿ç”¨å®ˆæŠ¤è¿›ç¨‹å¯åŠ¨ï¼Œä»¥ä¿è¯è¿›ç¨‹é€€å‡ºåï¼Œä¼šè¢«è‡ªåŠ¨æ‹‰èµ·ã€‚</strong></p>
<p>å‚è€ƒæ–‡ç« ï¼š<a href="https://www.cnblogs.com/lenmom/p/9973401.html">Apache Dorisé€šè¿‡supervisorè¿›è¡Œè¿›ç¨‹ç®¡ç† - è€è‘£ - åšå®¢å›­</a></p>
</blockquote>
<p>å¯ä»¥é€šè¿‡å¦‚ä¸‹é“¾æ¥æŸ¥çœ‹ FE æ˜¯å¦å¯åŠ¨æˆåŠŸï¼šhttp://192.168.1.107:8030/api/bootstrap</p>
<p>é€šè¿‡å¦‚ä¸‹é“¾æ¥æŸ¥çœ‹ BE æ˜¯å¦å¯åŠ¨æˆåŠŸï¼šhttp://192.168.1.107:8040/api/health</p>
<h3 id="6å®‰è£…-mysql-å®¢æˆ·ç«¯">6ã€å®‰è£… MySql å®¢æˆ·ç«¯</h3>
<p>é€‰æ‹©ä¸€å°æœåŠ¡å™¨ï¼Œå®‰è£… mysql 8 å®¢æˆ·ç«¯ï¼Œè¿™é‡Œæˆ‘æ˜¯åœ¨ 192.168.1.107 ä¸Šå®‰è£…ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Bash" data-lang="Bash"><span class="line"><span class="cl">wget https://dev.mysql.com/get/mysql80-community-release-el7-1.noarch.rpm
</span></span><span class="line"><span class="cl">yum localinstall mysql80-community-release-el7-1.noarch.rpm
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">yum repolist all <span class="p">|</span> grep mysql
</span></span><span class="line"><span class="cl">yum repolist enabled <span class="p">|</span> grep mysql
</span></span><span class="line"><span class="cl">yum install yum-utils -y
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">yum-config-manager --enable mysql80-community
</span></span><span class="line"><span class="cl">yum-config-manager --disable mysql57-community
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">rpm --import https://repo.mysql.com/RPM-GPG-KEY-mysql-2022
</span></span><span class="line"><span class="cl">yum install mysql-community-client -y
</span></span></code></pre></div><h3 id="7åœ¨-fe-ä¸Šæ·»åŠ -be-èŠ‚ç‚¹">7ã€åœ¨ FE ä¸Šæ·»åŠ  BE èŠ‚ç‚¹</h3>
<p>åœ¨ 192.168.1.107 èŠ‚ç‚¹è¿æ¥ FEï¼Œå¹¶ä¸”æ³¨å†Œ BE èŠ‚ç‚¹</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Bash" data-lang="Bash"><span class="line"><span class="cl">mysql -h 192.168.1.107 -P <span class="m">9030</span> -uroot
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">ALTER SYSTEM ADD BACKEND <span class="s2">&#34;192.168.1.107:9050&#34;</span><span class="p">;</span>
</span></span></code></pre></div><h3 id="8è®¿é—®-web-ui">8ã€è®¿é—® Web UI</h3>
<p>FE èŠ‚ç‚¹Web UIï¼šhttp://192.168.1.107:8030</p>
<p>BE èŠ‚ç‚¹Web UIï¼šhttp://192.168.1.107:8040</p>
<h3 id="9mysql-å®¢æˆ·ç«¯è®¿é—®">9ã€MySQL å®¢æˆ·ç«¯è®¿é—®</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-SQL" data-lang="SQL"><span class="line"><span class="cl"><span class="n">mysql</span><span class="w"> </span><span class="o">-</span><span class="n">h</span><span class="w"> </span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">107</span><span class="w"> </span><span class="o">-</span><span class="n">P</span><span class="w"> </span><span class="mi">9030</span><span class="w"> </span><span class="o">-</span><span class="n">uroot</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">&gt;</span><span class="w"> </span><span class="k">SHOW</span><span class="w"> </span><span class="n">DATABASES</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">&gt;</span><span class="w"> </span><span class="k">CREATE</span><span class="w"> </span><span class="k">DATABASE</span><span class="w"> </span><span class="n">example_db</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">&gt;</span><span class="w"> </span><span class="n">USE</span><span class="w"> </span><span class="n">example_db</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">#</span><span class="w"> </span><span class="err">æŸ¥çœ‹</span><span class="n">BE</span><span class="err">çŠ¶æ€</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">&gt;</span><span class="w"> </span><span class="k">SHOW</span><span class="w"> </span><span class="n">PROC</span><span class="w"> </span><span class="s1">&#39;/backends&#39;</span><span class="w">
</span></span></span></code></pre></div><h2 id="ä¸‰é›†ç¾¤éƒ¨ç½²">ä¸‰ã€é›†ç¾¤éƒ¨ç½²</h2>
<p>FE è§’è‰²ï¼š</p>
<ul>
<li>Followerï¼šæ‰€æœ‰ Follower è§’è‰²çš„ FE èŠ‚ç‚¹ä¼šç»„æˆä¸€ä¸ªå¯é€‰æ‹©ç»„ï¼Œç»„å†…é€‰æ‹©å‡ºä¸€ä¸ª master æˆ–è€…å«åš leaderã€‚å½“ Master æŒ‚äº†ï¼Œä¼šè‡ªåŠ¨é€‰æ‹©æ–°çš„ Follower ä½œä¸º Masterã€‚</li>
<li>Observerï¼šObserverä»…ä»…ä½œä¸ºè§‚å¯Ÿè€…æ¥åŒæ­¥å·²ç»æˆåŠŸå†™å…¥çš„å…ƒæ•°æ®æ—¥å¿—ï¼Œå¹¶ä¸”æä¾›å…ƒæ•°æ®è¯»æœåŠ¡ã€‚ä»–ä¸ä¼šå‚ä¸å¤šæ•°å†™çš„é€»è¾‘ã€‚Observer ä¹Ÿä¸ä¼šå‚ä¸é€‰ä¸¾ã€‚</li>
</ul>
<p>é€šå¸¸æƒ…å†µä¸‹ï¼Œå¯ä»¥éƒ¨ç½² 1 Follower + 2 Observer æˆ–è€… 3 Follower + N Observerã€‚å‰è€…è¿ç»´ç®€å•ï¼Œå‡ ä¹ä¸ä¼šå‡ºç° Follower ä¹‹é—´çš„ä¸€è‡´æ€§åè®®å¯¼è‡´è¿™ç§å¤æ‚é”™è¯¯æƒ…å†µï¼ˆä¼ä¸šå¤§å¤šä½¿ç”¨è¿™ç§æ–¹å¼ï¼‰ã€‚åè€…å¯ä»¥ä¿è¯å…ƒæ•°æ®å†™çš„é«˜å¯ç”¨ï¼Œå¦‚æœæ˜¯é«˜å¹¶å‘æŸ¥è¯¢åœºæ™¯ï¼Œå¯ä»¥é€‚å½“å¢åŠ  Observerã€‚</p>
<h3 id="1åœ¨å…¶ä»–æœåŠ¡å™¨ä¸Šå®‰è£…-doris">1ã€åœ¨å…¶ä»–æœåŠ¡å™¨ä¸Šå®‰è£… doris</h3>
<p>é›†ç¾¤ä¸‰ä¸ªèŠ‚ç‚¹ï¼š</p>
<ul>
<li>192.168.1.107 FEï¼ˆmaster followerï¼‰ã€BE</li>
<li>192.168.1.108 FEï¼ˆfollowerï¼‰ã€BE</li>
<li>192.168.1.109 FEï¼ˆfollowerï¼‰ã€BE</li>
</ul>
<p>åœ¨é›†ç¾¤æ¯ä¸ªèŠ‚ç‚¹é…ç½® hostsï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">192.168.1.107 doris-01
</span></span><span class="line"><span class="cl">192.168.1.108 doris-02
</span></span><span class="line"><span class="cl">192.168.1.109 doris-03
</span></span></code></pre></div><p>å‚è€ƒå•æœºéƒ¨ç½²æ­¥éª¤ï¼Œåœ¨å…¶ä»–æœåŠ¡å™¨ä¸Šå®‰è£… doris ã€‚</p>
<h3 id="2å¯åŠ¨-be">2ã€å¯åŠ¨ BE</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Bash" data-lang="Bash"><span class="line"><span class="cl">be/bin/start_be.sh --daemon
</span></span></code></pre></div><h3 id="3fe-æ‰©å®¹">3ã€FE æ‰©å®¹</h3>
<p>é€šè¿‡ mysql å®¢æˆ·ç«¯ç™»é™† Master FE ä¹Ÿå°±æ˜¯ 192.168.1.107</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Bash" data-lang="Bash"><span class="line"><span class="cl">mysql -h 192.168.1.107 -P <span class="m">9030</span> -uroot
</span></span></code></pre></div><p>æŸ¥çœ‹ FE èŠ‚ç‚¹æƒ…å†µï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Bash" data-lang="Bash"><span class="line"><span class="cl">mysql&gt; SHOW PROC <span class="s1">&#39;/frontends&#39;</span><span class="p">;</span>
</span></span></code></pre></div><p>ä¹Ÿå¯ä»¥é€šè¿‡ http://192.168.1.107:8030/System?path=//frontends æŸ¥çœ‹</p>
<p><img src="https://chensoul.oss-cn-hangzhou.aliyuncs.com/images/doris-fe-web.jpg" alt="img"></p>
<p>åœ¨ 192.168.1.108 å’Œ  192.168.1.109 èŠ‚ç‚¹ä¸Šå¯åŠ¨ FE ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Bash" data-lang="Bash"><span class="line"><span class="cl">fe/bin/start_fe.sh --helper 192.168.1.107:9010 --daemon
</span></span></code></pre></div><blockquote>
<p>æ³¨æ„ï¼š</p>
<p>ç¬¬ä¸€æ¬¡å¯åŠ¨éœ€è¦æŒ‡å®š <code>--helper</code>ï¼Œä¹‹åä¸éœ€è¦ã€‚</p>
</blockquote>
<p>ç„¶åï¼Œç™»é™† Master FEï¼Œæ·»åŠ  FE åˆ°é›†ç¾¤ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Bash" data-lang="Bash"><span class="line"><span class="cl">mysql -h 192.168.1.107 -P <span class="m">9030</span> -uroot
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">ALTER SYSTEM ADD FOLLOWER  <span class="s2">&#34;192.168.1.108:9010&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">ALTER SYSTEM ADD FOLLOWER  <span class="s2">&#34;192.168.1.109:9010&#34;</span><span class="p">;</span>
</span></span></code></pre></div><p>æŸ¥çœ‹ FE çŠ¶æ€</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Bash" data-lang="Bash"><span class="line"><span class="cl">SHOW PROC <span class="s1">&#39;/frontends&#39;</span><span class="p">;</span>
</span></span></code></pre></div><h3 id="4åœ¨-fe-ä¸­æ·»åŠ -be-èŠ‚ç‚¹">4ã€åœ¨ FE ä¸­æ·»åŠ  BE èŠ‚ç‚¹</h3>
<p>ç™»é™† Master FEï¼Œæ³¨å†Œ BE èŠ‚ç‚¹</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Bash" data-lang="Bash"><span class="line"><span class="cl">mysql -h 192.168.1.107 -P <span class="m">9030</span> -uroot
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">ALTER SYSTEM ADD BACKEND <span class="s2">&#34;192.168.1.107:9050&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">ALTER SYSTEM ADD BACKEND <span class="s2">&#34;192.168.1.108:9050&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">ALTER SYSTEM ADD BACKEND <span class="s2">&#34;192.168.1.109:9050&#34;</span><span class="p">;</span>
</span></span></code></pre></div><p>æŸ¥çœ‹BEçŠ¶æ€</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Bash" data-lang="Bash"><span class="line"><span class="cl">SHOW PROC <span class="s1">&#39;/backends&#39;</span><span class="p">;</span>
</span></span></code></pre></div><h3 id="5åœæ­¢-fe-å’Œ-be">5ã€åœæ­¢ FE å’Œ BE</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Bash" data-lang="Bash"><span class="line"><span class="cl">fe/bin/stop_fe.sh
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">be/bin/stop_be.sh
</span></span></code></pre></div><h3 id="6é‡æ–°åˆå§‹åŒ–é›†ç¾¤">6ã€é‡æ–°åˆå§‹åŒ–é›†ç¾¤</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Bash" data-lang="Bash"><span class="line"><span class="cl"><span class="nb">cd</span> /opt/doris
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">fe/bin/stop_fe.sh
</span></span><span class="line"><span class="cl">be/bin/stop_be.sh
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">rm -rf /meta/* /data/doris/*
</span></span><span class="line"><span class="cl">mkdir -p /meta /data/doris
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># FE master</span>
</span></span><span class="line"><span class="cl">fe/bin/start_fe.sh --daemon
</span></span><span class="line"><span class="cl">be/bin/start_be.sh --daemon
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># FE follwer</span>
</span></span><span class="line"><span class="cl">fe/bin/start_fe.sh --helper 192.168.1.107:9010 --daemon
</span></span><span class="line"><span class="cl">be/bin/start_be.sh --daemon
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">mysql -h 192.168.1.107 -P <span class="m">9030</span> -uroot
</span></span><span class="line"><span class="cl">ALTER SYSTEM ADD BACKEND <span class="s2">&#34;192.168.1.107:9050&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">ALTER SYSTEM ADD BACKEND <span class="s2">&#34;192.168.1.108:9050&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">ALTER SYSTEM ADD BACKEND <span class="s2">&#34;192.168.1.109:9050&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">ALTER SYSTEM ADD FOLLOWER  <span class="s2">&#34;192.168.1.108:9010&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">ALTER SYSTEM ADD FOLLOWER  <span class="s2">&#34;192.168.1.109:9010&#34;</span><span class="p">;</span>
</span></span></code></pre></div><h2 id="å››æ€»ç»“">å››ã€æ€»ç»“</h2>
<p>å®‰è£… doris å®Œæ•´å®‰è£…è„šæœ¬å¦‚ä¸‹ï¼Œä½ å¯ä»¥æŒ‰ç…§ä½ çš„éœ€æ±‚è¿›è¡Œä¿®æ”¹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Bash" data-lang="Bash"><span class="line"><span class="cl">cat &gt;&gt; /etc/security/limits.conf<span class="s">&lt;&lt;EOF
</span></span></span><span class="line"><span class="cl"><span class="s">*       soft    nproc   131072
</span></span></span><span class="line"><span class="cl"><span class="s">*       hard    nproc   131072
</span></span></span><span class="line"><span class="cl"><span class="s">*       soft    nofile  131072
</span></span></span><span class="line"><span class="cl"><span class="s">*       hard    nofile  131072
</span></span></span><span class="line"><span class="cl"><span class="s">root    soft    nproc   131072
</span></span></span><span class="line"><span class="cl"><span class="s">root    hard    nproc   131072
</span></span></span><span class="line"><span class="cl"><span class="s">root    soft    nofile  131072
</span></span></span><span class="line"><span class="cl"><span class="s">root    hard    nofile  131072
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è®¾ç½®æ—¶é’ŸåŒæ­¥</span>
</span></span><span class="line"><span class="cl">yum erase -y ntp
</span></span><span class="line"><span class="cl">yum install -y chrony
</span></span><span class="line"><span class="cl">sed -i -e <span class="s1">&#39;/^server/d&#39;</span> /etc/chrony.conf
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;server ntp1.aliyun.com iburst&#34;</span> &gt;&gt; /etc/chrony.conf
</span></span><span class="line"><span class="cl">egrep -v <span class="s2">&#34;^#|^</span>$<span class="s2">&#34;</span> /etc/chrony.conf 
</span></span><span class="line"><span class="cl">systemctl start chronyd <span class="o">&amp;&amp;</span> systemctl <span class="nb">enable</span> chronyd
</span></span><span class="line"><span class="cl">ss -tulp <span class="p">|</span> grep chronyd
</span></span><span class="line"><span class="cl">chronyc tracking
</span></span><span class="line"><span class="cl">chronyc sources
</span></span><span class="line"><span class="cl">chronyc sourcestats
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å®‰è£… JDK </span>
</span></span><span class="line"><span class="cl">yum install -y java-1.8.0-openjdk java-1.8.0-openjdk-devel
</span></span><span class="line"><span class="cl">cat <span class="s">&lt;&lt; EOF | sudo tee -a /etc/profile
</span></span></span><span class="line"><span class="cl"><span class="s">export JAVA_HOME=/usr/lib/jvm/java
</span></span></span><span class="line"><span class="cl"><span class="s">export CLASSPATH=.:\$JAVA_HOME/lib:\$JAVA_HOME/jre/lib:\$CLASSPATH
</span></span></span><span class="line"><span class="cl"><span class="s">export PATH=\$JAVA_HOME/bin:\$JAVA_HOME/jre/bin:\$PATH
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span><span class="line"><span class="cl"><span class="nb">source</span> /etc/profile
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">wget https://mirrors.aliyun.com/apache/doris/1.1/1.1.1-rc03/apache-doris-1.1.1-bin-x86.tar.gz
</span></span><span class="line"><span class="cl">tar zxvf apache-doris-1.1.1-bin-x86.tar.gz
</span></span><span class="line"><span class="cl">mv apache-doris-1.1.1-bin-x86 /opt/doris
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> /opt/doris
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">sed -i -e <span class="s1">&#39;/^priority_networks/d&#39;</span> fe/conf/fe.conf
</span></span><span class="line"><span class="cl">mkdir /meta
</span></span><span class="line"><span class="cl">cat &gt;&gt; fe/conf/fe.conf <span class="s">&lt;&lt;EOF
</span></span></span><span class="line"><span class="cl"><span class="s">priority_networks=192.168.1.0/24
</span></span></span><span class="line"><span class="cl"><span class="s">meta_dir=/meta
</span></span></span><span class="line"><span class="cl"><span class="s">lower_case_table_names=1
</span></span></span><span class="line"><span class="cl"><span class="s">enable_outfile_to_local=true
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">sed -i -e <span class="s1">&#39;/^priority_networks/d&#39;</span> be/conf/be.conf
</span></span><span class="line"><span class="cl">mkdir /data/doris
</span></span><span class="line"><span class="cl">cat &gt;&gt; be/conf/be.conf <span class="s">&lt;&lt;EOF
</span></span></span><span class="line"><span class="cl"><span class="s">priority_networks=192.168.1.0/24
</span></span></span><span class="line"><span class="cl"><span class="s">storage_root_path=/data/doris
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">fe/bin/start_fe.sh --daemon
</span></span><span class="line"><span class="cl">be/bin/start_be.sh --daemon
</span></span></code></pre></div>]]></content:encoded></item><item><title>Linuxè®¾ç½®æ—¶é’ŸåŒæ­¥</title><link>https://blog.chensoul.com/posts/2022/08/16/config-ntp-on-linux/</link><pubDate>Tue, 16 Aug 2022 10:13:42 +0800</pubDate><guid>https://blog.chensoul.com/posts/2022/08/16/config-ntp-on-linux/</guid><description>NTP æ˜¯ Network Time Protocol çš„ç¼©å†™ï¼Œä¹Ÿå³ç½‘ç»œæ—¶é—´åè®®ï¼Œä¸€ç§åœ¨ Linux ä¸Šä¿æŒå‡†ç¡®æ—¶é—´çš„åè®®ï¼Œå®ƒå’Œç½‘ç»œä¸Šå¯ç”¨çš„ NTP æœåŠ¡å™¨ä¿æŒç€æ—¶é’ŸåŒæ­¥ã€‚ ç”¨äºåŒæ­¥æ—¥æœŸå’Œæ—¶é—´çš„ ntpd æœåŠ¡ï¼Œåœ¨æ–°çš„</description><content:encoded><![CDATA[<p>NTP æ˜¯ Network Time Protocol çš„ç¼©å†™ï¼Œä¹Ÿå³ç½‘ç»œæ—¶é—´åè®®ï¼Œä¸€ç§åœ¨ Linux ä¸Šä¿æŒå‡†ç¡®æ—¶é—´çš„åè®®ï¼Œå®ƒå’Œç½‘ç»œä¸Šå¯ç”¨çš„ NTP æœåŠ¡å™¨ä¿æŒç€æ—¶é’ŸåŒæ­¥ã€‚</p>
<p>ç”¨äºåŒæ­¥æ—¥æœŸå’Œæ—¶é—´çš„ ntpd æœåŠ¡ï¼Œåœ¨æ–°çš„Linuxå‘è¡Œç‰ˆ ( centos8ã€Ubuntu 20.04ã€Fedora 30 ) ä¸­å·²ç»åºŸå¼ƒäº†ï¼Œå–è€Œä»£ä¹‹çš„æ˜¯ chronyã€‚</p>
<p>Chrony å’Œ NTP çš„åŒºåˆ«å¦‚ä¸‹ï¼š</p>
<table>
<thead>
<tr>
<th><code>ntp name</code></th>
<th><code>chrony name</code></th>
</tr>
</thead>
<tbody>
<tr>
<td>/etc/ntp.conf</td>
<td>/etc/chrony.conf</td>
</tr>
<tr>
<td>/etc/ntp/keys</td>
<td>/etc/chrony.keys</td>
</tr>
<tr>
<td>ntpd</td>
<td>chronyd</td>
</tr>
<tr>
<td>ntpq</td>
<td>chronyc</td>
</tr>
<tr>
<td>ntpd.service</td>
<td>chronyd.service</td>
</tr>
<tr>
<td>ntp-wait.service</td>
<td>chrony-wait.service</td>
</tr>
</tbody>
</table>
<h2 id="ntp">NTP</h2>
<h3 id="1å®‰è£…-ntp-æœåŠ¡">1ã€å®‰è£… NTP æœåŠ¡</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">yum install -y ntp
</span></span></code></pre></div><p>æ¥ä¸‹æ¥å¯ä»¥ä½¿ç”¨ ntpdate å‘½ä»¤æ¥æ›´æ–°æ—¶é—´ï¼Œæ¯”å¦‚ï¼Œåœ¨è”ç½‘ç¯å¢ƒä¸‹ï¼Œå¯ä»¥é€šè¿‡ç½‘ç»œä¸Šçš„æ ¡æ—¶æœåŠ¡å™¨æ¥åŒæ­¥æ—¶é—´ã€‚</p>
<p>å¸¸è§çš„æ ¡æ—¶æœåŠ¡å™¨ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># å›½å®¶æˆæ—¶ä¸­å¿ƒ</span>
</span></span><span class="line"><span class="cl">210.72.145.44
</span></span><span class="line"><span class="cl"><span class="c1"># é˜¿é‡Œäº‘</span>
</span></span><span class="line"><span class="cl">ntp.aliyun.com
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">s1a.time.edu.cn <span class="c1">#åŒ—äº¬é‚®ç”µå¤§å­¦</span>
</span></span><span class="line"><span class="cl">s1b.time.edu.cn <span class="c1">#æ¸…åå¤§å­¦</span>
</span></span><span class="line"><span class="cl">s1c.time.edu.cn <span class="c1">#åŒ—äº¬å¤§å­¦</span>
</span></span><span class="line"><span class="cl">s1d.time.edu.cn <span class="c1">#ä¸œå—å¤§å­¦</span>
</span></span><span class="line"><span class="cl">s1e.time.edu.cn <span class="c1">#æ¸…åå¤§å­¦</span>
</span></span><span class="line"><span class="cl">s2a.time.edu.cn <span class="c1">#æ¸…åå¤§å­¦</span>
</span></span><span class="line"><span class="cl">s2b.time.edu.cn <span class="c1">#æ¸…åå¤§å­¦</span>
</span></span><span class="line"><span class="cl">s2c.time.edu.cn <span class="c1">#åŒ—äº¬é‚®ç”µå¤§å­¦</span>
</span></span><span class="line"><span class="cl">s2d.time.edu.cn <span class="c1">#è¥¿å—åœ°åŒºç½‘ç»œä¸­å¿ƒ</span>
</span></span><span class="line"><span class="cl">s2e.time.edu.cn <span class="c1">#è¥¿åŒ—åœ°åŒºç½‘ç»œä¸­å¿ƒ</span>
</span></span><span class="line"><span class="cl">s2f.time.edu.cn <span class="c1">#ä¸œåŒ—åœ°åŒºç½‘ç»œä¸­å¿ƒ</span>
</span></span><span class="line"><span class="cl">s2g.time.edu.cn <span class="c1">#åä¸œå—åœ°åŒºç½‘ç»œä¸­å¿ƒ</span>
</span></span><span class="line"><span class="cl">s2h.time.edu.cn <span class="c1">#å››å·å¤§å­¦ç½‘ç»œç®¡ç†ä¸­å¿ƒ</span>
</span></span><span class="line"><span class="cl">s2j.time.edu.cn <span class="c1">#å¤§è¿ç†å·¥å¤§å­¦ç½‘ç»œä¸­å¿ƒ</span>
</span></span><span class="line"><span class="cl">s2k.time.edu.cn <span class="c1">#CERNETæ¡‚æ—ä¸»èŠ‚ç‚¹</span>
</span></span><span class="line"><span class="cl">s2m.time.edu.cn <span class="c1">#åŒ—äº¬å¤§å­¦</span>
</span></span><span class="line"><span class="cl">ntp.sjtu.edu.cn <span class="c1">#ä¸Šæµ·äº¤é€šå¤§å­¦</span>
</span></span></code></pre></div><p>ä¸‹é¢æ˜¯é‡‡ç”¨å¾®è½¯çš„æ ¡æ—¶æœåŠ¡å™¨è°ƒæ•´ç³»ç»Ÿæ—¶é—´</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ntpdate time.windows.com 
</span></span></code></pre></div><h3 id="2å†…ç½‘æ­å»ºæ—¶é’ŸæœåŠ¡å™¨">2ã€å†…ç½‘æ­å»ºæ—¶é’ŸæœåŠ¡å™¨</h3>
<p>å¦‚æœæ˜¯åœ¨å†…ç½‘ä¸èƒ½è¿æ¥å¤–ç½‘ï¼Œåˆ™å¯ä»¥åœ¨å†…ç½‘é€‰æ‹©ä¸€å°æœåŠ¡å™¨ä½œä¸ºæ—¶é’ŸæœåŠ¡å™¨ï¼Œå…¶ä»–æœåŠ¡å™¨éƒ½ä½œä¸ºå®¢æˆ·ç«¯åŒæ­¥è¿™å°æ—¶é’ŸæœåŠ¡å™¨çš„æ—¶é—´ã€‚</p>
<p>ä¿®æ”¹ <code>/etc/ntp.conf</code> é…ç½®ï¼Œæ³¨é‡Šæˆ–è€…åˆ é™¤ <code>server</code> å¼€å¤´çš„é…ç½®ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sed -i <span class="s2">&#34;/^server/ d&#34;</span> /etc/ntp.conf
</span></span></code></pre></div><p>ä½¿ç”¨æœ¬åœ°æ—¶é’Ÿä½œä¸ºntpæœåŠ¡å™¨æ—¶é—´ï¼Œè¿™é‡Œçš„ 127.127.1.0 åœ¨ ntp ä¸­ä»£è¡¨æœ¬æœº</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">cat <span class="s">&lt;&lt; EOF | sudo tee -a /etc/ntp.conf
</span></span></span><span class="line"><span class="cl"><span class="s">server 127.127.1.0
</span></span></span><span class="line"><span class="cl"><span class="s">fudge 127.127.1.0 stratum 10
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span></code></pre></div><p>å¯åŠ¨ ntp æœåŠ¡ï¼Œå¹¶è®¾ç½®å¼€æœºå¯åŠ¨ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">systemctl start ntpd
</span></span><span class="line"><span class="cl">systemctl <span class="nb">enable</span> ntpd
</span></span></code></pre></div><p>é…ç½®å®¢æˆ·ç«¯ã€‚åŒæ ·ï¼Œéœ€è¦å…ˆå®‰è£… ntp æœåŠ¡ï¼Œç„¶åä¿®æ”¹ <code>/etc/ntp.conf</code> æ–‡ä»¶ï¼Œæ³¨é‡Šæˆ–è€…åˆ é™¤ <code>server</code> å¼€å¤´çš„é…ç½®ï¼Œå¹¶æ·»åŠ ä¸€è¡Œï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sed -i <span class="s2">&#34;/^server/ d&#34;</span> /etc/ntp.conf
</span></span><span class="line"><span class="cl">cat <span class="s">&lt;&lt; EOF | sudo tee -a /etc/ntp.conf
</span></span></span><span class="line"><span class="cl"><span class="s">server 192.168.1.107
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span><span class="line"><span class="cl">sudo systemctl start ntpd
</span></span><span class="line"><span class="cl">sudo systemctl <span class="nb">enable</span> ntpd
</span></span><span class="line"><span class="cl">ntpdate -u ntp1.aliyun.com
</span></span><span class="line"><span class="cl">hwclock --systohc
</span></span></code></pre></div><p>å¯åŠ¨ ntp æœåŠ¡ï¼Œå¹¶è®¾ç½®å¼€æœºå¯åŠ¨ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">systemctl start ntpd
</span></span><span class="line"><span class="cl">systemctl <span class="nb">enable</span> ntpd
</span></span></code></pre></div><p>å‘æ—¶é’ŸæœåŠ¡å™¨å‘é€è¯·æ±‚ï¼ŒåŒæ­¥æ—¶é—´</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ntpdate 192.168.1.107
</span></span></code></pre></div><h3 id="3ä½¿ç”¨ç½‘ç»œæ—¶é’ŸæœåŠ¡å™¨">3ã€ä½¿ç”¨ç½‘ç»œæ—¶é’ŸæœåŠ¡å™¨</h3>
<p>å¦‚æœå†…ç½‘æœåŠ¡å™¨å¯ä»¥è”ç½‘ï¼Œåˆ™å¯ä»¥å°†æ‰€æœ‰æœåŠ¡å™¨é…ç½®ä¸ºå®¢æˆ·ç«¯è¿æ¥ç½‘ç»œä¸Šçš„æ—¶é’ŸæœåŠ¡å™¨ã€‚</p>
<p>è¿™é‡Œä½¿ç”¨é˜¿é‡Œäº‘çš„æ—¶é’ŸæœåŠ¡å™¨ï¼Œæ‰€æœ‰æœåŠ¡å™¨ä½œä¸ºå®¢æˆ·ç«¯åŒæ­¥é˜¿é‡Œäº‘çš„æ—¶é’ŸæœåŠ¡å™¨çš„æ—¶é—´ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sed -i <span class="s2">&#34;/^server/ d&#34;</span> /etc/ntp.conf
</span></span><span class="line"><span class="cl">cat <span class="s">&lt;&lt; EOF | sudo tee -a /etc/ntp.conf
</span></span></span><span class="line"><span class="cl"><span class="s">server ntp1.aliyun.com
</span></span></span><span class="line"><span class="cl"><span class="s">server ntp2.aliyun.com
</span></span></span><span class="line"><span class="cl"><span class="s">server ntp3.aliyun.com
</span></span></span><span class="line"><span class="cl"><span class="s">server ntp4.aliyun.com
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span><span class="line"><span class="cl">sudo systemctl start ntpd
</span></span><span class="line"><span class="cl">sudo systemctl <span class="nb">enable</span> ntpd
</span></span><span class="line"><span class="cl">ntpdate -u ntp1.aliyun.com
</span></span></code></pre></div><h3 id="4æŸ¥çœ‹çŠ¶æ€">4ã€æŸ¥çœ‹çŠ¶æ€</h3>
<p>æ£€æµ‹ntpdæœåŠ¡çš„ç«¯å£æƒ…å†µï¼Œé»˜è®¤ç«¯å£æ˜¯123ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ss -tunlp<span class="p">|</span>grep ntp
</span></span></code></pre></div><p>æŸ¥çœ‹ ntp æœåŠ¡å™¨æœ‰æ— å’Œä¸Šå±‚ ntp è¿é€šï¼Œä½¿ç”¨ <code>ntpstat</code> è¡ŒæŸ¥è¯¢</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ntpstat
</span></span></code></pre></div><p><code>ntpq -p</code>å¯ä»¥æŸ¥çœ‹æœ¬åœ°NTPéœ€è¿›è¡ŒåŒæ­¥çš„å…¬ç½‘ NTP æœåŠ¡å™¨çŠ¶æ€ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ntpq -p 
</span></span></code></pre></div><blockquote>
<h6 id="tpq--p-å‚æ•°è¯¦è§£">tpq -p å‚æ•°è¯¦è§£</h6>
<ul>
<li>remote ï¼šæœ¬åœ°ä¸»æœºæ‰€è¿æ¥çš„ä¸Šå±‚NTPæœåŠ¡å™¨ï¼Œæœ€å·¦è¾¹çš„ç¬¦å·å¦‚ä¸‹ï¼š
å¦‚æœæœ‰[*] ä»£è¡¨ç›®å‰æ­£åœ¨ä½¿ç”¨å½“ä¸­çš„ä¸Šå±‚NTPæœåŠ¡å™¨ã€‚
å¦‚æœæœ‰[+] ä»£è¡¨ä¹Ÿæœ‰è¿ä¸Šä¸Šå±‚NTPæœåŠ¡å™¨ï¼Œå¯ä»¥ä½œä¸ºæé«˜æ—¶é—´æ›´æ–°çš„å€™é€‰NTPæœåŠ¡å™¨
å¦‚æœæœ‰[-] ä»£è¡¨åŒæ­¥çš„è¯¥NTPæœåŠ¡å™¨è¢«è®¤ä¸ºæ˜¯ä¸åˆæ ¼çš„NTP Server
å¦‚æœæœ‰<input checked="" disabled="" type="checkbox"> ä»£è¡¨åŒæ­¥çš„å¤–ç½‘NTPæœåŠ¡å™¨ä¸å¯ç”¨</li>
<li>refid  ï¼šæŒ‡çš„æ˜¯ç»™ä¸Šå±‚NTPæœåŠ¡å™¨æä¾›æ—¶é—´æ ¡å¯¹çš„æœåŠ¡å™¨ã€‚</li>
<li>St:ä¸Šå±‚NTPæœåŠ¡å™¨çš„çº§åˆ«</li>
<li>When: ä¸Šä¸€æ¬¡ä¸ä¸Šå±‚NTPæœåŠ¡å™¨è¿›è¡Œæ—¶é—´æ ¡å¯¹çš„æ—¶é—´ï¼ˆå•ä½ï¼šs)</li>
<li>Poll :æœ¬åœ°ä¸»æœºä¸ä¸Šå±‚NTPæœåŠ¡å™¨è¿›è¡Œæ—¶é—´æ ¡å¯¹çš„å‘¨æœŸï¼ˆå•ä½ï¼šsï¼‰</li>
<li>reachï¼šå…«è¿›åˆ¶æ•°ï¼Œè¡¨ç¤ºæœ€è¿‘8æ¬¡æ—¶é’ŸåŒæ­¥åŒ…æ¥æ”¶æƒ…å†µï¼ˆ1è¡¨ç¤ºæ¥æ”¶æˆåŠŸï¼Œ0è¡¨ç¤ºæ¥æ”¶å¤±è´¥ã€‚æ¯æ¥æ”¶ä¸€ä¸ªåŒ…å·¦ç§»ä¸€ä½ã€‚å¯¹äºä¸€ä¸ªè¿è¡Œè¾ƒé•¿æ—¶é—´çš„NTP clientè€Œè¨€ï¼Œè¿™ä¸ªå€¼åº”è¯¥æ˜¯377-&gt;11,111,111ï¼Œå³æœ€è¿‘8æ¬¡åŒ…æ¥æ”¶å‡æˆåŠŸï¼›å¦åˆ™è¡¨ç¤ºæœ‰ä¸¢åŒ…æƒ…å†µå‘ç”Ÿï¼‰</li>
<li>delayï¼šç½‘ç»œä¼ è¾“è¿‡ç¨‹å½“ä¸­å»¶è¿Ÿçš„æ—¶é—´ï¼Œå•ä½ä¸º 10^(-6) ç§’</li>
<li>offsetï¼šæ—¶é—´è¡¥å¿çš„ç»“æœï¼Œå•ä½ä¸º10^(-6) ç§’</li>
<li>jitterï¼šLinux ç³»ç»Ÿæ—¶é—´ä¸ BIOS ç¡¬ä»¶æ—¶é—´çš„å·®å¼‚æ—¶é—´ï¼Œ å•ä½ä¸º 10^(-6) ç§’ã€‚</li>
</ul>
</blockquote>
<p>æ£€æŸ¥åŒæ­¥æ˜¯å¦æˆåŠŸã€‚æŸ¥çœ‹ä¸æ—¶é—´åŒæ­¥æœåŠ¡å™¨çš„æ—¶é—´åå·®ï¼Œoffset åå·®å°ï¼ŒåŒæ­¥æˆåŠŸã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ntpdc -c loopinfo
</span></span></code></pre></div><h3 id="5é…ç½®è‡ªåŠ¨åŒæ­¥">5ã€é…ç½®è‡ªåŠ¨åŒæ­¥</h3>
<p>è®¾ç½®è‡ªåŠ¨åŒæ­¥ï¼ŒåŒæ­¥é¢‘ç‡ï¼šæ¯ååˆ†é’ŸåŒæ­¥ä¸€æ¬¡ã€‚ç¼–è¾‘ crontabï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># crontab -e </span>
</span></span><span class="line"><span class="cl">*/10 * * * * /usr/sbin/ntpdate ntp1.aliyun.com <span class="o">&amp;&amp;</span> hwclock -w &gt;&gt; /tmp/crontab.log
</span></span></code></pre></div><h3 id="6ç³»ç»Ÿæ—¶é’Ÿä¸ç¡¬ä»¶æ—¶é’Ÿä¹‹é—´åŒæ­¥">6ã€ç³»ç»Ÿæ—¶é’Ÿä¸ç¡¬ä»¶æ—¶é’Ÿä¹‹é—´åŒæ­¥</h3>
<p>è®¾ç½®ç¡¬ä»¶æ—¶é’Ÿ</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># -w,--systohc</span>
</span></span><span class="line"><span class="cl">hwclock -w
</span></span></code></pre></div><p>è®¾ç½®ç³»ç»Ÿæ—¶é’Ÿï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># -s, --hctosys</span>
</span></span><span class="line"><span class="cl">hwclock -s
</span></span></code></pre></div><h2 id="chrony">chrony</h2>
<h3 id="1å®‰è£…æœåŠ¡">1ã€å®‰è£…æœåŠ¡</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">yum erase -y ntp
</span></span><span class="line"><span class="cl">yum install -y chrony
</span></span></code></pre></div><h3 id="2ä½¿ç”¨ç½‘ç»œæ—¶é’ŸæœåŠ¡å™¨">2ã€ä½¿ç”¨ç½‘ç»œæ—¶é’ŸæœåŠ¡å™¨</h3>
<p>è¿™é‡Œä½¿ç”¨ç½‘ç»œæ—¶é’ŸæœåŠ¡å™¨ï¼Œåœ¨æ¯å°æœåŠ¡å™¨ä¸Šä¿®æ”¹é…ç½®ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sed -i -e <span class="s1">&#39;/^server/d&#39;</span> /etc/chrony.conf
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;server ntp1.aliyun.com iburst&#34;</span> &gt;&gt; /etc/chrony.conf
</span></span><span class="line"><span class="cl">egrep -v <span class="s2">&#34;^#|^</span>$<span class="s2">&#34;</span> /etc/chrony.conf 
</span></span></code></pre></div><p>å¯åŠ¨æœåŠ¡ï¼Œå¹¶è®¾ç½®å¼€æœºå¯åŠ¨ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">systemctl start chronyd <span class="o">&amp;&amp;</span> systemctl <span class="nb">enable</span> chronyd
</span></span></code></pre></div><h3 id="3æŸ¥çœ‹çŠ¶æ€">3ã€æŸ¥çœ‹çŠ¶æ€</h3>
<p>æŸ¥çœ‹ç«¯å£ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ss -tulp <span class="p">|</span> grep chronyd
</span></span></code></pre></div><p>æŸ¥çœ‹åŒæ­¥çŠ¶æ€ï¼Œæ˜¾ç¤ºåˆšåˆšé…ç½®çš„ip å¹¶ä¸”ipå‰é¢æœ‰ï¼Œ*æ˜Ÿå·å³ä¸ºæˆåŠŸ ï¼Œè¿™ä¸ªç¬¦å· ^ ä¸ºå¤±è´¥</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">chronyc sources
</span></span><span class="line"><span class="cl">chronyc sources -v
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">chronyc sourcestats
</span></span></code></pre></div><p>è·Ÿè¸ªæ—¶é—´åŒæ­¥è¿‡ç¨‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">chronyc tracking
</span></span></code></pre></div><h2 id="å…¶ä»–">å…¶ä»–</h2>
<p>é…ç½®æ—¶åŒº</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># é…ç½®æ—¶åŒº</span>
</span></span><span class="line"><span class="cl">timedatectl set-timezone Asia/Shanghai
</span></span></code></pre></div><p>å°†ç¡¬ä»¶æ—¶é’Ÿè°ƒæ•´ä¸ºUTCæ—¶é—´ï¼Œ1ä¸ºæœ¬åœ°æ—¶é’Ÿï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># å°†ç¡¬ä»¶æ—¶é’Ÿè°ƒæ•´ä¸ºUTCæ—¶é—´ï¼Œ1ä¸ºæœ¬åœ°æ—¶é’Ÿ</span>
</span></span><span class="line"><span class="cl">timedatectl set-local-rtc <span class="m">0</span>
</span></span></code></pre></div><h2 id="æ€»ç»“">æ€»ç»“</h2>
<h3 id="ntp-å®‰è£…å’Œè®¾ç½®å®Œæ•´è„šæœ¬">ntp å®‰è£…å’Œè®¾ç½®å®Œæ•´è„šæœ¬</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1">#è®¾ç½®æ—¶é’ŸåŒæ­¥</span>
</span></span><span class="line"><span class="cl">yum install -y ntp
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">sed -i <span class="s2">&#34;/^server/ d&#34;</span> /etc/ntp.conf
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">cat <span class="s">&lt;&lt; EOF | sudo tee -a /etc/ntp.conf
</span></span></span><span class="line"><span class="cl"><span class="s">server ntp1.aliyun.com
</span></span></span><span class="line"><span class="cl"><span class="s">server ntp2.aliyun.com
</span></span></span><span class="line"><span class="cl"><span class="s">server ntp3.aliyun.com
</span></span></span><span class="line"><span class="cl"><span class="s">server ntp4.aliyun.com
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">systemctl start ntpd
</span></span><span class="line"><span class="cl">systemctl <span class="nb">enable</span> ntpd
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">ntpdate -u ntp1.aliyun.com
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">hwclock --systohc
</span></span></code></pre></div><h3 id="chrony-å®‰è£…å’Œè®¾ç½®å®Œæ•´è„šæœ¬">chrony å®‰è£…å’Œè®¾ç½®å®Œæ•´è„šæœ¬</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># è®¾ç½®æ—¶é’ŸåŒæ­¥</span>
</span></span><span class="line"><span class="cl">yum erase -y ntp
</span></span><span class="line"><span class="cl">yum install -y chrony
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">sed -i -e <span class="s1">&#39;/^server/d&#39;</span> /etc/chrony.conf
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;server ntp1.aliyun.com iburst&#34;</span> &gt;&gt; /etc/chrony.conf
</span></span><span class="line"><span class="cl">egrep -v <span class="s2">&#34;^#|^</span>$<span class="s2">&#34;</span> /etc/chrony.conf 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">systemctl start chronyd <span class="o">&amp;&amp;</span> systemctl <span class="nb">enable</span> chronyd
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">ss -tulp <span class="p">|</span> grep chronyd
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">chronyc tracking
</span></span><span class="line"><span class="cl">chronyc sources
</span></span><span class="line"><span class="cl">chronyc sourcestats
</span></span></code></pre></div>]]></content:encoded></item><item><title>Macå¼€å‘ç¯å¢ƒé…ç½®</title><link>https://blog.chensoul.com/posts/2021/09/09/mac-development-environment-setup/</link><pubDate>Thu, 09 Sep 2021 18:14:34 +0800</pubDate><guid>https://blog.chensoul.com/posts/2021/09/09/mac-development-environment-setup/</guid><description>è¿™æ˜¯æˆ‘çš„ç¬¬ä¸€ç¯‡æ–‡ç« ï¼Œä½œä¸ºç¨‹åºå‘˜ï¼Œé¦–å…ˆè¦åšå¾—ç¬¬ä¸€ä»¶äº‹æƒ…ï¼Œå°±æ˜¯é…ç½®å¥½å¼€å‘ç¯å¢ƒï¼Œå› ä¸ºæˆ‘ä½¿ç”¨çš„æ˜¯Macå¼€å‘ç¯å¢ƒï¼Œæ‰€ä»¥ï¼Œè¿™ç¯‡æ–‡ç« ä¸»è¦æ˜¯åŸºäºMacæ“ä½œç³»</description><content:encoded><![CDATA[<p>è¿™æ˜¯æˆ‘çš„ç¬¬ä¸€ç¯‡æ–‡ç« ï¼Œä½œä¸ºç¨‹åºå‘˜ï¼Œé¦–å…ˆè¦åšå¾—ç¬¬ä¸€ä»¶äº‹æƒ…ï¼Œå°±æ˜¯é…ç½®å¥½å¼€å‘ç¯å¢ƒï¼Œå› ä¸ºæˆ‘ä½¿ç”¨çš„æ˜¯Macå¼€å‘ç¯å¢ƒï¼Œæ‰€ä»¥ï¼Œè¿™ç¯‡æ–‡ç« ä¸»è¦æ˜¯åŸºäºMacæ“ä½œç³»ç»Ÿï¼Œè®°å½•å¼€å‘ç¯å¢ƒæ­å»ºè¿‡ç¨‹ã€‚</p>
<h2 id="åå¥½è®¾ç½®">åå¥½è®¾ç½®</h2>
<ul>
<li>ç³»ç»Ÿæ‰€æœ‰åå¥½è®¾ç½®
<ul>
<li>é€šç”¨ï¼šå…³é—­æ–‡ç¨¿æ—¶è¦æ±‚ä¿å­˜æ›´æ”¹</li>
<li>Siriï¼šå…³é—­</li>
<li>è¾…åŠ©åŠŸèƒ½ - æŒ‡é’ˆæ§åˆ¶ï¼ˆæˆ–é¼ æ ‡ä¸è§¦æ§æ¿ï¼‰ - è§¦æ§æ¿é€‰é¡¹ï¼šå¯åŠ¨æ‹–ç§»(ä¸‰æŒ‡æ‹–ç§»)</li>
<li>è§¦æ§æ¿ &gt; å…‰æ ‡ä¸ç‚¹å‡»ï¼Œè½»æ‹æ¥ç‚¹æŒ‰ï¼Œè¾…åŠ©ç‚¹æŒ‰</li>
<li>Dock
<ul>
<li>ç½®äºå±å¹•ä¸Šçš„ä½ç½®ï¼šå³è¾¹</li>
<li>è®¾ç½® Dock å›¾æ ‡æ›´å°ï¼ˆå¤§å°éšä¸ªäººå–œå¥½ï¼‰</li>
</ul>
</li>
</ul>
</li>
<li>Finder
<ul>
<li>æ˜¾ç¤ºå„ç§æ </li>
<li>æ˜¾ç¤ºæ‰€æœ‰æ–‡ä»¶æ‰©å±•å</li>
<li>æ ‡é¢˜æ æ˜¾ç¤ºå®Œæ•´è·¯å¾„ï¼šdefaults write com.apple.finder _FXShowPosixPathInTitle -bool YES;killall Finder</li>
</ul>
</li>
<li>ç¦ç”¨å¤§éƒ¨åˆ† iCloud åŒæ­¥</li>
<li>é”®ç›˜ -&gt; å¿«æ·é”®
<ul>
<li>command + ç©ºæ ¼ï¼šspotlightÂ Â </li>
<li>control + ç©ºæ ¼ï¼šåˆ‡æ¢è¾“å…¥æ³•</li>
</ul>
</li>
</ul>
<h2 id="xcode">XCode</h2>
<p>ä» App store æˆ–è‹¹æœå¼€å‘è€…ç½‘ç«™å®‰è£… <a href="https://developer.apple.com/xcode/">Xcode</a> ï¼Œç„¶åå®‰è£… Xcode command line toolsï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">xcode-select --install
</span></span></code></pre></div><p>å®‰è£…å®Œæˆåï¼Œä½ å°†å¯ä»¥ç›´æ¥åœ¨ terminal ä¸­ä½¿ç”¨ä¸»è¦çš„å‘½ä»¤ï¼Œæ¯”å¦‚ï¼š<code>make, GCC, clang, perl, svn, git, size, strip, strings, libtool, cpp</code>ç­‰ç­‰ã€‚</p>
<p>å¦‚æœä½ æƒ³äº†è§£ Xcode command line tools åŒ…å«å¤šå°‘å¯ç”¨çš„å‘½ä»¤ï¼Œå¯ä»¥é€šè¿‡ä¸‹é¢å‘½ä»¤æŸ¥çœ‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ls /Library/Developer/CommandLineTools/usr/bin/
</span></span></code></pre></div><h2 id="homebrew">Homebrew</h2>
<p><a href="http://brew.sh/">Brew</a> æ˜¯ Mac ä¸‹é¢çš„åŒ…ç®¡ç†å·¥å…·ï¼Œé€šè¿‡ Github æ‰˜ç®¡é€‚åˆ Mac çš„ç¼–è¯‘é…ç½®ä»¥åŠ Patchï¼Œå¯ä»¥æ–¹ä¾¿çš„å®‰è£…å¼€å‘å·¥å…·ã€‚</p>
<p>Linuxä¹Ÿæ”¯æŒHomebrewäº†ï¼Œè¯·å‚è€ƒ <a href="https://docs.brew.sh/Homebrew-on-Linux">https://docs.brew.sh/Homebrew-on-Linux</a>ã€‚</p>
<h3 id="å®‰è£…">å®‰è£…</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">/usr/bin/ruby -e <span class="s2">&#34;</span><span class="k">$(</span>curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install<span class="k">)</span><span class="s2">&#34;</span>
</span></span></code></pre></div><p>æ›¿æ¢brew.git</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">git -C <span class="s2">&#34;</span><span class="k">$(</span>brew --repo<span class="k">)</span><span class="s2">&#34;</span> remote set-url origin https://mirrors.cloud.tencent.com/homebrew/brew.git 
</span></span><span class="line"><span class="cl">git -C <span class="s2">&#34;</span><span class="k">$(</span>brew --repo homebrew/core<span class="k">)</span><span class="s2">&#34;</span> remote set-url origin https://mirrors.cloud.tencent.com//homebrew/homebrew-core.git brew update
</span></span></code></pre></div><p>è®¾ç½®ç¯å¢ƒå˜é‡ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s1">&#39;PATH=&#34;/usr/local/bin:$PATH&#34;&#39;</span> &gt;&gt; ~/.bash_profile
</span></span></code></pre></div><p>å¦‚æœå®‰è£…äº†zshï¼Œåˆ™æ˜¯ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s1">&#39;PATH=&#34;/usr/local/bin:$PATH&#34;&#39;</span> &gt;&gt; ~/.zshrc
</span></span></code></pre></div><h3 id="cask">Cask</h3>
<p><a href="https://github.com/phinze/homebrew-cask">Brew cask</a> æ˜¯ç±»ä¼¼ Brew çš„ç®¡ç†å·¥å…·ï¼Œ ç›´æ¥æä¾› dmg çº§åˆ«çš„äºŒè¿›åˆ¶åŒ…ï¼Œï¼ˆBrew æ˜¯ä¸å¸¦æºç ï¼Œåªæœ‰å¯¹åº”é¡¹ç›®æ‰€åœ¨çš„ URLï¼‰ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ Homebrew Cask ä¼˜é›…ã€ç®€å•ã€å¿«é€Ÿçš„å®‰è£…å’Œç®¡ç† OS X å›¾å½¢ç•Œé¢ç¨‹åºï¼Œæ¯”å¦‚ Google Chrome å’Œ Dropboxã€‚</p>
<p>Brew cask å®‰è£…ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">brew tap phinze/homebrew-cask
</span></span></code></pre></div><p>å¯ä»¥é€šè¿‡ Brew cask å®‰è£…çš„è½¯ä»¶æœ‰ï¼š</p>
<ul>
<li>QQ</li>
<li>qqmusic</li>
<li>google-chrome</li>
<li>virtualbox</li>
<li>vagrant</li>
<li>iterm2</li>
<li>the-unarchiver</li>
<li>switchhosts</li>
<li>aerial</li>
<li>fliqlo</li>
</ul>
<h2 id="iterm2">iTerm2</h2>
<p>å®‰è£…ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">brew install --cask iterm2
</span></span></code></pre></div><p>è®¾ç½®ï¼š</p>
<ul>
<li>Preferences &ndash;&gt; Profiles&ndash;&gt; Default &ndash;&gt; Terminalï¼šè®¾ç½® cursor é¢œè‰²ä¸ºé»„è‰²</li>
<li>Preferences &ndash;&gt; Profiles &ndash;&gt; Window &ndash;&gt; Transparencyï¼šè®¾ç½®é€æ˜åº¦ 10%~20% å³å¯ï¼Œå¤ªé«˜ä¼šå’Œæ¡Œé¢èƒŒæ™¯å†²çªã€‚å¦‚æœéœ€è¦ä¸´æ—¶ç¦ç”¨é€æ˜åº¦å¯ä»¥ä½¿ç”¨å¿«æ·é”® âŒ˜+uã€‚</li>
</ul>
<h3 id="zsh">Zsh</h3>
<p>å®‰è£…ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">brew install zsh
</span></span></code></pre></div><p><strong>å®‰è£…Oh My Zshï¼š</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sh -c <span class="s2">&#34;</span><span class="k">$(</span>curl -fsSL https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh<span class="k">)</span><span class="s2">&#34;</span>
</span></span></code></pre></div><p>è®¾ç½®zshä¸ºé»˜è®¤ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo sh -c <span class="s2">&#34;echo </span><span class="k">$(</span>which zsh<span class="k">)</span><span class="s2"> &gt;&gt; /etc/shells&#34;</span>  
</span></span><span class="line"><span class="cl">chsh -s <span class="k">$(</span>which zsh<span class="k">)</span>
</span></span></code></pre></div><p>bashåˆ‡æ¢åˆ°zsh</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">chsh -s /bin/zsh
</span></span></code></pre></div><p>ä½¿è®¾ç½®ç”Ÿæ•ˆï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">source</span> ~/.zshrc
</span></span></code></pre></div><p><strong>å®‰è£…<a href="https://github.com/robbyrussell/oh-my-zsh/wiki/Plugins">Oh My Zsh æ’ä»¶</a></strong>ï¼Œä¿®æ”¹ .zshrc ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">plugins</span><span class="o">=(</span>git mvn colorize encode64 urltools wd last-working-dir sublime vagrant Z zsh-syntax-highlighting brew osx<span class="o">)</span>
</span></span></code></pre></div><p>å®‰è£… zsh-syntax-highlightingï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">git clone https://github.com/zsh-users/zsh-syntax-highlighting.git <span class="si">${</span><span class="nv">ZSH_CUSTOM</span><span class="k">:-</span><span class="p">~/.oh-my-zsh/custom</span><span class="si">}</span>/plugins/zsh-syntax-highlighting
</span></span></code></pre></div><p>å®‰è£… zsh-autosuggestionsï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">git clone https://github.com/zsh-users/zsh-autosuggestions <span class="nv">$ZSH_CUSTOM</span>/plugins/zsh-autosuggestions
</span></span></code></pre></div><p>å®‰è£…git-open</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">git clone https://github.com/paulirish/git-open.git <span class="nv">$ZSH_CUSTOM</span>/plugins/git-open
</span></span></code></pre></div><p>ä¿®æ”¹ä¸»é¢˜ï¼Œæ›´å¤šä¸»é¢˜å‚è€ƒ <a href="https://github.com/robbyrussell/oh-my-zsh/wiki/themes">Oh My Zsh Wiki</a>ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">ZSH_THEME</span><span class="o">=</span>pygmalion
</span></span></code></pre></div><h3 id="tree">tree</h3>
<p>å®‰è£…ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">brew install tree
</span></span></code></pre></div><h3 id="fzf">fzf</h3>
<p>å®‰è£… fzfï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">brew install fzf
</span></span></code></pre></div><p>fzfç”¨æ³•ï¼š</p>
<ul>
<li>1ã€åˆ‡æ¢åˆ°æŒ‡å®šç›®å½•</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># fd - cd to selected directory</span>
</span></span><span class="line"><span class="cl">fd<span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">local</span> dir
</span></span><span class="line"><span class="cl">  <span class="nv">dir</span><span class="o">=</span><span class="k">$(</span>find <span class="si">${</span><span class="nv">1</span><span class="k">:-</span><span class="p">.</span><span class="si">}</span> -path <span class="s1">&#39;*/\.*&#39;</span> -prune <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>                  -o -type d -print 2&gt; /dev/null <span class="p">|</span> fzf +m<span class="k">)</span> <span class="o">&amp;&amp;</span>
</span></span><span class="line"><span class="cl">  <span class="nb">cd</span> <span class="s2">&#34;</span><span class="nv">$dir</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><ul>
<li>2ã€æŸ¥çœ‹å†å²å‘½ä»¤ï¼Œå¹¶ä¸”æ‰§è¡Œé€‰ä¸­çš„å‘½ä»¤</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># fh - search in your command history and execute selected command</span>
</span></span><span class="line"><span class="cl">fh<span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">eval</span> <span class="k">$(</span> <span class="o">([</span> -n <span class="s2">&#34;</span><span class="nv">$ZSH_NAME</span><span class="s2">&#34;</span> <span class="o">]</span> <span class="o">&amp;&amp;</span> <span class="nb">fc</span> -l <span class="m">1</span> <span class="o">||</span> <span class="nb">history</span><span class="k">)</span> <span class="p">|</span> fzf +s --tac <span class="p">|</span> sed <span class="s1">&#39;s/ *[0-9]* *//&#39;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><ul>
<li>3ã€æŸ¥çœ‹Chromeå†å²</li>
</ul>
<blockquote>
<p>æç¤ºï¼šæŸ¥çœ‹ <a href="https://junegunn.kr/2015/04/browsing-chrome-history-with-fzf/">blog post</a>ã€‚</p>
</blockquote>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># ch - browse chrome history</span>
</span></span><span class="line"><span class="cl">ch<span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">local</span> cols sep
</span></span><span class="line"><span class="cl">  <span class="nv">cols</span><span class="o">=</span><span class="k">$((</span> COLUMNS <span class="o">/</span> <span class="m">3</span> <span class="k">))</span>
</span></span><span class="line"><span class="cl">  <span class="nv">sep</span><span class="o">=</span><span class="s1">&#39;{::}&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  cp -f ~/Library/Application<span class="se">\ </span>Support/Google/Chrome/Default/History /tmp/h
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  sqlite3 -separator <span class="nv">$sep</span> /tmp/h <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    <span class="s2">&#34;select substr(title, 1, </span><span class="nv">$cols</span><span class="s2">), url
</span></span></span><span class="line"><span class="cl"><span class="s2">     from urls order by last_visit_time desc&#34;</span> <span class="p">|</span>
</span></span><span class="line"><span class="cl">  awk -F <span class="nv">$sep</span> <span class="s1">&#39;{printf &#34;%-&#39;</span><span class="nv">$cols</span><span class="s1">&#39;s  \x1b[36m%s\x1b[m\n&#34;, $1, $2}&#39;</span> <span class="p">|</span>
</span></span><span class="line"><span class="cl">  fzf --ansi --multi <span class="p">|</span> sed <span class="s1">&#39;s#.*\(https*://\)#\1#&#39;</span> <span class="p">|</span> xargs open
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><p>æ³¨æ„ï¼š</p>
<ul>
<li>è¯·ç¡®è®¤Chromeçš„å†å²è®°å½•çš„åœ°å€æ˜¯æ­£ç¡®çš„ã€‚</li>
<li>æ›´å¤šè¯´æ˜ï¼Œå‚è€ƒ <a href="https://stackoverflow.com/a/16742333/1564365">StackOverflow</a>ã€‚</li>
</ul>
<p>fzfæ›´å¤šç”¨æ³•ï¼Œå‚è€ƒ  <strong><a href="https://github.com/junegunn/fzf#fuzzy-completion-for-bash-and-zsh">official repo</a></strong>ã€‚</p>
<h3 id="ack">ack</h3>
<p>å®‰è£…ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">brew install ack
</span></span></code></pre></div><p>æœç´¢ js æ–‡ä»¶ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ack --js pancakes
</span></span></code></pre></div><p>æœç´¢ä¸åŒ…å« brew çš„æ–‡ä»¶ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ack -L brew
</span></span></code></pre></div><p>æ’åºï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">--sort-files
</span></span></code></pre></div><p>ç»“æœé«˜äº®æ˜¾ç¤ºï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">--sort-files
</span></span></code></pre></div><p>è‡ªå®šä¹‰ç±»å‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">--type-set<span class="o">=</span><span class="nv">markdown</span><span class="o">=</span>.md,.mkd,.markdown
</span></span></code></pre></div><p>æŸ¥çœ‹acké…ç½®ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ack --dump
</span></span></code></pre></div><h2 id="git">Git</h2>
<h3 id="å®‰è£…å’Œé…ç½®">å®‰è£…å’Œé…ç½®</h3>
<p>å®‰è£…ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">brew install git
</span></span></code></pre></div><p>æŸ¥çœ‹gitå‘½ä»¤ä½ç½®ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">which git
</span></span></code></pre></div><p>é…ç½®ç”¨æˆ·åå’Œé‚®ç®±ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">git config --global user.name <span class="s2">&#34;Your Name Here&#34;</span>
</span></span><span class="line"><span class="cl">git config --global user.email <span class="s2">&#34;your_email@youremail.com&#34;</span>
</span></span></code></pre></div><ul>
<li>è¿™äº›é…ç½®ä¼šåŠ åˆ° ~/.gitconfig</li>
</ul>
<p>ä¸ºäº†å°†ä»£ç æ¨é€åˆ° GitHub ä»“åº“ï¼Œå»ºè®®ä½¿ç”¨HTTPSæ–¹æ³•ã€‚å¦‚æœä½ ä¸æƒ³æ¯æ¬¡éƒ½è¾“å…¥ç”¨æˆ·åå’Œå¯†ç çš„è¯ï¼Œå¯ä»¥æŒ‰ç…§æ­¤ <a href="https://help.github.com/articles/set-up-git">æè¿°</a> è¯´çš„é‚£æ ·ï¼Œè¿è¡Œï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">git config --global credential.helper osxkeychain
</span></span></code></pre></div><p>è®¾ç½®é»˜è®¤åˆ†æ”¯åç§°ä¸ºmainï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">git config --global init.defaultBranch main
</span></span></code></pre></div><p>é…ç½®sshç§˜é’¥ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ssh-keygen -t rsa -C <span class="s2">&#34;your_email@example.com&#34;</span>
</span></span></code></pre></div><p>æ·»åŠ  SSH å…¬é’¥åˆ° ssh-agent ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">eval</span> <span class="s2">&#34;</span><span class="k">$(</span>ssh-agent -s<span class="k">)</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">ssh-add -K ~/.ssh/id_rsa
</span></span></code></pre></div><p>æ·»åŠ SSH å…¬é’¥åˆ° GitHub è´¦æˆ·ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">pbcopy &lt; ~/.ssh/id_rsa.pub
</span></span></code></pre></div><p>æ‰“å¼€ <a href="https://github.com/settings/ssh/new">https://github.com/settings/ssh/new</a>ï¼Œç„¶åæ·»åŠ ã€‚</p>
<h2 id="bash-completion">Bash Completion</h2>
<p>å®‰è£…ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">brew install bash-completion
</span></span></code></pre></div><p>æŸ¥çœ‹æ›´å¤š completion ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ brew search completion
</span></span></code></pre></div><p>ç„¶åï¼Œå®‰è£…ï¼Œä¾‹å¦‚ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">brew install docker-completion
</span></span></code></pre></div><h2 id="vim">Vim</h2>
<p>å®‰è£…ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">brew install vim
</span></span></code></pre></div><h3 id="vimrc">vimrc</h3>
<p>ä¸‹è½½ <a href="https://github.com/amix/vimrc">The Ultimate vimrc</a>ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">git clone https://github.com/amix/vimrc.git ~/.vim_runtime
</span></span></code></pre></div><p>å®‰è£… complete ç‰ˆæœ¬ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sh ~/.vim_runtime/install_awesome_vimrc.sh
</span></span></code></pre></div><p>å®‰è£… bash ç‰ˆæœ¬ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sh ~/.vim_runtime/install_basic_vimrc.sh
</span></span></code></pre></div><p>æ›´æ–° vimrc ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">cd</span> ~/.vim_runtime <span class="o">&amp;&amp;</span> git pull --rebase <span class="o">&amp;&amp;</span> <span class="nb">cd</span> -
</span></span></code></pre></div><h3 id="maximum-awesome">Maximum Awesome</h3>
<p>å®‰è£…<a href="https://github.com/square/maximum-awesome">Maximum Awesome</a>ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">git clone https://github.com/square/maximum-awesome.git
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> maximum-awesome
</span></span><span class="line"><span class="cl">rake
</span></span></code></pre></div><h2 id="visual-studio-code">Visual Studio Code</h2>
<p>å®‰è£…ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">brew install --cask visual-studio-code
</span></span></code></pre></div><p>ä»å‘½ä»¤è¡Œå¯åŠ¨vscodeï¼š</p>
<ul>
<li>å¯åŠ¨vscodeï¼Œè¾“å…¥ <strong>Command Palette</strong> (Cmd+Shift+P)ï¼ŒæŸ¥æ‰¾ <strong>Shell Command: Install &lsquo;code&rsquo; command in PATH</strong></li>
<li>é‡å¯ vscode ä½¿ç¯å¢ƒå˜é‡ç”Ÿæ•ˆ</li>
<li>åœ¨å‘½ä»¤è¡Œè¾“å…¥ <code>code .</code>ï¼Œåœ¨å½“å‰ç›®å½•å¯åŠ¨ vscodeï¼Œä¹Ÿå¯ä»¥è¿™æ ·æ‰“å¼€æ–‡ä»¶ <code>code myfile.txt</code></li>
</ul>
<p>å®‰è£…æ‰©å±•ï¼š</p>
<ul>
<li>JavaScript
<ul>
<li><a href="https://marketplace.visualstudio.com/items?itemName=dbaeumer.vscode-eslint">ESLint</a></li>
<li><a href="https://marketplace.visualstudio.com/items?itemName=esbenp.prettier-vscode">Prettier</a></li>
</ul>
</li>
<li>SQL
<ul>
<li><a href="https://marketplace.visualstudio.com/items?itemName=bradymholt.pgformatter">PostgreSQL formatter</a></li>
</ul>
</li>
<li>Markdown
<ul>
<li><a href="https://marketplace.visualstudio.com/items?itemName=shd101wyy.markdown-preview-enhanced">Markdown Preview</a></li>
</ul>
</li>
<li>GitLens
<ul>
<li><a href="https://marketplace.visualstudio.com/items?itemName=eamodio.gitlens">GitLens</a></li>
</ul>
</li>
<li>Docker
<ul>
<li><a href="https://marketplace.visualstudio.com/items?itemName=ms-azuretools.vscode-docker">Docker</a></li>
</ul>
</li>
<li>JSON
<ul>
<li><a href="https://marketplace.visualstudio.com/items?itemName=quicktype.quicktype">Paste JSON as Code</a></li>
</ul>
</li>
<li>Live Server
<ul>
<li><a href="https://marketplace.visualstudio.com/items?itemName=ritwickdey.LiveServer">Live Server</a></li>
</ul>
</li>
<li>VS Code Icons
<ul>
<li><a href="https://marketplace.visualstudio.com/items?itemName=vscode-icons-team.vscode-icons">vscode-icons</a></li>
</ul>
</li>
</ul>
<h2 id="jetbrains-ides">JetBrains IDEs</h2>
<p>ä¸‹è½½åœ°å€ï¼šhttps://www.jetbrains.com/products.html?fromMenu#type=ide</p>
<p>ç ´è§£æ’ä»¶ï¼šhttps://github.com/osvax/ide-eval-resetter</p>
<h2 id="vagrant">Vagrant</h2>
<p>å®‰è£…ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">brew install --cask virtualbox
</span></span><span class="line"><span class="cl">brew install --cask vagrant
</span></span><span class="line"><span class="cl">brew install --cask vagrant-manager
</span></span></code></pre></div><p>ä½¿ç”¨ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">vagrant box add precise64 https://vagrantcloud.com/hashicorp/boxes/precise64/versions/1.1.0/providers/virtualbox.box
</span></span><span class="line"><span class="cl">vagrant init precise64
</span></span><span class="line"><span class="cl">vagrant up
</span></span><span class="line"><span class="cl">vagrant ssh
</span></span><span class="line"><span class="cl">vagrant halt
</span></span></code></pre></div><h2 id="mysql">MySQL</h2>
<p>å®‰è£…mysqlï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">brew install mysql
</span></span></code></pre></div><p>å¦‚æœæƒ³å®‰è£…mysql5.7ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">brew install mysql@5.7
</span></span></code></pre></div><p>ä½¿ç”¨ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1">#è®¾ç½®å¼€æœºå¯åŠ¨</span>
</span></span><span class="line"><span class="cl">brew services start mysql
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#å¯åŠ¨</span>
</span></span><span class="line"><span class="cl">mysql.server start
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#åœæ­¢</span>
</span></span><span class="line"><span class="cl">mysql.server stop
</span></span></code></pre></div><p>ä½¿ç”¨ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1">#ç™»å½•mysql</span>
</span></span><span class="line"><span class="cl">mysql -hlocalhost -p3306 -uroot -p123456
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#æ·»åŠ è¿œç¨‹ç™»å½•ç”¨æˆ·</span>
</span></span><span class="line"><span class="cl">CREATE USER <span class="s1">&#39;test&#39;</span>@<span class="s1">&#39;%&#39;</span> IDENTIFIED WITH mysql_native_password BY <span class="s1">&#39;123456&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">GRANT ALL PRIVILEGES ON *.* TO <span class="s1">&#39;test&#39;</span>@<span class="s1">&#39;%&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#æŸ¥çœ‹ç¼–ç </span>
</span></span><span class="line"><span class="cl">showvariables like <span class="s2">&#34;%char%&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">flush privileges<span class="p">;</span>
</span></span></code></pre></div><p>å®‰è£… sequel-proï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">brew install --cask sequel-pro
</span></span></code></pre></div><h2 id="postgresql">PostgreSQL</h2>
<p>å®‰è£…ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">brew install postgres
</span></span></code></pre></div><p>æŸ¥çœ‹ç‰ˆæœ¬ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">postgres -V
</span></span></code></pre></div><p>ä½¿ç”¨ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1">#å¯åŠ¨</span>
</span></span><span class="line"><span class="cl">pg_ctl -D /usr/local/var/postgres start
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#å¼€å¯å¯åŠ¨</span>
</span></span><span class="line"><span class="cl">brew services start postgresql
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#åœæ­¢</span>
</span></span><span class="line"><span class="cl">pg_ctl -D /usr/local/var/postgres stop
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#é‡å¯</span>
</span></span><span class="line"><span class="cl">pg_ctl -D /usr/local/var/postgres restart
</span></span><span class="line"><span class="cl">brew services restart postgresql
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#å¯åŠ¨ PostgreSQL console</span>
</span></span><span class="line"><span class="cl">psql
</span></span></code></pre></div><p>å®‰è£…å®¢æˆ·ç«¯ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">brew install psequel
</span></span></code></pre></div><h2 id="java">Java</h2>
<p>ä¸‹è½½ Oracle JDKï¼š</p>
<ul>
<li><a href="http://support.apple.com/downloads/DL1572/en_US/JavaForOSX2013-05.dmg">jdk6</a></li>
<li><a href="http://download.oracle.com/otn-pub/java/jdk/7u60-b19/jdk-7u60-macosx-x64.dmg">jdk7</a></li>
</ul>
<p>è®¾ç½® java_home ä¸º 1.8:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s1">&#39;export JAVA_HOME=$(/usr/libexec/java_home -v 1.8) &#39;</span> &gt;&gt; ~/.zshrc
</span></span></code></pre></div><p>å®‰è£…OpenJDKï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">brew install openjdk
</span></span></code></pre></div><h3 id="sdkman">SDKMAN</h3>
<p>å®‰è£…ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"> curl -s <span class="s2">&#34;https://get.sdkman.io&#34;</span> <span class="p">|</span> bash
</span></span></code></pre></div><p>å®‰è£…completeï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">source</span> <span class="s2">&#34;</span><span class="nv">$HOME</span><span class="s2">/.sdkman/bin/sdkman-init.sh&#34;</span>
</span></span></code></pre></div><p>æŸ¥çœ‹ç‰ˆæœ¬ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sdk version
</span></span></code></pre></div><p>ä½¿ç”¨ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1">#å®‰è£…jdk</span>
</span></span><span class="line"><span class="cl">sdk install java
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#å®‰è£…scala</span>
</span></span><span class="line"><span class="cl">sdk install scala 2.12.1
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#å¸è½½</span>
</span></span><span class="line"><span class="cl">sdk uninstall scala 2.11.6
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#æŸ¥çœ‹</span>
</span></span><span class="line"><span class="cl">sdk list
</span></span></code></pre></div><h2 id="maven">Maven</h2>
<p>å®‰è£…ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">brew install maven
</span></span></code></pre></div><h2 id="nodejs">Node.js</h2>
<p>å®‰è£…nodeï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">brew install node
</span></span></code></pre></div><h3 id="nvm">nvm</h3>
<p>å®‰è£…nvmï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">brew install nvm
</span></span></code></pre></div><p>ä½¿ç”¨ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">source</span> ~/.bashrc        <span class="c1"># source your bashrc/zshrc to add nvm to PATH</span>
</span></span><span class="line"><span class="cl"><span class="nb">command</span> -v nvm          <span class="c1"># check the nvm use message</span>
</span></span><span class="line"><span class="cl">nvm install node        <span class="c1"># install most recent Node stable version</span>
</span></span><span class="line"><span class="cl">nvm ls                  <span class="c1"># list installed Node version</span>
</span></span><span class="line"><span class="cl">nvm use node            <span class="c1"># use stable as current version</span>
</span></span><span class="line"><span class="cl">nvm ls-remote           <span class="c1"># list all the Node versions you can install</span>
</span></span><span class="line"><span class="cl">nvm <span class="nb">alias</span> default node  <span class="c1"># set the installed stable version as the default Node</span>
</span></span></code></pre></div><h3 id="nvs">nvs</h3>
<p>Linux / macOS ç¯å¢ƒé€šè¿‡ Git Clone å¯¹åº”çš„é¡¹ç›®å³å¯ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ <span class="nb">export</span> <span class="nv">NVS_HOME</span><span class="o">=</span><span class="s2">&#34;</span><span class="nv">$HOME</span><span class="s2">/.nvs&#34;</span>
</span></span><span class="line"><span class="cl">$ git clone https://github.com/jasongin/nvs --depth<span class="o">=</span><span class="m">1</span> <span class="s2">&#34;</span><span class="nv">$NVS_HOME</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">$ . <span class="s2">&#34;</span><span class="nv">$NVS_HOME</span><span class="s2">/nvs.sh&#34;</span> install
</span></span></code></pre></div><p>åœ¨å›½å†…ç”±äºå¤§å®¶éƒ½æ‡‚çš„åŸå› ï¼Œéœ€è¦æŠŠå¯¹åº”çš„é•œåƒåœ°å€ä¿®æ”¹ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ nvs remote node https://npm.taobao.org/mirrors/node/
</span></span><span class="line"><span class="cl">$ nvs remote
</span></span></code></pre></div><p>é€šè¿‡ä»¥ä¸‹å‘½ä»¤ï¼Œå³å¯éå¸¸ç®€å•çš„å®‰è£… Node.js æœ€æ–°çš„ LTS ç‰ˆæœ¬ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># å®‰è£…æœ€æ–°çš„ LTS ç‰ˆæœ¬</span>
</span></span><span class="line"><span class="cl">$ nvs add lts
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># é…ç½®ä¸ºé»˜è®¤ç‰ˆæœ¬</span>
</span></span><span class="line"><span class="cl">$ nvs link lts
</span></span></code></pre></div><p>å®‰è£…å…¶ä»–ç‰ˆæœ¬ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># å®‰è£…å…¶ä»–ç‰ˆæœ¬å°å°é²œ</span>
</span></span><span class="line"><span class="cl">$ nvs add <span class="m">12</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æŸ¥çœ‹å·²å®‰è£…çš„ç‰ˆæœ¬</span>
</span></span><span class="line"><span class="cl">$ nvs ls
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># åœ¨å½“å‰ Shell åˆ‡æ¢ç‰ˆæœ¬</span>
</span></span><span class="line"><span class="cl">$ nvs use <span class="m">12</span>
</span></span></code></pre></div><p>æ›´å¤šæŒ‡ä»¤å‚è§ <code>nvs --help</code> ã€‚</p>
<h2 id="go">Go</h2>
<p>å®‰è£…ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">brew install go
</span></span></code></pre></div><p>è®¾ç½®ç¯å¢ƒå˜é‡ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;export GOPATH=/something-else&#34;</span> &gt;&gt; ~/.zshrc
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;export PATH=</span><span class="nv">$PATH</span><span class="s2">:</span><span class="k">$(</span>go env GOPATH<span class="k">)</span><span class="s2">/bin&#34;</span> &gt;&gt; ~/.zshrc
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">source</span> ~/.zshrc
</span></span></code></pre></div><h2 id="python">Python</h2>
<p>å®‰è£…python3ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">brew install python
</span></span></code></pre></div><p>å®‰è£…python2.7ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">brew install python@2
</span></span></code></pre></div><p>å‡çº§ setuptoolsï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">pip install --upgrade setuptools
</span></span><span class="line"><span class="cl">pip install --upgrade pip
</span></span></code></pre></div><h3 id="pyenv">pyenv</h3>
<p>å®‰è£…<a href="https://github.com/yyuu/pyenv"><code>pyenv</code></a>ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">brew install pyenv
</span></span></code></pre></div><p>è®¾ç½®ç¯å¢ƒå˜é‡ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s1">&#39;eval &#34;$(pyenv init -)&#34;&#39;</span> &gt;&gt; ~/.zshrc
</span></span><span class="line"><span class="cl"><span class="nb">exec</span> <span class="nv">$SHELL</span>
</span></span></code></pre></div><p>æŸ¥çœ‹pythonç‰ˆæœ¬ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">pyenv install --list
</span></span></code></pre></div><p>å®‰è£…æŒ‡å®šç‰ˆæœ¬ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">pyenv install 2.7.12
</span></span><span class="line"><span class="cl">pyenv install 3.5.2
</span></span></code></pre></div><p>è®¾ç½®å…¨å±€ç‰ˆæœ¬ï¼Œä¾‹å¦‚ï¼Œè®¾ç½®2.7.12 ä¼˜å…ˆçº§é«˜äº3.5.2 ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">pyenv global 2.7.12 3.5.2
</span></span><span class="line"><span class="cl">pyenv rehash
</span></span></code></pre></div><p>æŸ¥çœ‹ç‰ˆæœ¬ä¼˜å…ˆçº§ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">pyenv versions
</span></span></code></pre></div><h3 id="pip">pip</h3>
<p>å®‰è£…ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">curl https://bootstrap.pypa.io/get-pip.py &gt; get-pip.py
</span></span><span class="line"><span class="cl">sudo python get-pip.py
</span></span></code></pre></div><h3 id="virtualenv">virtualenv</h3>
<p>å®‰è£…ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">pip install virtualenv
</span></span></code></pre></div><p>ä½¿ç”¨ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">cd</span> my-project/
</span></span><span class="line"><span class="cl">virtualenv venv
</span></span></code></pre></div><p>å¦‚æœæƒ³virtualenvç»§æ‰¿å…¨å±€å®‰è£…çš„åŒ…ï¼Œå¯ä»¥æ‰§è¡Œï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-BASH" data-lang="BASH"><span class="line"><span class="cl">virtualenv venv --system-site-packages
</span></span></code></pre></div><p>ä¸Šé¢å‘½ä»¤ä¼šåˆ›å»ºä¸€ä¸ª venv/ ç›®å½•ï¼Œæ¿€æ´»é…ç½®ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">source</span> venv/bin/activate
</span></span></code></pre></div><p>ç¦»å¼€è™šæ‹Ÿç¯å¢ƒï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">deactivate
</span></span></code></pre></div><p>å®‰è£…Virtualenvwrapperï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">pip install virtualenvwrapper
</span></span></code></pre></div><h3 id="numpy-scipy">Numpy-Scipy</h3>
<p>å®‰è£…<a href="https://sourabhbajaj.com/mac-setup/Python/numpy.html">Numpy-Scipy</a>ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">python -m pip install --user numpy scipy matplotlib ipython jupyter pandas sympy nose
</span></span></code></pre></div><p>ä½¿ç”¨ MacPort å®‰è£…python3.5ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo port install py35-numpy py35-scipy py35-matplotlib py35-ipython +notebook py35-pandas py35-sympy py35-nose
</span></span></code></pre></div><h3 id="ipython">IPython</h3>
<p>å®‰è£…ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">pip install ipython
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">pip install <span class="s1">&#39;ipython[zmq,qtconsole,notebook,test]&#39;</span>
</span></span></code></pre></div><h2 id="heroku">Heroku</h2>
<p>å®‰è£…ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">brew install heroku/brew/heroku
</span></span></code></pre></div><p>é…ç½®ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">heroku login
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">mkdir ~/.ssh
</span></span><span class="line"><span class="cl">ssh-keygen -t rsa
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">heroku keys:add
</span></span></code></pre></div><p>ä½¿ç”¨ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ <span class="nb">cd</span> myapp/
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Create the app on Heroku</span>
</span></span><span class="line"><span class="cl">$ heroku create myapp
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Deploy it</span>
</span></span><span class="line"><span class="cl">$ git push heroku master
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Check its status</span>
</span></span><span class="line"><span class="cl">$ heroku ps
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Check the logs</span>
</span></span><span class="line"><span class="cl">$ heroku logs -t
</span></span></code></pre></div><h2 id="å…¶ä»–åº”ç”¨">å…¶ä»–åº”ç”¨</h2>
<h3 id="å¼€å‘å·¥å…·">å¼€å‘å·¥å…·</h3>
<ul>
<li><a href="https://www.google.com/intl/en/chrome/browser/">Google Chrome</a></li>
<li><a href="https://agilebits.com/onepassword">1Password</a>ï¼šå¯†ç </li>
<li><a href="http://wakaba.c3.cx/s/apps/unarchiver.html">Unarchiver</a>ï¼šè§£å‹ç¼©è½¯ä»¶</li>
<li>ç™¾åº¦äº‘ç½‘ç›˜</li>
<li>æœç‹—è¾“å…¥æ³•</li>
<li>Typora</li>
<li>é£ä¹¦</li>
<li>xmind</li>
<li>PostMan</li>
<li>è¯­é›€</li>
<li>TablePlus</li>
<li>V2rayU</li>
<li>Staruml</li>
<li>PicGo</li>
<li>Sublime Text</li>
</ul>
<h2 id="å‚è€ƒæ–‡ç« ">å‚è€ƒæ–‡ç« </h2>
<ul>
<li><a href="https://sourabhbajaj.com/mac-setup/">https://sourabhbajaj.com/mac-setup/</a></li>
</ul>
]]></content:encoded></item><item><title>ä»é›¶å¼€å§‹æ­å»ºä¸ªäººåšå®¢</title><link>https://blog.chensoul.com/posts/2021/09/09/build-personal-blog-from-zero/</link><pubDate>Thu, 09 Sep 2021 18:14:34 +0800</pubDate><guid>https://blog.chensoul.com/posts/2021/09/09/build-personal-blog-from-zero/</guid><description>ä»é›¶å¼€å§‹æ­å»ºåšå®¢ï¼ŒåŒ…æ‹¬æ³¨å†ŒåŸŸåã€è´­ä¹°æœåŠ¡å™¨ã€éƒ¨ç½²ç¨‹åºåŠç½‘ç«™é…ç½®å’Œä¼˜åŒ–ã€‚ åŸŸå æ­å»ºä¸€ä¸ªåšå®¢æˆ–è€…ç½‘ç«™ï¼Œéœ€è¦æœ‰ä¸€ä¸ªåŸŸåã€‚é‚£ä»€ä¹ˆæ˜¯åŸŸåå‘¢ï¼Ÿçœ‹çœ‹ç™¾åº¦ç™¾ç§‘</description><content:encoded><![CDATA[<p>ä»é›¶å¼€å§‹æ­å»ºåšå®¢ï¼ŒåŒ…æ‹¬æ³¨å†ŒåŸŸåã€è´­ä¹°æœåŠ¡å™¨ã€éƒ¨ç½²ç¨‹åºåŠç½‘ç«™é…ç½®å’Œä¼˜åŒ–ã€‚</p>
<h2 id="åŸŸå">åŸŸå</h2>
<p>æ­å»ºä¸€ä¸ªåšå®¢æˆ–è€…ç½‘ç«™ï¼Œéœ€è¦æœ‰ä¸€ä¸ªåŸŸåã€‚é‚£ä»€ä¹ˆæ˜¯åŸŸåå‘¢ï¼Ÿçœ‹çœ‹ç™¾åº¦ç™¾ç§‘ä¸Šçš„è§£é‡Šï¼š</p>
<blockquote>
<p><strong>åŸŸå</strong>ï¼ˆè‹±è¯­ï¼š<strong>Domain Name</strong>ï¼‰ï¼Œåˆç§°<strong>ç½‘åŸŸ</strong>ï¼Œæ˜¯ç”±ä¸€ä¸²ç”¨ç‚¹åˆ†éš”çš„åå­—ç»„æˆçš„<a href="https://baike.baidu.com/item/Internet">Internet</a>ä¸ŠæŸä¸€å°<a href="https://baike.baidu.com/item/%E8%AE%A1%E7%AE%97%E6%9C%BA/140338">è®¡ç®—æœº</a>æˆ–è®¡ç®—æœºç»„çš„åç§°ï¼Œç”¨äºåœ¨æ•°æ®ä¼ è¾“æ—¶å¯¹è®¡ç®—æœºçš„å®šä½æ ‡è¯†ï¼ˆæœ‰æ—¶ä¹ŸæŒ‡åœ°ç†ä½ç½®ï¼‰ã€‚</p>
<p>ç”±äº<a href="https://baike.baidu.com/item/IP%E5%9C%B0%E5%9D%80/150859">IPåœ°å€</a>å…·æœ‰ä¸æ–¹ä¾¿è®°å¿†å¹¶ä¸”ä¸èƒ½æ˜¾ç¤ºåœ°å€ç»„ç»‡çš„åç§°å’Œæ€§è´¨ç­‰ç¼ºç‚¹ï¼Œäººä»¬è®¾è®¡å‡ºäº†åŸŸåï¼Œå¹¶é€šè¿‡ç½‘åŸŸåç§°ç³»ç»Ÿï¼ˆ<a href="https://baike.baidu.com/item/DNS">DNS</a>ï¼ŒDomain Name Systemï¼‰æ¥å°†åŸŸåå’Œ<a href="https://baike.baidu.com/item/IP%E5%9C%B0%E5%9D%80">IPåœ°å€</a>ç›¸äº’<a href="https://baike.baidu.com/item/%E6%98%A0%E5%B0%84/20402621">æ˜ å°„</a>ï¼Œä½¿äººæ›´æ–¹ä¾¿åœ°è®¿é—®<a href="https://baike.baidu.com/item/%E4%BA%92%E8%81%94%E7%BD%91/199186">äº’è”ç½‘</a>ï¼Œè€Œä¸ç”¨å»è®°ä½èƒ½å¤Ÿè¢«æœºå™¨ç›´æ¥è¯»å–çš„<a href="https://baike.baidu.com/item/IP%E5%9C%B0%E5%9D%80">IPåœ°å€</a>æ•°ä¸²ã€‚</p>
</blockquote>
<p>ç®€å•æ¥è¯´ï¼ŒIPåœ°å€å¯ä»¥æ ‡è¯†ä¸€å°è®¡ç®—æœºï¼Œä½†æ˜¯ä¸å®¹æ˜“è®°å¿†ï¼Œæ‰€ä»¥ï¼Œè®¾è®¡å‡ºäº†åŸŸåã€‚è€ŒåŸŸåå°±æ˜¯æ ‡è¯†å› ç‰¹ç½‘ä¸Šçš„ä¸€å°è®¡ç®—æœºï¼Œç”±ç½‘åŸŸåç§°ç³»ç»ŸDNSæ¥å®ŒæˆåŸŸåå’ŒIPä¹‹é—´çš„æ˜ å°„ã€‚</p>
<p>å¦‚ä½•æ³¨å†ŒåŸŸåï¼Ÿæœ‰å¾ˆå¤šç½‘ç«™æä¾›åŸŸåæ³¨å†ŒæœåŠ¡ï¼Œæ¯”å¦‚å›½å†…çš„ï¼š</p>
<ul>
<li><a href="https://www.alibabacloud.com/zh/domain">é˜¿é‡Œäº‘</a></li>
<li><a href="https://cloud.tencent.com/act/domainsales">è…¾è®¯äº‘</a></li>
<li><a href="https://www.huaweicloud.com/">åä¸ºäº‘</a></li>
</ul>
<p>å›½å¤–çš„ï¼š</p>
<ul>
<li><a href="https://sg.godaddy.com/zh/offers/domain">GoDaddy</a></li>
<li><a href="https://www.namecheap.com/">Namecheap</a></li>
<li><a href="https://console.aws.amazon.com/route53/home?#DomainRegistration:">Amazon</a></li>
</ul>
<p>æ³¨å†ŒåŸŸåçš„å»ºè®®ï¼š</p>
<ul>
<li>1ã€å»ºè®®åœ¨æ­£è§„ã€å‡ºåçš„ç½‘ç«™æ³¨å†ŒåŸŸåï¼Œé˜²æ­¢ç½‘ç«™è·‘è·¯ã€‚æˆ‘æ›¾ç»åœ¨ä¸€ä¸ªå°ç½‘ç«™æ³¨å†Œäº†ä¸€ä¸ªåŸŸåï¼Œä½¿ç”¨äº†å‡ å¹´ä¹‹åï¼Œç»­æœŸçš„æ—¶å€™ï¼Œè”ç³»ä¸ä¸Šå¯¹æ–¹ï¼Œå¯¼è‡´æ— æ³•ä½¿ç”¨è¯¥åŸŸåï¼Œç”šè‡³è¯¥åŸŸåè¢«åˆ«äººæŠ¢æ³¨å†Œäº†ã€‚</li>
<li>2ã€åœ¨å›½å†…ç½‘ç«™æ³¨å†ŒåŸŸåï¼Œéƒ½éœ€è¦å¤‡æ¡ˆã€‚å¦‚æœä¸æƒ³å¤‡æ¡ˆï¼Œè¯·åœ¨å›½å¤–ç½‘ç«™æ³¨å†ŒåŸŸåã€‚æˆ‘çš„åŸŸå chensoul.com å°±æ˜¯åœ¨äºšé©¬é€Šä¸Šæ³¨å†Œçš„ã€‚ä¸€æ˜¯ä¸æƒ³å¤‡æ¡ˆï¼ŒäºŒæ˜¯å¯¹æ¯”äº†ä¸Šé¢å‡ ä¸ªç½‘ç«™ï¼Œå‘ç°äºšé©¬é€Šä¸Šçš„comåŸŸåä»·æ ¼ç›¸å¯¹ä¾¿å®œï¼Œæ‰€ä»¥ä¸€æ¬¡æ€§è´­ä¹°äº†5å¹´ã€‚</li>
<li>3ã€å»ºè®®ä¼˜å…ˆæ³¨å†ŒcomåŸŸåï¼ŒåŸŸåå°½å¯èƒ½çš„ç®€çŸ­å¹¶ä¸”æ–¹ä¾¿è®°å¿†ã€‚</li>
</ul>
<p>æˆ‘æ›¾ç»æ³¨å†Œè¿‡çš„åŸŸåï¼š</p>
<ul>
<li>javachen.comã€javachen.spaceã€javachen.xyz</li>
<li>huaiu.com</li>
</ul>
<h2 id="æœåŠ¡å™¨">æœåŠ¡å™¨</h2>
<p>æ³¨å†Œäº†åŸŸåä¹‹åï¼Œéœ€è¦ä¸€å°æœåŠ¡å™¨è¿è¡Œç¨‹åºã€‚æœåŠ¡å™¨å¯ä»¥æ˜¯ä¸€å°ç‰©ç†æœºï¼Œæ¯”å¦‚ä½ å¯ä»¥ä½¿ç”¨è‡ªå·±çš„ç”µè„‘ä½œä¸ºæœåŠ¡å™¨ï¼›ä¹Ÿå¯ä»¥æ˜¯ä¸€å°è™šæ‹Ÿçš„äº‘æœåŠ¡å™¨ï¼Œæ¯”å¦‚åœ¨äº‘æœåŠ¡æä¾›å•†è´­ä¹°ä¸€å°ç‹¬ç«‹çš„æœåŠ¡å™¨ï¼›ä¹Ÿå¯ä»¥ä½¿ç”¨ç¬¬ä¸‰æ–¹æä¾›çš„æœåŠ¡å™¨ç©ºé—´ï¼Œæ¯”å¦‚Githubä¸Šå¯ä»¥éƒ¨ç½²é™æ€ç¨‹åºã€‚ä¸ç®¡å“ªç§æ–¹å¼ï¼ŒæœåŠ¡å™¨éƒ½éœ€è¦æœ‰ä¸€ä¸ªå…¬ç½‘IPï¼Œè¿™æ ·æ‰èƒ½åœ¨å› ç‰¹ç½‘ä¸Šè®¿é—®ä½ æœåŠ¡å™¨ä¸Šéƒ¨ç½²çš„ç¨‹åºã€‚æœ‰äº†æœåŠ¡å™¨ä¹‹åï¼Œå°±å¯ä»¥ç»™æœåŠ¡å™¨å…¬ç½‘IPè®¾ç½®åŸŸåè§£æã€‚</p>
<p>æˆ‘çš„æœåŠ¡å™¨æ˜¯åœ¨<a href="https://bandwagonhost.com/aff.php?aff=58710">æ¬ç“¦å·¥</a>è´­ä¹°çš„ï¼Œä¸€å¹´49.99ç¾å…ƒã€‚</p>
<p><img src="https://chensoul.oss-cn-hangzhou.aliyuncs.com/images/bwg-plan.png" alt="bwg-plan"></p>
<h2 id="ç¨‹åº">ç¨‹åº</h2>
<h3 id="å®‰è£…hugo">å®‰è£…Hugo</h3>
<p><img src="https://chensoul.oss-cn-hangzhou.aliyuncs.com/images/hugo-logo.svg" alt="ä½¿ç”¨ Hugo æ­å»ºåšå®¢"></p>
<p>åœ¨ Mac ä¸‹å®‰è£… Hugoï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">brew install hugo
</span></span></code></pre></div><h3 id="æ–°å»ºç«™ç‚¹">æ–°å»ºç«™ç‚¹</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">hugo new site chensoul.github.io -y yaml
</span></span></code></pre></div><p>ä¸Šè¿°å‘½ä»¤ä¼šç”Ÿæˆä¸€ä¸ªåä¸º <code>chensoul.github.io</code> çš„æ–‡ä»¶å¤¹ï¼Œä¸‹é¢å¯¹æ–‡ä»¶å¤¹ç»“æ„åšä¸ªè¯´æ˜ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ tree chensoul.github.io
</span></span><span class="line"><span class="cl">chensoul.github.io
</span></span><span class="line"><span class="cl">â”œâ”€â”€ archetypes
</span></span><span class="line"><span class="cl">â”‚   â””â”€â”€ default.md
</span></span><span class="line"><span class="cl">â”œâ”€â”€ config.yaml
</span></span><span class="line"><span class="cl">â”œâ”€â”€ content
</span></span><span class="line"><span class="cl">â”œâ”€â”€ data
</span></span><span class="line"><span class="cl">â”œâ”€â”€ layouts
</span></span><span class="line"><span class="cl">â”œâ”€â”€ static
</span></span><span class="line"><span class="cl">â””â”€â”€ themes
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="m">6</span> directories, <span class="m">2</span> files
</span></span></code></pre></div><p>æ–°å»ºçš„ç«™ç‚¹ï¼Œè¿˜æ²¡æœ‰åŠ å…¥ Git ç‰ˆæœ¬ç®¡ç†ï¼Œè¿›å…¥åˆ°è¿™ä¸ªç›®å½•ä¸‹ï¼Œæ‰§è¡Œä¸€ä¸‹å¦‚ä¸‹å‘½ä»¤ï¼Œå®Œæˆ Git Repo çš„åˆå§‹åŒ–ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">cd</span> chensoul.github.io
</span></span><span class="line"><span class="cl">git init . 
</span></span></code></pre></div><p>æ–°å»ºç«™ç‚¹åï¼Œæˆ‘ä»¬å¼€å§‹æ·»åŠ ä¸»é¢˜ã€‚</p>
<h3 id="æ·»åŠ ä¸»é¢˜">æ·»åŠ ä¸»é¢˜</h3>
<p>åœ¨ Hugo çš„å®˜ç½‘ä¸Š <a href="https://themes.gohugo.io/">Hugo Themes</a> æœ‰éå¸¸éå¸¸å¤šçš„ä¸»é¢˜ï¼Œå¯ä»¥æ ¹æ®è‡ªå·±çš„å–œå¥½é€‰æ‹©ä¸€ä¸ªä¸»é¢˜ã€‚è¿™é‡Œï¼Œæˆ‘ä½¿ç”¨çš„æ˜¯ hugo-theme-den ä¸»é¢˜ã€‚</p>
<p>ä½¿ç”¨ git submodule&ndash;helper ä¸‹è½½ä¸»é¢˜åˆ° theme ç›®å½•ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">git submodule--helper add https://github.com/shaform/hugo-theme-den themes/den --depth<span class="o">=</span><span class="m">1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">git submodule--helper update --init --recursive <span class="c1"># needed when you reclone your repo (submodules may not get cloned automatically)</span>
</span></span></code></pre></div><p>ä»¥åï¼Œå½“ä¸»é¢˜æœ‰æ›´æ–°æ—¶ï¼Œæ‰§è¡Œä¸‹é¢å‘½ä»¤æ›´æ–°ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">git submodule update --remote --merge
</span></span></code></pre></div><p>å¦‚æœé‡åˆ°å¼‚å¸¸ï¼Œå¯ä»¥å‚è€ƒ<a href="https://xuzhijvn.github.io/zh-cn/posts/other/git-submodule-update-init-recursive/">æ–‡ç« </a>è§£å†³ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">fatal: remote error: upload-pack: not our ref fc7223ca00124e8f5b5b354457379071e2fd091b
</span></span></code></pre></div><h3 id="å¯åŠ¨">å¯åŠ¨</h3>
<p>å¯åŠ¨é¢„è§ˆï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">hugo server
</span></span></code></pre></div><p>é»˜è®¤æ˜¯ <code>1313</code> ç«¯å£å·ï¼Œåœ¨æµè§ˆå™¨ä¸­ç›´æ¥è®¿é—® http://localhost:1313/ å°±å¯ä»¥è®¿é—®åˆ°æ–°å»ºçš„åšå®¢äº†ã€‚</p>
<h2 id="å®šåˆ¶åŒ–">å®šåˆ¶åŒ–</h2>
<h3 id="ç«™ç‚¹ä¿¡æ¯">ç«™ç‚¹ä¿¡æ¯</h3>
<p>é…ç½®ç½‘ç«™çš„åŸºæœ¬ä¿¡æ¯ï¼Œå°† config.yaml ä¿®æ”¹å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">baseURL: https://blog.chensoul.com/
</span></span><span class="line"><span class="cl">title: ChenSoul
</span></span><span class="line"><span class="cl">theme: den
</span></span><span class="line"><span class="cl">enableRobotsTXT: <span class="nb">true</span>
</span></span><span class="line"><span class="cl">enableEmoji: <span class="nb">true</span>
</span></span><span class="line"><span class="cl">hasCJKLanguage: <span class="nb">true</span>
</span></span><span class="line"><span class="cl">preserveTaxonomyNames: <span class="nb">true</span>
</span></span><span class="line"><span class="cl">rssLimit: <span class="m">100</span>
</span></span><span class="line"><span class="cl">page_view_conter: <span class="nb">true</span>
</span></span><span class="line"><span class="cl">enableRelated: <span class="nb">true</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Copyright, appears in the footer</span>
</span></span><span class="line"><span class="cl"><span class="c1"># copyright = &#34;&#34;             # default: author.name</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Pagination</span>
</span></span><span class="line"><span class="cl"><span class="c1"># number of entries per page for archives, tags and categories</span>
</span></span><span class="line"><span class="cl"><span class="c1"># since we don&#39;t have list view, recommend a large value</span>
</span></span><span class="line"><span class="cl">paginate: <span class="m">20</span>
</span></span><span class="line"><span class="cl">paginatePath: <span class="s2">&#34;page&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Syntax Hightlight</span>
</span></span><span class="line"><span class="cl">PygmentsCodeFences: <span class="nb">true</span>
</span></span><span class="line"><span class="cl">PygmentsUseClasses: <span class="nb">true</span>    <span class="c1"># required for shhighlight shortcode</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># service plugins</span>
</span></span><span class="line"><span class="cl">disqusShortname: <span class="s2">&#34;&#34;</span>         <span class="c1"># disqus_shortname</span>
</span></span><span class="line"><span class="cl">googleAnalytics: <span class="s2">&#34;&#34;</span>         <span class="c1"># UA-XXXXXXXX-X</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># language support # en / zh / other... translations present in i18n/</span>
</span></span><span class="line"><span class="cl">defaultContentLanguage: <span class="s2">&#34;zh&#34;</span>           <span class="c1"># Default language to use</span>
</span></span><span class="line"><span class="cl">defaultContentLanguageInSubdir: <span class="nb">true</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">permalinks:
</span></span><span class="line"><span class="cl">  posts: /posts/:slug/
</span></span><span class="line"><span class="cl">  categories: /categories/:slug/
</span></span><span class="line"><span class="cl">  tags: /tags/:slug/
</span></span><span class="line"><span class="cl">  pages: /:slug/
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">author:
</span></span><span class="line"><span class="cl">  name: chensoul
</span></span><span class="line"><span class="cl">sitemap:
</span></span><span class="line"><span class="cl">  changefreq: weekly
</span></span><span class="line"><span class="cl">  priority: 0.5
</span></span><span class="line"><span class="cl">  filename: sitemap.xml
</span></span><span class="line"><span class="cl">params:
</span></span><span class="line"><span class="cl">  since: <span class="s2">&#34;2020&#34;</span>
</span></span><span class="line"><span class="cl">  rssFullContent: <span class="nb">true</span>
</span></span><span class="line"><span class="cl">  keywords:
</span></span><span class="line"><span class="cl">    - devops
</span></span><span class="line"><span class="cl">    - programming
</span></span><span class="line"><span class="cl">  description: Programming <span class="p">|</span> Devops
</span></span><span class="line"><span class="cl">  logoTitle: ChenSoul
</span></span><span class="line"><span class="cl">  siteLogoImage: images/fly.png
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1"># headerTitle = &#34;chensoul&#34;                   # default: title</span>
</span></span><span class="line"><span class="cl">  headerImage: images/background.webp
</span></span><span class="line"><span class="cl">  showAuthorCard: <span class="nb">true</span>
</span></span><span class="line"><span class="cl">  showMenuLanguages: <span class="nb">true</span>
</span></span><span class="line"><span class="cl">  autoLoadComments: <span class="nb">false</span>
</span></span><span class="line"><span class="cl">  paginateOriginalStyle: <span class="nb">true</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1"># The date format to use; for a list of valid formats, see https://gohugo.io/functions/format/</span>
</span></span><span class="line"><span class="cl">  dateFormatToUse: 2006-01-02
</span></span><span class="line"><span class="cl">  google_verification: <span class="s2">&#34;D8XBzUhT4irNUQLKut79HFni0v3Xow4FY-oxUcsUlVk&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1"># Link custom CSS and JS assets</span>
</span></span><span class="line"><span class="cl">  <span class="c1">#   (relative to /static/css and /static/js respectively)</span>
</span></span><span class="line"><span class="cl">  customCSS: <span class="o">[]</span>
</span></span><span class="line"><span class="cl">  customJS: <span class="o">[]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">markup:
</span></span><span class="line"><span class="cl">  goldmark:
</span></span><span class="line"><span class="cl">    renderer:
</span></span><span class="line"><span class="cl">      unsafe: <span class="nb">true</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ---- Related Articles --------------- #</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ------------------------------------- #</span>
</span></span><span class="line"><span class="cl">related:
</span></span><span class="line"><span class="cl">  <span class="c1"># Only include matches with rank &gt;= threshold. This is a normalized rank between 0 and 100.</span>
</span></span><span class="line"><span class="cl">  threshold: <span class="m">50</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1"># To get stable &#34;See also&#34; sections we, by default, exclude newer related pages.</span>
</span></span><span class="line"><span class="cl">  includeNewer: <span class="nb">true</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1"># Will lower case keywords in both queries and in the indexes.</span>
</span></span><span class="line"><span class="cl">  toLower: <span class="nb">true</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  indices:
</span></span><span class="line"><span class="cl">    - name: categories
</span></span><span class="line"><span class="cl">      weight: <span class="m">200</span>
</span></span><span class="line"><span class="cl">    - name: keywords
</span></span><span class="line"><span class="cl">      weight: <span class="m">150</span>
</span></span><span class="line"><span class="cl">    - name: tags
</span></span><span class="line"><span class="cl">      weight: <span class="m">100</span>
</span></span><span class="line"><span class="cl">languages:
</span></span><span class="line"><span class="cl">  zh:
</span></span><span class="line"><span class="cl">    languageCode: zh
</span></span><span class="line"><span class="cl">    languageName: ä¸­æ–‡
</span></span><span class="line"><span class="cl">    contentDir: content
</span></span><span class="line"><span class="cl">    weight: <span class="m">1</span>
</span></span><span class="line"><span class="cl">    params:
</span></span><span class="line"><span class="cl">      description: Devops <span class="p">|</span> Programming
</span></span><span class="line"><span class="cl">    menu:
</span></span><span class="line"><span class="cl">      main:
</span></span><span class="line"><span class="cl">        - name: æ€è€ƒ
</span></span><span class="line"><span class="cl">          weight: <span class="m">10</span>
</span></span><span class="line"><span class="cl">          identifier: idea
</span></span><span class="line"><span class="cl">          url: categories/idea/
</span></span><span class="line"><span class="cl">      social:
</span></span><span class="line"><span class="cl">        - name: Telegram
</span></span><span class="line"><span class="cl">          weight: <span class="m">10</span>
</span></span><span class="line"><span class="cl">          identifier: telegram
</span></span><span class="line"><span class="cl">          url: https://t.me/chensoul_share
</span></span><span class="line"><span class="cl">        - name: Twitter
</span></span><span class="line"><span class="cl">          weight: <span class="m">20</span>
</span></span><span class="line"><span class="cl">          identifier: twitter
</span></span><span class="line"><span class="cl">          url: https://twitter.com/chensoul_eth
</span></span><span class="line"><span class="cl">        - name: BiliBili
</span></span><span class="line"><span class="cl">          weight: <span class="m">40</span>
</span></span><span class="line"><span class="cl">          identifier: bilibili
</span></span><span class="line"><span class="cl">          url: https://space.bilibili.com/699805065/
</span></span><span class="line"><span class="cl">      links:
</span></span><span class="line"><span class="cl">        - name: GitHub
</span></span><span class="line"><span class="cl">          weight: <span class="m">10</span>
</span></span><span class="line"><span class="cl">          identifier: github
</span></span><span class="line"><span class="cl">          url: https://github.com/chensoul
</span></span><span class="line"><span class="cl">        - name: Services
</span></span><span class="line"><span class="cl">          weight: <span class="m">20</span>
</span></span><span class="line"><span class="cl">          identifier: services-status
</span></span><span class="line"><span class="cl">          url: https://uptime.chensoul.com/status/services
</span></span><span class="line"><span class="cl">        - name: Analytics
</span></span><span class="line"><span class="cl">          weight: <span class="m">30</span>
</span></span><span class="line"><span class="cl">          identifier: chensoul-analytics
</span></span><span class="line"><span class="cl">          url: https://data.chensoul.com/share/8YKX7FUa/pseudoyu-blog
</span></span></code></pre></div><h2 id="éƒ¨ç½²">éƒ¨ç½²</h2>
<h3 id="github-actionséƒ¨ç½²">GitHub Actionséƒ¨ç½²</h3>
<p><strong>1ã€é¦–å…ˆåœ¨githubé‡Œåˆ›å»ºä¸€ä¸ªä»“åº“ï¼šchensoul.github.io</strong></p>
<p><strong>2ã€å°†æœ¬åœ°æ–‡ä»¶æäº¤åˆ°github</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">cd</span> chensoul.github.io
</span></span><span class="line"><span class="cl">git init .
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;# chensoul.github.io&#34;</span> &gt;&gt; README.md
</span></span><span class="line"><span class="cl">git remote add origin git@github.com:chensoul/chensoul.github.io.git
</span></span></code></pre></div><p><strong>3ã€å°†æœ¬åœ°ä»£ç æ¨é€åˆ°ä»“åº“</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">git commit -m <span class="s2">&#34;first commit&#34;</span>
</span></span><span class="line"><span class="cl">git push -u origin main
</span></span></code></pre></div><p><strong>4ã€åˆ›å»º GitHub Actions çš„ workflow</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">mkdir -p .github/workflows
</span></span><span class="line"><span class="cl">touch .github/workflows/gh-page.yml
</span></span></code></pre></div><p>gh-page.ymlå†…å®¹å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">github pages</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">on</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">workflow_dispatch</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">push</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">branches</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">hugo</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">jobs</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">deploy</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">runs-on</span><span class="p">:</span><span class="w"> </span><span class="l">ubuntu-18.04</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">timeout-minutes</span><span class="p">:</span><span class="w"> </span><span class="m">3</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">steps</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">Checkout</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l">actions/checkout@v2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">with</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">submodules</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">  </span><span class="c"># Fetch Hugo themes (true OR recursive)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">fetch-depth</span><span class="p">:</span><span class="w"> </span><span class="m">0</span><span class="w">    </span><span class="c"># Fetch all history for .GitInfo and .Lastmod</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">Setup hugo</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l">peaceiris/actions-hugo@v2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">with</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">hugo-version</span><span class="p">:</span><span class="w"> </span><span class="l">latest</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">extended</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">Build web</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l">hugo --minify</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">Deploy</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l">peaceiris/actions-gh-pages@v3</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">with</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">github_token</span><span class="p">:</span><span class="w"> </span><span class="l">${{ secrets.GITHUB_TOKEN }}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">publish_branch</span><span class="p">:</span><span class="w"> </span><span class="l">gh-pages</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">publish_dir</span><span class="p">:</span><span class="w"> </span><span class="l">./public</span><span class="w">
</span></span></span></code></pre></div><p>ä¸Šé¢çš„å·¥ä½œæµæ˜¯åœ¨ gh-pages åˆ†æ”¯ä¸Šè§¦å‘ï¼Œå½“æœ‰ä»£ç æäº¤æ—¶å€™ï¼Œä¼šè¿è¡Œ hugo å‘½ä»¤ç”Ÿæˆé™æ€æ–‡ä»¶ï¼ˆpublicç›®å½•ï¼‰ï¼Œå¹¶ä¸”å°†ä»–ä»¬æ¨é€åˆ°mainåˆ†æ”¯ã€‚</p>
<p>æ‰€ä»¥ï¼Œæˆ‘ä»¬éœ€è¦åŸºäºå½“å‰åˆ†æ”¯åˆ›å»ºä¸€ä¸ªæ–°åˆ†æ”¯ gh-pages ï¼Œå¹¶ä¸”æ¨é€åˆ°è¿œç¨‹ä»“åº“ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">git branch gh-pages
</span></span><span class="line"><span class="cl">git checkout gh-pages
</span></span><span class="line"><span class="cl">git push origin gh-pages
</span></span></code></pre></div><p><strong>5ã€ä¿®æ”¹ä»£ç ï¼Œæ¨é€åˆ°ä»“åº“ï¼Œè§¦å‘å·¥ä½œæµ</strong></p>
<p>åœ¨æœ¬åœ°ä¿®æ”¹æŸä¸ªæ–‡ä»¶ï¼Œæäº¤ä»£ç ï¼Œç„¶ååœ¨ github <a href="https://github.com/chensoul/chensoul.github.io/actions">ç½‘ç«™</a> æŸ¥çœ‹å·¥ä½œæµ</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">git push origin gh-pages
</span></span></code></pre></div><p><strong>7ã€è®¾ç½®è‡ªå®šä¹‰åŸŸå</strong></p>
<p>å‚è€ƒ<a href="https://docs.github.com/cn/pages/configuring-a-custom-domain-for-your-github-pages-site/managing-a-custom-domain-for-your-github-pages-site#configuring-a-subdomain">ç®¡ç† GitHub Pages ç«™ç‚¹çš„è‡ªå®šä¹‰åŸŸ</a>ï¼Œæ·»åŠ ä¸€ä¸ªè‡ªå®šä¹‰åŸŸåï¼šblog.chensoul.comï¼š</p>
<p><img src="https://chensoul.oss-cn-hangzhou.aliyuncs.com/images/github-page-settings.png" alt="github-page-settings"></p>
<p>æˆ–è€…ï¼Œåœ¨ä»“åº“çš„ static ç›®å½•åˆ›å»ºä¸€ä¸ªCNAMEæ–‡ä»¶ï¼Œå†…å®¹ä¸ºï¼šblog.chensoul.comï¼Œç„¶åï¼Œä¿å­˜æäº¤ï¼ŒGithub Actionsä¼šå°†è¯¥æ–‡ä»¶æ¨é€åˆ°mainåˆ†æ”¯ã€‚</p>
<p>ç„¶åï¼Œåœ¨äºšé©¬é€Šç½‘ç«™æ·»åŠ  <a href="https://console.aws.amazon.com/route53/v2/hostedzones#">CNAMEè®°å½•</a>ï¼š</p>
<p><img src="https://chensoul.oss-cn-hangzhou.aliyuncs.com/images/amazon-dns-settings.png" alt="amazon-dns-settings"></p>
<p>8ã€éƒ¨ç½²åˆ° CloudFlare Pages</p>
<p>å‚è€ƒ <a href="https://hee.ink/p/%E4%BB%8E-github-pages-%E8%BF%81%E7%A7%BB%E5%88%B0-cloudflare-pages-%E7%9A%84%E4%BD%93%E9%AA%8C%E4%B8%8E%E8%B8%A9%E5%9D%91%E5%B0%8F%E8%AE%B0/">ä» GitHub Pages è¿ç§»åˆ° CloudFlare Pages çš„ä½“éªŒä¸è¸©å‘å°è®°</a></p>
]]></content:encoded></item></channel></rss>