<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>周报-11｜从语雀迁移到Obsidian | ChenSoul</title><meta name=keywords content="review,yuque,obsidian,nodejs"><meta name=description content="前言 ​	图片：涨渡湖湿地水上森林公园
本篇是对 2023-03-13 到 2023-03-19 这周生活的记录与思考。首发在我的个人 博客，你可以移步了解更多或者给我留言。
这周的工作主要是重构、优化系统，工作节奏比之前轻缓了很多。这周也开始了开车上下班，除去周五去医院做检查，一共开了 4 天车。从汉口到光谷，一共 29 公里，如果早上 6:30 出发，就只需要 50 分钟；如果 6:45 出发，竟然需要两个小时，真是无语了。无奈之下，只能每天早点出门早点到公司，然后，打完卡之后，在公司楼下走路。
这周开始心里默默定了一个 flag，就是每天走路 10000 步。看了一下微信运动，基本上达成了，除了周五晚上因为加班，而少走了 64 步。
从语雀迁移到Obsidian 上周提到开始使用格志 APP 来写日志，使用了一段时间之后，发现了一些缺点：
部分功能收费 导出的 markdown 不支持图片显示 不支持本地存储 于是，放弃了使用格志 APP，继而在使用了一段时间 Obsidian 之后，改为使用 Obsidian 来写日志和周报。
为了不给自己太大压力，日报每天复盘内容包括以下几方面：
今日待办
学习
工作
生活
健身
导出语雀文档为 markdown 参考 yuque/yuque-exporter 文档，下载 yuque-exporter 之后进行导出操作，发现以下问题：
该项目需要使用的 nodejs 版本为 18.0.4 nodejs 使用正确的版本还是导出失败 于是，改为使用源码编译和运行导出。
1、先下载代码：
git clone https://github.com/yuque/yuque-exporter.git 2、修改 main.ts 中需要导出的语雀知识库地址为自己的仓库地址：
// Determining if an ESM module is main then run the code if (import."><meta name=author content="chensoul"><link rel=canonical href=https://blog.chensoul.com/posts/2023/03/20/weekly_review_11/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.css rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.js onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://blog.chensoul.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://blog.chensoul.com/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://blog.chensoul.com/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://blog.chensoul.com/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://blog.chensoul.com/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="周报-11｜从语雀迁移到Obsidian"><meta property="og:description" content="前言 ​	图片：涨渡湖湿地水上森林公园
本篇是对 2023-03-13 到 2023-03-19 这周生活的记录与思考。首发在我的个人 博客，你可以移步了解更多或者给我留言。
这周的工作主要是重构、优化系统，工作节奏比之前轻缓了很多。这周也开始了开车上下班，除去周五去医院做检查，一共开了 4 天车。从汉口到光谷，一共 29 公里，如果早上 6:30 出发，就只需要 50 分钟；如果 6:45 出发，竟然需要两个小时，真是无语了。无奈之下，只能每天早点出门早点到公司，然后，打完卡之后，在公司楼下走路。
这周开始心里默默定了一个 flag，就是每天走路 10000 步。看了一下微信运动，基本上达成了，除了周五晚上因为加班，而少走了 64 步。
从语雀迁移到Obsidian 上周提到开始使用格志 APP 来写日志，使用了一段时间之后，发现了一些缺点：
部分功能收费 导出的 markdown 不支持图片显示 不支持本地存储 于是，放弃了使用格志 APP，继而在使用了一段时间 Obsidian 之后，改为使用 Obsidian 来写日志和周报。
为了不给自己太大压力，日报每天复盘内容包括以下几方面：
今日待办
学习
工作
生活
健身
导出语雀文档为 markdown 参考 yuque/yuque-exporter 文档，下载 yuque-exporter 之后进行导出操作，发现以下问题：
该项目需要使用的 nodejs 版本为 18.0.4 nodejs 使用正确的版本还是导出失败 于是，改为使用源码编译和运行导出。
1、先下载代码：
git clone https://github.com/yuque/yuque-exporter.git 2、修改 main.ts 中需要导出的语雀知识库地址为自己的仓库地址：
// Determining if an ESM module is main then run the code if (import."><meta property="og:type" content="article"><meta property="og:url" content="https://blog.chensoul.com/posts/2023/03/20/weekly_review_11/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-03-20T11:00:00+08:00"><meta property="article:modified_time" content="2023-03-20T11:00:00+08:00"><meta property="og:site_name" content="ChenSoul"><meta name=twitter:card content="summary"><meta name=twitter:title content="周报-11｜从语雀迁移到Obsidian"><meta name=twitter:description content="前言 ​	图片：涨渡湖湿地水上森林公园
本篇是对 2023-03-13 到 2023-03-19 这周生活的记录与思考。首发在我的个人 博客，你可以移步了解更多或者给我留言。
这周的工作主要是重构、优化系统，工作节奏比之前轻缓了很多。这周也开始了开车上下班，除去周五去医院做检查，一共开了 4 天车。从汉口到光谷，一共 29 公里，如果早上 6:30 出发，就只需要 50 分钟；如果 6:45 出发，竟然需要两个小时，真是无语了。无奈之下，只能每天早点出门早点到公司，然后，打完卡之后，在公司楼下走路。
这周开始心里默默定了一个 flag，就是每天走路 10000 步。看了一下微信运动，基本上达成了，除了周五晚上因为加班，而少走了 64 步。
从语雀迁移到Obsidian 上周提到开始使用格志 APP 来写日志，使用了一段时间之后，发现了一些缺点：
部分功能收费 导出的 markdown 不支持图片显示 不支持本地存储 于是，放弃了使用格志 APP，继而在使用了一段时间 Obsidian 之后，改为使用 Obsidian 来写日志和周报。
为了不给自己太大压力，日报每天复盘内容包括以下几方面：
今日待办
学习
工作
生活
健身
导出语雀文档为 markdown 参考 yuque/yuque-exporter 文档，下载 yuque-exporter 之后进行导出操作，发现以下问题：
该项目需要使用的 nodejs 版本为 18.0.4 nodejs 使用正确的版本还是导出失败 于是，改为使用源码编译和运行导出。
1、先下载代码：
git clone https://github.com/yuque/yuque-exporter.git 2、修改 main.ts 中需要导出的语雀知识库地址为自己的仓库地址：
// Determining if an ESM module is main then run the code if (import."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://blog.chensoul.com/posts/"},{"@type":"ListItem","position":2,"name":"周报-11｜从语雀迁移到Obsidian","item":"https://blog.chensoul.com/posts/2023/03/20/weekly_review_11/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"周报-11｜从语雀迁移到Obsidian","name":"周报-11｜从语雀迁移到Obsidian","description":"前言 ​\t图片：涨渡湖湿地水上森林公园\n本篇是对 2023-03-13 到 2023-03-19 这周生活的记录与思考。首发在我的个人 博客，你可以移步了解更多或者给我留言。\n这周的工作主要是重构、优化系统，工作节奏比之前轻缓了很多。这周也开始了开车上下班，除去周五去医院做检查，一共开了 4 天车。从汉口到光谷，一共 29 公里，如果早上 6:30 出发，就只需要 50 分钟；如果 6:45 出发，竟然需要两个小时，真是无语了。无奈之下，只能每天早点出门早点到公司，然后，打完卡之后，在公司楼下走路。\n这周开始心里默默定了一个 flag，就是每天走路 10000 步。看了一下微信运动，基本上达成了，除了周五晚上因为加班，而少走了 64 步。\n从语雀迁移到Obsidian 上周提到开始使用格志 APP 来写日志，使用了一段时间之后，发现了一些缺点：\n部分功能收费 导出的 markdown 不支持图片显示 不支持本地存储 于是，放弃了使用格志 APP，继而在使用了一段时间 Obsidian 之后，改为使用 Obsidian 来写日志和周报。\n为了不给自己太大压力，日报每天复盘内容包括以下几方面：\n今日待办\n学习\n工作\n生活\n健身\n导出语雀文档为 markdown 参考 yuque/yuque-exporter 文档，下载 yuque-exporter 之后进行导出操作，发现以下问题：\n该项目需要使用的 nodejs 版本为 18.0.4 nodejs 使用正确的版本还是导出失败 于是，改为使用源码编译和运行导出。\n1、先下载代码：\ngit clone https://github.com/yuque/yuque-exporter.git 2、修改 main.ts 中需要导出的语雀知识库地址为自己的仓库地址：\n// Determining if an ESM module is main then run the code if (import.","keywords":["review","yuque","obsidian","nodejs"],"articleBody":"前言 ​\t图片：涨渡湖湿地水上森林公园\n本篇是对 2023-03-13 到 2023-03-19 这周生活的记录与思考。首发在我的个人 博客，你可以移步了解更多或者给我留言。\n这周的工作主要是重构、优化系统，工作节奏比之前轻缓了很多。这周也开始了开车上下班，除去周五去医院做检查，一共开了 4 天车。从汉口到光谷，一共 29 公里，如果早上 6:30 出发，就只需要 50 分钟；如果 6:45 出发，竟然需要两个小时，真是无语了。无奈之下，只能每天早点出门早点到公司，然后，打完卡之后，在公司楼下走路。\n这周开始心里默默定了一个 flag，就是每天走路 10000 步。看了一下微信运动，基本上达成了，除了周五晚上因为加班，而少走了 64 步。\n从语雀迁移到Obsidian 上周提到开始使用格志 APP 来写日志，使用了一段时间之后，发现了一些缺点：\n部分功能收费 导出的 markdown 不支持图片显示 不支持本地存储 于是，放弃了使用格志 APP，继而在使用了一段时间 Obsidian 之后，改为使用 Obsidian 来写日志和周报。\n为了不给自己太大压力，日报每天复盘内容包括以下几方面：\n今日待办\n学习\n工作\n生活\n健身\n导出语雀文档为 markdown 参考 yuque/yuque-exporter 文档，下载 yuque-exporter 之后进行导出操作，发现以下问题：\n该项目需要使用的 nodejs 版本为 18.0.4 nodejs 使用正确的版本还是导出失败 于是，改为使用源码编译和运行导出。\n1、先下载代码：\ngit clone https://github.com/yuque/yuque-exporter.git 2、修改 main.ts 中需要导出的语雀知识库地址为自己的仓库地址：\n// Determining if an ESM module is main then run the code if (import.meta.url.startsWith('file:')) { const modulePath = fileURLToPath(import.meta.url); if (process.argv[1] === modulePath) { const urlPaths = [ 'chensoul/rose', 'chensoul/growup', 'chensoul/tech', ]; await start({ urlPaths }); } } 3、参考 文档 申请语雀 TOKEN。\n4、下载项目依赖：\nnpm i 5、运行项目，开始导出：\nYUQUE_TOKEN=XXXXXX npm start 导出的文件在 storage 目录，接下来可以拷贝到 Obsidian 目录里。\n6、另外，可以对 yuque-exporter 源码做一些修改：\n导出的 markdown 文件不要有 frontmatter，修改 doc.ts 中 buildDoc 方法： export async function buildDoc(doc: TreeNode, mapping: Record\u003cstring, TreeNode\u003e) { const docDetail = await readJSON(path.join(metaDir, doc.namespace, 'docs', `${doc.url}.json`)); const content = await remark() .data('settings', { bullet: '-', listItemIndent: 'one' }) .use([ [ replaceHTML ], [ relativeLink, { doc, mapping }], [ downloadAsset, { doc, mapping }], ]) .process(docDetail.body); // doc.content = frontmatter(doc) + content.toString(); doc.content = content.toString(); // FIXME: remark will transform `*` to `\\*` doc.content = doc.content.replaceAll('\\\\*', '*'); return doc; } 导出的段落之间增加换行，修改 doc.ts 中 replaceHTML 方法： function replaceHTML() { return tree =\u003e { const htmlNodes = selectAll('html', tree) as Text[]; for (const node of htmlNodes) { if (node.value === '\n' || node.value === '') { node.type = 'text'; node.value = '\\n\\n\\n'; } } }; } 7、删除导出的 markdown 文件当中的锚点标签（例如：）\ncd storage # macos 上执行 find . -type f -name '*.md' -exec sed -i '' 's/\u003c\\/a\u003e//g' {} + 在上面的示例代码中，我们使用了 sed 命令来删除 Markdown 文件中所有的类似 的锚点标签。其中：\n-i '' 参数表示直接修改源文件，而不是输出到标准输出流。'' 表示在 macOS 系统上备份修改前的文件，如果在 Linux 系统上使用该命令，可以省略该参数。 s/\u003c\\/a\u003e//g 表示用空字符串替换所有符合正则表达式 \u003c\\/a\u003e 的字符串。该正则表达式匹配所有以 开头，以 \"\u003e 结尾的标签，且中间的文本不包含双引号。 8、将导出的 markdown 文件中的本地图片批量上传到图床，操作方法：使用 typora 打开 storage 目录，然后依次点击 格式、图像、上传所有本地图片\n好物分享 虽然大部分有意思的内容会分享在 『ChenSoul Share』Telegram 频道，不过还是挑选一部分在这里列举一下，感觉更像一个 newsletter 了。\n一些文章 GitHub Actions 成本优化：让你的团队更具竞争力\nNginx 开启 gzip 压缩\nObsidan日记、记账与自动同步\nDoprax搭建免费V2ray节点\nHi，土区 iCloud\n国区使用土耳其iCloud服务，手把手保姆级上车教程\n以上。\n","wordCount":"328","inLanguage":"en","datePublished":"2023-03-20T11:00:00+08:00","dateModified":"2023-03-20T11:00:00+08:00","author":{"@type":"Person","name":"chensoul"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.chensoul.com/posts/2023/03/20/weekly_review_11/"},"publisher":{"@type":"Organization","name":"ChenSoul","logo":{"@type":"ImageObject","url":"https://blog.chensoul.com/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://blog.chensoul.com/ accesskey=h title="ChenSoul (Alt + H)">ChenSoul</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://blog.chensoul.com/about/ title=关于><span>关于</span></a></li><li><a href=https://blog.chensoul.com/categories/ideas title=周报><span>周报</span></a></li><li><a href=https://blog.chensoul.com/categories/notes title=编程><span>编程</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>周报-11｜从语雀迁移到Obsidian</h1><div class=post-meta><span title='2023-03-20 11:00:00 +0800 +0800'>2023-03-20</span>&nbsp;·&nbsp;chensoul</div></header><div class=post-content><h2 id=前言>前言<a hidden class=anchor aria-hidden=true href=#前言>#</a></h2><p><img loading=lazy src=https://chensoul.oss-cn-hangzhou.aliyuncs.com/images/weekly-review-11-04.jpeg alt=weekly-review-11-04></p><p>​ 图片：<em>涨渡湖湿地水上森林公园</em></p><p>本篇是对 <code>2023-03-13</code> 到 <code>2023-03-19</code> 这周生活的记录与思考。首发在我的个人 <a href=https://blog.chensoul.com/>博客</a>，你可以移步了解更多或者给我留言。</p><p>这周的工作主要是重构、优化系统，工作节奏比之前轻缓了很多。这周也开始了开车上下班，除去周五去医院做检查，一共开了 4 天车。从汉口到光谷，一共 29 公里，如果早上 6:30 出发，就只需要 50 分钟；如果 6:45 出发，竟然需要两个小时，真是无语了。无奈之下，只能每天早点出门早点到公司，然后，打完卡之后，在公司楼下走路。</p><p>这周开始心里默默定了一个 flag，就是每天走路 10000 步。看了一下微信运动，基本上达成了，除了周五晚上因为加班，而少走了 64 步。</p><h2 id=从语雀迁移到obsidian>从语雀迁移到Obsidian<a hidden class=anchor aria-hidden=true href=#从语雀迁移到obsidian>#</a></h2><p>上周提到开始使用格志 APP 来写日志，使用了一段时间之后，发现了一些缺点：</p><ul><li>部分功能收费</li><li>导出的 markdown 不支持图片显示</li><li>不支持本地存储</li></ul><p>于是，放弃了使用格志 APP，继而在使用了一段时间 Obsidian 之后，改为使用 Obsidian 来写日志和周报。</p><p>为了不给自己太大压力，日报每天复盘内容包括以下几方面：</p><ul><li><p>今日待办</p></li><li><p>学习</p></li><li><p>工作</p></li><li><p>生活</p></li><li><p>健身</p></li></ul><h3 id=导出语雀文档为-markdown>导出语雀文档为 markdown<a hidden class=anchor aria-hidden=true href=#导出语雀文档为-markdown>#</a></h3><p>参考 <a href=https://github.com/yuque/yuque-exporter>yuque/yuque-exporter</a> 文档，下载 yuque-exporter 之后进行导出操作，发现以下问题：</p><ul><li>该项目需要使用的 nodejs 版本为 18.0.4</li><li>nodejs 使用正确的版本还是导出失败</li></ul><p>于是，改为使用源码编译和运行导出。</p><p>1、先下载代码：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>git clone https://github.com/yuque/yuque-exporter.git
</span></span></code></pre></div><p>2、修改 main.ts 中需要导出的语雀知识库地址为自己的仓库地址：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-ts data-lang=ts><span class=line><span class=cl><span class=c1>// Determining if an ESM module is main then run the code
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>if</span> <span class=p>(</span><span class=kr>import</span><span class=p>.</span><span class=nx>meta</span><span class=p>.</span><span class=nx>url</span><span class=p>.</span><span class=nx>startsWith</span><span class=p>(</span><span class=s1>&#39;file:&#39;</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=kr>module</span><span class=nx>Path</span> <span class=o>=</span> <span class=nx>fileURLToPath</span><span class=p>(</span><span class=kr>import</span><span class=p>.</span><span class=nx>meta</span><span class=p>.</span><span class=nx>url</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=nx>process</span><span class=p>.</span><span class=nx>argv</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>===</span> <span class=kr>module</span><span class=nx>Path</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>urlPaths</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>      <span class=s1>&#39;chensoul/rose&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=s1>&#39;chensoul/growup&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=s1>&#39;chensoul/tech&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=k>await</span> <span class=nx>start</span><span class=p>({</span> <span class=nx>urlPaths</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>3、参考 <a href=https://www.yuque.com/yuque/developer/api#785a3731>文档</a> 申请语雀 TOKEN。</p><p>4、下载项目依赖：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>npm i
</span></span></code></pre></div><p>5、运行项目，开始导出：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nv>YUQUE_TOKEN</span><span class=o>=</span>XXXXXX npm start
</span></span></code></pre></div><blockquote><p>导出的文件在 storage 目录，接下来可以拷贝到 Obsidian 目录里。</p></blockquote><p>6、另外，可以对 yuque-exporter 源码做一些修改：</p><ul><li>导出的 markdown 文件不要有 frontmatter，修改 doc.ts 中 buildDoc 方法：</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-ts data-lang=ts><span class=line><span class=cl><span class=kr>export</span> <span class=kr>async</span> <span class=kd>function</span> <span class=nx>buildDoc</span><span class=p>(</span><span class=nx>doc</span>: <span class=kt>TreeNode</span><span class=p>,</span> <span class=nx>mapping</span>: <span class=kt>Record</span><span class=p>&lt;</span><span class=nt>string</span><span class=err>,</span> <span class=na>TreeNode</span><span class=p>&gt;)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>docDetail</span> <span class=o>=</span> <span class=k>await</span> <span class=nx>readJSON</span><span class=p>(</span><span class=nx>path</span><span class=p>.</span><span class=nx>join</span><span class=p>(</span><span class=nx>metaDir</span><span class=p>,</span> <span class=nx>doc</span><span class=p>.</span><span class=kr>namespace</span><span class=p>,</span> <span class=s1>&#39;docs&#39;</span><span class=p>,</span> <span class=sb>`</span><span class=si>${</span><span class=nx>doc</span><span class=p>.</span><span class=nx>url</span><span class=si>}</span><span class=sb>.json`</span><span class=p>));</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>content</span> <span class=o>=</span> <span class=k>await</span> <span class=nx>remark</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>data</span><span class=p>(</span><span class=s1>&#39;settings&#39;</span><span class=p>,</span> <span class=p>{</span> <span class=nx>bullet</span><span class=o>:</span> <span class=s1>&#39;-&#39;</span><span class=p>,</span> <span class=nx>listItemIndent</span><span class=o>:</span> <span class=s1>&#39;one&#39;</span> <span class=p>})</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>use</span><span class=p>([</span>
</span></span><span class=line><span class=cl>      <span class=p>[</span> <span class=nx>replaceHTML</span> <span class=p>],</span>
</span></span><span class=line><span class=cl>      <span class=p>[</span> <span class=nx>relativeLink</span><span class=p>,</span> <span class=p>{</span> <span class=nx>doc</span><span class=p>,</span> <span class=nx>mapping</span> <span class=p>}],</span>
</span></span><span class=line><span class=cl>      <span class=p>[</span> <span class=nx>downloadAsset</span><span class=p>,</span> <span class=p>{</span> <span class=nx>doc</span><span class=p>,</span> <span class=nx>mapping</span> <span class=p>}],</span>
</span></span><span class=line><span class=cl>    <span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>process</span><span class=p>(</span><span class=nx>docDetail</span><span class=p>.</span><span class=nx>body</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>//  doc.content = frontmatter(doc) + content.toString();
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>doc</span><span class=p>.</span><span class=nx>content</span> <span class=o>=</span> <span class=nx>content</span><span class=p>.</span><span class=nx>toString</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// FIXME: remark will transform `*` to `\*`
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>doc</span><span class=p>.</span><span class=nx>content</span> <span class=o>=</span> <span class=nx>doc</span><span class=p>.</span><span class=nx>content</span><span class=p>.</span><span class=nx>replaceAll</span><span class=p>(</span><span class=s1>&#39;\\*&#39;</span><span class=p>,</span> <span class=s1>&#39;*&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nx>doc</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><ul><li>导出的段落之间增加换行，修改 doc.ts 中 replaceHTML 方法：</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-ts data-lang=ts><span class=line><span class=cl><span class=kd>function</span> <span class=nx>replaceHTML() {</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nx>tree</span> <span class=o>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>htmlNodes</span> <span class=o>=</span> <span class=nx>selectAll</span><span class=p>(</span><span class=s1>&#39;html&#39;</span><span class=p>,</span> <span class=nx>tree</span><span class=p>)</span> <span class=kr>as</span> <span class=nx>Text</span><span class=p>[];</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kr>const</span> <span class=nx>node</span> <span class=k>of</span> <span class=nx>htmlNodes</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=p>(</span><span class=nx>node</span><span class=p>.</span><span class=nx>value</span> <span class=o>===</span> <span class=s1>&#39;&lt;br /&gt;&#39;</span> <span class=o>||</span> <span class=nx>node</span><span class=p>.</span><span class=nx>value</span> <span class=o>===</span> <span class=s1>&#39;&lt;br/&gt;&#39;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>node</span><span class=p>.</span><span class=kr>type</span> <span class=o>=</span> <span class=s1>&#39;text&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=nx>node</span><span class=p>.</span><span class=nx>value</span> <span class=o>=</span> <span class=s1>&#39;\n\n\n&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>};</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>7、删除导出的 markdown 文件当中的锚点标签（例如：<code>&lt;a name="xx">&lt;/a></code>）</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> storage
</span></span><span class=line><span class=cl><span class=c1># macos 上执行</span>
</span></span><span class=line><span class=cl>find . -type f -name <span class=s1>&#39;*.md&#39;</span> -exec sed -i <span class=s1>&#39;&#39;</span> <span class=s1>&#39;s/&lt;a name=\&#34;[^\&#34;]*\&#34;&gt;&lt;\/a&gt;//g&#39;</span> <span class=o>{}</span> +
</span></span></code></pre></div><p>在上面的示例代码中，我们使用了 sed 命令来删除 Markdown 文件中所有的类似 <code>&lt;a name="xx">&lt;/a></code> 的锚点标签。其中：</p><ul><li><code>-i ''</code> 参数表示直接修改源文件，而不是输出到标准输出流。<code>''</code> 表示在 macOS 系统上备份修改前的文件，如果在 Linux 系统上使用该命令，可以省略该参数。</li><li><code>s/&lt;a name=\"[^\"]*\">&lt;\/a>//g</code> 表示用空字符串替换所有符合正则表达式 <code>&lt;a name=\"[^\"]*\">&lt;\/a></code> 的字符串。该正则表达式匹配所有以 <code>&lt;a name=</code> 开头，以 <code>">&lt;/a></code> 结尾的标签，且中间的文本不包含双引号。</li></ul><p>8、将导出的 markdown 文件中的本地图片批量上传到图床，操作方法：使用 typora 打开 storage 目录，然后依次点击 格式、图像、上传所有本地图片</p><h2 id=好物分享>好物分享<a hidden class=anchor aria-hidden=true href=#好物分享>#</a></h2><p>虽然大部分有意思的内容会分享在 『<a href=https://t.me/chensoul_share>ChenSoul Share</a>』Telegram 频道，不过还是挑选一部分在这里列举一下，感觉更像一个 newsletter 了。</p><h3 id=一些文章>一些文章<a hidden class=anchor aria-hidden=true href=#一些文章>#</a></h3><ul><li><p><a href=https://moelove.info/2023/03/21/GitHub-Actions-%E6%88%90%E6%9C%AC%E4%BC%98%E5%8C%96%E8%AE%A9%E4%BD%A0%E7%9A%84%E5%9B%A2%E9%98%9F%E6%9B%B4%E5%85%B7%E7%AB%9E%E4%BA%89%E5%8A%9B/>GitHub Actions 成本优化：让你的团队更具竞争力</a></p></li><li><p><a href=https://juemuren4449.com/archives/open-gzip-on-nginx>Nginx 开启 gzip 压缩</a></p></li><li><p><a href=https://www.superheaoz.top/2022/06/57091/>Obsidan日记、记账与自动同步</a></p></li><li><p><a href=https://elmagnifico.tech/2023/03/16/Doprax-V2ray/>Doprax搭建免费V2ray节点</a></p></li><li><p><a href=https://elizen.me/posts/2023/03/hi-icloud/>Hi，土区 iCloud</a></p></li><li><p><a href=https://btsogiwudc.feishu.cn/docx/CgoJdHyWKopl3UxV12GcG3psnjf>国区使用土耳其iCloud服务，手把手保姆级上车教程</a></p></li></ul><p>以上。</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://blog.chensoul.com/tags/review/>review</a></li><li><a href=https://blog.chensoul.com/tags/yuque/>yuque</a></li><li><a href=https://blog.chensoul.com/tags/obsidian/>obsidian</a></li><li><a href=https://blog.chensoul.com/tags/nodejs/>nodejs</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://blog.chensoul.com/>ChenSoul</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script async src=https://umami.chensoul.com/script.js data-website-id=f110cfa0-b737-4690-a032-2b9073a57fc3></script>
<script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>