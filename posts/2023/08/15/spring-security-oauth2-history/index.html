<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Spring Security和OAuth2发展过程 | ChenSoul</title>
<meta name=keywords content="spring-security"><meta name=description content="Spring Security 的发展过程
Spring Security 是一个功能强大且广泛使用的安全框架，为企业级应用程序提供了全面的安全性。Spring Security 最初是 Acegi Security 项目的一部分，于 2004 年发布，现在已经成为 Spring 生态系统的核心组件。 Spring Security 的发展过程可以分为三个阶段："><meta name=author content="chensoul"><link rel=canonical href=https://blog.chensoul.cc/posts/2023/08/15/spring-security-oauth2-history/><meta name=google-site-verification content="nBXwg45SBRjTX78SA-mH0asrAbsdu9c1nk0ObSry7aQ"><link crossorigin=anonymous href=/assets/css/stylesheet.899d9a536396b9b03c9eae0c99cc6ec954a90da94036f5390d131eb8071bb417.css integrity="sha256-iZ2aU2OWubA8nq4MmcxuyVSpDalANvU5DRMeuAcbtBc=" rel="preload stylesheet" as=style><link rel=icon href=https://blog.chensoul.cc/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://blog.chensoul.cc/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://blog.chensoul.cc/favicon-32x32.png><link rel=apple-touch-icon href=https://blog.chensoul.cc/apple-touch-icon.png><link rel=mask-icon href=https://blog.chensoul.cc/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://blog.chensoul.cc/posts/2023/08/15/spring-security-oauth2-history/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta name=baidu-site-verification content="codeva-FYpQY8JdLU"><meta property="og:title" content="Spring Security和OAuth2发展过程"><meta property="og:description" content="Spring Security 的发展过程
Spring Security 是一个功能强大且广泛使用的安全框架，为企业级应用程序提供了全面的安全性。Spring Security 最初是 Acegi Security 项目的一部分，于 2004 年发布，现在已经成为 Spring 生态系统的核心组件。 Spring Security 的发展过程可以分为三个阶段："><meta property="og:type" content="article"><meta property="og:url" content="https://blog.chensoul.cc/posts/2023/08/15/spring-security-oauth2-history/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-08-15T00:00:00+08:00"><meta property="article:modified_time" content="2023-08-15T00:00:00+08:00"><meta property="og:site_name" content="ChenSoul"><meta name=twitter:card content="summary"><meta name=twitter:title content="Spring Security和OAuth2发展过程"><meta name=twitter:description content="Spring Security 的发展过程
Spring Security 是一个功能强大且广泛使用的安全框架，为企业级应用程序提供了全面的安全性。Spring Security 最初是 Acegi Security 项目的一部分，于 2004 年发布，现在已经成为 Spring 生态系统的核心组件。 Spring Security 的发展过程可以分为三个阶段："><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://blog.chensoul.cc/posts/"},{"@type":"ListItem","position":2,"name":"Spring Security和OAuth2发展过程","item":"https://blog.chensoul.cc/posts/2023/08/15/spring-security-oauth2-history/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Spring Security和OAuth2发展过程","name":"Spring Security和OAuth2发展过程","description":"Spring Security 的发展过程 Spring Security 是一个功能强大且广泛使用的安全框架，为企业级应用程序提供了全面的安全性。Spring Security 最初是 Acegi Security 项目的一部分，于 2004 年发布，现在已经成为 Spring 生态系统的核心组件。 Spring Security 的发展过程可以分为三个阶段：\n","keywords":["spring-security"],"articleBody":"Spring Security 的发展过程 Spring Security 是一个功能强大且广泛使用的安全框架，为企业级应用程序提供了全面的安全性。Spring Security 最初是 Acegi Security 项目的一部分，于 2004 年发布，现在已经成为 Spring 生态系统的核心组件。 Spring Security 的发展过程可以分为三个阶段：\n第一阶段：Spring Security 起源于一个名为 Acegi Security 的开源项目，初期重点实现了 Spring 应用的身份认证和授权服务功能。2003 年，Acegi Security 作为一个孵化项目被捐献给 Spring 社区。2004 年，正式作为 Spring 框架的核心组件之一 Absorbed 进 Spring。并更名为 Spring Security。Spring Security 1.0 版本 Spring Security 1.0 版本发布于 2004 年。它提供了最基本的安全功能，包括身份验证和授权。身份验证是验证用户是否是他们所声称的人的过程。授权是确定用户是否有权访问特定资源的过程。 Spring Security 1.0 版本使用了以下技术来实现身份验证和授权：\n表单身份验证：表单身份验证是通过用户提交表单来验证用户身份的过程。 基于角色的访问控制 (RBAC)：RBAC 是一种授权模型，它将用户分配到角色，然后这些角色被授予对特定资源的访问权限。 第二阶段：Spring Security 2.0 版本 Spring Security 2.0 版本发布于 2006 年。它提供了更多的安全功能，包括加密和会话管理。加密是将数据转换成无法被他人理解的形式的过程。会话管理是跟踪用户会话的状态的过程。 Spring Security 2.0 版本使用了以下技术来实现加密和会话管理：\n安全套接字层 (SSL)：SSL 是一种加密协议，它可以保护数据在传输过程中不被窃听。 会话管理：Spring Security 提供了自己的会话管理实现，它可以跟踪用户会话的状态。 第三阶段：Spring Security 3.0 版本 Spring Security 3.0 版本发布于 2008 年。它是一个重大的版本更新，它提供了许多新的安全功能，包括 OAuth、SAML 和 OpenID。 OAuth 是一种授权框架，它允许第三方应用程序访问用户的资源。SAML 是一种单点登录 (SSO) 协议，它允许用户在一个地方登录，然后访问多个网站。OpenID 是一种开放的身份验证协议，它允许用户使用他们选择的身份提供商来验证他们的身份。 Spring Security 3.0 版本使用了以下技术来实现 OAuth、SAML 和 OpenID：\nOAuth：Spring Security 提供了自己的 OAuth 实现，它可以让你轻松地在你的应用程序中使用 OAuth。\nSAML：Spring Security 提供了自己的 SAML 实现，它可以让你轻松地在你的应用程序中使用 SAML。\nOpenID：Spring Security 提供了自己的 OpenID 实现，它可以让你轻松地在你的应用程序中使用 OpenID。\n以下是 Spring Security 的详细的发展过程和版本变化：\nAcegi Security：Acegi Security 是 Spring Security 的前身，最初由 Ben Alex 创建并于 2004 年发布。Acegi Security 提供了一组基于 Spring 的安全性功能，用于保护 Web 应用程序、Web 服务和基于 Spring 的应用程序。\nSpring Security 2：Spring Security 2 是 Acegi Security 的继任者，于 2006 年发布。Spring Security 2 提供了一些新的功能和改进，例如对 OpenID、LDAP 和 CAS 的支持，以及更好的集成和配置选项。\nSpring Security 3：Spring Security 3 于 2009 年发布，是 Spring Security 的一个重大更新。Spring Security 3 提供了更多的安全功能和改进，例如对 RESTful Web 服务的支持、基于注解的安全性、更好的 CSRF 防护、更好的密码存储和认证管理等。\nSpring Security 4：Spring Security 4 于 2015 年发布，带来了一些新的功能和改进，例如对 OAuth2、JWT 和 Spring Boot 的支持、更好的 SSO 和多因素认证等。\nSpring Security 5：Spring Security 5 于 2017 年发布，是一个重大的更新，带来了一些新的功能和改进，例如对 WebFlux 和 Reactive Spring 的支持、更好的 OAuth2 和 OpenID Connect 的支持、更好的密码编码和认证管理等。\nSpring Security 5.1：Spring Security 5.1 发布于 2018 年，主要提供了对 Spring Boot 2.1 的支持和一些新的功能，如 Kotlin DSL、OAuth2 支持的私有证书、JWT 生成器等。\nSpring Security 5.2：Spring Security 5.2 发布于 2019 年，带来了许多改进和新特性，包括对 Spring Cloud Gateway 和 Spring MVC 的 WebFlux 支持、OAuth2 和 OpenID Connect 的改进、更好的密码管理和认证、更好的跨域资源共享（CORS）支持等。\nSpring Security 5.3：Spring Security 5.3 发布于 2020 年，主要提供了更好的 WebFlux 和 RSocket 支持、更好的 OAuth2 支持、更好的测试和性能、更好的 Kotlin 支持、更好的 JUnit 5 支持等。\nSpring Security 5.4：Spring Security 5.4 发布于 2021 年，带来了一些新的功能和改进，例如对 Spring Boot 2.4 的支持、更好的 JWT 和 OAuth2 支持、更好的密码编码、更好的 WebFlux 和 RSocket 支持、更好的测试和性能等。\nSpring Security 5.5：是当前最新的版本，于 2022 年发布。Spring Security 5.5 带来了一些新的功能和改进，包括对 Spring Framework 6 和 Java 17 的支持、更好的密码编码和认证管理、更好的 OAuth2 和 OpenID Connect 支持、更好的 WebFlux 和 RSocket 支持、更好的测试和性能等。\nSpring Security 5.7：由于根据 Spring 官网发布的公告，WebSecurityConfigurerAdapter 已从 Spring Security 5.7.0-M2 中弃用。\nSpring Security 6.0：2022 年 11 月发布，WebSecurityConfigurerAdapter 已从 Spring Security API 中完全删除。它还影响了 2022 年 11 月新发布的 Spring Boot 3.0。\n除了不断改进和增强现有功能之外，Spring Security 还增加了对新的安全威胁的防御和支持，例如 CSRF、XSS、CSP 等。此外，Spring Security 还提供了许多有用的扩展和插件，例如 Spring Security OAuth、Spring Security SAML、Spring Security Kerberos 等，以满足不同的安全需求。\nSpring Security OAuth2 发展 Spring Security OAuth2 是一个用于构建安全的 OAuth2-based 网络应用的框架，它是 Spring Security 的一部分。下面是 Spring Security OAuth2 的发展过程：\n1. Spring Security OAuth2 V1.x – V2.0 最初的几个版本是为了构建一个安全的 OAuth2-based 网络应用。核心的功能包括：\n支持 OAuth2 协议的四种授权方式：授权码（authorization code）、隐式授权（implicit）、密码授权（resource owner password credentials）和客户端凭据（client credentials） 提供了一个简单易用的 API 用于构建 OAuth2 服务器和客户端 支持 JWT（JSON Web Tokens） 提供了详细的文档和示例代码 2. Spring Security OAuth2 V2.1 在 2.1 版本中，Spring Security OAuth2 进行了一系列的改进和扩展，包括：\n支持 OpenID Connect 1.0 支持 Token Introspection Endpoint 更好的支持 JWT，包括 JWS（JSON Web Signatures）和 JWE（JSON Web Encryption） 3. Spring Security 5.0 OAuth2 Login and OAuth2 Client 在 Spring Security 5.0 中，Spring Security OAuth2 的部分功能被合并到了 Spring Security 5.0 中，提供了 OAuth2 登录和客户端支持。\n4. Spring Security 5.1 OAuth2 Resource Server 在 Spring Security 5.1 中，Spring Security OAuth2 的资源服务器功能被合并到了 Spring Security 中。\n5. Spring Security 5.2 OAuth2 Authorization Server 在 Spring Security 5.2 中，Spring Security OAuth2 的授权服务器功能被合并到了 Spring Security 中。这是 Spring Security OAuth2 的最后一个独立版本。\n6. Spring Authorization Server 在 2020 年 4 月，Spring 宣布了一个新的项目——Spring Authorization Server，该项目旨在提供一个用于实现 OAuth 2.1 授权服务器的基础。\n7. Spring Security 5.3 and beyond 在 Spring Security 5.3 和之后的版本中，Spring Security OAuth2 的所有功能都被合并到了 Spring Security 中，而 Spring Security OAuth2 作为一个独立的项目已经停止开发。与之相对应的 Spring Security OAuth Boot 2 Autoconfig 也停止了开发。\n总结一下，目前，Spring Security OAuth2 的最新版本为 2.5.2.RELEASE，并且所有类都标注为 @Deprecated，官方也提供了一个迁移文档 OAuth 2.0 Migration Guide。\nSpring Boot 和 Spring OAuth2 版本关系 Spring Boot 和 Spring OAuth2 是可以配合使用的，主要注意版本匹配即可。\nSpring Boot 使用了特定版本的 Spring OAuth2 作为依赖。所以使用对应的 Spring Boot 版本，就会自动获取匹配的 Spring OAuth2 版本。\n举几个版本的例子：\nSpring Boot 1.5.x 使用 Spring OAuth2 2.0.x Spring Boot 2.0.x 使用 Spring OAuth2 2.0.x Spring Boot 2.1.x 使用 Spring OAuth2 2.1.x Spring Boot 2.2.x 使用 Spring OAuth2 2.2.x Spring Boot 2.3.x 使用 Spring OAuth2 2.3.x 所以使用 Spring Boot 时，不需要额外指定 Spring OAuth2 的版本，只需要选择匹配的 Spring Boot 版本即可。\n在配置和使用 Spring OAuth2 时，只需要参考 Spring OAuth2 的文档即可，不需要特别关注其版本。Spring Boot 会负责管理版本匹配。\n此外，从 Spring Boot 1.5 开始，Spring Security 已经集成了 OAuth2 的实现，可以直接使用 Spring Security 来实现 OAuth2，无需引入 Spring OAuth 项目。\n总之，Spring Boot 大大简化了 Spring OAuth2 的使用，只需要关注 Spring Boot 版本即可自动获取正确的 Spring OAuth2 版本。\nSpring Cloud 和 Spring OAuth2 版本关系 Spring Cloud 和 Spring OAuth2 版本之间没有固定的对应关系，但通常来说建议符合以下情况：\nSpring Cloud 版本越新，内置的 Spring OAuth 支持也会更稳定和完善。 Spring Cloud Hoxton/Greenwich 等主流版本，内置的 Spring OAuth 支持正常使用 Spring Security OAuth2 版本 2.x。 Spring Cloud Edgware 及更早版本，内置的 Spring OAuth 支持建议使用 Spring Security OAuth2 版本 1.x。 即使 Spring Cloud 版本和 Spring Security OAuth 版本不完全匹配，也无大碍，但功能和兼容性会受一定影响。 所以一般来说：\nSpring Cloud Finch/ Greenwich 等最新版本，建议使用 Spring Security OAuth2 版本 2.3.x 及以上。 Spring Cloud Edgware 到 Hoxton，建议使用 Spring Security OAuth2 版本 1.5.x 到 2.3.x 都可以。 Spring Cloud 版本比较早，如 Dalston 以下，建议使用 Spring Security OAuth2 版本 1.0.x 到 1.5.x。 但不是说版本一定要完全匹配，主要看自己需要用到的 Spring OAuth 功能是否得到支持。选择版本时优先考虑 Spring Cloud 版本的内置支持程度。此外，也可以根据项目其他依赖选择一个相对稳定的 Spring Security OAuth 版本。\nSpring Cloud Security Spring Cloud Security 提供了一种集成化的方式来实现微服务应用的安全功能。主要有以下几点：\n身份认证(Authentication) Spring Cloud Security 支持常见的认证方式，比如基于 OAuth2.0 的认证协议。可以实现集中式的认证管理，登入后获取访问令牌并在各个微服务之间传递。\n授权(Authorization) 支持基于 RBAC 和 ABAC 等授权模型。可以实现集中式的授权管理，给不同用户或组分配不同的访问权限。\n安全终端(Security Endpoints) 提供了安全终端的实现，比如/oauth/token 令牌访问端点、/userinfo 用户信息端点等。\n加密通信(Encryption) 支持在微服务之间进行安全的 HTTP 通信，通过 TLS/SSL 加密数据传输和服务间调用。\n日志审计(Logging \u0026 Auditing) 支持收集和记录安全相关的审计日志，比如授权错误日志、登入/登出日志等，方便管理和监控。\n安全配置(Security Configuration) 提供了弹性和易用的安全配置能力，如动态配置安全相关 Bean 等。\n集成支持(Integration Support) 天然支持 Spring Cloud 和 Springboot 项目，无缝集成从认证到授权的全套安全功能。\n所以总体来说，Spring Cloud Security 提供了一种标准化和集成的方式来实现微服务环境下的安全需求。开发人员可以更便捷地利用其丰富的功能。\n示例 Spring Security 如何实现 JSON Web Token 的功能？ Spring Security 可以通过如下方式实现 JSON Web Token(JWT)的功能：\n导入 spring-security-jwt 依赖。 1 2 3 4 5 6 7 8 9 org.springframework.boot spring-boot-starter-security org.springframework.security spring-security-jwt spring-boot-starter-security 版本信息如下：\nspring-boot-starter-parent 版本号：2.7.5 依赖的 spring-boot-starter-security 版本号：2.7.5 spring-boot-starter-security 是 Spring Boot 安全功能的启动器依赖，它会自动引入核心安全依赖：\nspring-security-core：Spring Security 的核心模块，提供认证、授权、安全相关的主要接口和组件。\nspring-security-config：提供了 Spring Security 的基础配置能力，包含过滤器链、密码编码器等。\nspring-security-web：提供了 web 安全相关的支持，如过滤器、登录表单、注解等。\nspring-security-crypto：包含密码哈希功能的实现类，用于对密码进行安全的加密存储。\nspring-security-data：包含了支持 JDBC 和 LDAP 等后端数据源的安全组件。\nspring-security-oauth2-client：提供了对 OAuth2 客户端功能的支持。主要提供以下 OAuth2 客户端相关功能：\n客户端注册和资源服务器配置：支持为客户端应用配置 clientId、secret 等信息。 客户端凭证获取：支持 BasicAuth 和密码模式获取 client credentials。 访问令牌请求：实现客户端向授权服务器请求访问令牌的功能，支持 password、refresh_token 等 grant 类型。 令牌存储：提供 TokenStore 接口的实现，支持在会话或数据库中存储/获取访问令牌。 资源服务器访问：通过访问令牌来访问受保护的资源，支持从请求头或参数中提取令牌。 刷新令牌：实现使用 refresh_token 来刷新过期的访问令牌功能。 用户授权：提供类似@PreAuthorize 注解来处理用户授权逻辑。 客户端详情：封装 ClientDetails 实现类，包含客户端注册信息。 默认令牌服务：DefaultTokenServices 实现类管理令牌生命周期。 请求工厂：提供 RestTemplate 和 Apache HTTP Components 等请求客户端。 spring-security-oauth2-client 模块同时也提供部分支持其他授权类型：\n授权码模式(authorization_code)：主流模式，客户端通过 auth code 获取 access token。 密码模式(password)：客户端直接提供用户名密码获取 token，适合 trusted 客户端。 隐藏式授权模式(implicit)：客户端直接获取 access token，不支持 refresh。 客户端模式(client_credentials)：客户端以自身名义请求资源服务，适合机密客户端。 资主授权模式(owner)：类似密码模式但用户需确认通过用户界面。 运行时审批模式(approval_prompt)：用户每次访问都需确认授权。 除了上述常见授权类型外，spring-security-oauth2-client 还提供了对以下模式的选择性支持：\n断路器模式(urn:ietf:params:oauth:grant-type:device_code) 分阶段授权模式(urn:ietf:params:oauth:grant-type:stage) 令牌交换模式(urn:ietf:params:oauth:grant-type:token-exchange) spring-security-oauth2-core：OAuth2 协议支持的核心部件。\n因此 spring-boot-starter-security 的版本始终保持与 spring-boot-starters 版本一致。\n当前较为主流和稳定的 spring-boot 版本有：\nSpring Boot 2.7.x 最新版 Spring Boot 2.6.x Spring Boot 2.5.x 对应的 spring-boot-starter-security 版本如下：\nSpring Boot 2.7.x - spring-boot-starter-security 2.7.x Spring Boot 2.6.x - spring-boot-starter-security 2.6.x Spring Boot 2.5.x - spring-boot-starter-security 2.5.x 所以在选择 spring boot 版本时，直接依赖 spring-boot-starter-security 而不用单独指定版本，就可以保证安全功能的版本一致性。\n目前大多数场景下可以使用 Spring Boot 2.6.x 或者 2.7.x 作为选择，它们内置的 spring-boot-starter-security 版本都很成熟。\n配置 JwtToken enhancer 来生成 JWT 令牌。 1 2 3 4 5 6 @Bean public JwtAccessTokenConverter jwtTokenEnhancer() { JwtAccessTokenConverter converter = new JwtAccessTokenConverter(); converter.setSigningKey(\"123456\"); return converter; } 定义 JwtTokenStore 来保存 JWT 令牌。 1 2 3 4 @Bean public TokenStore tokenStore() { return new JwtTokenStore(jwtTokenEnhancer()); } 在 AuthorizationServerConfigurerAdapter 配置类中设置 tokenStore。 1 2 3 4 @Override public void configure(AuthorizationServerEndpointsConfigurer endpoints) { endpoints.tokenStore(tokenStore()); } 客户端使用 JWT 令牌进行认证访问资源服务器。\n资源服务器使用 JwtTokenStore 和 JwtAccessTokenConverter 校验 JWT 令牌的合法性。\n解析 JWTpayload 获取用户信息，实现鉴权决策。\n1 String username = ((Jwt)authentication.getPrincipal()).getSubject(); 完整代码，配置类：\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 @Configuration @EnableWebSecurity public class SecurityConfig extends WebSecurityConfigurerAdapter { @Bean public JwtAccessTokenConverter accessTokenConverter() { JwtAccessTokenConverter converter = new JwtAccessTokenConverter(); converter.setSigningKey(\"as123456dfsdf\"); return converter; } @Bean public TokenStore tokenStore() { return new JwtTokenStore(accessTokenConverter()); } @Override protected void configure(HttpSecurity http) throws Exception { http.csrf().disable(); http .authorizeRequests() .antMatchers(\"/oauth/**\").permitAll(); } @Bean @Primary public DefaultTokenServices tokenServices() { DefaultTokenServices defaultTokenServices = new DefaultTokenServices(); defaultTokenServices.setTokenStore(tokenStore()); defaultTokenServices.setSupportRefreshToken(true); return defaultTokenServices; } } 授权服务器配置，使用客户端模式配置：\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 @Configuration public class AuthorizationServerConfig extends AuthorizationServerConfigurerAdapter { @Autowired private TokenStore tokenStore; @Override public void configure(ClientDetailsServiceConfigurer clients) throws Exception { clients.inMemory() .withClient(\"clientapp\") .secret(\"$2a$10$6aQQyhlhol4M1KAncczPdu4zX7/TgvjpOU.sWzt7j5Xl6W/z5V4cC\") .authorizedGrantTypes(\"password\"， \"refresh_token\") .scopes(\"read\"， \"write\") .accessTokenValiditySeconds(3600); } @Override public void configure(AuthorizationServerEndpointsConfigurer endpoints) throws Exception { endpoints.tokenStore(tokenStore) .authenticationManager(authenticationManager()); } } 主要配置：\n使用 ClientDetailsServiceConfigurer 配置客户端信息，如 clientId、secret 等 配置 tokenStore 配置 authenticationManager 来获取用户信息 这样就实现了基于客户端模式下的授权服务配置，客户端可以使用 clientId/secret 获取访问令牌而无需用户登录。\n客户端访问示例：\n1 curl -X POST http://localhost:8080/oauth/token -d \"grant_type=password\u0026username=user\u0026password=password\u0026client_id=clientapp\u0026client_secret=secret\" 让客户端在后台获取访问令牌，资源服务再使用令牌验证授权。\n","wordCount":"5855","inLanguage":"en","datePublished":"2023-08-15T00:00:00+08:00","dateModified":"2023-08-15T00:00:00+08:00","author":{"@type":"Person","name":"chensoul"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.chensoul.cc/posts/2023/08/15/spring-security-oauth2-history/"},"publisher":{"@type":"Organization","name":"ChenSoul","logo":{"@type":"ImageObject","url":"https://blog.chensoul.cc/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://blog.chensoul.cc/ accesskey=h title="ChenSoul (Alt + H)">ChenSoul</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://blog.chensoul.cc/categories title=分类><span>分类</span></a></li><li><a href=https://blog.chensoul.cc/tags title=标签><span>标签</span></a></li><li><a href=https://blog.chensoul.cc/search title="搜索 (Alt + /)" accesskey=/><span>搜索</span></a></li><li><a href=https://blog.chensoul.cc/index.xml title=订阅><span>订阅</span></a></li><li><a href=https://github.com/chensoul title=关于><span>关于</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">Spring Security和OAuth2发展过程</h1><div class=post-meta><span title='2023-08-15 00:00:00 +0800 CST'>2023-08-15</span>&nbsp;·&nbsp;12 min&nbsp;·&nbsp;5855 words&nbsp;·&nbsp;chensoul</div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#spring-security-%e7%9a%84%e5%8f%91%e5%b1%95%e8%bf%87%e7%a8%8b aria-label="Spring Security 的发展过程">Spring Security 的发展过程</a></li><li><a href=#spring-security-oauth2-%e5%8f%91%e5%b1%95 aria-label="Spring Security OAuth2 发展">Spring Security OAuth2 发展</a><ul><li><a href=#1-spring-security-oauth2-v1x--v20 aria-label="1. Spring Security OAuth2 V1.x – V2.0">1. Spring Security OAuth2 V1.x – V2.0</a></li><li><a href=#2-spring-security-oauth2-v21 aria-label="2. Spring Security OAuth2 V2.1">2. Spring Security OAuth2 V2.1</a></li><li><a href=#3-spring-security-50-oauth2-login-and-oauth2-client aria-label="3. Spring Security 5.0 OAuth2 Login and OAuth2 Client">3. Spring Security 5.0 OAuth2 Login and OAuth2 Client</a></li><li><a href=#4-spring-security-51-oauth2-resource-server aria-label="4. Spring Security 5.1 OAuth2 Resource Server">4. Spring Security 5.1 OAuth2 Resource Server</a></li><li><a href=#5-spring-security-52-oauth2-authorization-server aria-label="5. Spring Security 5.2 OAuth2 Authorization Server">5. Spring Security 5.2 OAuth2 Authorization Server</a></li><li><a href=#6-spring-authorization-server aria-label="6. Spring Authorization Server">6. Spring Authorization Server</a></li><li><a href=#7-spring-security-53-and-beyond aria-label="7. Spring Security 5.3 and beyond">7. Spring Security 5.3 and beyond</a></li></ul></li><li><a href=#spring-boot-%e5%92%8c-spring-oauth2-%e7%89%88%e6%9c%ac%e5%85%b3%e7%b3%bb aria-label="Spring Boot 和 Spring OAuth2 版本关系">Spring Boot 和 Spring OAuth2 版本关系</a></li><li><a href=#spring-cloud-%e5%92%8c-spring-oauth2-%e7%89%88%e6%9c%ac%e5%85%b3%e7%b3%bb aria-label="Spring Cloud 和 Spring OAuth2 版本关系">Spring Cloud 和 Spring OAuth2 版本关系</a></li><li><a href=#spring-cloud-security aria-label="Spring Cloud Security">Spring Cloud Security</a></li><li><a href=#%e7%a4%ba%e4%be%8b aria-label=示例>示例</a><ul><li><a href=#spring-security-%e5%a6%82%e4%bd%95%e5%ae%9e%e7%8e%b0-json-web-token-%e7%9a%84%e5%8a%9f%e8%83%bd aria-label="Spring Security 如何实现 JSON Web Token 的功能？">Spring Security 如何实现 JSON Web Token 的功能？</a></li></ul></li></ul></div></details></div><div class=post-content><h2 id=spring-security-的发展过程>Spring Security 的发展过程<a hidden class=anchor aria-hidden=true href=#spring-security-的发展过程>#</a></h2><p>Spring Security 是一个功能强大且广泛使用的安全框架，为企业级应用程序提供了全面的安全性。Spring Security 最初是 Acegi Security 项目的一部分，于 2004 年发布，现在已经成为 Spring 生态系统的核心组件。 Spring Security 的发展过程可以分为三个阶段：</p><p>第一阶段：Spring Security 起源于一个名为 Acegi Security 的开源项目，初期重点实现了 Spring 应用的身份认证和授权服务功能。2003 年，Acegi Security 作为一个孵化项目被捐献给 Spring 社区。2004 年，正式作为 Spring 框架的核心组件之一 Absorbed 进 Spring。并更名为 Spring Security。Spring Security 1.0 版本 Spring Security 1.0 版本发布于 2004 年。它提供了最基本的安全功能，包括身份验证和授权。身份验证是验证用户是否是他们所声称的人的过程。授权是确定用户是否有权访问特定资源的过程。 Spring Security 1.0 版本使用了以下技术来实现身份验证和授权：</p><ul><li>表单身份验证：表单身份验证是通过用户提交表单来验证用户身份的过程。</li><li>基于角色的访问控制 (RBAC)：RBAC 是一种授权模型，它将用户分配到角色，然后这些角色被授予对特定资源的访问权限。</li></ul><p>第二阶段：Spring Security 2.0 版本 Spring Security 2.0 版本发布于 2006 年。它提供了更多的安全功能，包括加密和会话管理。加密是将数据转换成无法被他人理解的形式的过程。会话管理是跟踪用户会话的状态的过程。 Spring Security 2.0 版本使用了以下技术来实现加密和会话管理：</p><ul><li>安全套接字层 (SSL)：SSL 是一种加密协议，它可以保护数据在传输过程中不被窃听。</li><li>会话管理：Spring Security 提供了自己的会话管理实现，它可以跟踪用户会话的状态。</li></ul><p>第三阶段：Spring Security 3.0 版本 Spring Security 3.0 版本发布于 2008 年。它是一个重大的版本更新，它提供了许多新的安全功能，包括 OAuth、SAML 和 OpenID。 OAuth 是一种授权框架，它允许第三方应用程序访问用户的资源。SAML 是一种单点登录 (SSO) 协议，它允许用户在一个地方登录，然后访问多个网站。OpenID 是一种开放的身份验证协议，它允许用户使用他们选择的身份提供商来验证他们的身份。 Spring Security 3.0 版本使用了以下技术来实现 OAuth、SAML 和 OpenID：</p><ul><li><p>OAuth：Spring Security 提供了自己的 OAuth 实现，它可以让你轻松地在你的应用程序中使用 OAuth。</p></li><li><p>SAML：Spring Security 提供了自己的 SAML 实现，它可以让你轻松地在你的应用程序中使用 SAML。</p></li><li><p>OpenID：Spring Security 提供了自己的 OpenID 实现，它可以让你轻松地在你的应用程序中使用 OpenID。</p></li></ul><p>以下是 Spring Security 的详细的发展过程和版本变化：</p><ol><li><p>Acegi Security：Acegi Security 是 Spring Security 的前身，最初由 Ben Alex 创建并于 2004 年发布。Acegi Security 提供了一组基于 Spring 的安全性功能，用于保护 Web 应用程序、Web 服务和基于 Spring 的应用程序。</p></li><li><p>Spring Security 2：Spring Security 2 是 Acegi Security 的继任者，于 2006 年发布。Spring Security 2 提供了一些新的功能和改进，例如对 OpenID、LDAP 和 CAS 的支持，以及更好的集成和配置选项。</p></li><li><p>Spring Security 3：Spring Security 3 于 2009 年发布，是 Spring Security 的一个重大更新。Spring Security 3 提供了更多的安全功能和改进，例如对 RESTful Web 服务的支持、基于注解的安全性、更好的 CSRF 防护、更好的密码存储和认证管理等。</p></li><li><p>Spring Security 4：Spring Security 4 于 2015 年发布，带来了一些新的功能和改进，例如对 OAuth2、JWT 和 Spring Boot 的支持、更好的 SSO 和多因素认证等。</p></li><li><p>Spring Security 5：Spring Security 5 于 2017 年发布，是一个重大的更新，带来了一些新的功能和改进，例如对 WebFlux 和 Reactive Spring 的支持、更好的 OAuth2 和 OpenID Connect 的支持、更好的密码编码和认证管理等。</p></li><li><p>Spring Security 5.1：Spring Security 5.1 发布于 2018 年，主要提供了对 Spring Boot 2.1 的支持和一些新的功能，如 Kotlin DSL、OAuth2 支持的私有证书、JWT 生成器等。</p></li><li><p>Spring Security 5.2：Spring Security 5.2 发布于 2019 年，带来了许多改进和新特性，包括对 Spring Cloud Gateway 和 Spring MVC 的 WebFlux 支持、OAuth2 和 OpenID Connect 的改进、更好的密码管理和认证、更好的跨域资源共享（CORS）支持等。</p></li><li><p>Spring Security 5.3：Spring Security 5.3 发布于 2020 年，主要提供了更好的 WebFlux 和 RSocket 支持、更好的 OAuth2 支持、更好的测试和性能、更好的 Kotlin 支持、更好的 JUnit 5 支持等。</p></li><li><p>Spring Security 5.4：Spring Security 5.4 发布于 2021 年，带来了一些新的功能和改进，例如对 Spring Boot 2.4 的支持、更好的 JWT 和 OAuth2 支持、更好的密码编码、更好的 WebFlux 和 RSocket 支持、更好的测试和性能等。</p></li><li><p>Spring Security 5.5：是当前最新的版本，于 2022 年发布。Spring Security 5.5 带来了一些新的功能和改进，包括对 Spring Framework 6 和 Java 17 的支持、更好的密码编码和认证管理、更好的 OAuth2 和 OpenID Connect 支持、更好的 WebFlux 和 RSocket 支持、更好的测试和性能等。</p></li><li><p>Spring Security 5.7：由于<a href=https://javatechonline.com/spring-security-without-websecurityconfigureradapter/ target=_blank>根据 Spring 官网发布的公告</a>，WebSecurityConfigurerAdapter 已从 Spring Security 5.7.0-M2 中弃用。</p></li><li><p>Spring Security 6.0：2022 年 11 月发布，WebSecurityConfigurerAdapter 已从 Spring Security API 中完全删除。它还影响了 2022 年 11 月新发布的 <a href=https://javatechonline.com/new-features-in-spring-boot-3-and-spring-6/ target=_blank>Spring Boot 3.0</a>。</p><p>除了不断改进和增强现有功能之外，Spring Security 还增加了对新的安全威胁的防御和支持，例如 CSRF、XSS、CSP 等。此外，Spring Security 还提供了许多有用的扩展和插件，例如 Spring Security OAuth、Spring Security SAML、Spring Security Kerberos 等，以满足不同的安全需求。</p></li></ol><h2 id=spring-security-oauth2-发展>Spring Security OAuth2 发展<a hidden class=anchor aria-hidden=true href=#spring-security-oauth2-发展>#</a></h2><p><a href=https://github.com/spring-attic/spring-security-oauth target=_blank>Spring Security OAuth2</a> 是一个用于构建安全的 OAuth2-based 网络应用的框架，它是 Spring Security 的一部分。下面是 Spring Security OAuth2 的发展过程：</p><h3 id=1-spring-security-oauth2-v1x--v20>1. Spring Security OAuth2 V1.x – V2.0<a hidden class=anchor aria-hidden=true href=#1-spring-security-oauth2-v1x--v20>#</a></h3><p>最初的几个版本是为了构建一个安全的 OAuth2-based 网络应用。核心的功能包括：</p><ul><li>支持 OAuth2 协议的四种授权方式：授权码（authorization code）、隐式授权（implicit）、密码授权（resource owner password credentials）和客户端凭据（client credentials）</li><li>提供了一个简单易用的 API 用于构建 OAuth2 服务器和客户端</li><li>支持 JWT（JSON Web Tokens）</li><li>提供了详细的文档和示例代码</li></ul><h3 id=2-spring-security-oauth2-v21>2. Spring Security OAuth2 V2.1<a hidden class=anchor aria-hidden=true href=#2-spring-security-oauth2-v21>#</a></h3><p>在 2.1 版本中，Spring Security OAuth2 进行了一系列的改进和扩展，包括：</p><ul><li>支持 OpenID Connect 1.0</li><li>支持 Token Introspection Endpoint</li><li>更好的支持 JWT，包括 JWS（JSON Web Signatures）和 JWE（JSON Web Encryption）</li></ul><h3 id=3-spring-security-50-oauth2-login-and-oauth2-client>3. Spring Security 5.0 OAuth2 Login and OAuth2 Client<a hidden class=anchor aria-hidden=true href=#3-spring-security-50-oauth2-login-and-oauth2-client>#</a></h3><p>在 Spring Security 5.0 中，Spring Security OAuth2 的部分功能被合并到了 Spring Security 5.0 中，提供了 OAuth2 登录和客户端支持。</p><h3 id=4-spring-security-51-oauth2-resource-server>4. Spring Security 5.1 OAuth2 Resource Server<a hidden class=anchor aria-hidden=true href=#4-spring-security-51-oauth2-resource-server>#</a></h3><p>在 Spring Security 5.1 中，Spring Security OAuth2 的资源服务器功能被合并到了 Spring Security 中。</p><h3 id=5-spring-security-52-oauth2-authorization-server>5. Spring Security 5.2 OAuth2 Authorization Server<a hidden class=anchor aria-hidden=true href=#5-spring-security-52-oauth2-authorization-server>#</a></h3><p>在 Spring Security 5.2 中，Spring Security OAuth2 的授权服务器功能被合并到了 Spring Security 中。这是 Spring Security OAuth2 的最后一个独立版本。</p><h3 id=6-spring-authorization-server>6. Spring Authorization Server<a hidden class=anchor aria-hidden=true href=#6-spring-authorization-server>#</a></h3><p>在 2020 年 4 月，Spring 宣布了一个新的项目——Spring Authorization Server，该项目旨在提供一个用于实现 OAuth 2.1 授权服务器的基础。</p><h3 id=7-spring-security-53-and-beyond>7. Spring Security 5.3 and beyond<a hidden class=anchor aria-hidden=true href=#7-spring-security-53-and-beyond>#</a></h3><p>在 Spring Security 5.3 和之后的版本中，Spring Security OAuth2 的所有功能都被合并到了 Spring Security 中，而 <a href=https://github.com/spring-attic/spring-security-oauth target=_blank>Spring Security OAuth2</a> 作为一个独立的项目已经停止开发。与之相对应的 <a href=https://github.com/spring-attic/spring-security-oauth2-boot target=_blank>Spring Security OAuth Boot 2 Autoconfig</a> 也停止了开发。</p><p>总结一下，目前，Spring Security OAuth2 的最新版本为 2.5.2.RELEASE，并且所有类都标注为 @Deprecated，官方也提供了一个迁移文档 <a href=https://github.com/spring-projects/spring-security/wiki/OAuth-2.0-Migration-Guide target=_blank>OAuth 2.0 Migration Guide</a>。</p><h2 id=spring-boot-和-spring-oauth2-版本关系>Spring Boot 和 Spring OAuth2 版本关系<a hidden class=anchor aria-hidden=true href=#spring-boot-和-spring-oauth2-版本关系>#</a></h2><p>Spring Boot 和 Spring OAuth2 是可以配合使用的，主要注意版本匹配即可。</p><p>Spring Boot 使用了特定版本的 Spring OAuth2 作为依赖。所以使用对应的 Spring Boot 版本，就会自动获取匹配的 Spring OAuth2 版本。</p><p>举几个版本的例子：</p><ul><li>Spring Boot 1.5.x 使用 Spring OAuth2 2.0.x</li><li>Spring Boot 2.0.x 使用 Spring OAuth2 2.0.x</li><li>Spring Boot 2.1.x 使用 Spring OAuth2 2.1.x</li><li>Spring Boot 2.2.x 使用 Spring OAuth2 2.2.x</li><li>Spring Boot 2.3.x 使用 Spring OAuth2 2.3.x</li></ul><p>所以使用 Spring Boot 时，不需要额外指定 Spring OAuth2 的版本，只需要选择匹配的 Spring Boot 版本即可。</p><p>在配置和使用 Spring OAuth2 时，只需要参考 Spring OAuth2 的文档即可，不需要特别关注其版本。Spring Boot 会负责管理版本匹配。</p><p>此外，从 Spring Boot 1.5 开始，Spring Security 已经集成了 OAuth2 的实现，可以直接使用 Spring Security 来实现 OAuth2，无需引入 Spring OAuth 项目。</p><p>总之，Spring Boot 大大简化了 Spring OAuth2 的使用，只需要关注 Spring Boot 版本即可自动获取正确的 Spring OAuth2 版本。</p><h2 id=spring-cloud-和-spring-oauth2-版本关系>Spring Cloud 和 Spring OAuth2 版本关系<a hidden class=anchor aria-hidden=true href=#spring-cloud-和-spring-oauth2-版本关系>#</a></h2><p>Spring Cloud 和 Spring OAuth2 版本之间没有固定的对应关系，但通常来说建议符合以下情况：</p><ul><li>Spring Cloud 版本越新，内置的 Spring OAuth 支持也会更稳定和完善。</li><li>Spring Cloud Hoxton/Greenwich 等主流版本，内置的 Spring OAuth 支持正常使用 Spring Security OAuth2 版本 2.x。</li><li>Spring Cloud Edgware 及更早版本，内置的 Spring OAuth 支持建议使用 Spring Security OAuth2 版本 1.x。</li><li>即使 Spring Cloud 版本和 Spring Security OAuth 版本不完全匹配，也无大碍，但功能和兼容性会受一定影响。</li></ul><p>所以一般来说：</p><ul><li>Spring Cloud Finch/ Greenwich 等最新版本，建议使用 Spring Security OAuth2 版本 2.3.x 及以上。</li><li>Spring Cloud Edgware 到 Hoxton，建议使用 Spring Security OAuth2 版本 1.5.x 到 2.3.x 都可以。</li><li>Spring Cloud 版本比较早，如 Dalston 以下，建议使用 Spring Security OAuth2 版本 1.0.x 到 1.5.x。</li></ul><p>但不是说版本一定要完全匹配，主要看自己需要用到的 Spring OAuth 功能是否得到支持。选择版本时优先考虑 Spring Cloud 版本的内置支持程度。此外，也可以根据项目其他依赖选择一个相对稳定的 Spring Security OAuth 版本。</p><h2 id=spring-cloud-security>Spring Cloud Security<a hidden class=anchor aria-hidden=true href=#spring-cloud-security>#</a></h2><p>Spring Cloud Security 提供了一种集成化的方式来实现微服务应用的安全功能。主要有以下几点：</p><ol><li>身份认证(Authentication)</li></ol><p>Spring Cloud Security 支持常见的认证方式，比如基于 OAuth2.0 的认证协议。可以实现集中式的认证管理，登入后获取访问令牌并在各个微服务之间传递。</p><ol><li>授权(Authorization)</li></ol><p>支持基于 RBAC 和 ABAC 等授权模型。可以实现集中式的授权管理，给不同用户或组分配不同的访问权限。</p><ol><li>安全终端(Security Endpoints)</li></ol><p>提供了安全终端的实现，比如/oauth/token 令牌访问端点、/userinfo 用户信息端点等。</p><ol><li>加密通信(Encryption)</li></ol><p>支持在微服务之间进行安全的 HTTP 通信，通过 TLS/SSL 加密数据传输和服务间调用。</p><ol><li>日志审计(Logging & Auditing)</li></ol><p>支持收集和记录安全相关的审计日志，比如授权错误日志、登入/登出日志等，方便管理和监控。</p><ol><li>安全配置(Security Configuration)</li></ol><p>提供了弹性和易用的安全配置能力，如动态配置安全相关 Bean 等。</p><ol><li>集成支持(Integration Support)</li></ol><p>天然支持 Spring Cloud 和 Springboot 项目，无缝集成从认证到授权的全套安全功能。</p><p>所以总体来说，Spring Cloud Security 提供了一种标准化和集成的方式来实现微服务环境下的安全需求。开发人员可以更便捷地利用其丰富的功能。</p><h2 id=示例>示例<a hidden class=anchor aria-hidden=true href=#示例>#</a></h2><h3 id=spring-security-如何实现-json-web-token-的功能>Spring Security 如何实现 JSON Web Token 的功能？<a hidden class=anchor aria-hidden=true href=#spring-security-如何实现-json-web-token-的功能>#</a></h3><p>Spring Security 可以通过如下方式实现 JSON Web Token(JWT)的功能：</p><ol><li>导入 spring-security-jwt 依赖。</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;dependency&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;groupId&gt;</span>org.springframework.boot<span class=nt>&lt;/groupId&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;artifactId&gt;</span>spring-boot-starter-security<span class=nt>&lt;/artifactId&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/dependency&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nt>&lt;dependency&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;groupId&gt;</span>org.springframework.security<span class=nt>&lt;/groupId&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;artifactId&gt;</span>spring-security-jwt<span class=nt>&lt;/artifactId&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/dependency&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>spring-boot-starter-security 版本信息如下：</p><ul><li>spring-boot-starter-parent 版本号：2.7.5</li><li>依赖的 spring-boot-starter-security 版本号：2.7.5</li></ul><p>spring-boot-starter-security 是 Spring Boot 安全功能的启动器依赖，它会自动引入核心安全依赖：</p><ul><li><p>spring-security-core：Spring Security 的核心模块，提供认证、授权、安全相关的主要接口和组件。</p></li><li><p>spring-security-config：提供了 Spring Security 的基础配置能力，包含过滤器链、密码编码器等。</p></li><li><p>spring-security-web：提供了 web 安全相关的支持，如过滤器、登录表单、注解等。</p></li><li><p>spring-security-crypto：包含密码哈希功能的实现类，用于对密码进行安全的加密存储。</p></li><li><p>spring-security-data：包含了支持 JDBC 和 LDAP 等后端数据源的安全组件。</p></li><li><p>spring-security-oauth2-client：提供了对 OAuth2 客户端功能的支持。主要提供以下 OAuth2 客户端相关功能：</p><ul><li>客户端注册和资源服务器配置：支持为客户端应用配置 clientId、secret 等信息。</li><li>客户端凭证获取：支持 BasicAuth 和密码模式获取 client credentials。</li><li>访问令牌请求：实现客户端向授权服务器请求访问令牌的功能，支持 password、refresh_token 等 grant 类型。</li><li>令牌存储：提供 TokenStore 接口的实现，支持在会话或数据库中存储/获取访问令牌。</li><li>资源服务器访问：通过访问令牌来访问受保护的资源，支持从请求头或参数中提取令牌。</li><li>刷新令牌：实现使用 refresh_token 来刷新过期的访问令牌功能。</li><li>用户授权：提供类似@PreAuthorize 注解来处理用户授权逻辑。</li><li>客户端详情：封装 ClientDetails 实现类，包含客户端注册信息。</li><li>默认令牌服务：DefaultTokenServices 实现类管理令牌生命周期。</li><li>请求工厂：提供 RestTemplate 和 Apache HTTP Components 等请求客户端。</li></ul><p>spring-security-oauth2-client 模块同时也提供部分支持其他授权类型：</p><ul><li>授权码模式(authorization_code)：主流模式，客户端通过 auth code 获取 access token。</li><li>密码模式(password)：客户端直接提供用户名密码获取 token，适合 trusted 客户端。</li><li>隐藏式授权模式(implicit)：客户端直接获取 access token，不支持 refresh。</li><li>客户端模式(client_credentials)：客户端以自身名义请求资源服务，适合机密客户端。</li><li>资主授权模式(owner)：类似密码模式但用户需确认通过用户界面。</li><li>运行时审批模式(approval_prompt)：用户每次访问都需确认授权。</li></ul><p>除了上述常见授权类型外，spring-security-oauth2-client 还提供了对以下模式的选择性支持：</p><ul><li>断路器模式(urn:ietf:params:oauth:grant-type:device_code)</li><li>分阶段授权模式(urn:ietf:params:oauth:grant-type:stage)</li><li>令牌交换模式(urn:ietf:params:oauth:grant-type:token-exchange)</li></ul></li><li><p>spring-security-oauth2-core：OAuth2 协议支持的核心部件。</p></li></ul><p>因此 spring-boot-starter-security 的版本始终保持与 spring-boot-starters 版本一致。</p><p>当前较为主流和稳定的 spring-boot 版本有：</p><ul><li>Spring Boot 2.7.x 最新版</li><li>Spring Boot 2.6.x</li><li>Spring Boot 2.5.x</li></ul><p>对应的 spring-boot-starter-security 版本如下：</p><ul><li>Spring Boot 2.7.x - spring-boot-starter-security 2.7.x</li><li>Spring Boot 2.6.x - spring-boot-starter-security 2.6.x</li><li>Spring Boot 2.5.x - spring-boot-starter-security 2.5.x</li></ul><p>所以在选择 spring boot 版本时，直接依赖 spring-boot-starter-security 而不用单独指定版本，就可以保证安全功能的版本一致性。</p><p>目前大多数场景下可以使用 Spring Boot 2.6.x 或者 2.7.x 作为选择，它们内置的 spring-boot-starter-security 版本都很成熟。</p><ol start=2><li>配置 JwtToken enhancer 来生成 JWT 令牌。</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Bean</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=n>JwtAccessTokenConverter</span><span class=w> </span><span class=nf>jwtTokenEnhancer</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>JwtAccessTokenConverter</span><span class=w> </span><span class=n>converter</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>JwtAccessTokenConverter</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>converter</span><span class=p>.</span><span class=na>setSigningKey</span><span class=p>(</span><span class=s>&#34;123456&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>return</span><span class=w> </span><span class=n>converter</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><ol start=3><li>定义 JwtTokenStore 来保存 JWT 令牌。</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Bean</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=n>TokenStore</span><span class=w> </span><span class=nf>tokenStore</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>return</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>JwtTokenStore</span><span class=p>(</span><span class=n>jwtTokenEnhancer</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><ol start=4><li>在 AuthorizationServerConfigurerAdapter 配置类中设置 tokenStore。</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>configure</span><span class=p>(</span><span class=n>AuthorizationServerEndpointsConfigurer</span><span class=w> </span><span class=n>endpoints</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>endpoints</span><span class=p>.</span><span class=na>tokenStore</span><span class=p>(</span><span class=n>tokenStore</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><ol start=5><li><p>客户端使用 JWT 令牌进行认证访问资源服务器。</p></li><li><p>资源服务器使用 JwtTokenStore 和 JwtAccessTokenConverter 校验 JWT 令牌的合法性。</p></li><li><p>解析 JWTpayload 获取用户信息，实现鉴权决策。</p></li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>String</span><span class=w> </span><span class=n>username</span><span class=w> </span><span class=o>=</span><span class=w>  </span><span class=p>((</span><span class=n>Jwt</span><span class=p>)</span><span class=n>authentication</span><span class=p>.</span><span class=na>getPrincipal</span><span class=p>()).</span><span class=na>getSubject</span><span class=p>();</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>完整代码，配置类：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Configuration</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@EnableWebSecurity</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>SecurityConfig</span><span class=w> </span><span class=kd>extends</span><span class=w> </span><span class=n>WebSecurityConfigurerAdapter</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nd>@Bean</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=kd>public</span><span class=w> </span><span class=n>JwtAccessTokenConverter</span><span class=w> </span><span class=nf>accessTokenConverter</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>JwtAccessTokenConverter</span><span class=w> </span><span class=n>converter</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>JwtAccessTokenConverter</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>converter</span><span class=p>.</span><span class=na>setSigningKey</span><span class=p>(</span><span class=s>&#34;as123456dfsdf&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>converter</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nd>@Bean</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=kd>public</span><span class=w> </span><span class=n>TokenStore</span><span class=w> </span><span class=nf>tokenStore</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>JwtTokenStore</span><span class=p>(</span><span class=n>accessTokenConverter</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=kd>protected</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>configure</span><span class=p>(</span><span class=n>HttpSecurity</span><span class=w> </span><span class=n>http</span><span class=p>)</span><span class=w> </span><span class=kd>throws</span><span class=w> </span><span class=n>Exception</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>http</span><span class=p>.</span><span class=na>csrf</span><span class=p>().</span><span class=na>disable</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>http</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=p>.</span><span class=na>authorizeRequests</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=p>.</span><span class=na>antMatchers</span><span class=p>(</span><span class=s>&#34;/oauth/**&#34;</span><span class=p>).</span><span class=na>permitAll</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nd>@Bean</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nd>@Primary</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=kd>public</span><span class=w> </span><span class=n>DefaultTokenServices</span><span class=w> </span><span class=nf>tokenServices</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>DefaultTokenServices</span><span class=w> </span><span class=n>defaultTokenServices</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>DefaultTokenServices</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>defaultTokenServices</span><span class=p>.</span><span class=na>setTokenStore</span><span class=p>(</span><span class=n>tokenStore</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>defaultTokenServices</span><span class=p>.</span><span class=na>setSupportRefreshToken</span><span class=p>(</span><span class=kc>true</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>defaultTokenServices</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>授权服务器配置，使用客户端模式配置：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Configuration</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>AuthorizationServerConfig</span><span class=w> </span><span class=kd>extends</span><span class=w> </span><span class=n>AuthorizationServerConfigurerAdapter</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nd>@Autowired</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=kd>private</span><span class=w> </span><span class=n>TokenStore</span><span class=w> </span><span class=n>tokenStore</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>configure</span><span class=p>(</span><span class=n>ClientDetailsServiceConfigurer</span><span class=w> </span><span class=n>clients</span><span class=p>)</span><span class=w> </span><span class=kd>throws</span><span class=w> </span><span class=n>Exception</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>clients</span><span class=p>.</span><span class=na>inMemory</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>.</span><span class=na>withClient</span><span class=p>(</span><span class=s>&#34;clientapp&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>.</span><span class=na>secret</span><span class=p>(</span><span class=s>&#34;$2a$10$6aQQyhlhol4M1KAncczPdu4zX7/TgvjpOU.sWzt7j5Xl6W/z5V4cC&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>.</span><span class=na>authorizedGrantTypes</span><span class=p>(</span><span class=s>&#34;password&#34;</span><span class=err>，</span><span class=w> </span><span class=s>&#34;refresh_token&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>.</span><span class=na>scopes</span><span class=p>(</span><span class=s>&#34;read&#34;</span><span class=err>，</span><span class=w> </span><span class=s>&#34;write&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>.</span><span class=na>accessTokenValiditySeconds</span><span class=p>(</span><span class=n>3600</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>configure</span><span class=p>(</span><span class=n>AuthorizationServerEndpointsConfigurer</span><span class=w> </span><span class=n>endpoints</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=kd>throws</span><span class=w> </span><span class=n>Exception</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>endpoints</span><span class=p>.</span><span class=na>tokenStore</span><span class=p>(</span><span class=n>tokenStore</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>.</span><span class=na>authenticationManager</span><span class=p>(</span><span class=n>authenticationManager</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>主要配置：</p><ol><li>使用 ClientDetailsServiceConfigurer 配置客户端信息，如 clientId、secret 等</li><li>配置 tokenStore</li><li>配置 authenticationManager 来获取用户信息</li></ol><p>这样就实现了基于客户端模式下的授权服务配置，客户端可以使用 clientId/secret 获取访问令牌而无需用户登录。</p><p>客户端访问示例：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl -X POST http://localhost:8080/oauth/token -d <span class=s2>&#34;grant_type=password&amp;username=user&amp;password=password&amp;client_id=clientapp&amp;client_secret=secret&#34;</span>
</span></span></code></pre></td></tr></table></div></div><p>让客户端在后台获取访问令牌，资源服务再使用令牌验证授权。</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://blog.chensoul.cc/tags/spring-security/>Spring-Security</a></li></ul><nav class=paginav><a class=prev href=https://blog.chensoul.cc/posts/2023/08/16/spring-transaction-management-transactional-in-depth/><span class=title>« Prev</span><br><span>[译]深入了解Spring事务管理：@Transactional</span>
</a><a class=next href=https://blog.chensoul.cc/posts/2023/08/15/tree-structure-in-database/><span class=title>Next »</span><br><span>数据库如何设计树形结构</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share Spring Security和OAuth2发展过程 on x" href="https://x.com/intent/tweet/?text=Spring%20Security%e5%92%8cOAuth2%e5%8f%91%e5%b1%95%e8%bf%87%e7%a8%8b&amp;url=https%3a%2f%2fblog.chensoul.cc%2fposts%2f2023%2f08%2f15%2fspring-security-oauth2-history%2f&amp;hashtags=spring-security"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Spring Security和OAuth2发展过程 on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fblog.chensoul.cc%2fposts%2f2023%2f08%2f15%2fspring-security-oauth2-history%2f&amp;title=Spring%20Security%e5%92%8cOAuth2%e5%8f%91%e5%b1%95%e8%bf%87%e7%a8%8b&amp;summary=Spring%20Security%e5%92%8cOAuth2%e5%8f%91%e5%b1%95%e8%bf%87%e7%a8%8b&amp;source=https%3a%2f%2fblog.chensoul.cc%2fposts%2f2023%2f08%2f15%2fspring-security-oauth2-history%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Spring Security和OAuth2发展过程 on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fblog.chensoul.cc%2fposts%2f2023%2f08%2f15%2fspring-security-oauth2-history%2f&title=Spring%20Security%e5%92%8cOAuth2%e5%8f%91%e5%b1%95%e8%bf%87%e7%a8%8b"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Spring Security和OAuth2发展过程 on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fblog.chensoul.cc%2fposts%2f2023%2f08%2f15%2fspring-security-oauth2-history%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Spring Security和OAuth2发展过程 on whatsapp" href="https://api.whatsapp.com/send?text=Spring%20Security%e5%92%8cOAuth2%e5%8f%91%e5%b1%95%e8%bf%87%e7%a8%8b%20-%20https%3a%2f%2fblog.chensoul.cc%2fposts%2f2023%2f08%2f15%2fspring-security-oauth2-history%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Spring Security和OAuth2发展过程 on telegram" href="https://telegram.me/share/url?text=Spring%20Security%e5%92%8cOAuth2%e5%8f%91%e5%b1%95%e8%bf%87%e7%a8%8b&amp;url=https%3a%2f%2fblog.chensoul.cc%2fposts%2f2023%2f08%2f15%2fspring-security-oauth2-history%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Spring Security和OAuth2发展过程 on ycombinator" href="https://news.ycombinator.com/submitlink?t=Spring%20Security%e5%92%8cOAuth2%e5%8f%91%e5%b1%95%e8%bf%87%e7%a8%8b&u=https%3a%2f%2fblog.chensoul.cc%2fposts%2f2023%2f08%2f15%2fspring-security-oauth2-history%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentcolor" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://blog.chensoul.cc/>ChenSoul</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script async src=https://umami.chensoul.cc/random-string.js data-website-id=821c25f8-a31a-4607-92d7-91ee76843d00></script><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>