<!doctype html><html lang=en-US prefix="og: http://ogp.me/ns#"><head><meta charset=utf-8><meta name=viewport content="width=device-width,minimum-scale=1"><meta name=description content="1. æ¦‚è¿°
æœ¬æ•™ç¨‹å°†è¯´æ˜å¦‚ä½•ä½¿ç”¨ Spring ä¸º REST API å®ç°å¼‚å¸¸å¤„ç†ã€‚æˆ‘ä»¬è¿˜å°†è·å¾—ä¸€äº›å†å²æ¦‚è¿°ï¼Œå¹¶äº†è§£ä¸åŒç‰ˆæœ¬å¼•å…¥äº†å“ªäº›æ–°é€‰é¡¹ã€‚"><title>[è¯‘]ä½¿ç”¨Springè¿›è¡ŒRESTçš„é”™è¯¯å¤„ç† | ChenSoul</title>
<link rel=canonical href=https://blog.chensoul.cc/posts/2023/08/25/exception-handling-for-rest-with-spring/><link rel=preconnect href=https://fonts.font.im><link rel=preconnect href=https://fonts.loli.net crossorigin><link href="https://fonts.loli.net/css2?family=Roboto+Slab:wght@400;500;700&display=swap" rel=stylesheet><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://blog.chensoul.cc/images/favicon.webp"><meta name=twitter:title content="[è¯‘]ä½¿ç”¨Springè¿›è¡ŒRESTçš„é”™è¯¯å¤„ç†"><meta name=twitter:description content="1. æ¦‚è¿° æœ¬æ•™ç¨‹å°†è¯´æ˜å¦‚ä½•ä½¿ç”¨ Spring ä¸º REST API å®ç°å¼‚å¸¸å¤„ç†ã€‚æˆ‘ä»¬è¿˜å°†è·å¾—ä¸€äº›å†å²æ¦‚è¿°ï¼Œå¹¶äº†è§£ä¸åŒç‰ˆæœ¬å¼•å…¥äº†å“ªäº›æ–°é€‰é¡¹ã€‚"><meta name=twitter:creator content="@ichensoul"><meta property="og:locale" content="en_US"><meta property="og:site_name" content="chensoul"><meta property="og:url" content="https://blog.chensoul.cc/posts/2023/08/25/exception-handling-for-rest-with-spring/"><meta property="og:site_name" content="ChenSoul"><meta property="og:title" content="[è¯‘]ä½¿ç”¨Springè¿›è¡ŒRESTçš„é”™è¯¯å¤„ç†"><meta property="og:description" content="1. æ¦‚è¿° æœ¬æ•™ç¨‹å°†è¯´æ˜å¦‚ä½•ä½¿ç”¨ Spring ä¸º REST API å®ç°å¼‚å¸¸å¤„ç†ã€‚æˆ‘ä»¬è¿˜å°†è·å¾—ä¸€äº›å†å²æ¦‚è¿°ï¼Œå¹¶äº†è§£ä¸åŒç‰ˆæœ¬å¼•å…¥äº†å“ªäº›æ–°é€‰é¡¹ã€‚"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-08-25T00:00:00+00:00"><meta property="article:modified_time" content="2023-08-25T00:00:00+00:00"><meta property="article:tag" content="Spring-Boot"><meta property="og:image" content="https://blog.chensoul.cc/images/favicon.webp"><meta itemprop=name content="[è¯‘]ä½¿ç”¨Springè¿›è¡ŒRESTçš„é”™è¯¯å¤„ç†"><meta itemprop=description content="1. æ¦‚è¿° æœ¬æ•™ç¨‹å°†è¯´æ˜å¦‚ä½•ä½¿ç”¨ Spring ä¸º REST API å®ç°å¼‚å¸¸å¤„ç†ã€‚æˆ‘ä»¬è¿˜å°†è·å¾—ä¸€äº›å†å²æ¦‚è¿°ï¼Œå¹¶äº†è§£ä¸åŒç‰ˆæœ¬å¼•å…¥äº†å“ªäº›æ–°é€‰é¡¹ã€‚"><meta itemprop=datePublished content="2023-08-25T00:00:00+00:00"><meta itemprop=dateModified content="2023-08-25T00:00:00+00:00"><meta itemprop=wordCount content="657"><meta itemprop=image content="https://blog.chensoul.cc/images/favicon.webp"><meta itemprop=keywords content="Spring-Boot"><link rel=stylesheet href=https://cdnjs.loli.net/ajax/libs/font-awesome/6.4.0/css/all.min.css media=all><link rel=stylesheet href=/main.min.css type=text/css media=all><link rel="shortcut icon" href=/favicon.ico type=image/x-icon><script type=application/ld+json>{"@context":"https://schema.org","@graph":[{"@type":"TechArticle","name":"[è¯‘]ä½¿ç”¨Springè¿›è¡ŒRESTçš„é”™è¯¯å¤„ç†","headline":"[è¯‘]ä½¿ç”¨Springè¿›è¡ŒRESTçš„é”™è¯¯å¤„ç†","inLanguage":"en-US","url":"https://blog.chensoul.cc/posts/2023/08/25/exception-handling-for-rest-with-spring/","description":"\u003ch2 id=\"1-æ¦‚è¿°\"\u003e1. æ¦‚è¿°\u003c/h2\u003e\n\u003cp\u003eæœ¬æ•™ç¨‹å°†è¯´æ˜å¦‚ä½•ä½¿ç”¨ Spring ä¸º REST API å®ç°å¼‚å¸¸å¤„ç†ã€‚æˆ‘ä»¬è¿˜å°†è·å¾—ä¸€äº›å†å²æ¦‚è¿°ï¼Œå¹¶äº†è§£ä¸åŒç‰ˆæœ¬å¼•å…¥äº†å“ªäº›æ–°é€‰é¡¹ã€‚\u003c/p\u003e","wordCount":"657","keywords":["spring-boot"],"datePublished":"2023-08-25T00:00:00Z","dateModified":"2023-08-25T00:00:00Z","author":{"@type":"Person","name":"chensoul"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.chensoul.cc/posts/2023/08/25/exception-handling-for-rest-with-spring/"},"publisher":{"@type":"Organization","name":"chensoul","url":"https://blog.chensoul.cc/posts/2023/08/25/exception-handling-for-rest-with-spring/"}},{"@context":"https://schema.org","@type":"Organization","name":"chensoul","url":"https://blog.chensoul.cc/","sameAs":["https://x.com/ichensoul","https://github.com/chensoul","https://www.linkedin.com/in/","https://www.youtube.com/@chensoul","https://t.me/chensouls"]}]}</script><script defer src=https://umami.chensoul.cc/random-string.js data-website-id=821c25f8-a31a-4607-92d7-91ee76843d00></script></head><body class="home blog post-layout-one-column"><button onclick=topFunction() id=scrollTopBtn title="Go to top">
<i class="fa-solid fa-arrow-up"></i></button><div id=header-top class=header-bar-wrap></div><div id=page class=site><a class="skip-link screen-reader-text" href=#content>Skip to content</a><header id=masthead class="site-header clearfix" role=banner><div class="header-main container clearfix"><div id=logo class="site-branding clearfix"><h1 class=site-title><a href=/ title=ChenSoul rel=home>ChenSoul</a></h1><p class=site-description>Java, Spring Boot, Microservice, Cloud, Architecture and DevOps Tutorials</p></div><div class="header-widgets clearfix"><aside id=search-2 class="header-widget widget_search"><form role=search method=get class=search-form onsubmit="return searchSite(event)"><label><span class=screen-reader-text>Search for:</span>
<input type=search class=search-field placeholder="Enter search keyword" name=query id=query title="Enter search keyword">
</label><button type=submit class=search-submit title=Search> <span class=genericon-search></span>
<span class=screen-reader-text>Search</span></button></form></aside></div></div><div id=main-navigation-wrap class=primary-navigation-wrap><nav id=main-navigation class="primary-navigation navigation container clearfix" role=navigation><ul id=menu-home class=main-navigation-menu><li class="menu-item menu-item-type-custom menu-item-object-custom
current-menu-item current_page_item menu-item-home"><a href=/>Home</a></li><li class="menu-item menu-item-type-taxonomy menu-item-object-category"><a href=/categories/spring-boot/>Spring Boot</a></li><li class="menu-item menu-item-type-taxonomy menu-item-object-category"><a href=/categories/architecture/>Architecture</a></li><li class="menu-item menu-item-type-taxonomy menu-item-object-category"><a href=/categories/microservice/>Microservice</a></li><li class="menu-item menu-item-type-taxonomy menu-item-object-category"><a href=/categories/kubernetes/>Kubernetes</a></li><li class="menu-item menu-item-type-taxonomy menu-item-object-category
menu-item-has-children"><a href=/tutorials/>Tutorials</a><ul class=sub-menu><li class="menu-item menu-item-type-taxonomy menu-item-object-category"><a href=/spring-boot-tutorials/>Spring Boot Tutorials</a></li><li class="menu-item menu-item-type-taxonomy menu-item-object-category"><a href=/microservice-tutorials/>Microservice Tutorials</a></li><li class="menu-item menu-item-type-taxonomy menu-item-object-category"><a href=/kubernetes-tutorials/>Kubernetes Tutorials</a></li></ul></li><li class="menu-item menu-item-type-post_type menu-item-object-page"><a href=https://github.com/chensoul target=_blank>About Me</a></li></ul></nav></div></header><div id=content class="site-content container clearfix"><section id=primary class="content-archive content-area post-content-area"><main id=main class=site-main role=main><article class="post type-post"><div class=post-inner-content><header class=entry-header><h2 class=entry-title><a href=https://blog.chensoul.cc/posts/2023/08/25/exception-handling-for-rest-with-spring/ rel=bookmark title=[è¯‘]ä½¿ç”¨Springè¿›è¡ŒRESTçš„é”™è¯¯å¤„ç†>[è¯‘]ä½¿ç”¨Springè¿›è¡ŒRESTçš„é”™è¯¯å¤„ç†</a></h2><div class=entry-meta><span class=meta-date><time class="entry-date published" datetime=2023-08-25T00:00:00>2023-08-25
</time></span><span class=meta-author><span class="author vcard">chensoul</span>
</span><span class="tagcloud post-tags"><i class="fa fa-tags"></i>&nbsp;
<a class="tag-cloud-link widget__link widget__link--taglist" href=/tags/spring-boot/ title=spring-boot>spring-boot</a></span></div></header><div class=entry-content><h2 id=1-æ¦‚è¿°>1. æ¦‚è¿°</h2><p>æœ¬æ•™ç¨‹å°†è¯´æ˜å¦‚ä½•ä½¿ç”¨ Spring ä¸º REST API å®ç°å¼‚å¸¸å¤„ç†ã€‚æˆ‘ä»¬è¿˜å°†è·å¾—ä¸€äº›å†å²æ¦‚è¿°ï¼Œå¹¶äº†è§£ä¸åŒç‰ˆæœ¬å¼•å…¥äº†å“ªäº›æ–°é€‰é¡¹ã€‚</p><p>åœ¨ Spring 3.2 ä¹‹å‰ï¼ŒSpring MVC åº”ç”¨ç¨‹åºä¸­å¤„ç†å¼‚å¸¸çš„ä¸¤ç§ä¸»è¦æ–¹æ³•æ˜¯ <code>HandlerExceptionResolver</code> æˆ– <code>@ExceptionHandler</code> æ³¨è§£ã€‚ä¸¤è€…éƒ½æœ‰ä¸€äº›æ˜æ˜¾çš„ç¼ºç‚¹ã€‚</p><p>ä» 3.2 å¼€å§‹ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† <code>@ControllerAdvice</code> æ³¨é‡Šæ¥è§£å†³å‰ä¸¤ä¸ªè§£å†³æ–¹æ¡ˆçš„å±€é™æ€§ï¼Œå¹¶ä¿ƒè¿›æ•´ä¸ªåº”ç”¨ç¨‹åºçš„ç»Ÿä¸€å¼‚å¸¸å¤„ç†ã€‚</p><p>ç°åœ¨ Spring 5 å¼•å…¥äº† <code>ResponseStatusException</code> ç±»ï¼Œä¸€ç§åœ¨ REST API ä¸­è¿›è¡ŒåŸºæœ¬é”™è¯¯å¤„ç†çš„å¿«é€Ÿæ–¹æ³•ã€‚</p><p>æ‰€æœ‰è¿™äº›éƒ½æœ‰ä¸€ä¸ªå…±åŒç‚¹ï¼šå®ƒä»¬å¾ˆå¥½åœ°å¤„ç†äº†å…³æ³¨ç‚¹åˆ†ç¦»ã€‚åº”ç”¨ç¨‹åºå¯ä»¥æ­£å¸¸æŠ›å‡ºå¼‚å¸¸æ¥æŒ‡ç¤ºæŸç§å¤±è´¥ï¼Œç„¶åå°†å•ç‹¬å¤„ç†ã€‚</p><p>æœ€åï¼Œæˆ‘ä»¬å°†äº†è§£ Spring Boot å¸¦æ¥çš„åŠŸèƒ½ä»¥åŠå¦‚ä½•é…ç½®å®ƒä»¥æ»¡è¶³æˆ‘ä»¬çš„éœ€æ±‚ã€‚</p><h2 id=2æ–¹æ¡ˆä¸€æ§åˆ¶å™¨çº§exceptionhandler>2.æ–¹æ¡ˆä¸€ï¼šæ§åˆ¶å™¨çº§@ExceptionHandler</h2><p>ç¬¬ä¸€ä¸ªè§£å†³æ–¹æ¡ˆåœ¨ <code>@Controller </code>çº§åˆ«å·¥ä½œã€‚æˆ‘ä»¬å°†å®šä¹‰ä¸€ä¸ªå¤„ç†å¼‚å¸¸çš„æ–¹æ³•å¹¶ä½¿ç”¨<code>@ExceptionHandler</code> è¿›è¡Œæ³¨é‡Šï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>FooController</span>{
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>//...</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@ExceptionHandler</span>({ CustomException1.<span style=color:#a6e22e>class</span>, CustomException2.<span style=color:#a6e22e>class</span> })
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>handleException</span>() {
</span></span><span style=display:flex><span>        <span style=color:#75715e>//</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>è¿™ç§æ–¹æ³•æœ‰ä¸€ä¸ªä¸»è¦ç¼ºç‚¹ï¼šÂ· æ³¨è§£çš„æ–¹æ³•ä»…å¯¹ç‰¹å®šçš„æ§åˆ¶å™¨æœ‰æ•ˆï¼Œè€Œä¸æ˜¯å¯¹æ•´ä¸ªåº”ç”¨ç¨‹åºå…¨å±€æœ‰æ•ˆã€‚å½“ç„¶ï¼Œå°†å…¶æ·»åŠ åˆ°æ¯ä¸ªæ§åˆ¶å™¨ä½¿å…¶ä¸å¤ªé€‚åˆé€šç”¨å¼‚å¸¸å¤„ç†æœºåˆ¶ã€‚</p><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡è®©æ‰€æœ‰æ§åˆ¶å™¨æ‰©å±•åŸºæœ¬æ§åˆ¶å™¨ç±»æ¥è§£å†³æ­¤é™åˆ¶ã€‚</p><p>ç„¶è€Œï¼Œå¯¹äºæ— è®ºå‡ºäºä½•ç§åŸå› è¿™æ˜¯ä¸å¯èƒ½çš„åº”ç”¨ç¨‹åºæ¥è¯´ï¼Œæ­¤è§£å†³æ–¹æ¡ˆå¯èƒ½æ˜¯ä¸€ä¸ªé—®é¢˜ã€‚ä¾‹å¦‚ï¼Œæ§åˆ¶å™¨å¯èƒ½å·²ç»ä»å¦ä¸€ä¸ªåŸºç±»æ‰©å±•ï¼Œè¯¥åŸºç±»å¯èƒ½ä½äºå¦ä¸€ä¸ª jar ä¸­æˆ–ä¸å¯ç›´æ¥ä¿®æ”¹ï¼Œæˆ–è€…æœ¬èº«å¯èƒ½ä¸å¯ç›´æ¥ä¿®æ”¹ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†ç ”ç©¶å¦ä¸€ç§è§£å†³å¼‚å¸¸å¤„ç†é—®é¢˜çš„æ–¹æ³• - ä¸€ç§å…¨å±€çš„æ–¹æ³•ï¼Œä¸åŒ…æ‹¬å¯¹ç°æœ‰å·¥ä»¶ï¼ˆä¾‹å¦‚æ§åˆ¶å™¨ï¼‰çš„ä»»ä½•æ›´æ”¹ã€‚</p><h2 id=3è§£å†³æ–¹æ¡ˆ-2handlerexceptionresolver>3.è§£å†³æ–¹æ¡ˆ 2ï¼šHandlerExceptionResolver</h2><p>ç¬¬äºŒç§è§£å†³æ–¹æ¡ˆæ˜¯å®šä¹‰ä¸€ä¸ª <code>HandlerExceptionResolver</code>ã€‚è¿™å°†è§£å†³åº”ç”¨ç¨‹åºæŠ›å‡ºçš„ä»»ä½•å¼‚å¸¸ã€‚å®ƒè¿˜å…è®¸æˆ‘ä»¬åœ¨ REST API ä¸­å®ç°ç»Ÿä¸€çš„å¼‚å¸¸å¤„ç†æœºåˆ¶ã€‚</p><p>åœ¨é€‰æ‹©è‡ªå®šä¹‰è§£æå™¨ä¹‹å‰ï¼Œè®©æˆ‘ä»¬å…ˆå›é¡¾ä¸€ä¸‹ç°æœ‰çš„å®ç°ã€‚</p><h3 id=31å¼‚å¸¸å¤„ç†å™¨å¼‚å¸¸è§£æå™¨>3.1.å¼‚å¸¸å¤„ç†å™¨å¼‚å¸¸è§£æå™¨</h3><p>è¯¥è§£æå™¨æ˜¯åœ¨ Spring 3.1 ä¸­å¼•å…¥çš„ï¼Œå¹¶ä¸”åœ¨ <code>DispatcherServlet</code> ä¸­é»˜è®¤å¯ç”¨ã€‚è¿™å®é™…ä¸Šæ˜¯å‰é¢ä»‹ç»çš„ <code>@ExceptionHandler</code> æœºåˆ¶å¦‚ä½•å·¥ä½œçš„æ ¸å¿ƒç»„ä»¶ã€‚</p><h3 id=32é»˜è®¤å¤„ç†ç¨‹åºå¼‚å¸¸è§£æå™¨>3.2.é»˜è®¤å¤„ç†ç¨‹åºå¼‚å¸¸è§£æå™¨</h3><p>è¿™ä¸ªè§£æå™¨æ˜¯åœ¨ Spring 3.0 ä¸­å¼•å…¥çš„ï¼Œå¹¶ä¸”åœ¨ <code>DispatcherServlet</code> ä¸­é»˜è®¤å¯ç”¨ã€‚</p><p>å®ƒç”¨äºå°†æ ‡å‡† Spring å¼‚å¸¸è§£æä¸ºå…¶ç›¸åº”çš„ HTTP çŠ¶æ€ä»£ç ï¼Œå³å®¢æˆ·ç«¯é”™è¯¯ 4xx å’ŒæœåŠ¡å™¨é”™è¯¯ 5xx çŠ¶æ€ä»£ç ã€‚ä»¥ä¸‹æ˜¯å®ƒå¤„ç†çš„ Spring å¼‚å¸¸çš„å®Œæ•´åˆ—è¡¨ä»¥åŠå®ƒä»¬å¦‚ä½•æ˜ å°„åˆ°çŠ¶æ€ä»£ç ã€‚</p><p>è™½ç„¶å®ƒç¡®å®æ­£ç¡®è®¾ç½®äº†å“åº”çš„çŠ¶æ€ä»£ç ï¼Œä½†ä¸€ä¸ªé™åˆ¶æ˜¯å®ƒä¸ä¼šå¯¹å“åº”æ­£æ–‡è®¾ç½®ä»»ä½•å†…å®¹ã€‚å¯¹äº REST APIï¼ˆçŠ¶æ€ä»£ç å®é™…ä¸Šä¸è¶³ä»¥å‘å®¢æˆ·ç«¯æä¾›è¶³å¤Ÿçš„ä¿¡æ¯ï¼‰ï¼Œå“åº”è¿˜å¿…é¡»æœ‰ä¸€ä¸ªæ­£æ–‡ï¼Œä»¥å…è®¸åº”ç”¨ç¨‹åºæä¾›æœ‰å…³å¤±è´¥çš„é™„åŠ ä¿¡æ¯ã€‚</p><p>è¿™å¯ä»¥é€šè¿‡ Â· é…ç½®è§†å›¾åˆ†è¾¨ç‡å¹¶æ¸²æŸ“é”™è¯¯å†…å®¹æ¥è§£å†³ï¼Œä½†è¯¥è§£å†³æ–¹æ¡ˆæ˜¾ç„¶ä¸æ˜¯æœ€ä¼˜çš„ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆ Spring 3.2 å¼•å…¥äº†ä¸€ä¸ªæ›´å¥½çš„é€‰é¡¹ï¼Œæˆ‘ä»¬å°†åœ¨åé¢çš„éƒ¨åˆ†ä¸­è®¨è®ºã€‚</p><h3 id=33å“åº”çŠ¶æ€å¼‚å¸¸è§£æå™¨>3.3.å“åº”çŠ¶æ€å¼‚å¸¸è§£æå™¨</h3><p>è¿™ä¸ªè§£æå™¨ä¹Ÿåœ¨ Spring 3.0 ä¸­å¼•å…¥ï¼Œå¹¶ä¸”åœ¨ Â· ä¸­é»˜è®¤å¯ç”¨ã€‚</p><p>å®ƒçš„ä¸»è¦èŒè´£æ˜¯ä½¿ç”¨è‡ªå®šä¹‰å¼‚å¸¸ä¸Šå¯ç”¨çš„ <code>@ResponseStatus</code> æ³¨é‡Šå¹¶å°†è¿™äº›å¼‚å¸¸æ˜ å°„åˆ° HTTP çŠ¶æ€ä»£ç ã€‚</p><p>è¿™æ ·çš„è‡ªå®šä¹‰å¼‚å¸¸å¯èƒ½å¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a6e22e>@ResponseStatus</span>(value <span style=color:#f92672>=</span> HttpStatus.<span style=color:#a6e22e>NOT_FOUND</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>MyResourceNotFoundException</span> <span style=color:#66d9ef>extends</span> RuntimeException {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>MyResourceNotFoundException</span>() {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>super</span>();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>MyResourceNotFoundException</span>(String message, Throwable cause) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>super</span>(message, cause);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>MyResourceNotFoundException</span>(String message) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>super</span>(message);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>MyResourceNotFoundException</span>(Throwable cause) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>super</span>(cause);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>ä¸ <code>DefaultHandlerExceptionResolver</code> ç›¸åŒï¼Œæ­¤è§£æå™¨åœ¨å¤„ç†å“åº”æ­£æ–‡çš„æ–¹å¼ä¸Šå—åˆ°é™åˆ¶ - å®ƒç¡®å®å°†çŠ¶æ€ä»£ç æ˜ å°„åˆ°å“åº”ä¸Šï¼Œä½†æ­£æ–‡ä»ç„¶ä¸ºç©ºã€‚</p><h3 id=34è‡ªå®šä¹‰-handlerexceptionresolver>3.4.è‡ªå®šä¹‰ HandlerExceptionResolver</h3><p><code>DefaultHandlerExceptionResolver</code> å’Œ <code>ResponseStatusExceptionResolver</code> çš„ç»„åˆå¤§å¤§æœ‰åŠ©äºä¸º Spring RESTful æœåŠ¡æä¾›è‰¯å¥½çš„é”™è¯¯å¤„ç†æœºåˆ¶ã€‚å¦‚å‰æ‰€è¿°ï¼Œç¼ºç‚¹æ˜¯æ— æ³•æ§åˆ¶å“åº”çš„æ­£æ–‡ã€‚</p><p>ç†æƒ³æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¸Œæœ›èƒ½å¤Ÿè¾“å‡º JSON æˆ– XMLï¼Œå…·ä½“å–å†³äºå®¢æˆ·ç«¯è¦æ±‚çš„æ ¼å¼ï¼ˆé€šè¿‡ Accept æ ‡å¤´ï¼‰ã€‚</p><p>ä»…æ­¤ä¸€ç‚¹å°±è¯æ˜åˆ›å»ºä¸€ä¸ªæ–°çš„è‡ªå®šä¹‰å¼‚å¸¸è§£æå™¨æ˜¯åˆç†çš„ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a6e22e>@Component</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>RestResponseStatusExceptionResolver</span> <span style=color:#66d9ef>extends</span> AbstractHandlerExceptionResolver {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>protected</span> ModelAndView <span style=color:#a6e22e>doResolveException</span>(
</span></span><span style=display:flex><span>      HttpServletRequest request,
</span></span><span style=display:flex><span>      HttpServletResponse response,
</span></span><span style=display:flex><span>      Object handler,
</span></span><span style=display:flex><span>      Exception ex) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>try</span> {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (ex <span style=color:#66d9ef>instanceof</span> IllegalArgumentException) {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>return</span> handleIllegalArgument(
</span></span><span style=display:flex><span>                  (IllegalArgumentException) ex, response, handler);
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            ...
</span></span><span style=display:flex><span>        } <span style=color:#66d9ef>catch</span> (Exception handlerException) {
</span></span><span style=display:flex><span>            logger.<span style=color:#a6e22e>warn</span>(<span style=color:#e6db74>&#34;Handling of [&#34;</span> <span style=color:#f92672>+</span> ex.<span style=color:#a6e22e>getClass</span>().<span style=color:#a6e22e>getName</span>() <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;]
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              resulted in Exception&#34;</span>, handlerException);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>null</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> ModelAndView
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>handleIllegalArgument</span>(IllegalArgumentException ex, HttpServletResponse response)
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>throws</span> IOException {
</span></span><span style=display:flex><span>        response.<span style=color:#a6e22e>sendError</span>(HttpServletResponse.<span style=color:#a6e22e>SC_CONFLICT</span>);
</span></span><span style=display:flex><span>        String accept <span style=color:#f92672>=</span> request.<span style=color:#a6e22e>getHeader</span>(HttpHeaders.<span style=color:#a6e22e>ACCEPT</span>);
</span></span><span style=display:flex><span>        ...
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>new</span> ModelAndView();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>è¿™é‡Œéœ€è¦æ³¨æ„çš„ä¸€ä¸ªç»†èŠ‚æ˜¯æˆ‘ä»¬å¯ä»¥è®¿é—®è¯·æ±‚æœ¬èº«ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥è€ƒè™‘å®¢æˆ·ç«¯å‘é€çš„ Accept æ ‡å¤´çš„å€¼ã€‚</p><p>ä¾‹å¦‚ï¼Œå¦‚æœå®¢æˆ·ç«¯è¯·æ±‚ <code>application/json</code>ï¼Œé‚£ä¹ˆåœ¨å‡ºç°é”™è¯¯æƒ…å†µæ—¶ï¼Œæˆ‘ä»¬å¸Œæœ›ç¡®ä¿è¿”å›ç”¨ <code>application/json</code> ç¼–ç çš„å“åº”æ­£æ–‡ã€‚</p><p>å¦ä¸€ä¸ªé‡è¦çš„å®ç°ç»†èŠ‚æ˜¯æˆ‘ä»¬è¿”å›ä¸€ä¸ª <code>ModelAndView</code>â€”â€”è¿™æ˜¯å“åº”çš„ä¸»ä½“ï¼Œå®ƒå°†å…è®¸æˆ‘ä»¬å¯¹å…¶è¿›è¡Œå¿…è¦çš„è®¾ç½®ã€‚</p><p>è¿™ç§æ–¹æ³•æ˜¯ä¸€ç§ä¸€è‡´ä¸”æ˜“äºé…ç½®çš„æœºåˆ¶ï¼Œç”¨äº Spring REST æœåŠ¡çš„é”™ â€‹â€‹ è¯¯å¤„ç†ã€‚</p><p>ç„¶è€Œï¼Œå®ƒç¡®å®æœ‰å±€é™æ€§ï¼šå®ƒä¸ä½çº§ <code>HtttpServletResponse</code> äº¤äº’ï¼Œå¹¶ä¸”é€‚åˆä½¿ç”¨ ModelAndView çš„æ—§ MVC <code>æ¨¡å‹</code>ï¼Œå› æ­¤ä»æœ‰æ”¹è¿›çš„ç©ºé—´ã€‚</p><h2 id=4è§£å†³æ–¹æ¡ˆ-3controlleradvice>4.è§£å†³æ–¹æ¡ˆ 3ï¼š@ControllerAdvice</h2><p>Spring 3.2 é€šè¿‡ <code>@ControllerAdvice</code> æ³¨é‡Šæ”¯æŒå…¨å±€ <code>@ExceptionHandler</code>ã€‚</p><p>è¿™å®ç°äº†ä¸€ç§è„±ç¦»æ—§ MVC æ¨¡å‹çš„æœºåˆ¶ï¼Œå¹¶åˆ©ç”¨ <code>ResponseEntity</code> ä»¥åŠ <code>@ExceptionHandler</code> çš„ç±»å‹å®‰å…¨æ€§å’Œçµæ´»æ€§ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a6e22e>@ControllerAdvice</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>RestResponseEntityExceptionHandler</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>extends</span> ResponseEntityExceptionHandler {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@ExceptionHandler</span>(value
</span></span><span style=display:flex><span>      <span style=color:#f92672>=</span> { IllegalArgumentException.<span style=color:#a6e22e>class</span>, IllegalStateException.<span style=color:#a6e22e>class</span> })
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>protected</span> ResponseEntity<span style=color:#f92672>&lt;</span>Object<span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>handleConflict</span>(
</span></span><span style=display:flex><span>      RuntimeException ex, WebRequest request) {
</span></span><span style=display:flex><span>        String bodyOfResponse <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;This should be application specific&#34;</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> handleExceptionInternal(ex, bodyOfResponse,
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>new</span> HttpHeaders(), HttpStatus.<span style=color:#a6e22e>CONFLICT</span>, request);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><code>@ControllerAdvice</code> æ³¨é‡Šå…è®¸æˆ‘ä»¬å°†ä¹‹å‰çš„å¤šä¸ªåˆ†æ•£çš„ <code>@ExceptionHandler</code> åˆå¹¶åˆ°ä¸€ä¸ªå…¨å±€é”™è¯¯å¤„ç†ç»„ä»¶ä¸­ã€‚</p><p>å®é™…çš„æœºåˆ¶éå¸¸ç®€å•ä½†ä¹Ÿéå¸¸çµæ´»ï¼š</p><ul><li>å®ƒä½¿æˆ‘ä»¬èƒ½å¤Ÿå®Œå…¨æ§åˆ¶å“åº”æ­£æ–‡ä»¥åŠçŠ¶æ€ä»£ç ã€‚</li><li>å®ƒæä¾›äº†å¤šä¸ªå¼‚å¸¸åˆ°åŒä¸€æ–¹æ³•çš„æ˜ å°„ï¼Œä»¥ä¾¿ä¸€èµ·å¤„ç†ã€‚</li><li>å®ƒå……åˆ†åˆ©ç”¨äº†è¾ƒæ–°çš„ RESTful <code>ResposeEntity</code> å“åº”ã€‚</li></ul><p>è¿™é‡Œè¦è®°ä½çš„ä¸€ä»¶äº‹æ˜¯å°†ä½¿ç”¨ <code>@ExceptionHandler</code> å£°æ˜çš„å¼‚å¸¸ä¸ç”¨ä½œæ–¹æ³•å‚æ•°çš„å¼‚å¸¸ç›¸åŒ¹é…ã€‚</p><p>å¦‚æœå®ƒä»¬ä¸åŒ¹é…ï¼Œç¼–è¯‘å™¨ä¸ä¼šæŠ±æ€¨â€”â€”æ²¡æœ‰ç†ç”±åº”è¯¥æŠ±æ€¨â€”â€”Spring ä¹Ÿä¸ä¼šæŠ±æ€¨ã€‚</p><p>ç„¶è€Œï¼Œå½“å¼‚å¸¸åœ¨è¿è¡Œæ—¶å®é™…æŠ›å‡ºæ—¶ï¼Œå¼‚å¸¸è§£å†³æœºåˆ¶å°†å¤±è´¥ï¼Œå¹¶æ˜¾ç¤ºï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>java.lang.IllegalStateException: No suitable resolver <span style=color:#66d9ef>for</span> argument <span style=color:#f92672>[</span>0<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>type<span style=color:#f92672>=</span>...<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>HandlerMethod details: ...
</span></span></code></pre></div><h2 id=5è§£å†³æ–¹æ¡ˆ-4responsestatusexceptionspring-5-åŠä»¥ä¸Šç‰ˆæœ¬>5.è§£å†³æ–¹æ¡ˆ 4ï¼šResponseStatusExceptionï¼ˆSpring 5 åŠä»¥ä¸Šç‰ˆæœ¬ï¼‰</h2><p>Spring 5 å¼•å…¥äº† <code>ResponseStatusException</code> ç±»ã€‚</p><p>æˆ‘ä»¬å¯ä»¥åˆ›å»ºå®ƒçš„ä¸€ä¸ªå®ä¾‹ï¼Œæä¾› <code>HttpStatus</code> å’Œå¯é€‰çš„åŸå› ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a6e22e>@GetMapping</span>(value <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;/{id}&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> Foo <span style=color:#a6e22e>findById</span>(<span style=color:#a6e22e>@PathVariable</span>(<span style=color:#e6db74>&#34;id&#34;</span>) Long id, HttpServletResponse response) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>try</span> {
</span></span><span style=display:flex><span>        Foo resourceById <span style=color:#f92672>=</span> RestPreconditions.<span style=color:#a6e22e>checkFound</span>(service.<span style=color:#a6e22e>findOne</span>(id));
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        eventPublisher.<span style=color:#a6e22e>publishEvent</span>(<span style=color:#66d9ef>new</span> SingleResourceRetrievedEvent(<span style=color:#66d9ef>this</span>, response));
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> resourceById;
</span></span><span style=display:flex><span>     }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>catch</span> (MyResourceNotFoundException exc) {
</span></span><span style=display:flex><span>         <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> ResponseStatusException(
</span></span><span style=display:flex><span>           HttpStatus.<span style=color:#a6e22e>NOT_FOUND</span>, <span style=color:#e6db74>&#34;Foo Not Found&#34;</span>, exc);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>ä½¿ç”¨ <code>ResponseStatusException</code> æœ‰ä»€ä¹ˆå¥½å¤„ï¼Ÿ</p><ul><li>éå¸¸é€‚åˆåŸå‹è®¾è®¡ï¼šæˆ‘ä»¬å¯ä»¥éå¸¸å¿«é€Ÿåœ°å®æ–½åŸºæœ¬è§£å†³æ–¹æ¡ˆã€‚</li><li>ä¸€ç§ç±»å‹ï¼Œå¤šä¸ªçŠ¶æ€ä»£ç ï¼šä¸€ç§å¼‚å¸¸ç±»å‹å¯ä»¥å¯¼è‡´å¤šç§ä¸åŒçš„å“åº”ã€‚ä¸ @ExceptionHandler ç›¸æ¯”ï¼Œè¿™å‡å°‘äº†ç´§å¯†è€¦åˆã€‚</li><li>æˆ‘ä»¬ä¸å¿…åˆ›å»ºé‚£ä¹ˆå¤šè‡ªå®šä¹‰å¼‚å¸¸ç±»ã€‚</li><li>ç”±äºå¯ä»¥é€šè¿‡ç¼–ç¨‹æ–¹å¼åˆ›å»ºå¼‚å¸¸ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥æ›´å¥½åœ°æ§åˆ¶å¼‚å¸¸å¤„ç†ã€‚</li></ul><p>é‚£ä¹ˆæƒè¡¡åˆå¦‚ä½•å‘¢ï¼Ÿ</p><ul><li>æ²¡æœ‰ç»Ÿä¸€çš„å¼‚å¸¸å¤„ç†æ–¹å¼ï¼šä¸æä¾›å…¨å±€æ–¹æ³•çš„ <code>@ControllerAdvice</code> ç›¸æ¯”ï¼Œå¼ºåˆ¶æ‰§è¡Œä¸€äº›åº”ç”¨ç¨‹åºèŒƒå›´çš„çº¦å®šæ›´åŠ å›°éš¾ã€‚</li><li>ä»£ç é‡å¤ï¼šæˆ‘ä»¬å¯èƒ½ä¼šå‘ç°è‡ªå·±åœ¨å¤šä¸ªæ§åˆ¶å™¨ä¸­å¤åˆ¶ä»£ç ã€‚</li></ul><p>æˆ‘ä»¬è¿˜åº”è¯¥æ³¨æ„åˆ°ï¼Œå¯ä»¥åœ¨ä¸€ä¸ªåº”ç”¨ç¨‹åºä¸­ç»„åˆä¸åŒçš„æ–¹æ³•ã€‚</p><p>ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥å…¨å±€å®ç° <code>@ControllerAdvice</code>ï¼Œä¹Ÿå¯ä»¥åœ¨æœ¬åœ°å®ç° <code>ResponseStatusExceptions</code>ã€‚</p><p>ä½†æ˜¯ï¼Œæˆ‘ä»¬éœ€è¦å°å¿ƒï¼šå¦‚æœå¯ä»¥é€šè¿‡å¤šç§æ–¹å¼å¤„ç†ç›¸åŒçš„å¼‚å¸¸ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šæ³¨æ„åˆ°ä¸€äº›ä»¤äººæƒŠè®¶çš„è¡Œä¸ºã€‚ä¸€ç§å¯èƒ½çš„çº¦å®šæ˜¯å§‹ç»ˆä»¥ä¸€ç§æ–¹å¼å¤„ç†ä¸€ç§ç‰¹å®šç±»å‹çš„å¼‚å¸¸ã€‚</p><p>æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯å’Œæ›´å¤šç¤ºä¾‹ï¼Œè¯·å‚é˜…æœ‰å…³ <a href=https://www.baeldung.com/spring-response-status-exception target=_blank>ResponseStatusException çš„æ•™ç¨‹</a>ã€‚</p><h2 id=6å¤„ç†-spring-security-ä¸­æ‹’ç»è®¿é—®çš„æƒ…å†µ>6.å¤„ç† Spring Security ä¸­æ‹’ç»è®¿é—®çš„æƒ…å†µ</h2><p>å½“ç»è¿‡èº«ä»½éªŒè¯çš„ç”¨æˆ·å°è¯•è®¿é—®ä»–æ²¡æœ‰è¶³å¤Ÿæƒé™è®¿é—®çš„èµ„æºæ—¶ï¼Œå°±ä¼šå‘ç”Ÿè®¿é—®è¢«æ‹’ç»çš„æƒ…å†µã€‚</p><h3 id=61-rest-å’Œæ–¹æ³•çº§å®‰å…¨æ€§>6.1. REST å’Œæ–¹æ³•çº§å®‰å…¨æ€§</h3><p>æœ€åï¼Œè®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•å¤„ç†æ–¹æ³•çº§å®‰å…¨æ³¨è§£ <code>@PreAuthorize</code>ã€<code>@PostAuthorize</code> å’Œ <code>@Secure</code> æŠ›å‡ºçš„ <code>Access Denied</code> å¼‚å¸¸ã€‚</p><p>å½“ç„¶ï¼Œæˆ‘ä»¬ä¹Ÿå°†ä½¿ç”¨å‰é¢è®¨è®ºçš„å…¨å±€å¼‚å¸¸å¤„ç†æœºåˆ¶æ¥å¤„ç† <code>AccessDeniedException</code>ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a6e22e>@ControllerAdvice</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>RestResponseEntityExceptionHandler</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>extends</span> ResponseEntityExceptionHandler {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@ExceptionHandler</span>({ AccessDeniedException.<span style=color:#a6e22e>class</span> })
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> ResponseEntity<span style=color:#f92672>&lt;</span>Object<span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>handleAccessDeniedException</span>(
</span></span><span style=display:flex><span>      Exception ex, WebRequest request) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>new</span> ResponseEntity<span style=color:#f92672>&lt;</span>Object<span style=color:#f92672>&gt;</span>(
</span></span><span style=display:flex><span>          <span style=color:#e6db74>&#34;Access denied message here&#34;</span>, <span style=color:#66d9ef>new</span> HttpHeaders(), HttpStatus.<span style=color:#a6e22e>FORBIDDEN</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    ...
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=7-spring-boot-æ”¯æŒ>7. Spring Boot æ”¯æŒ</h2><p>Spring Boot æä¾›äº† <code>ErrorController</code> å®ç°æ¥ä»¥åˆç†çš„æ–¹å¼å¤„ç†é”™è¯¯ã€‚</p><p>ç®€è€Œè¨€ä¹‹ï¼Œå®ƒä¸ºæµè§ˆå™¨æä¾›åå¤‡é”™è¯¯é¡µé¢ï¼ˆä¹Ÿç§°ä¸º Whitelabel é”™è¯¯é¡µé¢ï¼‰ï¼Œå¹¶ä¸º RESTfulã€é HTML è¯·æ±‚æä¾› JSON å“åº”ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;timestamp&#34;</span>: <span style=color:#e6db74>&#34;2019-01-17T16:12:45.977+0000&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;status&#34;</span>: <span style=color:#ae81ff>500</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;error&#34;</span>: <span style=color:#e6db74>&#34;Internal Server Error&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;message&#34;</span>: <span style=color:#e6db74>&#34;Error processing the request!&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;path&#34;</span>: <span style=color:#e6db74>&#34;/my-endpoint-with-exceptions&#34;</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>ä¸å¾€å¸¸ä¸€æ ·ï¼ŒSpring Boot å…è®¸ä½¿ç”¨å±æ€§é…ç½®è¿™äº›åŠŸèƒ½ï¼š</p><ul><li><code>server.error.whitelabel.enabled</code>: å¯ç”¨äºç¦ç”¨ Whitelabel é”™è¯¯é¡µé¢å¹¶ä¾èµ– servlet å®¹å™¨æä¾› HTML é”™è¯¯æ¶ˆæ¯</li><li><code>server.error.include-stacktrace</code>: å…·æœ‰å§‹ç»ˆå€¼ï¼›åœ¨ HTML å’Œ JSON é»˜è®¤å“åº”ä¸­åŒ…å«å †æ ˆè·Ÿè¸ª</li><li><code>server.error.include-message</code>: ä» 2.3 ç‰ˆæœ¬å¼€å§‹ï¼ŒSpring Boot éšè—äº†å“åº”ä¸­çš„ <code>message</code> å­—æ®µï¼Œä»¥é¿å…æ³„éœ²æ•æ„Ÿä¿¡æ¯ï¼›æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¸¦æœ‰ <code>always</code> å€¼çš„è¿™ä¸ªå±æ€§æ¥å¯ç”¨å®ƒ</li></ul><p>é™¤äº†è¿™äº›å±æ€§ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä¸º<code> /error</code> æä¾›æˆ‘ä»¬è‡ªå·±çš„è§†å›¾è§£æå™¨æ˜ å°„ï¼Œè¦†ç›–ç™½æ ‡ç­¾é¡µé¢ã€‚</p><p>æˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡åœ¨ä¸Šä¸‹æ–‡ä¸­åŒ…å« <code>ErrorAttributes</code> bean æ¥è‡ªå®šä¹‰è¦åœ¨å“åº”ä¸­æ˜¾ç¤ºçš„å±æ€§ã€‚æˆ‘ä»¬å¯ä»¥æ‰©å±• Spring Boot æä¾›çš„ <code>DefaultErrorAttributes</code> ç±»æ¥ä½¿äº‹æƒ…å˜å¾—æ›´ç®€å•ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a6e22e>@Component</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>MyCustomErrorAttributes</span> <span style=color:#66d9ef>extends</span> DefaultErrorAttributes {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> Map<span style=color:#f92672>&lt;</span>String, Object<span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>getErrorAttributes</span>(
</span></span><span style=display:flex><span>      WebRequest webRequest, ErrorAttributeOptions options) {
</span></span><span style=display:flex><span>        Map<span style=color:#f92672>&lt;</span>String, Object<span style=color:#f92672>&gt;</span> errorAttributes <span style=color:#f92672>=</span>
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>super</span>.<span style=color:#a6e22e>getErrorAttributes</span>(webRequest, options);
</span></span><span style=display:flex><span>        errorAttributes.<span style=color:#a6e22e>put</span>(<span style=color:#e6db74>&#34;locale&#34;</span>, webRequest.<span style=color:#a6e22e>getLocale</span>()
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>toString</span>());
</span></span><span style=display:flex><span>        errorAttributes.<span style=color:#a6e22e>remove</span>(<span style=color:#e6db74>&#34;error&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>//...</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> errorAttributes;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>å¦‚æœæˆ‘ä»¬æƒ³è¿›ä¸€æ­¥å®šä¹‰ï¼ˆæˆ–è¦†ç›–ï¼‰åº”ç”¨ç¨‹åºå¦‚ä½•å¤„ç†ç‰¹å®šå†…å®¹ç±»å‹çš„é”™è¯¯ï¼Œæˆ‘ä»¬å¯ä»¥æ³¨å†Œä¸€ä¸ª <code>ErrorController</code> beanã€‚</p><p>åŒæ ·ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ Spring Boot æä¾›çš„é»˜è®¤ <code>BasicErrorController</code> æ¥å¸®åŠ©æˆ‘ä»¬ã€‚</p><p>ä¾‹å¦‚ï¼Œå‡è®¾æˆ‘ä»¬æƒ³è¦è‡ªå®šä¹‰åº”ç”¨ç¨‹åºå¦‚ä½•å¤„ç† XML ç«¯ç‚¹ä¸­è§¦å‘çš„é”™è¯¯ã€‚æˆ‘ä»¬æ‰€è¦åšçš„å°±æ˜¯ä½¿ç”¨ <code>@RequestMapping</code> å®šä¹‰ä¸€ä¸ªå…¬å…±æ–¹æ³•ï¼Œå¹¶å£°æ˜å®ƒç”Ÿæˆ <code>application/xm</code>l åª’ä½“ç±»å‹ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a6e22e>@Component</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>MyErrorController</span> <span style=color:#66d9ef>extends</span> BasicErrorController {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>MyErrorController</span>(
</span></span><span style=display:flex><span>      ErrorAttributes errorAttributes, ServerProperties serverProperties) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>super</span>(errorAttributes, serverProperties.<span style=color:#a6e22e>getError</span>());
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@RequestMapping</span>(produces <span style=color:#f92672>=</span> MediaType.<span style=color:#a6e22e>APPLICATION_XML_VALUE</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> ResponseEntity<span style=color:#f92672>&lt;</span>Map<span style=color:#f92672>&lt;</span>String, Object<span style=color:#f92672>&gt;&gt;</span> <span style=color:#a6e22e>xmlError</span>(HttpServletRequest request) {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// ...</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>æ³¨æ„ï¼šè¿™é‡Œæˆ‘ä»¬ä»ç„¶ä¾èµ–äºæˆ‘ä»¬é¡¹ç›®ä¸­å¯èƒ½å®šä¹‰çš„ <code>server.error.*</code> å¼•å¯¼å±æ€§ï¼Œè¿™äº›å±æ€§ç»‘å®šåˆ° <code>ServerProperties</code> beanã€‚</p><h2 id=8-ç»“è®º>8. ç»“è®º</h2><p>æœ¬æ–‡è®¨è®ºäº†åœ¨ Spring ä¸­å®ç° REST API å¼‚å¸¸å¤„ç†æœºåˆ¶çš„å‡ ç§æ–¹æ³•ï¼Œä»æ—§çš„æœºåˆ¶å¼€å§‹ï¼Œç»§ç»­æä¾› Spring 3.2 æ”¯æŒï¼Œä¸€ç›´åˆ° 4.x å’Œ 5.xã€‚</p><p>ä¸å¾€å¸¸ä¸€æ ·ï¼Œæœ¬æ–‡ä¸­æä¾›çš„ä»£ç å¯ä»¥åœ¨ <a href=https://github.com/eugenp/tutorials/tree/master/spring-boot-rest target=_blank>GitHub</a> ä¸Šè·å–ã€‚</p><p>Spring Security ç›¸å…³çš„ä»£ç å¯ä»¥æŸ¥çœ‹ <a href=https://github.com/eugenp/tutorials/tree/master/spring-security-modules/spring-security-web-rest target=_blank>spring-security-rest</a> æ¨¡å—ã€‚</p><p>åŸæ–‡é“¾æ¥ï¼š<a href=https://www.baeldung.com/exception-handling-for-rest-with-spring target=_blank>https://www.baeldung.com/exception-handling-for-rest-with-spring</a></p></div><div><div style=font-weight:700>Share this post:</div><a class=social-link-item href="https://twitter.com/intent/tweet?text=%5b%e8%af%91%5d%e4%bd%bf%e7%94%a8Spring%e8%bf%9b%e8%a1%8cREST%e7%9a%84%e9%94%99%e8%af%af%e5%a4%84%e7%90%86 https%3a%2f%2fblog.chensoul.cc%2fposts%2f2023%2f08%2f25%2fexception-handling-for-rest-with-spring%2f" target=_blank rel="noopener noreferrer" title="Click to share on Twitter"><i class="fa-brands fa-square-twitter fa-2xl" style=color:#55acee></i>
</a><a class=social-link-item href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fblog.chensoul.cc%2fposts%2f2023%2f08%2f25%2fexception-handling-for-rest-with-spring%2f&title=%5b%e8%af%91%5d%e4%bd%bf%e7%94%a8Spring%e8%bf%9b%e8%a1%8cREST%e7%9a%84%e9%94%99%e8%af%af%e5%a4%84%e7%90%86" target=_blank rel="noopener noreferrer" title="Click to share on LinkedIn"><i class="fa-brands fa-linkedin fa-2xl" style=color:#007bb5></i>
</a><a class=social-link-item href="https://telegram.me/share/url?text=%5b%e8%af%91%5d%e4%bd%bf%e7%94%a8Spring%e8%bf%9b%e8%a1%8cREST%e7%9a%84%e9%94%99%e8%af%af%e5%a4%84%e7%90%86&amp;url=https%3a%2f%2fblog.chensoul.cc%2fposts%2f2023%2f08%2f25%2fexception-handling-for-rest-with-spring%2f" target=_blank rel="noopener noreferrer" title="Click to share on telegram"><i class="fa-brands fa-telegram fa-2xl" style=color:#007bb5></i>
</a><a class=social-link-item href="https://reddit.com/submit?url=https%3a%2f%2fblog.chensoul.cc%2fposts%2f2023%2f08%2f25%2fexception-handling-for-rest-with-spring%2f&title=%5b%e8%af%91%5d%e4%bd%bf%e7%94%a8Spring%e8%bf%9b%e8%a1%8cREST%e7%9a%84%e9%94%99%e8%af%af%e5%a4%84%e7%90%86" target=_blank rel="noopener noreferrer" title="Click to share on reddit"><i class="fa-brands fa-reddit fa-2xl" style=color:#007bb5></i>
</a><a class=social-link-item href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fblog.chensoul.cc%2fposts%2f2023%2f08%2f25%2fexception-handling-for-rest-with-spring%2f" target=_blank rel="noopener noreferrer" title="Click to share on facebook"><i class="fa-brands fa-facebook fa-2xl" style=color:#007bb5></i>
</a><a class=social-link-item href="https://api.whatsapp.com/send?text=%5b%e8%af%91%5d%e4%bd%bf%e7%94%a8Spring%e8%bf%9b%e8%a1%8cREST%e7%9a%84%e9%94%99%e8%af%af%e5%a4%84%e7%90%86%20-%20https%3a%2f%2fblog.chensoul.cc%2fposts%2f2023%2f08%2f25%2fexception-handling-for-rest-with-spring%2f" target=_blank rel="noopener noreferrer" title="Click to share on whatsapp"><i class="fa-brands fa-whatsapp fa-2xl" style=color:#007bb5></i></a></div></div></article><nav class="navigation post-navigation" role=navigation><h2 class=screen-reader-text>Post navigation</h2><div class=nav-links><div class=nav-previous><a href=/posts/2023/08/25/spring-security-async-principal-propagation/ rel=next><span class=post-title>[è¯‘]ä½¿ç”¨@Asyncè¿›è¡ŒSpring Securityä¸Šä¸‹æ–‡ä¼ æ’­</span></a></div><div class=nav-next><a href=/posts/2023/08/25/spring-async/ rel=prev><span class=post-title>[è¯‘]å¦‚ä½•åœ¨Springä¸­æ‰§è¡Œ@Async</span></a></div></div></nav><h2>Related content</h2><ul><li><a href=/posts/2023/10/13/new-features-in-spring-boot-3-and-spring-6/>[è¯‘]Spring Boot3å’ŒSpring6ä¸­çš„æ–°ç‰¹æ€§</a></li><li><a href=/posts/2023/10/12/spring-security-interview-questions/>[è¯‘]Spring Security é¢è¯•é—®é¢˜</a></li><li><a href=/posts/2023/09/19/spring-security-tutorial/>[è¯‘]Spring Security ä¸ JWT for REST API</a></li><li><a href=/posts/2023/09/19/spring-security-jwt/>[è¯‘]å¦‚ä½•ä½¿ç”¨Spring Securityå’ŒJWTä¿æŠ¤æ‚¨çš„REST API</a></li><li><a href=/posts/2023/08/25/global-error-handler-in-a-spring-rest-api/>[è¯‘]REST API çš„è‡ªå®šä¹‰é”™è¯¯æ¶ˆæ¯å¤„ç†</a></li><li><a href=/posts/2023/08/25/spring-events/>[è¯‘]Spring Events</a></li><li><a href=/posts/2023/08/25/spring-security-async-principal-propagation/>[è¯‘]ä½¿ç”¨@Asyncè¿›è¡ŒSpring Securityä¸Šä¸‹æ–‡ä¼ æ’­</a></li><li><a href=/posts/2023/08/25/spring-async/>[è¯‘]å¦‚ä½•åœ¨Springä¸­æ‰§è¡Œ@Async</a></li><li><a href=/posts/2023/08/18/how-to-implement-jwt-authentication-in-spring-boot-project/>[è¯‘]Spring Booté¡¹ç›®å¦‚ä½•å®ç°JWTè®¤è¯ï¼Ÿ</a></li><li><a href=/posts/2023/08/18/how-to-implement-security-in-spring-boot-project/>[è¯‘]Spring Booté¡¹ç›®å¦‚ä½•å®ç°Securityï¼Ÿ</a></li></ul></main></section></div><div id=footer class=footer-wrap><footer id=colophon class="site-footer container clearfix" role=contentinfo><div id=footer-text class=site-info><span class=credit-link>Made with ğŸ©·
by <a href=/ target=_blank rel="noopener noreferrer">ChenSoul</a></span></div></footer></div></div><script type=text/javascript src=/main.min.js></script></body></html>