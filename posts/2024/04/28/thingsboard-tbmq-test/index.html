<!doctype html><html lang=en-US prefix="og: http://ogp.me/ns#"><head><meta charset=utf-8><meta name=viewport content="width=device-width,minimum-scale=1"><meta name=description content="

å¯åŠ¨ TBMQ ç¨‹åºï¼Œæµè§ˆå™¨è®¿é—® http://localhost:8083ï¼Œåˆ›å»ºä¸€ä¸ª Applicationï¼ŒCredentials Type ä¸º   BASICï¼Œå®¢æˆ·ç«¯ IDã€ç”¨æˆ·åå’Œå¯†ç å‡è®¾ç½®ä¸º tbmq_app"><title>TBMQæµ‹è¯•å’Œæºç åˆ†æ | ChenSoul</title>
<link rel=canonical href=https://blog.chensoul.cc/posts/2024/04/28/thingsboard-tbmq-test/><link rel=preconnect href=https://fonts.font.im><link rel=preconnect href=https://fonts.loli.net crossorigin><link href="https://fonts.loli.net/css2?family=Roboto+Slab:wght@400;500;700&display=swap" rel=stylesheet><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://blog.chensoul.cc/images/favicon.webp"><meta name=twitter:title content="TBMQæµ‹è¯•å’Œæºç åˆ†æ"><meta name=twitter:description content="å¯åŠ¨ TBMQ ç¨‹åºï¼Œæµè§ˆå™¨è®¿é—® http://localhost:8083ï¼Œåˆ›å»ºä¸€ä¸ª Applicationï¼ŒCredentials Type ä¸º BASICï¼Œå®¢æˆ·ç«¯ IDã€ç”¨æˆ·åå’Œå¯†ç å‡è®¾ç½®ä¸º tbmq_app"><meta name=twitter:creator content="@ichensoul"><meta property="og:locale" content="en_US"><meta property="og:site_name" content="chensoul"><meta property="og:url" content="https://blog.chensoul.cc/posts/2024/04/28/thingsboard-tbmq-test/"><meta property="og:site_name" content="ChenSoul"><meta property="og:title" content="TBMQæµ‹è¯•å’Œæºç åˆ†æ"><meta property="og:description" content="å¯åŠ¨ TBMQ ç¨‹åºï¼Œæµè§ˆå™¨è®¿é—® http://localhost:8083ï¼Œåˆ›å»ºä¸€ä¸ª Applicationï¼ŒCredentials Type ä¸º BASICï¼Œå®¢æˆ·ç«¯ IDã€ç”¨æˆ·åå’Œå¯†ç å‡è®¾ç½®ä¸º tbmq_app"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-04-28T00:00:00+00:00"><meta property="article:modified_time" content="2024-04-28T00:00:00+00:00"><meta property="article:tag" content="Thingsboard"><meta property="og:image" content="https://blog.chensoul.cc/images/favicon.webp"><meta itemprop=name content="TBMQæµ‹è¯•å’Œæºç åˆ†æ"><meta itemprop=description content="å¯åŠ¨ TBMQ ç¨‹åºï¼Œæµè§ˆå™¨è®¿é—® http://localhost:8083ï¼Œåˆ›å»ºä¸€ä¸ª Applicationï¼ŒCredentials Type ä¸º BASICï¼Œå®¢æˆ·ç«¯ IDã€ç”¨æˆ·åå’Œå¯†ç å‡è®¾ç½®ä¸º tbmq_app"><meta itemprop=datePublished content="2024-04-28T00:00:00+00:00"><meta itemprop=dateModified content="2024-04-28T00:00:00+00:00"><meta itemprop=wordCount content="393"><meta itemprop=image content="https://blog.chensoul.cc/images/favicon.webp"><meta itemprop=keywords content="Thingsboard"><link rel=stylesheet href=https://cdnjs.loli.net/ajax/libs/font-awesome/6.4.0/css/all.min.css media=all><link rel=stylesheet href=/main.min.css type=text/css media=all><link rel="shortcut icon" href=/favicon.ico type=image/x-icon><script type=application/ld+json>{"@context":"https://schema.org","@graph":[{"@type":"TechArticle","name":"TBMQæµ‹è¯•å’Œæºç åˆ†æ","headline":"TBMQæµ‹è¯•å’Œæºç åˆ†æ","inLanguage":"en-US","url":"https://blog.chensoul.cc/posts/2024/04/28/thingsboard-tbmq-test/","description":"\u003col\u003e\n\u003cli\u003e\n\u003cp\u003eå¯åŠ¨ TBMQ ç¨‹åºï¼Œæµè§ˆå™¨è®¿é—® http://localhost:8083ï¼Œåˆ›å»ºä¸€ä¸ª Applicationï¼ŒCredentials Type ä¸º   BASICï¼Œå®¢æˆ·ç«¯ IDã€ç”¨æˆ·åå’Œå¯†ç å‡è®¾ç½®ä¸º tbmq_app\u003c/p\u003e","wordCount":"393","keywords":["thingsboard"],"datePublished":"2024-04-28T00:00:00Z","dateModified":"2024-04-28T00:00:00Z","author":{"@type":"Person","name":"chensoul"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.chensoul.cc/posts/2024/04/28/thingsboard-tbmq-test/"},"publisher":{"@type":"Organization","name":"chensoul","url":"https://blog.chensoul.cc/posts/2024/04/28/thingsboard-tbmq-test/"}},{"@context":"https://schema.org","@type":"Organization","name":"chensoul","url":"https://blog.chensoul.cc/","sameAs":["https://x.com/ichensoul","https://github.com/chensoul","https://www.linkedin.com/in/","https://www.youtube.com/@chensoul","https://t.me/chensouls"]}]}</script><script defer src=https://umami.chensoul.cc/random-string.js data-website-id=821c25f8-a31a-4607-92d7-91ee76843d00></script></head><body class="home blog post-layout-one-column"><button onclick=topFunction() id=scrollTopBtn title="Go to top">
<i class="fa-solid fa-arrow-up"></i></button><div id=header-top class=header-bar-wrap></div><div id=page class=site><a class="skip-link screen-reader-text" href=#content>Skip to content</a><header id=masthead class="site-header clearfix" role=banner><div class="header-main container clearfix"><div id=logo class="site-branding clearfix"><h1 class=site-title><a href=/ title=ChenSoul rel=home>ChenSoul</a></h1><p class=site-description>Java, Spring Boot, Microservice, Cloud, Architecture and DevOps Tutorials</p></div><div class="header-widgets clearfix"><aside id=search-2 class="header-widget widget_search"><form role=search method=get class=search-form onsubmit="return searchSite(event)"><label><span class=screen-reader-text>Search for:</span>
<input type=search class=search-field placeholder="Enter search keyword" name=query id=query title="Enter search keyword">
</label><button type=submit class=search-submit title=Search> <span class=genericon-search></span>
<span class=screen-reader-text>Search</span></button></form></aside></div></div><div id=main-navigation-wrap class=primary-navigation-wrap><nav id=main-navigation class="primary-navigation navigation container clearfix" role=navigation><ul id=menu-home class=main-navigation-menu><li class="menu-item menu-item-type-custom menu-item-object-custom
current-menu-item current_page_item menu-item-home"><a href=/>Home</a></li><li class="menu-item menu-item-type-taxonomy menu-item-object-category"><a href=/categories/spring-boot/>Spring Boot</a></li><li class="menu-item menu-item-type-taxonomy menu-item-object-category"><a href=/categories/architecture/>Architecture</a></li><li class="menu-item menu-item-type-taxonomy menu-item-object-category"><a href=/categories/microservice/>Microservice</a></li><li class="menu-item menu-item-type-taxonomy menu-item-object-category"><a href=/categories/kubernetes/>Kubernetes</a></li><li class="menu-item menu-item-type-taxonomy menu-item-object-category
menu-item-has-children"><a href=/tutorials/>Tutorials</a><ul class=sub-menu><li class="menu-item menu-item-type-taxonomy menu-item-object-category"><a href=/spring-boot-tutorials/>Spring Boot Tutorials</a></li><li class="menu-item menu-item-type-taxonomy menu-item-object-category"><a href=/microservice-tutorials/>Microservice Tutorials</a></li><li class="menu-item menu-item-type-taxonomy menu-item-object-category"><a href=/kubernetes-tutorials/>Kubernetes Tutorials</a></li></ul></li><li class="menu-item menu-item-type-post_type menu-item-object-page"><a href=https://github.com/chensoul target=_blank>About Me</a></li></ul></nav></div></header><div id=content class="site-content container clearfix"><section id=primary class="content-archive content-area post-content-area"><main id=main class=site-main role=main><article class="post type-post"><div class=post-inner-content><header class=entry-header><h2 class=entry-title><a href=https://blog.chensoul.cc/posts/2024/04/28/thingsboard-tbmq-test/ rel=bookmark title=TBMQæµ‹è¯•å’Œæºç åˆ†æ>TBMQæµ‹è¯•å’Œæºç åˆ†æ</a></h2><div class=entry-meta><span class=meta-date><time class="entry-date published" datetime=2024-04-28T00:00:00>2024-04-28
</time></span><span class=meta-author><span class="author vcard">chensoul</span>
</span><span class="tagcloud post-tags"><i class="fa fa-tags"></i>&nbsp;
<a class="tag-cloud-link widget__link widget__link--taglist" href=/tags/thingsboard/ title=thingsboard>thingsboard</a></span></div></header><div class=entry-content><ol><li><p>å¯åŠ¨ TBMQ ç¨‹åºï¼Œæµè§ˆå™¨è®¿é—® http://localhost:8083ï¼Œåˆ›å»ºä¸€ä¸ª Applicationï¼ŒCredentials Type ä¸º BASICï¼Œå®¢æˆ·ç«¯ IDã€ç”¨æˆ·åå’Œå¯†ç å‡è®¾ç½®ä¸º tbmq_app</p></li><li><p>ä½¿ç”¨ mosquitto æµ‹è¯•è®¢é˜…æ¶ˆæ¯</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>mosquitto_sub -d -q <span style=color:#ae81ff>1</span> -h localhost -p <span style=color:#ae81ff>1883</span> -t tbmq/demo/+ -i <span style=color:#e6db74>&#39;tbmq_app&#39;</span> -u <span style=color:#e6db74>&#39;tbmq_app&#39;</span> -P <span style=color:#e6db74>&#39;tbmq_app&#39;</span> -c -v
</span></span></code></pre></div></li><li><p>Debug è°ƒè¯• MqttSessionHandler ç±»çš„ <code>channelRead(ChannelHandlerContext ctx, Object msg)</code> æ–¹æ³•</p><ol><li><p>ç¬¬ä¸€æ¬¡è¿æ¥ï¼Œæ¶ˆæ¯ç±»å‹æ˜¯ CONNECT</p><ul><li><p>æ¶ˆæ¯ï¼š</p><ul><li><p>å›ºå®šå¤´ï¼šMqttFixedHeader[messageType=CONNECT, isDup=false, qosLevel=AT_MOST_ONCE, isRetain=false, remainingLength=40]</p></li><li><p>å˜é‡å¤´ï¼šMqttConnectVariableHeader[name=MQTT, version=4, hasUserName=true, hasPassword=true, isWillRetain=false, isWillFlag=false, isCleanSession=false, keepAliveTimeSeconds=60]</p></li><li><p>è´Ÿè½½ï¼šMqttConnectPayload[clientIdentifier=tbmq_app, willTopic=null, willMessage=null, userName=tbmq_app, password=[116, 98, 109, 113, 95, 97, 112, 112]]</p></li></ul></li><li><p>address ä¸ºç©ºï¼Œæ•…ä» ChannelHandlerContext è·å–å®¢æˆ·ç«¯åœ°å€ï¼Œå¹¶å°†åœ°å€ä¿æŒåˆ°å®¢æˆ·ç«¯ Session ä¸Šä¸‹æ–‡ ClientSessionCtx</p></li><li><p>åˆå§‹åŒ– Sessionï¼šè·å– clientIã€mqtt ç‰ˆæœ¬ï¼Œè°ƒç”¨ ClientMqttActorManager åˆå§‹åŒ– sessionï¼šåˆ›å»º clientActorRefï¼Œå‘é€ä¸€ä¸ª SessionInitMsg æ¶ˆæ¯</p></li><li><p>è°ƒç”¨ ClientMqttActorManager connect æ–¹æ³•ï¼Œå‘é€ä¸€ä¸ª MqttConnectMsg æ¶ˆæ¯</p></li></ul></li><li><p>ç¬¬äºŒæ¬¡è¿æ¥ï¼Œæ¶ˆæ¯ç±»å‹æ˜¯ SUBSCRIBE</p><p>MqttSubscribeMessage[fixedHeader=MqttFixedHeader[messageType=SUBSCRIBE, isDup=false, qosLevel=AT_LEAST_ONCE, isRetain=false, remainingLength=16], variableHeader=MqttMessageIdAndPropertiesVariableHeader[messageId=1, properties=io.netty.handler.codec.mqtt.MqttProperties@15c52601], payload=MqttSubscribePayload[MqttTopicSubscription[topicFilter=tbmq/demo/+, option=SubscriptionOption[qos=AT_LEAST_ONCE, noLocal=false, retainAsPublished=false, retainHandling=SEND_AT_SUBSCRIBE]]]]</p></li><li><p>ç¬¬ä¸‰æ¬¡è¿æ¥ï¼Œæ¶ˆæ¯ç±»å‹æ˜¯ PINGREQ</p></li></ol></li></ol><h2 id=mqttsessionhandler>MqttSessionHandler</h2><p>ç¬¬ä¸€æ¬¡è¿æ¥æ—¶ï¼ŒClientMqttActorManagerImpl åˆå§‹åŒ–ä»£ç </p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>initSession</span>(String clientId, <span style=color:#66d9ef>boolean</span> isClientIdGenerated, SessionInitMsg sessionInitMsg) {
</span></span><span style=display:flex><span>    TbActorRef clientActorRef <span style=color:#f92672>=</span> getActor(clientId);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (clientActorRef <span style=color:#f92672>==</span> <span style=color:#66d9ef>null</span>) {
</span></span><span style=display:flex><span>        clientActorRef <span style=color:#f92672>=</span> createRootActor(clientId, isClientIdGenerated);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    clientActorRef.<span style=color:#a6e22e>tellWithHighPriority</span>(sessionInitMsg);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>å¯ä»¥çœ‹åˆ°ï¼š</p><ul><li><p>MqttSessionHandler å°†æ¶ˆæ¯çš„å¤„ç†å§”æ‰˜ç»™äº† ClientMqttActorManager å¯¹è±¡ã€‚ClientMqttActorManagerä½¿ç”¨äº† Actor æ¨¡å‹ã€‚</p><ul><li><p>ClientMqttActorManager</p><ul><li><p>ActorSystemContext</p></li><li><p>TbActorSystem</p><ul><li><p>é€šè¿‡ ClientActorCreator åˆ›å»ºä¸€ä¸ª TbActorCtxï¼Œå…¶å®æ˜¯åˆ›å»ºäº†ä¸€ä¸ª TbActorMailbox</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>private</span> TbActorRef <span style=color:#a6e22e>createRootActor</span>(String clientId, <span style=color:#66d9ef>boolean</span> isClientIdGenerated) {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> actorSystem.<span style=color:#a6e22e>createRootActor</span>(ActorSystemLifecycle.<span style=color:#a6e22e>CLIENT_DISPATCHER_NAME</span>,
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>new</span> ClientActorCreator(actorSystemContext, clientId, isClientIdGenerated));
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></li><li><p>ClientActorCreator è´Ÿè´£åˆ›å»º ClientActor</p></li></ul></li></ul></li></ul></li><li><p>NettyMqttConverter è´Ÿè´£å°† MqttMessage è½¬æ¢ä¸º TbActorMsgã€‚</p></li><li><p>clientActorRef.tellWithHighPriority å‘é€äº†ä¸€ä¸ªé«˜ä¼˜å…ˆçº§çš„æ¶ˆæ¯ï¼š<code>clientActorRef.tellWithHighPriority(sessionInitMsg)</code>ã€‚è¿™ä¸ªæ–¹æ³•æ˜¯ Actor æ¨¡å‹å®šä¹‰çš„æ–¹æ³•ï¼Œè°ƒç”¨è¯¥æ–¹æ³•æ„å‘³ç€ç¨‹åºçš„æ‰§è¡Œè¿›å…¥äº† Actorã€‚å…³äº Actor å…·ä½“çš„æ‰§è¡Œé€»è¾‘ï¼Œå¯ä»¥å…ˆå¿½ç•¥ï¼Œä¸»è¦å…³æ³¨ Actor æ˜¯åœ¨ä»€ä¹ˆæ—¶å€™ã€æ€ä¹ˆè°ƒç”¨ä¸šåŠ¡ä»£ç çš„ï¼ˆå³å¦‚ä½•å¤„ç† MQTT æ¶ˆæ¯çš„é€»è¾‘ï¼‰ã€‚</p><ul><li>è°ƒç”¨ TbActorMailboxçš„ enqueue(TbActorMsg msg, boolean highPriority) æ–¹æ³•<ul><li>è°ƒç”¨ tryProcessQueue(true);<ul><li>è°ƒç”¨ processMailbox() æ–¹æ³•<ul><li>è°ƒç”¨ actor.process(msg); æ–¹æ³•ï¼Œè¿™é‡Œçš„ actor æ˜¯ç”± ClientActorCreator åˆ›å»ºçš„ ClientActor<ul><li>è°ƒç”¨ ClientActor çš„actor.process(msg); æ–¹æ³•<ul><li>å¦‚æœ TimedMsg åˆ™ clientActorStats.logMsgQueueTime(msg, TimeUnit.NANOSECONDS);</li><li>clientLogger è®°å½•äº‹ä»¶</li><li>å¦‚æœæ˜¯é˜Ÿåˆ—æ¶ˆæ¯ QueueableMqttMsgï¼Œè°ƒç”¨ processQueueableMqttMsg((QueueableMqttMsg) msg); æ–¹æ³•</li><li>å¦‚æœæ˜¯å…¶ä»–æ¶ˆæ¯ï¼š</li><li>SessionInitMsgï¼šActorProcessor<ul><li>åˆ›å»º AuthContext</li><li>è°ƒç”¨ AuthResponse authenticateClient(AuthContext authContext)<ul><li>è°ƒç”¨ authenticationService.authenticate(authContext)<ul><li>è°ƒç”¨ MqttClientAuthProviderçš„authenticate(AuthContext authContext)<ul><li>è°ƒç”¨ BasicMqttClientAuthProvider<ul><li>è®¤è¯å¯†ç  BasicMqttCredentials</li><li>è°ƒç”¨ authorizationRuleService.parseBasicAuthorizationRule(credentials) è·å– AuthRulePatterns</li><li>è¿”å› AuthResponse</li></ul></li></ul></li></ul></li></ul></li><li>finishSessionAuth(state.getClientId(), sessionCtx, authResponse) ï¼š ClientSessionCtx ä¿å­˜å®¢æˆ·ç«¯ç±»å‹ã€authRulePatterns</li><li>æ›´æ–° ClientActorState</li></ul></li><li>MQTT_CONNECT_MSGï¼š<ul><li>ConnectService startConnection<ul><li>ClientSessionCtx ä¿å­˜ SessionInfo</li><li>ClientSessionCtx è®¾ç½® TopicAliasCtx</li><li>KeepAliveService æ³¨å†Œ session</li><li>ClientSessionEventService requestConnection(SessionInfo sessionInfo)<ul><li>å‘é€ ClientSessionEventProto åˆ° MQ</li></ul></li></ul></li><li></li></ul></li></ul></li></ul></li></ul></li></ul></li></ul></li></ul></li></ul><p>â€‹</p><p>MqttSessionHandler ç±»è°ƒç”¨å…³ç³»ï¼š</p><ul><li><p>MqttSessionHandler</p><ul><li><p>ClientMqttActorManager</p><ul><li><p>TbActorMailbox</p><ul><li><p>ContextAwareActor</p><ul><li><p>ClientActor</p><ul><li><p>1ï¼šSessionInitMsg</p><ul><li>ActorProcessor<ul><li>AuthenticationService<ul><li>MqttClientAuthProvider<ul><li>MqttClientCredentialsService<ul><li>MqttClientCredentialsDao</li></ul></li></ul></li></ul></li></ul></li></ul></li><li><ol start=2><li>MqttConnectMsg</li></ol><ul><li>ConnectService<ul><li>ClientSessionEventService<ul><li>TbQueueProducer<ul><li>ClientSessionEventConsumer<ul><li>ClientSessionEventActorManager<ul><li>TbActorRef</li></ul></li></ul></li></ul></li></ul></li></ul></li></ul></li><li><ol start=3><li>ConnectionRequestMsg</li></ol><ul><li>SessionClusterManager<ul><li>ClientSessionService<ul><li>ClientSessionPersistenceService<ul><li>TbQueueProducer</li></ul></li></ul></li></ul></li></ul></li><li><p>ConnectionAcceptedMsg</p><ul><li>ConnectService</li></ul></li><li><p>MqttDisconnectMsg</p><ul><li>DisconnectService</li></ul></li><li><p>SessionDisconnectedMsg</p><ul><li>SessionClusterManager<ul><li>ClientSessionService</li><li>ClientSubscriptionService</li></ul></li></ul></li></ul></li></ul></li></ul></li></ul></li></ul></li></ul><p>MqttSessionHandler æ˜¯ä¸€ä¸ªç”¨äºå¤„ç†MQTTä¼šè¯çš„Javaç±»ã€‚å®ƒå®ç°äº†<code>ChannelInboundHandlerAdapter</code>å’Œ<code>GenericFutureListener</code>æ¥å£ï¼Œå› æ­¤å¯ä»¥ä½œä¸ºNettyæ¡†æ¶ä¸­çš„å¤„ç†ç»„ä»¶ã€‚</p><p>å®ç°åŸç†ï¼š</p><ol><li>ç±»ä¸­åŒ…å«äº†ä¸€ä¸ª<code>sessionId</code>ï¼Œç”¨äºæ ‡è¯†æ¯ä¸ªä¼šè¯ã€‚sessionIdæ˜¯éšæœºç”Ÿæˆçš„UUIDï¼Œæ¯æ¬¡ä¼šè¯å¼€å§‹æ—¶éƒ½ä¼šé‡æ–°ç”Ÿæˆä¸€ä¸ªæ–°çš„sessionIdã€‚</li><li>ç±»ä¸­åŒ…å«äº†å„ç§å¤„ç†MQTTæ¶ˆæ¯çš„æ–¹æ³•ï¼Œä¾‹å¦‚<code>processMqttMsg</code>æ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•ä¼šæ ¹æ®æ¥æ”¶åˆ°çš„MQTTæ¶ˆæ¯ç±»å‹è¿›è¡Œç›¸åº”çš„å¤„ç†ã€‚ä¾‹å¦‚ï¼Œå½“æ”¶åˆ°<code>CONNECT</code>æ¶ˆæ¯æ—¶ï¼Œä¼šè°ƒç”¨<code>initSession</code>æ–¹æ³•åˆå§‹åŒ–ä¼šè¯ã€‚å½“æ”¶åˆ°<code>PUBLISH</code>æ¶ˆæ¯æ—¶ï¼Œä¼šæ£€æŸ¥é€Ÿç‡é™åˆ¶å¹¶å¤„ç†æ¶ˆæ¯ã€‚</li><li><code>disconnect</code>æ–¹æ³•ç”¨äºæ–­å¼€ä¸å®¢æˆ·ç«¯çš„è¿æ¥ã€‚å½“æ”¶åˆ°æ–­å¼€è¿æ¥çš„æ¶ˆæ¯æ—¶ï¼Œä¼šè°ƒç”¨è¿™ä¸ªæ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•ä¼šå…³é—­å®¢æˆ·ç«¯çš„é€šé“ï¼Œå¹¶å‘é€ä¸€ä¸ªMQTTæ–­å¼€è¿æ¥æ¶ˆæ¯ç»™å®¢æˆ·ç«¯ã€‚</li><li><code>getAddress</code>æ–¹æ³•ç”¨äºè·å–å®¢æˆ·ç«¯çš„è¿æ¥åœ°å€ã€‚è¿™ä¸ªæ–¹æ³•ä¼šä»ä¸Šä¸‹æ–‡ä¸­è·å–å®¢æˆ·ç«¯çš„åœ°å€ï¼Œå¦‚æœè·å–å¤±è´¥ï¼Œä¼šä½¿ç”¨è¿œç¨‹åœ°å€ä½œä¸ºå¤‡é€‰æ–¹æ¡ˆã€‚</li><li><code>operationComplete</code>æ–¹æ³•å®ç°äº†<code>GenericFutureListener</code>æ¥å£çš„æ–¹æ³•ã€‚å½“ä¸€ä¸ªæ“ä½œå®Œæˆæ—¶ï¼Œä¼šè°ƒç”¨è¿™ä¸ªæ–¹æ³•ã€‚åœ¨è¿™ä¸ªæ–¹æ³•ä¸­ï¼Œä¼šæ£€æŸ¥<code>clientId</code>æ˜¯å¦ä¸º<code>null</code>ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™æ–­å¼€è¿æ¥ï¼Œå‘é€ä¸€ä¸ªMQTTæ–­å¼€è¿æ¥æ¶ˆæ¯ç»™å®¢æˆ·ç«¯ã€‚</li><li><code>exceptionCaught</code>æ–¹æ³•ç”¨äºå¤„ç†å¼‚å¸¸ã€‚å½“å‘ç”Ÿå¼‚å¸¸æ—¶ï¼Œä¼šè°ƒç”¨è¿™ä¸ªæ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•ä¼šè®°å½•å¼‚å¸¸ä¿¡æ¯ï¼Œå¹¶æ–­å¼€è¿æ¥ã€‚</li><li><code>channelReadComplete</code>æ–¹æ³•ç”¨äºåˆ·æ–°ç¼“å†²åŒºã€‚å½“ä¸€æ¡æ¶ˆæ¯è¯»å–å®Œæˆæ—¶ï¼Œä¼šè°ƒç”¨è¿™ä¸ªæ–¹æ³•ã€‚</li><li><code>channelRead</code>æ–¹æ³•æ˜¯ä¸»è¦å¤„ç†æ–¹æ³•ã€‚å½“æ¥æ”¶åˆ°æ•°æ®æ—¶ï¼Œä¼šè°ƒç”¨è¿™ä¸ªæ–¹æ³•è¿›è¡Œå¤„ç†ã€‚è¿™ä¸ªæ–¹æ³•ä¼šå…ˆæ£€æŸ¥<code>address</code>æ˜¯å¦ä¸º<code>null</code>ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™ç”Ÿæˆä¸€ä¸ªæ–°çš„<code>address</code>ã€‚ç„¶åï¼Œä¼šæ ¹æ®æ¥æ”¶åˆ°çš„MQTTæ¶ˆæ¯ç±»å‹è¿›è¡Œç›¸åº”çš„å¤„ç†ã€‚</li></ol><p><code>channelRead</code>æ–¹æ³•ç”¨äºå¤„ç†æ¥è‡ªç½‘ç»œé€šé“çš„æ¶ˆæ¯ã€‚å…·ä½“æ¥è¯´ï¼Œå®ƒå¤„ç†çš„æ˜¯MQTTåè®®çš„æ¶ˆæ¯ã€‚MQTTæ˜¯ä¸€ç§è½»é‡çº§çš„é€šä¿¡åè®®ï¼Œç”¨äºç®€åŒ–ç½‘ç»œåº”ç”¨ç¨‹åºä¹‹é—´çš„é€šä¿¡ã€‚è¿™æ®µä»£ç çš„ä¸»è¦ä½œç”¨æ˜¯è§£æå’Œå¤„ç†æ¥è‡ªå®¢æˆ·ç«¯çš„MQTTæ¶ˆæ¯ã€‚</p><p>å®ç°åŸç†ï¼š</p><ol><li>é¦–å…ˆï¼Œä»£ç æ£€æŸ¥addressæ˜¯å¦ä¸ºnullï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è°ƒç”¨getAddress(ctx)è·å–å®¢æˆ·ç«¯çš„åœ°å€ï¼Œå¹¶å°†å…¶è®¾ç½®åˆ°addresså˜é‡ä¸­ã€‚åŒæ—¶ï¼Œå°†addressè®¾ç½®åˆ°clientSessionCtxä¸­ã€‚è¿™æ ·å¯ä»¥æ–¹ä¾¿åœ°åœ¨æ—¥å¿—ä¸­è®°å½•å®¢æˆ·ç«¯çš„åœ°å€ã€‚</li><li>å¦‚æœlog.isTraceEnabled()ä¸ºtrueï¼Œåˆ™è®°å½•ä¸‹å½“å‰å¤„ç†çš„æ¶ˆæ¯ï¼Œä»¥ä¾¿äºè°ƒè¯•å’Œæ—¥å¿—åˆ†æã€‚</li><li>å°†ctxè®¾ç½®åˆ°clientSessionCtxä¸­ï¼Œè¿™æ ·åç»­çš„å¤„ç†éƒ½å¯ä»¥é€šè¿‡clientSessionCtxæ¥è¿›è¡Œã€‚</li><li>æ£€æŸ¥æ¥æ”¶åˆ°çš„æ¶ˆæ¯msgæ˜¯å¦æ˜¯MqttMessageç±»å‹ã€‚å¦‚æœä¸æ˜¯ï¼Œåˆ™è®°å½•ä¸€æ¡è­¦å‘Šä¿¡æ¯ï¼Œå¹¶æ–­å¼€ä¸å®¢æˆ·ç«¯çš„è¿æ¥ã€‚</li><li>å¦‚æœæ¶ˆæ¯msgçš„è§£ç ç»“æœä¸æˆåŠŸï¼Œåˆ™è®°å½•ä¸€æ¡è­¦å‘Šä¿¡æ¯ï¼Œå¹¶æ–­å¼€ä¸å®¢æˆ·ç«¯çš„è¿æ¥ã€‚å¦‚æœæ¶ˆæ¯msgçš„è§£ç ç»“æœæ˜¯TooLongFrameExceptionå¼‚å¸¸ï¼Œåˆ™æ–­å¼€è¿æ¥çš„åŸå› æ˜¯ON_PACKET_TOO_LARGEï¼Œå¦åˆ™æ–­å¼€è¿æ¥çš„åŸå› æ˜¯ON_MALFORMED_PACKETã€‚</li><li>è°ƒç”¨processMqttMsgæ–¹æ³•å¤„ç†MqttMessageç±»å‹çš„æ¶ˆæ¯ã€‚</li><li>åœ¨å¤„ç†æ¶ˆæ¯åï¼Œ finally å—ä¸­ï¼Œé€šè¿‡ReferenceCountUtil.safeRelease(msg)é‡Šæ”¾æ¶ˆæ¯msgçš„å¼•ç”¨è®¡æ•°ã€‚</li></ol><p><code>processMqttMsg</code> æ–¹æ³•æ¥æ”¶ä¸€ä¸ªMqttMessageå¯¹è±¡ä½œä¸ºå‚æ•°ï¼Œç„¶åæ ¹æ®æ¶ˆæ¯çš„ç±»å‹è¿›è¡Œç›¸åº”çš„å¤„ç†ã€‚</p><p>å®ç°åŸç†ï¼š</p><ol><li>é¦–å…ˆï¼Œå®ƒæ£€æŸ¥æ¶ˆæ¯çš„å›ºå®šå¤´éƒ¨æ˜¯å¦ä¸ºç©ºï¼Œå¦‚æœä¸ºç©ºï¼Œåˆ™æŠ›å‡ºä¸€ä¸ªåè®®è¿åå¼‚å¸¸ã€‚</li><li>æ¥ä¸‹æ¥ï¼Œå®ƒæ£€æŸ¥å®¢æˆ·ç«¯IDï¼ˆclientIdï¼‰æ˜¯å¦ä¸ºç©ºã€‚å¦‚æœæ˜¯è¿æ¥æ¶ˆæ¯ï¼ˆCONNECTï¼‰ï¼Œåˆ™åˆå§‹åŒ–ä¼šè¯ï¼ˆinitSessionæ–¹æ³•ï¼‰ï¼›å¦åˆ™ï¼Œå¦‚æœclientIdä¸ºç©ºï¼Œåˆ™æŠ›å‡ºä¸€ä¸ªåè®®è¿åå¼‚å¸¸ã€‚</li><li>ç„¶åï¼Œå®ƒè®°å½•å®¢æˆ·ç«¯æ—¥å¿—ï¼ˆclientLoggerï¼‰å¹¶ä½¿ç”¨ä¸€ä¸ªswitchè¯­å¥æ ¹æ®æ¶ˆæ¯ç±»å‹è¿›è¡Œç›¸åº”çš„å¤„ç†ã€‚</li></ol><p>ç”¨é€”ï¼š</p><p>è¿™ä¸ªæ–¹æ³•ä¸»è¦ç”¨äºå¤„ç†MQTTæ¶ˆæ¯ï¼Œæ ¹æ®æ¶ˆæ¯ç±»å‹è¿›è¡Œç›¸åº”çš„å¤„ç†ã€‚</p><p>ä¾‹å¦‚ï¼Œå½“æ”¶åˆ°CONNECTæ¶ˆæ¯æ—¶ï¼Œå®ƒéœ€è¦åˆå§‹åŒ–ä¼šè¯ï¼›æ”¶åˆ°SUBSCRIBEæ¶ˆæ¯æ—¶ï¼Œéœ€è¦è®¢é˜…topicï¼›æ”¶åˆ°PUBLISHæ¶ˆæ¯æ—¶ï¼Œéœ€è¦å‘å¸ƒæ¶ˆæ¯ç­‰ã€‚</p><h2 id=clientmqttactormanagerimpl>ClientMqttActorManagerImpl</h2><p>è¿™ä¸ªä»£ç æ˜¯ä¸€ä¸ªJavaå®ç°çš„MQTTå®¢æˆ·ç«¯ ActorSystemï¼Œç”¨äºå¤„ç†MQTTæ¶ˆæ¯ã€‚ä»¥ä¸‹æ˜¯è¿™ä¸ªä»£ç çš„ä¸»è¦å®ç°åŸç†ã€ç”¨é€”å’Œæ³¨æ„äº‹é¡¹ï¼š</p><ol><li>å®ç°åŸç†ï¼šè¿™ä¸ªç±»ä½¿ç”¨äº†Akkaæ¡†æ¶çš„ActorSystemæ¥å¤„ç†MQTTæ¶ˆæ¯ã€‚ActorSystemæ˜¯ä¸€ä¸ªç”¨äºç»„ç»‡å’Œç®¡ç†Akkaactorçš„å±‚æ¬¡ç»“æ„ã€‚Actoræ˜¯Akkaçš„æ ¸å¿ƒæ¦‚å¿µï¼Œå®ƒå…è®¸ä»£ç ä»¥æ¶ˆæ¯ä¼ é€’çš„æ–¹å¼ç¼–å†™ï¼Œä»è€Œå®ç°å¹¶è¡Œå’Œæ— é˜»å¡çš„å¼‚æ­¥ç¼–ç¨‹ã€‚åœ¨è¿™ä¸ªç±»ä¸­ï¼ŒClientMqttActorManagerImplä½œä¸ºç®¡ç†å™¨ï¼Œè´Ÿè´£åˆ›å»ºã€é…ç½®å’Œæ§åˆ¶Actorçš„åˆ›å»ºå’Œæ¶ˆæ¯å¤„ç†ã€‚</li><li>ç”¨é€”ï¼šè¿™ä¸ªç±»çš„ä¸»è¦ç”¨é€”æ˜¯å¤„ç†MQTTæ¶ˆæ¯ï¼Œç‰¹åˆ«æ˜¯è¿æ¥ã€æ–­è¿ã€è®¢é˜…å’Œå–æ¶ˆè®¢é˜…ç­‰æ¶ˆæ¯ã€‚é€šè¿‡è¿™ä¸ªç±»ï¼Œå®¢æˆ·ç«¯å¯ä»¥ä¸ActorSystemé€šä¿¡ï¼Œä»è€Œå¤„ç†MQTTæ¶ˆæ¯ã€‚</li></ol><blockquote><p>Akka æ˜¯ä¸€ä¸ªç”¨äºå¼€å‘å¹¶å‘åº”ç”¨ç¨‹åºçš„Javaæ¡†æ¶ï¼Œå®ƒåŸºäºAkka Actoræ¨¡å‹ã€‚ActorSystemæ˜¯ä¸€ä¸ªç”¨äºç»„ç»‡å’Œç®¡ç†Akkaactorçš„å±‚æ¬¡ç»“æ„ã€‚Actoræ˜¯Akkaçš„æ ¸å¿ƒæ¦‚å¿µï¼Œå®ƒå…è®¸ä»£ç ä»¥æ¶ˆæ¯ä¼ é€’çš„æ–¹å¼ç¼–å†™ï¼Œä»è€Œå®ç°å¹¶è¡Œå’Œæ— é˜»å¡çš„å¼‚æ­¥ç¼–ç¨‹ã€‚ActorSystemçš„ä¸»è¦ä½œç”¨æ˜¯åˆ›å»ºã€é…ç½®å’Œæ§åˆ¶Actorçš„åˆ›å»ºå’Œæ¶ˆæ¯å¤„ç†ã€‚</p><p>åœ¨è¿™ä¸ªç³»ç»Ÿä¸­ï¼ŒActoræ˜¯åŸºæœ¬çš„é€šä¿¡å•å…ƒã€‚å®ƒä»¬é€šè¿‡æ¶ˆæ¯ä¼ é€’è¿›è¡Œé€šä¿¡ï¼Œè€Œä¸æ˜¯ç›´æ¥è°ƒç”¨å…¶ä»–æ–¹æ³•ã€‚è¿™ç§è®¾è®¡å…è®¸ä»£ç ä»¥ä¸€ç§çµæ´»çš„æ–¹å¼ç¼–å†™ï¼Œä»è€Œé€‚åº”å¹¶å‘ç¼–ç¨‹çš„è¦æ±‚ã€‚ActorSystemçš„ä¸»è¦ç»„ä»¶åŒ…æ‹¬ï¼š</p><ol><li>Celluloidï¼šè¿™æ˜¯ä¸€ä¸ªç”¨äºåè°ƒå¹¶å‘è¡Œä¸ºçš„åº“ï¼Œå®ƒæä¾›äº†åŸºæœ¬çš„çº¿ç¨‹å®‰å…¨å’Œé€šä¿¡æœºåˆ¶ã€‚</li><li>JSR 229ï¼šè¿™æ˜¯ä¸€ä¸ªJavaæ ‡å‡†è§„èŒƒï¼Œå®ƒå®šä¹‰äº†ä¸€ä¸ªç”¨äºå¤„ç†æ¶ˆæ¯çš„APIã€‚Akkaä½¿ç”¨JSR 229 APIæ¥å®ç°Actorä¹‹é—´çš„é€šä¿¡ã€‚</li><li>ThreadPoolï¼šè¿™æ˜¯ä¸€ä¸ªçº¿ç¨‹æ± ï¼Œå®ƒç”¨äºåœ¨Actorç³»ç»Ÿä¸­å…±äº«çº¿ç¨‹èµ„æºã€‚è¿™æ ·å¯ä»¥æé«˜æ€§èƒ½ï¼Œé¿å…é¢‘ç¹åˆ›å»ºå’Œé”€æ¯çº¿ç¨‹ã€‚</li><li>Mailboxï¼šè¿™æ˜¯ä¸€ä¸ªæ¶ˆæ¯å­˜å‚¨ç»“æ„ï¼Œç”¨äºå­˜å‚¨Actoræ”¶åˆ°çš„æ¶ˆæ¯ã€‚Mailboxå¯ä»¥ç¡®ä¿æ¶ˆæ¯çš„å®‰å…¨æ€§å’Œé¡ºåºæ€§ã€‚</li><li>ActorRefï¼šè¿™æ˜¯ä¸€ä¸ªå¼•ç”¨ï¼Œç”¨äºè¡¨ç¤ºActorçš„å®ä¾‹ã€‚ActorRefå…è®¸å…¶ä»–Actoré€šè¿‡å…¶è®¿é—®å’Œæ“ä½œActorã€‚</li><li>Managerï¼šè¿™æ˜¯ä¸€ä¸ªé«˜çº§çš„Actorç®¡ç†å™¨ï¼Œå®ƒè´Ÿè´£åˆ›å»ºã€é…ç½®å’Œæ§åˆ¶Actorçš„åˆ›å»ºå’Œæ¶ˆæ¯å¤„ç†ã€‚</li><li>ActorSystemï¼šè¿™æ˜¯ä¸€ä¸ªå…¨å±€çš„Actorç³»ç»Ÿï¼Œå®ƒè´Ÿè´£ç®¡ç†æ‰€æœ‰çš„Actorå’Œæ¶ˆæ¯ã€‚</li></ol><p>æ€»ä¹‹ï¼ŒAkkaæ¡†æ¶çš„ä¸»è¦ç‰¹æ€§æ˜¯å¹¶è¡Œç¼–ç¨‹ï¼Œå®ƒé€šè¿‡ActorSystemæ¥å®ç°ã€‚ActorSystemæ˜¯ä¸€ä¸ªå±‚æ¬¡ç»“æ„ï¼Œç”±Actorç»„æˆï¼Œå®ƒä»¬é€šè¿‡æ¶ˆæ¯ä¼ é€’è¿›è¡Œé€šä¿¡ã€‚è¿™ç§è®¾è®¡ä½¿å¾—ä»£ç æ˜“äºç†è§£å’Œç»´æŠ¤ï¼ŒåŒæ—¶æ»¡è¶³å¹¶å‘ç¼–ç¨‹çš„è¦æ±‚ã€‚</p></blockquote><h2 id=tbactormailbox>TbActorMailbox</h2><p>è¿™ä¸ªä»£ç æ˜¯ä¸€ä¸ªå®ç°é«˜ä¼˜å…ˆçº§æ¶ˆæ¯å¤„ç†çš„Javaç±»ã€‚å®ƒä¸»è¦ç”¨äºåœ¨æ¶ˆæ¯é˜Ÿåˆ—ä¸­å¤„ç†é«˜ä¼˜å…ˆçº§æ¶ˆæ¯ï¼Œä»è€Œæé«˜æ€§èƒ½ã€‚ä»¥ä¸‹æ˜¯è¿™ä¸ªç±»çš„è¯¦ç»†è§£é‡Šï¼š</p><ol><li>å®šä¹‰äº†ä¸¤ä¸ªå¸¸é‡<code>HIGH_PRIORITY</code>å’Œ<code>NORMAL_PRIORITY</code>æ¥è¡¨ç¤ºé«˜ä¼˜å…ˆçº§å’Œæ™®é€šä¼˜å…ˆçº§ã€‚</li><li>å®šä¹‰äº†ä¸¤ä¸ªå¸¸é‡<code>FREE</code>å’Œ<code>BUSY</code>æ¥è¡¨ç¤ºé‚®ç®±çš„ç©ºé—²çŠ¶æ€å’Œå¤„ç†æ¶ˆæ¯çš„çŠ¶æ€ã€‚</li><li>å®šä¹‰äº†ä¸¤ä¸ªå¸¸é‡<code>NOT_READY</code>å’Œ<code>READY</code>æ¥è¡¨ç¤ºé‚®ç®±æœªå‡†å¤‡å¥½æ¥æ”¶æ¶ˆæ¯å’Œå·²å‡†å¤‡å¥½æ¥æ”¶æ¶ˆæ¯çš„çŠ¶æ€ã€‚</li><li>ä½¿ç”¨äº†<code>ConcurrentLinkedQueue</code>æ¥å­˜å‚¨æ¶ˆæ¯ï¼Œä»¥æé«˜æ€§èƒ½ã€‚</li><li><code>initActor</code>æ–¹æ³•ç”¨äºåˆå§‹åŒ– Actorï¼Œå®ƒä¼šå°†åˆå§‹åŒ–ä»»åŠ¡åˆ†é…ç»™çº¿ç¨‹æ± æ‰§è¡Œã€‚</li><li><code>enqueue</code>æ–¹æ³•ç”¨äºå°†æ¶ˆæ¯æ·»åŠ åˆ°é‚®ç®±ä¸­ï¼Œå®ƒä¼šæ ¹æ®æ¶ˆæ¯çš„ä¼˜å…ˆçº§å°†æ¶ˆæ¯æ·»åŠ åˆ°ç›¸åº”çš„é˜Ÿåˆ—ä¸­ã€‚</li><li><code>tryProcessQueue</code>æ–¹æ³•ç”¨äºå¤„ç†æ¶ˆæ¯ï¼Œå®ƒä¼šæ£€æŸ¥é‚®ç®±æ˜¯å¦å·²å‡†å¤‡å¥½æ¥æ”¶æ¶ˆæ¯ï¼Œæ˜¯å¦åœ¨destroyInProgressä¸­ï¼Œä»¥åŠæ˜¯å¦è¿˜æœ‰æ¶ˆæ¯éœ€è¦å¤„ç†ã€‚å¦‚æœæ»¡è¶³æ¡ä»¶ï¼Œå®ƒä¼šè°ƒç”¨<code>processMailbox</code>æ–¹æ³•æ¥å¤„ç†æ¶ˆæ¯ã€‚</li><li><code>processMailbox</code>æ–¹æ³•ç”¨äºå¤„ç†æ¶ˆæ¯ï¼Œå®ƒä¼šä»é˜Ÿåˆ—ä¸­å–å‡ºæ¶ˆæ¯ï¼Œå¹¶è°ƒç”¨<code>actor.process</code>æ–¹æ³•æ¥å¤„ç†æ¶ˆæ¯ã€‚</li><li><code>getSelf</code>æ–¹æ³•ç”¨äºè·å–å½“å‰çš„ActorIdã€‚</li><li><code>tell</code>æ–¹æ³•ç”¨äºå‘é€æ¶ˆæ¯ç»™å­Actorï¼Œå®ƒä¼šå°†æ¶ˆæ¯å‘é€ç»™ç³»ç»Ÿã€‚</li><li><code>broadcastToChildren</code>æ–¹æ³•ç”¨äºå‘å­Actorå¹¿æ’­æ¶ˆæ¯ï¼Œå®ƒä¼šå°†æ¶ˆæ¯å¹¿æ’­ç»™ç³»ç»Ÿä¸­æ»¡è¶³æ¡ä»¶çš„å­Actorã€‚</li><li><code>filterChildren</code>æ–¹æ³•ç”¨äºè¿‡æ»¤å­Actorï¼Œå®ƒä¼šè¿”å›æ»¡è¶³æ¡ä»¶çš„å­Actoråˆ—è¡¨ã€‚</li><li><code>stop</code>æ–¹æ³•ç”¨äºåœæ­¢Actorï¼Œå®ƒä¼šå°†åœæ­¢æ¶ˆæ¯å‘é€ç»™ç³»ç»Ÿã€‚</li><li><code>getOrCreateChildActor</code>æ–¹æ³•ç”¨äºåˆ›å»ºæˆ–è·å–å­Actorï¼Œå®ƒä¼šæ ¹æ®æ¡ä»¶æ¥åˆ›å»ºæˆ–è·å–å­Actorã€‚</li><li><code>destroy</code>æ–¹æ³•ç”¨äºé”€æ¯Actorï¼Œå®ƒä¼šè®¾ç½®<code>destroyInProgress</code>ä¸ºtrueï¼Œç„¶åé”€æ¯Actorã€‚</li><li>å®ç°äº†<code>TbActorId</code>æ¥å£ï¼Œè¯¥æ¥å£å®šä¹‰äº†Actorçš„å”¯ä¸€æ ‡è¯†ã€‚</li><li><code>tell</code>å’Œ<code>tellWithHighPriority</code>æ–¹æ³•ç”¨äºå‘é€æ¶ˆæ¯ç»™å­Actorï¼Œå®ƒä¼šæ ¹æ®æ¶ˆæ¯çš„ä¼˜å…ˆçº§å°†æ¶ˆæ¯æ·»åŠ åˆ°ç›¸åº”çš„é˜Ÿåˆ—ä¸­ã€‚</li></ol><p>é€šè¿‡å®ç°è¿™ä¸ªç±»ï¼Œå¯ä»¥åœ¨Actorç³»ç»Ÿä¸­å¤„ç†é«˜ä¼˜å…ˆçº§æ¶ˆæ¯ï¼Œä»è€Œæé«˜æ€§èƒ½ã€‚</p><p>MQæ¶ˆæ¯ä¸»é¢˜ï¼š</p><ul><li>tbmq.client.session<ul><li>ClientSessionConsumer</li></ul></li><li>tbmq.client.subscriptions<ul><li>ClientSubscriptionConsumer</li></ul></li><li>tbmq.client.session.event.request<ul><li>ClientSessionEventConsumer</li></ul></li><li>tbmq.msg.persisted</li><li>tbmq.msg.retained<ul><li>RetainedMsgConsumer</li></ul></li><li>tbmq.client.disconnect.chensoulMacBook.local<ul><li>DisconnectClientCommandConsumer</li></ul></li><li>tbmq.client.session.event.response.chensoulMacBook.local</li><li>tbmq.msg.downlink.basic.chensoulMacBook.local</li><li>tbmq.msg.app.1b2512eca293401e8be2f7376becfb6273758da77822acc28f9debd557f1d97a</li><li>tbmq.sys.historical.data<ul><li>HistoricalStatsTotalConsumer</li></ul></li></ul></div><div><div style=font-weight:700>Share this post:</div><a class=social-link-item href="https://twitter.com/intent/tweet?text=TBMQ%e6%b5%8b%e8%af%95%e5%92%8c%e6%ba%90%e7%a0%81%e5%88%86%e6%9e%90 https%3a%2f%2fblog.chensoul.cc%2fposts%2f2024%2f04%2f28%2fthingsboard-tbmq-test%2f" target=_blank rel="noopener noreferrer" title="Click to share on Twitter"><i class="fa-brands fa-square-twitter fa-2xl" style=color:#55acee></i>
</a><a class=social-link-item href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fblog.chensoul.cc%2fposts%2f2024%2f04%2f28%2fthingsboard-tbmq-test%2f&title=TBMQ%e6%b5%8b%e8%af%95%e5%92%8c%e6%ba%90%e7%a0%81%e5%88%86%e6%9e%90" target=_blank rel="noopener noreferrer" title="Click to share on LinkedIn"><i class="fa-brands fa-linkedin fa-2xl" style=color:#007bb5></i>
</a><a class=social-link-item href="https://telegram.me/share/url?text=TBMQ%e6%b5%8b%e8%af%95%e5%92%8c%e6%ba%90%e7%a0%81%e5%88%86%e6%9e%90&amp;url=https%3a%2f%2fblog.chensoul.cc%2fposts%2f2024%2f04%2f28%2fthingsboard-tbmq-test%2f" target=_blank rel="noopener noreferrer" title="Click to share on telegram"><i class="fa-brands fa-telegram fa-2xl" style=color:#007bb5></i>
</a><a class=social-link-item href="https://reddit.com/submit?url=https%3a%2f%2fblog.chensoul.cc%2fposts%2f2024%2f04%2f28%2fthingsboard-tbmq-test%2f&title=TBMQ%e6%b5%8b%e8%af%95%e5%92%8c%e6%ba%90%e7%a0%81%e5%88%86%e6%9e%90" target=_blank rel="noopener noreferrer" title="Click to share on reddit"><i class="fa-brands fa-reddit fa-2xl" style=color:#007bb5></i>
</a><a class=social-link-item href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fblog.chensoul.cc%2fposts%2f2024%2f04%2f28%2fthingsboard-tbmq-test%2f" target=_blank rel="noopener noreferrer" title="Click to share on facebook"><i class="fa-brands fa-facebook fa-2xl" style=color:#007bb5></i>
</a><a class=social-link-item href="https://api.whatsapp.com/send?text=TBMQ%e6%b5%8b%e8%af%95%e5%92%8c%e6%ba%90%e7%a0%81%e5%88%86%e6%9e%90%20-%20https%3a%2f%2fblog.chensoul.cc%2fposts%2f2024%2f04%2f28%2fthingsboard-tbmq-test%2f" target=_blank rel="noopener noreferrer" title="Click to share on whatsapp"><i class="fa-brands fa-whatsapp fa-2xl" style=color:#007bb5></i></a></div></div></article><nav class="navigation post-navigation" role=navigation><h2 class=screen-reader-text>Post navigation</h2><div class=nav-links><div class=nav-previous><a href=/posts/2024/04/29/all-things-about-thingsboard/ rel=next><span class=post-title>All things about ThingsBoard</span></a></div><div class=nav-next><a href=/posts/2024/04/17/thingsboard-tbmq-local-docker-run/ rel=prev><span class=post-title>ThingsBoard TBMQæœ¬åœ°å’Œé€šè¿‡Dockerè¿è¡Œ</span></a></div></div></nav><h2>Related content</h2><ul><li><a href=/posts/2024/12/03/github-actions-in-thingsboard/>ThingsBoardæºç ä¸­çš„Github Actions</a></li><li><a href=/posts/2024/12/03/security-in-thingsboard/>ThingsBoardæºç ä¸­çš„Security</a></li><li><a href=/posts/2024/11/14/quarkus-quick-start/>2024-11-14-Quarkus å¿«é€Ÿå…¥é—¨</a></li><li><a href=/posts/2024/11/07/junit-5-migration/>[è¯‘]ä»JUnit4è¿ç§»åˆ°JUnit5ï¼šæƒå¨æŒ‡å—</a></li><li><a href=/tutorials/>Tutorials</a></li><li><a href=/posts/2024/08/27/activemq-source-code-broker-service/>ActiveMQæºç -BrokerServiceå’ŒPersistenceAdapter</a></li><li><a href=/posts/2024/08/27/thingsboard-code-source-compile/>ThingsBoardæºç ç¼–è¯‘å’ŒIdeaè¿è¡Œ</a></li><li><a href=/posts/2024/08/09/debug-activemq-source-code/>ActiveMQæºç æœ¬åœ°è°ƒè¯•è¿è¡Œ</a></li><li><a href=/posts/2024/08/01/publishing-a-jar-to-maven-repository-with-github-action/>Github Action å‘å¸ƒ Jar åˆ° Maven ä¸­å¤®ä»“åº“</a></li><li><a href=/posts/2024/07/24/what-is-new-in-jms-2-0/>[è¯‘]JMS 2.0 ä¸­çš„æ–°å¢åŠŸèƒ½</a></li></ul></main></section></div><div id=footer class=footer-wrap><footer id=colophon class="site-footer container clearfix" role=contentinfo><div id=footer-text class=site-info><span class=credit-link>Made with ğŸ©·
by <a href=/ target=_blank rel="noopener noreferrer">ChenSoul</a></span></div></footer></div></div><script type=text/javascript src=/main.min.js></script></body></html>