<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>[译]JMS 2.0 中的新增功能 | ChenSoul</title>
<meta name=keywords content="jms"><meta name=description content="原文链接：What is new in JMS 2.0
在在软件集成领域，从一个软件组件到另一个软件组件进行通信是一项基本要求。虽然已经出现了许多具有这种能力的技术，但 Java 编程语言为我们提供了一个 API，以促进用 Java 编写的组件之间的消息传递。此 API 的实现将由不同的供应商（JMS 提供商）通过代理软件提供。
这个API被称为Java消息服务（JMS）。
JMS 规范的最后一次更新是在 2002 年，当时推出了JMS 1.1。从那时起，多年来，该 API 已在全球许多软件组件中使用，证明了其对开发人员的友好性。JMS 的下一个版本（JMS 2.0）于 2013 年 4 月问世，距离 1.1 版已有数年之久。
JMS 2.0 只能与Java SE 7 及更高版本一起使用。了解 JMS 2.0 中的新功能将会很有趣。
易于使用的语言功能 从语言角度来看，对 API 所做的最重大的更改是减少了开发人员需要编写的代码量。让我们将 JMS 2.0 与 1.1 进行比较，看看它们有什么区别。
连接和会话对象纳入单个 JMSContext 不再需要创建连接和会话对象。您可以创建 JMSContext 并直接使用它来创建消息生产者。
//JMS 1.1 public void sendMessageJMS11(ConnectionFactory connectionFactory, Queue queueString text) { try { Connection connection = connectionFactory.createConnection(); try { Session session =connection.createSession(false,Session.AUTO_ACKNOWLEDGE); MessageProducer messageProducer = session.createProducer(queue); TextMessage textMessage = session.createTextMessage(text); messageProducer.send(textMessage); } finally { connection.close(); } } catch (JMSException ex) { // handle exception (details omitted) } } //JMS 2."><meta name=author content="chensoul"><link rel=canonical href=https://blog.chensoul.cc/posts/2024/07/24/what-is-new-in-jms-2-0/><meta name=google-site-verification content="nBXwg45SBRjTX78SA-mH0asrAbsdu9c1nk0ObSry7aQ"><link crossorigin=anonymous href=/assets/css/stylesheet.48da2331f774073f2b09ec285a9c0e15fd969021a9d2d0fb60b7cbb73cef5ecc.css integrity="sha256-SNojMfd0Bz8rCewoWpwOFf2WkCGp0tD7YLfLtzzvXsw=" rel="preload stylesheet" as=style><link rel=icon href=https://blog.chensoul.cc/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://blog.chensoul.cc/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://blog.chensoul.cc/favicon-32x32.png><link rel=apple-touch-icon href=https://blog.chensoul.cc/apple-touch-icon.png><link rel=mask-icon href=https://blog.chensoul.cc/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://blog.chensoul.cc/posts/2024/07/24/what-is-new-in-jms-2-0/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta name=baidu-site-verification content="codeva-FYpQY8JdLU"><meta property="og:title" content="[译]JMS 2.0 中的新增功能"><meta property="og:description" content="原文链接：What is new in JMS 2.0
在在软件集成领域，从一个软件组件到另一个软件组件进行通信是一项基本要求。虽然已经出现了许多具有这种能力的技术，但 Java 编程语言为我们提供了一个 API，以促进用 Java 编写的组件之间的消息传递。此 API 的实现将由不同的供应商（JMS 提供商）通过代理软件提供。
这个API被称为Java消息服务（JMS）。
JMS 规范的最后一次更新是在 2002 年，当时推出了JMS 1.1。从那时起，多年来，该 API 已在全球许多软件组件中使用，证明了其对开发人员的友好性。JMS 的下一个版本（JMS 2.0）于 2013 年 4 月问世，距离 1.1 版已有数年之久。
JMS 2.0 只能与Java SE 7 及更高版本一起使用。了解 JMS 2.0 中的新功能将会很有趣。
易于使用的语言功能 从语言角度来看，对 API 所做的最重大的更改是减少了开发人员需要编写的代码量。让我们将 JMS 2.0 与 1.1 进行比较，看看它们有什么区别。
连接和会话对象纳入单个 JMSContext 不再需要创建连接和会话对象。您可以创建 JMSContext 并直接使用它来创建消息生产者。
//JMS 1.1 public void sendMessageJMS11(ConnectionFactory connectionFactory, Queue queueString text) { try { Connection connection = connectionFactory.createConnection(); try { Session session =connection.createSession(false,Session.AUTO_ACKNOWLEDGE); MessageProducer messageProducer = session.createProducer(queue); TextMessage textMessage = session.createTextMessage(text); messageProducer.send(textMessage); } finally { connection.close(); } } catch (JMSException ex) { // handle exception (details omitted) } } //JMS 2."><meta property="og:type" content="article"><meta property="og:url" content="https://blog.chensoul.cc/posts/2024/07/24/what-is-new-in-jms-2-0/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-07-24T00:00:00+00:00"><meta property="article:modified_time" content="2024-07-24T00:00:00+00:00"><meta property="og:site_name" content="ChenSoul"><meta name=twitter:card content="summary"><meta name=twitter:title content="[译]JMS 2.0 中的新增功能"><meta name=twitter:description content="原文链接：What is new in JMS 2.0
在在软件集成领域，从一个软件组件到另一个软件组件进行通信是一项基本要求。虽然已经出现了许多具有这种能力的技术，但 Java 编程语言为我们提供了一个 API，以促进用 Java 编写的组件之间的消息传递。此 API 的实现将由不同的供应商（JMS 提供商）通过代理软件提供。
这个API被称为Java消息服务（JMS）。
JMS 规范的最后一次更新是在 2002 年，当时推出了JMS 1.1。从那时起，多年来，该 API 已在全球许多软件组件中使用，证明了其对开发人员的友好性。JMS 的下一个版本（JMS 2.0）于 2013 年 4 月问世，距离 1.1 版已有数年之久。
JMS 2.0 只能与Java SE 7 及更高版本一起使用。了解 JMS 2.0 中的新功能将会很有趣。
易于使用的语言功能 从语言角度来看，对 API 所做的最重大的更改是减少了开发人员需要编写的代码量。让我们将 JMS 2.0 与 1.1 进行比较，看看它们有什么区别。
连接和会话对象纳入单个 JMSContext 不再需要创建连接和会话对象。您可以创建 JMSContext 并直接使用它来创建消息生产者。
//JMS 1.1 public void sendMessageJMS11(ConnectionFactory connectionFactory, Queue queueString text) { try { Connection connection = connectionFactory.createConnection(); try { Session session =connection.createSession(false,Session.AUTO_ACKNOWLEDGE); MessageProducer messageProducer = session.createProducer(queue); TextMessage textMessage = session.createTextMessage(text); messageProducer.send(textMessage); } finally { connection.close(); } } catch (JMSException ex) { // handle exception (details omitted) } } //JMS 2."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://blog.chensoul.cc/posts/"},{"@type":"ListItem","position":2,"name":"[译]JMS 2.0 中的新增功能","item":"https://blog.chensoul.cc/posts/2024/07/24/what-is-new-in-jms-2-0/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"[译]JMS 2.0 中的新增功能","name":"[译]JMS 2.0 中的新增功能","description":"原文链接：What is new in JMS 2.0\n在在软件集成领域，从一个软件组件到另一个软件组件进行通信是一项基本要求。虽然已经出现了许多具有这种能力的技术，但 Java 编程语言为我们提供了一个 API，以促进用 Java 编写的组件之间的消息传递。此 API 的实现将由不同的供应商（JMS 提供商）通过代理软件提供。\n这个API被称为Java消息服务（JMS）。\nJMS 规范的最后一次更新是在 2002 年，当时推出了JMS 1.1。从那时起，多年来，该 API 已在全球许多软件组件中使用，证明了其对开发人员的友好性。JMS 的下一个版本（JMS 2.0）于 2013 年 4 月问世，距离 1.1 版已有数年之久。\nJMS 2.0 只能与Java SE 7 及更高版本一起使用。了解 JMS 2.0 中的新功能将会很有趣。\n易于使用的语言功能 从语言角度来看，对 API 所做的最重大的更改是减少了开发人员需要编写的代码量。让我们将 JMS 2.0 与 1.1 进行比较，看看它们有什么区别。\n连接和会话对象纳入单个 JMSContext 不再需要创建连接和会话对象。您可以创建 JMSContext 并直接使用它来创建消息生产者。\n//JMS 1.1 public void sendMessageJMS11(ConnectionFactory connectionFactory, Queue queueString text) { try { Connection connection = connectionFactory.createConnection(); try { Session session =connection.createSession(false,Session.AUTO_ACKNOWLEDGE); MessageProducer messageProducer = session.createProducer(queue); TextMessage textMessage = session.createTextMessage(text); messageProducer.send(textMessage); } finally { connection.close(); } } catch (JMSException ex) { // handle exception (details omitted) } } //JMS 2.","keywords":["jms"],"articleBody":"原文链接：What is new in JMS 2.0\n在在软件集成领域，从一个软件组件到另一个软件组件进行通信是一项基本要求。虽然已经出现了许多具有这种能力的技术，但 Java 编程语言为我们提供了一个 API，以促进用 Java 编写的组件之间的消息传递。此 API 的实现将由不同的供应商（JMS 提供商）通过代理软件提供。\n这个API被称为Java消息服务（JMS）。\nJMS 规范的最后一次更新是在 2002 年，当时推出了JMS 1.1。从那时起，多年来，该 API 已在全球许多软件组件中使用，证明了其对开发人员的友好性。JMS 的下一个版本（JMS 2.0）于 2013 年 4 月问世，距离 1.1 版已有数年之久。\nJMS 2.0 只能与Java SE 7 及更高版本一起使用。了解 JMS 2.0 中的新功能将会很有趣。\n易于使用的语言功能 从语言角度来看，对 API 所做的最重大的更改是减少了开发人员需要编写的代码量。让我们将 JMS 2.0 与 1.1 进行比较，看看它们有什么区别。\n连接和会话对象纳入单个 JMSContext 不再需要创建连接和会话对象。您可以创建 JMSContext 并直接使用它来创建消息生产者。\n//JMS 1.1 public void sendMessageJMS11(ConnectionFactory connectionFactory, Queue queueString text) { try { Connection connection = connectionFactory.createConnection(); try { Session session =connection.createSession(false,Session.AUTO_ACKNOWLEDGE); MessageProducer messageProducer = session.createProducer(queue); TextMessage textMessage = session.createTextMessage(text); messageProducer.send(textMessage); } finally { connection.close(); } } catch (JMSException ex) { // handle exception (details omitted) } } //JMS 2.0 public void sendMessageJMS20(ConnectionFactory connectionFactory, Queue queue, String text) { try (JMSContext context = connectionFactory.createContext();){ context.createProducer().send(queue, text); } catch (JMSRuntimeException ex) { // handle exception (details omitted) } } 无需调用 connection.close() 但是，无需从代码中显式调用 close。JMSContext 实现了 Java SE 7 java.lang.AutoCloseable接口。这意味着，如果我们在 try-with-resources 块中创建 JMSContext（这也是 Java SE 7 的一项新功能），close 方法将在该块末尾自动调用，而无需将其显式添加到代码中。\n请参考上面的例子。\n创建会话时无需传递两个参数 在 JMS 1.1 中，需要传递一个附加参数来指定会话是否是事务性的。在 JMS 2.0 中，传递 就足够了Session.SESSION_TRANSACTED。\n//JMS 1.1 Session session = connection.createSession(true,Session.SESSION_TRANSACTED); //JMS 2.0 Session session = connection.createSession(Session.SESSION_TRANSACTED); //JMS 2.0 - a session with Session.AUTO_ACKNOWLEDGE Session session = connection.createSession(); 如果我们想指定其他会话模式（本地事务、CLIENT_ACKNOWLEDGE 或 DUPS_OK_ACKNOWLEDGE），我们只需传递一个参数，而不是两个。如果您需要会话处于 Session.AUTO_ACKNOWLEDGE 模式，则无需传递任何参数，因为它是默认模式。\n支持方法链 这大大减少了需要编写的代码量。请参考以下示例。\n//JMS 1.1 MessageProducer messageProducer = session.createProducer(demoQueue); messageProducer.setPriority(1); TextMessage textMessage = session.createTextMessage(body); textMessage.setStringProperty(\"foo\", \"bar\"); messageProducer.send(textMessage); //JMS 2.0 TextMessage textMessage = context.createTextMessage(body); context.createProducer().setPriority(1).setProperty(“foo”, “bar”).send(demoQueue, textMessage); //JMS 1.1 MessageProducer messageProducer = session.createProducer(demoQueue); messageProducer.send(message1); messageProducer.send(message2); //JMS 2.0 context.createProducer().send(demoQueue,message1); context.createProducer().send(demoQueue,message2); 在 Java EE 中，注入 JMSContext 意味着您不需要创建或关闭它 //JMS 1.1 try { Connection connection = connectionFactory.createConnection(); try { Session session = connection.createSession(false,Session.AUTO_ACKNOWLEDGE); MessageProducer messageProducer = session.createProducer(demoQueue); TextMessage textMessage = session.createTextMessage(body); messageProducer.send(textMessage); } finally { connection.close(); } } catch (JMSException ex) { ex.printStackTrace(); } //JMS 2.0 try { context.createProducer().send(inboundQueue, body); } catch (JMSRuntimeException ex){ ex.printStackTrace(); } 发送时不需要实例化Message对象 请注意，即使您想要设置消息属性，也可以执行此操作，因为可以在 JMSProducer 上设置这些属性。\n//JMS 1.1 MessageProducer messageProducer = session.createProducer(demoQueue); TextMessage textMessage = session.createTextMessage(\"Hello world\"); messageProducer.send(textMessage); //JMS 2.0 context.createProducer().send(demoQueue,\"Hello world\"); 直接接收消息有效负载 同步接收时，您会得到一个 Message 对象，并且需要将其转换为适当的子类型，然后才能提取其主体。\n//JMS 1.1 MessageConsumer messageConsumer = session.createConsumer(demoQueue); TextMessage textMessage = (TextMessage) messageConsumer.receive(1000); if (textMessage==null){ return \"Received null\"; } else { return \"Received \"+textMessage.getText(); } //JMS 2.0 JMSConsumer consumer = context.createConsumer(demoQueue); return \"Received \" + consumer.receiveBody(String.class, 1000); 提取邮件正文前无需进行强制类型转换 异步接收消息时，传递给 onMessage 方法的消息是 javax.jms.Message 您需要将其转换为预期的子类型，然后才能提取正文。如果消息是 ObjectMessage，则会为您提供 Serializable 正文，您必须再次将其转换为预期的正文类型。新方法getBody允许您从中提取正文，而Message无需先将其转换为适当的子类型。\n//JMS 1.1 Message message = consumer.receive(1000); // returns a TextMessage String body = ((TextMessage) message).getText(); //JMS 2.0 Message message = consumer.receive(1000); // returns a TextMessage String body = message.getBody(String.class); 五大新功能 JMS 2.0 还引入了一些新的消息传递功能。\n1. 同一主题订阅允许多个消费者 JMS 1.1 有一个限制，即对于一个主题，只能创建一个具有特定订阅 ID 的订阅者。这限制了我们将负载分布在多个 JVM 和机器之间，因为我们无法创建具有相同 ID 的另一个订阅。\nJMS 2.0 提供了一种解决方案。您可以使用新方法 createSharedConsumer 创建“共享”非持久订阅。此方法在 Session（对于使用经典 API 的应用程序）和 JMSContext（对于使用简化 API 的应用程序）上都可用。由于两个 JVM 需要能够识别它们需要共享的订阅，因此它们需要提供一个名称来标识共享订阅，如下所示。\n//non durable MessageConsumer messageConsumer = session.createSharedConsumer(topic,\"mySubscription\"); //durable MessageConsumer messageConsumer = session.createSharedDurableConsumer(topic,\"myDurableSub\"); 如果您在两个单独的 JVM 中运行上述代码，则发送到主题的每条消息都将传递给两个消费者中的一个。这样他们就可以共享处理来自订阅的消息的工作。\n2. 发送延迟 您现在可以指定消息的延迟时间。JMS 提供程序将在指定的延迟时间过去后才发送消息。\nMessageProducer messageProducer = session.createProducer(queue); messageProducer.setDeliveryDelay(20000); context.createProducer().setDeliveryDelay(20000).send(queue,\"Hello world\"); 3.异步发送消息 此功能适用于在 Java SE 或 Java EE 应用程序客户端容器中运行的应用程序。不适用于在 Java EE Web 或 EJB 容器中运行的应用程序。\n通常，发送持久消息时，send 方法直到 JMS 客户端将消息发送到服务器并收到回复以通知客户端该消息已被安全接收并持久化后才会返回。我们称此为同步发送。\nJMS 2.0 引入了执行异步发送的功能。异步发送消息时，发送方法会将消息发送到服务器，然后将控制权返回给应用程序，而无需等待服务器的回复。\n当收到服务器返回的回复以表明消息已被服务器接收并持久保存时，JMS 提供程序将通过调用应用程序指定的 CompletionListener 对象上的回调方法 onCompletion来通知应用程序。\n这对于允许连续发送大量消息而无需等待每条消息之后服务器的回复非常有用。\nMyCompletionListener myCompletionListener = new MyCompletionListener(latch); context.createProducer().setAsync(myCompletionListener).send(queue,\"Hello world\"); latch.await(); if (myCompletionListener.getException()==null){ System.out.println(\"Reply received from server\"); } else { throw myCompletionListener.getException(); } 4. JMSXDeliveryCount JMS 2.0 允许接收消息的应用程序确定该消息被重新传送的次数。可以从消息属性 JMSXDeliveryCount 中获取此信息：\nint deliveryCount = 消息.getIntProperty(“JMSXDeliveryCount”);\nJMSXDeliveryCount 属性允许消费应用程序检测某条消息是否已被多次重新传送，因此在某种程度上是“坏的”。应用程序可以使用此信息采取一些特殊操作（而不是简单地触发另一次重新传送），例如消费该消息并将其发送到单独的“坏”消息队列以供管理员操作。\n5. MDB 配置属性 需要异步接收消息的 Java EE 应用程序使用 MDB 来实现，MDB 是通过指定多个配置属性来配置的。\ndestinationLookup：管理定义的队列或主题对象的 JNDI 名称，该对象表示 MDB 将从中接收消息的队列或主题 connectionFactoryLookup：管理定义的 ConnectionFactory 对象的 JNDI 名称，MDB 将使用该对象连接到 JMS 提供程序 clientId： MDB 连接到 JMS 提供程序时使用的客户端标识符 subscriptionName：subscriptionDurability 设置为 Durable 时使用的持久订阅名称 来自 WSO2 的中间件 现在，WSO2的Enterprise Integrator可立即支持 JMS 2.0。此产品可让您在发送或接收来自支持 JMS 2.0 的第三方代理上定义的队列或主题的消息时使用上述新功能。\n","wordCount":"528","inLanguage":"en","datePublished":"2024-07-24T00:00:00Z","dateModified":"2024-07-24T00:00:00Z","author":{"@type":"Person","name":"chensoul"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.chensoul.cc/posts/2024/07/24/what-is-new-in-jms-2-0/"},"publisher":{"@type":"Organization","name":"ChenSoul","logo":{"@type":"ImageObject","url":"https://blog.chensoul.cc/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://blog.chensoul.cc/ accesskey=h title="ChenSoul (Alt + H)">ChenSoul</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://blog.chensoul.cc/categories title=分类><span>分类</span></a></li><li><a href=https://blog.chensoul.cc/tags title=标签><span>标签</span></a></li><li><a href=https://blog.chensoul.cc/search title="搜索 (Alt + /)" accesskey=/><span>搜索</span></a></li><li><a href=https://blog.chensoul.cc/index.xml title=订阅><span>订阅</span></a></li><li><a href=https://github.com/chensoul title=关于><span>关于</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">[译]JMS 2.0 中的新增功能</h1><div class=post-meta><span title='2024-07-24 00:00:00 +0000 UTC'>2024-07-24</span>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;528 words&nbsp;·&nbsp;chensoul</div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#%e6%98%93%e4%ba%8e%e4%bd%bf%e7%94%a8%e7%9a%84%e8%af%ad%e8%a8%80%e5%8a%9f%e8%83%bd aria-label=易于使用的语言功能>易于使用的语言功能</a><ul><li><a href=#%e8%bf%9e%e6%8e%a5%e5%92%8c%e4%bc%9a%e8%af%9d%e5%af%b9%e8%b1%a1%e7%ba%b3%e5%85%a5%e5%8d%95%e4%b8%aa-jmscontext aria-label="连接和会话对象纳入单个 JMSContext">连接和会话对象纳入单个 JMSContext</a></li><li><a href=#%e6%97%a0%e9%9c%80%e8%b0%83%e7%94%a8-connectionclose aria-label="无需调用 connection.close()">无需调用 connection.close()</a></li><li><a href=#%e5%88%9b%e5%bb%ba%e4%bc%9a%e8%af%9d%e6%97%b6%e6%97%a0%e9%9c%80%e4%bc%a0%e9%80%92%e4%b8%a4%e4%b8%aa%e5%8f%82%e6%95%b0 aria-label=创建会话时无需传递两个参数>创建会话时无需传递两个参数</a></li><li><a href=#%e6%94%af%e6%8c%81%e6%96%b9%e6%b3%95%e9%93%be aria-label=支持方法链>支持方法链</a></li><li><a href=#%e5%9c%a8-java-ee-%e4%b8%ad%e6%b3%a8%e5%85%a5-jmscontext-%e6%84%8f%e5%91%b3%e7%9d%80%e6%82%a8%e4%b8%8d%e9%9c%80%e8%a6%81%e5%88%9b%e5%bb%ba%e6%88%96%e5%85%b3%e9%97%ad%e5%ae%83 aria-label="在 Java EE 中，注入 JMSContext 意味着您不需要创建或关闭它">在 Java EE 中，注入 JMSContext 意味着您不需要创建或关闭它</a></li><li><a href=#%e5%8f%91%e9%80%81%e6%97%b6%e4%b8%8d%e9%9c%80%e8%a6%81%e5%ae%9e%e4%be%8b%e5%8c%96message%e5%af%b9%e8%b1%a1 aria-label=发送时不需要实例化Message对象>发送时不需要实例化Message对象</a></li><li><a href=#%e7%9b%b4%e6%8e%a5%e6%8e%a5%e6%94%b6%e6%b6%88%e6%81%af%e6%9c%89%e6%95%88%e8%b4%9f%e8%bd%bd aria-label=直接接收消息有效负载>直接接收消息有效负载</a></li><li><a href=#%e6%8f%90%e5%8f%96%e9%82%ae%e4%bb%b6%e6%ad%a3%e6%96%87%e5%89%8d%e6%97%a0%e9%9c%80%e8%bf%9b%e8%a1%8c%e5%bc%ba%e5%88%b6%e7%b1%bb%e5%9e%8b%e8%bd%ac%e6%8d%a2 aria-label=提取邮件正文前无需进行强制类型转换>提取邮件正文前无需进行强制类型转换</a></li></ul></li><li><a href=#%e4%ba%94%e5%a4%a7%e6%96%b0%e5%8a%9f%e8%83%bd aria-label=五大新功能>五大新功能</a><ul><li><a href=#1-%e5%90%8c%e4%b8%80%e4%b8%bb%e9%a2%98%e8%ae%a2%e9%98%85%e5%85%81%e8%ae%b8%e5%a4%9a%e4%b8%aa%e6%b6%88%e8%b4%b9%e8%80%85 aria-label="1. 同一主题订阅允许多个消费者">1. 同一主题订阅允许多个消费者</a></li><li><a href=#2-%e5%8f%91%e9%80%81%e5%bb%b6%e8%bf%9f aria-label="2. 发送延迟">2. 发送延迟</a></li><li><a href=#3%e5%bc%82%e6%ad%a5%e5%8f%91%e9%80%81%e6%b6%88%e6%81%af aria-label=3.异步发送消息>3.异步发送消息</a></li><li><a href=#4-jmsxdeliverycount aria-label="4. JMSXDeliveryCount">4. JMSXDeliveryCount</a></li><li><a href=#5-mdb-%e9%85%8d%e7%bd%ae%e5%b1%9e%e6%80%a7 aria-label="5. MDB 配置属性">5. MDB 配置属性</a></li></ul></li><li><a href=#%e6%9d%a5%e8%87%aa-wso2-%e7%9a%84%e4%b8%ad%e9%97%b4%e4%bb%b6 aria-label="来自 WSO2 的中间件">来自 WSO2 的中间件</a></li></ul></div></details></div><div class=post-content><p>原文链接：<a href=https://hasithah.medium.com/what-is-new-in-jms-2-0-821266fc1bf0>What is new in JMS 2.0</a></p><p>在在软件集成领域，从一个软件组件到另一个软件组件进行通信是一项基本要求。虽然已经出现了许多具有这种能力的技术，但 Java 编程语言为我们提供了一个 API，以促进用 Java 编写的组件之间的消息传递。此 API 的实现将由不同的供应商（JMS 提供商）通过代理软件提供。</p><p>这个API被称为Java消息服务（JMS）。</p><p><img loading=lazy src=https://miro.medium.com/v2/resize:fit:1400/1*VDRQDS9_WgyFVvvMGnWC4w.jpeg alt=img></p><p>JMS 规范的最后一次更新是在 2002 年，当时推出了<strong>JMS 1.1</strong>。从那时起，多年来，该 API 已在全球许多软件组件中使用，证明了其对开发人员的友好性。JMS 的下一个版本（<strong>JMS 2.0</strong>）于 2013 年 4 月问世，距离 1.1 版已有数年之久。</p><p><strong>JMS 2.0 只能与Java SE 7 及更高版本</strong>一起使用。了解 JMS 2.0 中的新功能将会很有趣。</p><h1 id=易于使用的语言功能>易于使用的语言功能<a hidden class=anchor aria-hidden=true href=#易于使用的语言功能>#</a></h1><p>从语言角度来看，对 API 所做的最重大的更改是减少了开发人员需要编写的代码量。让我们将 JMS 2.0 与 1.1 进行比较，看看它们有什么区别。</p><h2 id=连接和会话对象纳入单个-jmscontext>连接和会话对象纳入单个 JMSContext<a hidden class=anchor aria-hidden=true href=#连接和会话对象纳入单个-jmscontext>#</a></h2><p>不再需要创建连接和会话对象。您可以创建 JMSContext 并直接使用它来创建消息生产者。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>//JMS 1.1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>sendMessageJMS11</span><span class=p>(</span><span class=n>ConnectionFactory</span><span class=w> </span><span class=n>connectionFactory</span><span class=p>,</span><span class=w> </span><span class=n>Queue</span><span class=w> </span><span class=n>queueString</span><span class=w> </span><span class=n>text</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>   </span><span class=k>try</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=n>Connection</span><span class=w> </span><span class=n>connection</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>connectionFactory</span><span class=p>.</span><span class=na>createConnection</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=k>try</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>         </span><span class=n>Session</span><span class=w> </span><span class=n>session</span><span class=w> </span><span class=o>=</span><span class=n>connection</span><span class=p>.</span><span class=na>createSession</span><span class=p>(</span><span class=kc>false</span><span class=p>,</span><span class=n>Session</span><span class=p>.</span><span class=na>AUTO_ACKNOWLEDGE</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>         </span><span class=n>MessageProducer</span><span class=w> </span><span class=n>messageProducer</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>session</span><span class=p>.</span><span class=na>createProducer</span><span class=p>(</span><span class=n>queue</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>         </span><span class=n>TextMessage</span><span class=w> </span><span class=n>textMessage</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>session</span><span class=p>.</span><span class=na>createTextMessage</span><span class=p>(</span><span class=n>text</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>         </span><span class=n>messageProducer</span><span class=p>.</span><span class=na>send</span><span class=p>(</span><span class=n>textMessage</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=p>}</span><span class=w> </span><span class=k>finally</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>         </span><span class=n>connection</span><span class=p>.</span><span class=na>close</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>   </span><span class=p>}</span><span class=w> </span><span class=k>catch</span><span class=w> </span><span class=p>(</span><span class=n>JMSException</span><span class=w> </span><span class=n>ex</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c1>// handle exception (details omitted)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>   </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>//JMS 2.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>sendMessageJMS20</span><span class=p>(</span><span class=n>ConnectionFactory</span><span class=w> </span><span class=n>connectionFactory</span><span class=p>,</span><span class=w> </span><span class=n>Queue</span><span class=w> </span><span class=n>queue</span><span class=p>,</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>String</span><span class=w> </span><span class=n>text</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>   </span><span class=k>try</span><span class=w> </span><span class=p>(</span><span class=n>JMSContext</span><span class=w> </span><span class=n>context</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>connectionFactory</span><span class=p>.</span><span class=na>createContext</span><span class=p>();){</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=n>context</span><span class=p>.</span><span class=na>createProducer</span><span class=p>().</span><span class=na>send</span><span class=p>(</span><span class=n>queue</span><span class=p>,</span><span class=w> </span><span class=n>text</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>   </span><span class=p>}</span><span class=w> </span><span class=k>catch</span><span class=w> </span><span class=p>(</span><span class=n>JMSRuntimeException</span><span class=w> </span><span class=n>ex</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c1>// handle exception (details omitted)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>   </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><h2 id=无需调用-connectionclose>无需调用 connection.close()<a hidden class=anchor aria-hidden=true href=#无需调用-connectionclose>#</a></h2><p>但是，无需从代码中显式调用 close。JMSContext 实现了 Java SE 7 <em>java.lang.AutoCloseable</em>接口。这意味着，如果我们在 try-with-resources 块中创建 JMSContext（这也是 Java SE 7 的一项新功能），close 方法将在该块末尾自动调用，而无需将其显式添加到代码中。</p><p>请参考上面的例子。</p><h2 id=创建会话时无需传递两个参数>创建会话时无需传递两个参数<a hidden class=anchor aria-hidden=true href=#创建会话时无需传递两个参数>#</a></h2><p>在 JMS 1.1 中，需要传递一个附加参数来指定会话是否是事务性的。在 JMS 2.0 中，传递 就足够了<code>Session.SESSION_TRANSACTED</code>。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>//JMS 1.1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>Session</span><span class=w> </span><span class=n>session</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>connection</span><span class=p>.</span><span class=na>createSession</span><span class=p>(</span><span class=kc>true</span><span class=p>,</span><span class=n>Session</span><span class=p>.</span><span class=na>SESSION_TRANSACTED</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>//JMS 2.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>Session</span><span class=w> </span><span class=n>session</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>connection</span><span class=p>.</span><span class=na>createSession</span><span class=p>(</span><span class=n>Session</span><span class=p>.</span><span class=na>SESSION_TRANSACTED</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>//JMS 2.0 - a session with Session.AUTO_ACKNOWLEDGE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>Session</span><span class=w> </span><span class=n>session</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>connection</span><span class=p>.</span><span class=na>createSession</span><span class=p>();</span><span class=w>
</span></span></span></code></pre></div><p>如果我们想指定其他会话模式（本地事务、CLIENT_ACKNOWLEDGE 或 DUPS_OK_ACKNOWLEDGE），我们只需传递一个参数，而不是两个。如果您需要会话处于 Session.AUTO_ACKNOWLEDGE 模式，则无需传递任何参数，因为它是默认模式。</p><h2 id=支持方法链>支持方法链<a hidden class=anchor aria-hidden=true href=#支持方法链>#</a></h2><p>这大大减少了需要编写的代码量。请参考以下示例。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>//JMS 1.1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>MessageProducer</span><span class=w> </span><span class=n>messageProducer</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>session</span><span class=p>.</span><span class=na>createProducer</span><span class=p>(</span><span class=n>demoQueue</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>messageProducer</span><span class=p>.</span><span class=na>setPriority</span><span class=p>(</span><span class=n>1</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>TextMessage</span><span class=w> </span><span class=n>textMessage</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>session</span><span class=p>.</span><span class=na>createTextMessage</span><span class=p>(</span><span class=n>body</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>textMessage</span><span class=p>.</span><span class=na>setStringProperty</span><span class=p>(</span><span class=s>&#34;foo&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;bar&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>messageProducer</span><span class=p>.</span><span class=na>send</span><span class=p>(</span><span class=n>textMessage</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>//JMS 2.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>TextMessage</span><span class=w> </span><span class=n>textMessage</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>context</span><span class=p>.</span><span class=na>createTextMessage</span><span class=p>(</span><span class=n>body</span><span class=p>);</span><span class=w> </span><span class=n>context</span><span class=p>.</span><span class=na>createProducer</span><span class=p>().</span><span class=na>setPriority</span><span class=p>(</span><span class=n>1</span><span class=p>).</span><span class=na>setProperty</span><span class=p>(</span><span class=err>“</span><span class=n>foo</span><span class=err>”</span><span class=p>,</span><span class=w> </span><span class=err>“</span><span class=n>bar</span><span class=err>”</span><span class=p>).</span><span class=na>send</span><span class=p>(</span><span class=n>demoQueue</span><span class=p>,</span><span class=w> </span><span class=n>textMessage</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>//JMS 1.1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>MessageProducer</span><span class=w> </span><span class=n>messageProducer</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>session</span><span class=p>.</span><span class=na>createProducer</span><span class=p>(</span><span class=n>demoQueue</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>messageProducer</span><span class=p>.</span><span class=na>send</span><span class=p>(</span><span class=n>message1</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>messageProducer</span><span class=p>.</span><span class=na>send</span><span class=p>(</span><span class=n>message2</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>//JMS 2.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>context</span><span class=p>.</span><span class=na>createProducer</span><span class=p>().</span><span class=na>send</span><span class=p>(</span><span class=n>demoQueue</span><span class=p>,</span><span class=n>message1</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>context</span><span class=p>.</span><span class=na>createProducer</span><span class=p>().</span><span class=na>send</span><span class=p>(</span><span class=n>demoQueue</span><span class=p>,</span><span class=n>message2</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></div><h2 id=在-java-ee-中注入-jmscontext-意味着您不需要创建或关闭它>在 Java EE 中，注入 JMSContext 意味着您不需要创建或关闭它<a hidden class=anchor aria-hidden=true href=#在-java-ee-中注入-jmscontext-意味着您不需要创建或关闭它>#</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>//JMS 1.1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>try</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>Connection</span><span class=w> </span><span class=n>connection</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>connectionFactory</span><span class=p>.</span><span class=na>createConnection</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>try</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>Session</span><span class=w> </span><span class=n>session</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>connection</span><span class=p>.</span><span class=na>createSession</span><span class=p>(</span><span class=kc>false</span><span class=p>,</span><span class=n>Session</span><span class=p>.</span><span class=na>AUTO_ACKNOWLEDGE</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>MessageProducer</span><span class=w> </span><span class=n>messageProducer</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>session</span><span class=p>.</span><span class=na>createProducer</span><span class=p>(</span><span class=n>demoQueue</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>TextMessage</span><span class=w> </span><span class=n>textMessage</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>session</span><span class=p>.</span><span class=na>createTextMessage</span><span class=p>(</span><span class=n>body</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>messageProducer</span><span class=p>.</span><span class=na>send</span><span class=p>(</span><span class=n>textMessage</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=p>}</span><span class=w> </span><span class=k>finally</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>connection</span><span class=p>.</span><span class=na>close</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w> </span><span class=k>catch</span><span class=w> </span><span class=p>(</span><span class=n>JMSException</span><span class=w> </span><span class=n>ex</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>ex</span><span class=p>.</span><span class=na>printStackTrace</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>//JMS 2.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>try</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>context</span><span class=p>.</span><span class=na>createProducer</span><span class=p>().</span><span class=na>send</span><span class=p>(</span><span class=n>inboundQueue</span><span class=p>,</span><span class=w> </span><span class=n>body</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w> </span><span class=k>catch</span><span class=w> </span><span class=p>(</span><span class=n>JMSRuntimeException</span><span class=w> </span><span class=n>ex</span><span class=p>){</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>ex</span><span class=p>.</span><span class=na>printStackTrace</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><h2 id=发送时不需要实例化message对象>发送时不需要实例化Message对象<a hidden class=anchor aria-hidden=true href=#发送时不需要实例化message对象>#</a></h2><p>请注意，即使您想要设置消息属性，也可以执行此操作，因为可以在 JMSProducer 上设置这些属性。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>//JMS 1.1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>MessageProducer</span><span class=w> </span><span class=n>messageProducer</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>session</span><span class=p>.</span><span class=na>createProducer</span><span class=p>(</span><span class=n>demoQueue</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>TextMessage</span><span class=w> </span><span class=n>textMessage</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>session</span><span class=p>.</span><span class=na>createTextMessage</span><span class=p>(</span><span class=s>&#34;Hello world&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>messageProducer</span><span class=p>.</span><span class=na>send</span><span class=p>(</span><span class=n>textMessage</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>//JMS 2.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>context</span><span class=p>.</span><span class=na>createProducer</span><span class=p>().</span><span class=na>send</span><span class=p>(</span><span class=n>demoQueue</span><span class=p>,</span><span class=s>&#34;Hello world&#34;</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></div><h2 id=直接接收消息有效负载>直接接收消息有效负载<a hidden class=anchor aria-hidden=true href=#直接接收消息有效负载>#</a></h2><p>同步接收时，您会得到一个 Message 对象，并且需要将其转换为适当的子类型，然后才能提取其主体。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>//JMS 1.1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>MessageConsumer</span><span class=w> </span><span class=n>messageConsumer</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>session</span><span class=p>.</span><span class=na>createConsumer</span><span class=p>(</span><span class=n>demoQueue</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>TextMessage</span><span class=w> </span><span class=n>textMessage</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>TextMessage</span><span class=p>)</span><span class=w> </span><span class=n>messageConsumer</span><span class=p>.</span><span class=na>receive</span><span class=p>(</span><span class=n>1000</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>textMessage</span><span class=o>==</span><span class=kc>null</span><span class=p>){</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>return</span><span class=w> </span><span class=s>&#34;Received null&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>return</span><span class=w> </span><span class=s>&#34;Received &#34;</span><span class=o>+</span><span class=n>textMessage</span><span class=p>.</span><span class=na>getText</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>//JMS 2.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>JMSConsumer</span><span class=w> </span><span class=n>consumer</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>context</span><span class=p>.</span><span class=na>createConsumer</span><span class=p>(</span><span class=n>demoQueue</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>return</span><span class=w> </span><span class=s>&#34;Received &#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>consumer</span><span class=p>.</span><span class=na>receiveBody</span><span class=p>(</span><span class=n>String</span><span class=p>.</span><span class=na>class</span><span class=p>,</span><span class=w> </span><span class=n>1000</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></div><h2 id=提取邮件正文前无需进行强制类型转换>提取邮件正文前无需进行强制类型转换<a hidden class=anchor aria-hidden=true href=#提取邮件正文前无需进行强制类型转换>#</a></h2><p>异步接收消息时，传递给 onMessage 方法的消息是 javax.jms.Message 您需要将其转换为预期的子类型，然后才能提取正文。如果消息是 ObjectMessage，则会为您提供 Serializable 正文，您必须再次将其转换为预期的正文类型。新方法<code>getBody</code>允许您从中提取正文，而<code>Message</code>无需先将其转换为适当的子类型。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>//JMS 1.1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>Message</span><span class=w> </span><span class=n>message</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>consumer</span><span class=p>.</span><span class=na>receive</span><span class=p>(</span><span class=n>1000</span><span class=p>);</span><span class=w> </span><span class=c1>// returns a TextMessage</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>String</span><span class=w> </span><span class=n>body</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>((</span><span class=n>TextMessage</span><span class=p>)</span><span class=w> </span><span class=n>message</span><span class=p>).</span><span class=na>getText</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>//JMS 2.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>Message</span><span class=w> </span><span class=n>message</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>consumer</span><span class=p>.</span><span class=na>receive</span><span class=p>(</span><span class=n>1000</span><span class=p>);</span><span class=w> </span><span class=c1>// returns a TextMessage</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>String</span><span class=w> </span><span class=n>body</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>message</span><span class=p>.</span><span class=na>getBody</span><span class=p>(</span><span class=n>String</span><span class=p>.</span><span class=na>class</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></div><h1 id=五大新功能>五大新功能<a hidden class=anchor aria-hidden=true href=#五大新功能>#</a></h1><p>JMS 2.0 还引入了一些新的消息传递功能。</p><h2 id=1-同一主题订阅允许多个消费者>1. 同一主题订阅允许多个消费者<a hidden class=anchor aria-hidden=true href=#1-同一主题订阅允许多个消费者>#</a></h2><p>JMS 1.1 有一个限制，即对于一个主题，只能创建一个具有特定<strong>订阅 ID 的</strong>订阅者。这限制了我们将负载分布在多个 JVM 和机器之间，因为我们无法创建具有相同 ID 的另一个订阅。</p><p>JMS 2.0 提供了一种解决方案。您可以使用新方法 createSharedConsumer 创建“共享”非持久订阅。此方法在 Session（对于使用经典 API 的应用程序）和 JMSContext（对于使用简化 API 的应用程序）上都可用。由于两个 JVM 需要能够识别它们需要共享的订阅，因此它们需要提供一个名称来标识共享订阅，如下所示。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>//non durable</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>MessageConsumer</span><span class=w> </span><span class=n>messageConsumer</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>session</span><span class=p>.</span><span class=na>createSharedConsumer</span><span class=p>(</span><span class=n>topic</span><span class=p>,</span><span class=s>&#34;mySubscription&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>//durable</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>MessageConsumer</span><span class=w> </span><span class=n>messageConsumer</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>session</span><span class=p>.</span><span class=na>createSharedDurableConsumer</span><span class=p>(</span><span class=n>topic</span><span class=p>,</span><span class=s>&#34;myDurableSub&#34;</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></div><p>如果您在两个单独的 JVM 中运行上述代码，则发送到主题的每条消息都将传递给两个消费者中的一个。这样他们就可以共享处理来自订阅的消息的工作。</p><h2 id=2-发送延迟>2. 发送延迟<a hidden class=anchor aria-hidden=true href=#2-发送延迟>#</a></h2><p>您现在可以指定消息的延迟时间。JMS 提供程序将在指定的延迟时间过去后才发送消息。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>MessageProducer</span><span class=w> </span><span class=n>messageProducer</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>session</span><span class=p>.</span><span class=na>createProducer</span><span class=p>(</span><span class=n>queue</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=n>messageProducer</span><span class=p>.</span><span class=na>setDeliveryDelay</span><span class=p>(</span><span class=n>20000</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>context</span><span class=p>.</span><span class=na>createProducer</span><span class=p>().</span><span class=na>setDeliveryDelay</span><span class=p>(</span><span class=n>20000</span><span class=p>).</span><span class=na>send</span><span class=p>(</span><span class=n>queue</span><span class=p>,</span><span class=s>&#34;Hello world&#34;</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></div><h2 id=3异步发送消息>3.异步发送消息<a hidden class=anchor aria-hidden=true href=#3异步发送消息>#</a></h2><p>此功能适用于在 Java SE 或 Java EE 应用程序客户端容器中运行的应用程序。不适用于在 Java EE Web 或 EJB 容器中运行的应用程序。</p><p>通常，发送持久消息时，send 方法直到 JMS 客户端将消息发送到服务器并收到回复以通知客户端该消息已被安全接收并持久化后才会返回。我们称此为<strong>同步发送</strong>。</p><p><strong>JMS 2.0 引入了执行异步发送的</strong>功能。异步发送消息时，发送方法会将消息发送到服务器，然后将控制权返回给应用程序，而无需等待服务器的回复。</p><p>当收到服务器返回的回复以表明消息已被服务器接收并持久保存时，JMS 提供程序将通过调用应用程序指定的 CompletionListener 对象上的回调方法 onCompletion来通知应用程序。</p><p>这对于允许连续发送大量消息而无需等待每条消息之后服务器的回复非常有用。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>MyCompletionListener</span><span class=w> </span><span class=n>myCompletionListener</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>MyCompletionListener</span><span class=p>(</span><span class=n>latch</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>context</span><span class=p>.</span><span class=na>createProducer</span><span class=p>().</span><span class=na>setAsync</span><span class=p>(</span><span class=n>myCompletionListener</span><span class=p>).</span><span class=na>send</span><span class=p>(</span><span class=n>queue</span><span class=p>,</span><span class=s>&#34;Hello world&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>latch</span><span class=p>.</span><span class=na>await</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>myCompletionListener</span><span class=p>.</span><span class=na>getException</span><span class=p>()</span><span class=o>==</span><span class=kc>null</span><span class=p>){</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>         </span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&#34;Reply received from server&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>         </span><span class=k>throw</span><span class=w> </span><span class=n>myCompletionListener</span><span class=p>.</span><span class=na>getException</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><h2 id=4-jmsxdeliverycount>4. JMSXDeliveryCount<a hidden class=anchor aria-hidden=true href=#4-jmsxdeliverycount>#</a></h2><p>JMS 2.0 允许接收消息的应用程序确定该消息被重新传送的次数。可以从消息属性 JMSXDeliveryCount 中获取此信息：</p><p>int deliveryCount = 消息.getIntProperty(“JMSXDeliveryCount”);</p><p>JMSXDeliveryCount 属性允许消费应用程序检测某条消息是否已被多次重新传送，因此在某种程度上是“坏的”。应用程序可以使用此信息采取一些特殊操作（而不是简单地触发另一次重新传送），例如消费该消息并将其发送到单独的“坏”消息队列以供管理员操作。</p><h2 id=5-mdb-配置属性>5. MDB 配置属性<a hidden class=anchor aria-hidden=true href=#5-mdb-配置属性>#</a></h2><p>需要异步接收消息的 Java EE 应用程序使用 MDB 来实现，MDB 是通过指定多个配置属性来配置的。</p><ul><li><strong>destinationLookup</strong>：管理定义的队列或主题对象的 JNDI 名称，该对象表示 MDB 将从中接收消息的队列或主题</li><li><strong>connectionFactoryLookup</strong>：管理定义的 ConnectionFactory 对象的 JNDI 名称，MDB 将使用该对象连接到 JMS 提供程序</li><li><strong>clientId：</strong> MDB 连接到 JMS 提供程序时使用的客户端标识符
subscriptionName：subscriptionDurability 设置为 Durable 时使用的持久订阅名称</li></ul><h1 id=来自-wso2-的中间件>来自 WSO2 的中间件<a hidden class=anchor aria-hidden=true href=#来自-wso2-的中间件>#</a></h1><p>现在，<a href=https://wso2.com/>WSO2</a>的<a href=https://wso2.com/integration/>Enterprise Integrator</a>可立即支持 JMS 2.0。此产品可让您在发送或接收来自支持 JMS 2.0 的第三方代理上定义的队列或主题的消息时使用上述新功能。</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://blog.chensoul.cc/tags/jms/>Jms</a></li></ul><nav class=paginav><a class=prev href=https://blog.chensoul.cc/posts/2024/08/01/publishing-a-jar-to-maven-repository-with-github-action/><span class=title>« Prev</span><br><span>Github Action 发布 Jar 到 Maven 中央仓库</span>
</a><a class=next href=https://blog.chensoul.cc/posts/2024/07/24/jms20/><span class=title>Next »</span><br><span>[译]JMS 2.0 中的新增功能（第一部分）- 易于使用</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share [译]JMS 2.0 中的新增功能 on x" href="https://x.com/intent/tweet/?text=%5b%e8%af%91%5dJMS%202.0%20%e4%b8%ad%e7%9a%84%e6%96%b0%e5%a2%9e%e5%8a%9f%e8%83%bd&amp;url=https%3a%2f%2fblog.chensoul.cc%2fposts%2f2024%2f07%2f24%2fwhat-is-new-in-jms-2-0%2f&amp;hashtags=jms"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share [译]JMS 2.0 中的新增功能 on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fblog.chensoul.cc%2fposts%2f2024%2f07%2f24%2fwhat-is-new-in-jms-2-0%2f&amp;title=%5b%e8%af%91%5dJMS%202.0%20%e4%b8%ad%e7%9a%84%e6%96%b0%e5%a2%9e%e5%8a%9f%e8%83%bd&amp;summary=%5b%e8%af%91%5dJMS%202.0%20%e4%b8%ad%e7%9a%84%e6%96%b0%e5%a2%9e%e5%8a%9f%e8%83%bd&amp;source=https%3a%2f%2fblog.chensoul.cc%2fposts%2f2024%2f07%2f24%2fwhat-is-new-in-jms-2-0%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share [译]JMS 2.0 中的新增功能 on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fblog.chensoul.cc%2fposts%2f2024%2f07%2f24%2fwhat-is-new-in-jms-2-0%2f&title=%5b%e8%af%91%5dJMS%202.0%20%e4%b8%ad%e7%9a%84%e6%96%b0%e5%a2%9e%e5%8a%9f%e8%83%bd"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share [译]JMS 2.0 中的新增功能 on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fblog.chensoul.cc%2fposts%2f2024%2f07%2f24%2fwhat-is-new-in-jms-2-0%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share [译]JMS 2.0 中的新增功能 on whatsapp" href="https://api.whatsapp.com/send?text=%5b%e8%af%91%5dJMS%202.0%20%e4%b8%ad%e7%9a%84%e6%96%b0%e5%a2%9e%e5%8a%9f%e8%83%bd%20-%20https%3a%2f%2fblog.chensoul.cc%2fposts%2f2024%2f07%2f24%2fwhat-is-new-in-jms-2-0%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share [译]JMS 2.0 中的新增功能 on telegram" href="https://telegram.me/share/url?text=%5b%e8%af%91%5dJMS%202.0%20%e4%b8%ad%e7%9a%84%e6%96%b0%e5%a2%9e%e5%8a%9f%e8%83%bd&amp;url=https%3a%2f%2fblog.chensoul.cc%2fposts%2f2024%2f07%2f24%2fwhat-is-new-in-jms-2-0%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share [译]JMS 2.0 中的新增功能 on ycombinator" href="https://news.ycombinator.com/submitlink?t=%5b%e8%af%91%5dJMS%202.0%20%e4%b8%ad%e7%9a%84%e6%96%b0%e5%a2%9e%e5%8a%9f%e8%83%bd&u=https%3a%2f%2fblog.chensoul.cc%2fposts%2f2024%2f07%2f24%2fwhat-is-new-in-jms-2-0%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentcolor" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://blog.chensoul.cc/>ChenSoul</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script async src=https://umami.chensoul.cc/random-string.js data-website-id=821c25f8-a31a-4607-92d7-91ee76843d00></script><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>