<!doctype html><html lang=en-US prefix="og: http://ogp.me/ns#"><head><meta charset=utf-8><meta name=viewport content="width=device-width,minimum-scale=1"><meta name=description content="作为一名 Java 开发者,将自己的项目发布到 Maven 中央仓库是一个非常重要的步骤。这不仅可以让更多的开发者发现和使用您的项目,也可以提高项目的知名度和影响力。"><title>Github Action 发布 Jar 到 Maven 中央仓库 | ChenSoul</title>
<link rel=canonical href=https://blog.chensoul.cc/posts/2024/08/01/publishing-a-jar-to-maven-repository-with-github-action/><link rel=preconnect href=https://fonts.font.im><link rel=preconnect href=https://fonts.loli.net crossorigin><link href="https://fonts.loli.net/css2?family=Roboto+Slab:wght@400;500;700&display=swap" rel=stylesheet><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://blog.chensoul.cc/images/favicon.webp"><meta name=twitter:title content="Github Action 发布 Jar 到 Maven 中央仓库"><meta name=twitter:description content="作为一名 Java 开发者,将自己的项目发布到 Maven 中央仓库是一个非常重要的步骤。这不仅可以让更多的开发者发现和使用您的项目,也可以提高项目的知名度和影响力。"><meta name=twitter:creator content="@ichensoul"><meta property="og:locale" content="en_US"><meta property="og:site_name" content="chensoul"><meta property="og:url" content="https://blog.chensoul.cc/posts/2024/08/01/publishing-a-jar-to-maven-repository-with-github-action/"><meta property="og:site_name" content="ChenSoul"><meta property="og:title" content="Github Action 发布 Jar 到 Maven 中央仓库"><meta property="og:description" content="作为一名 Java 开发者,将自己的项目发布到 Maven 中央仓库是一个非常重要的步骤。这不仅可以让更多的开发者发现和使用您的项目,也可以提高项目的知名度和影响力。"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-08-01T00:00:00+00:00"><meta property="article:modified_time" content="2024-08-01T00:00:00+00:00"><meta property="article:tag" content="Maven"><meta property="og:image" content="https://blog.chensoul.cc/images/favicon.webp"><meta itemprop=name content="Github Action 发布 Jar 到 Maven 中央仓库"><meta itemprop=description content="作为一名 Java 开发者,将自己的项目发布到 Maven 中央仓库是一个非常重要的步骤。这不仅可以让更多的开发者发现和使用您的项目,也可以提高项目的知名度和影响力。"><meta itemprop=datePublished content="2024-08-01T00:00:00+00:00"><meta itemprop=dateModified content="2024-08-01T00:00:00+00:00"><meta itemprop=wordCount content="1140"><meta itemprop=image content="https://blog.chensoul.cc/images/favicon.webp"><meta itemprop=keywords content="Maven"><link rel=stylesheet href=https://cdnjs.loli.net/ajax/libs/font-awesome/6.4.0/css/all.min.css media=all><link rel=stylesheet href=/main.min.css type=text/css media=all><link rel="shortcut icon" href=/favicon.ico type=image/x-icon><script type=application/ld+json>{"@context":"https://schema.org","@graph":[{"@type":"TechArticle","name":"Github Action 发布 Jar 到 Maven 中央仓库","headline":"Github Action 发布 Jar 到 Maven 中央仓库","inLanguage":"en-US","url":"https://blog.chensoul.cc/posts/2024/08/01/publishing-a-jar-to-maven-repository-with-github-action/","description":"\u003cp\u003e作为一名 Java 开发者,将自己的项目发布到 Maven 中央仓库是一个非常重要的步骤。这不仅可以让更多的开发者发现和使用您的项目,也可以提高项目的知名度和影响力。\u003c/p\u003e","wordCount":"1140","keywords":["maven"],"datePublished":"2024-08-01T00:00:00Z","dateModified":"2024-08-01T00:00:00Z","author":{"@type":"Person","name":"chensoul"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.chensoul.cc/posts/2024/08/01/publishing-a-jar-to-maven-repository-with-github-action/"},"publisher":{"@type":"Organization","name":"chensoul","url":"https://blog.chensoul.cc/posts/2024/08/01/publishing-a-jar-to-maven-repository-with-github-action/"}},{"@context":"https://schema.org","@type":"Organization","name":"chensoul","url":"https://blog.chensoul.cc/","sameAs":["https://x.com/ichensoul","https://github.com/chensoul","https://www.linkedin.com/in/","https://www.youtube.com/@chensoul","https://t.me/chensouls"]}]}</script><script defer src=https://umami.chensoul.cc/random-string.js data-website-id=821c25f8-a31a-4607-92d7-91ee76843d00></script></head><body class="home blog post-layout-one-column"><button onclick=topFunction() id=scrollTopBtn title="Go to top">
<i class="fa-solid fa-arrow-up"></i></button><div id=header-top class=header-bar-wrap></div><div id=page class=site><a class="skip-link screen-reader-text" href=#content>Skip to content</a><header id=masthead class="site-header clearfix" role=banner><div class="header-main container clearfix"><div id=logo class="site-branding clearfix"><h1 class=site-title><a href=/ title=ChenSoul rel=home>ChenSoul</a></h1><p class=site-description>Java, Spring Boot, Microservice, Cloud, Architecture and DevOps Tutorials</p></div><div class="header-widgets clearfix"><aside id=search-2 class="header-widget widget_search"><form role=search method=get class=search-form onsubmit="return searchSite(event)"><label><span class=screen-reader-text>Search for:</span>
<input type=search class=search-field placeholder="Enter search keyword" name=query id=query title="Enter search keyword">
</label><button type=submit class=search-submit title=Search> <span class=genericon-search></span>
<span class=screen-reader-text>Search</span></button></form></aside></div></div><div id=main-navigation-wrap class=primary-navigation-wrap><nav id=main-navigation class="primary-navigation navigation container clearfix" role=navigation><ul id=menu-home class=main-navigation-menu><li class="menu-item menu-item-type-custom menu-item-object-custom
current-menu-item current_page_item menu-item-home"><a href=/>Home</a></li><li class="menu-item menu-item-type-taxonomy menu-item-object-category"><a href=/categories/spring-boot/>Spring Boot</a></li><li class="menu-item menu-item-type-taxonomy menu-item-object-category"><a href=/categories/architecture/>Architecture</a></li><li class="menu-item menu-item-type-taxonomy menu-item-object-category"><a href=/categories/microservice/>Microservice</a></li><li class="menu-item menu-item-type-taxonomy menu-item-object-category"><a href=/categories/kubernetes/>Kubernetes</a></li><li class="menu-item menu-item-type-taxonomy menu-item-object-category
menu-item-has-children"><a href=/tutorials/>Tutorials</a><ul class=sub-menu><li class="menu-item menu-item-type-taxonomy menu-item-object-category"><a href=/spring-boot-tutorials/>Spring Boot Tutorials</a></li><li class="menu-item menu-item-type-taxonomy menu-item-object-category"><a href=/microservice-tutorials/>Microservice Tutorials</a></li><li class="menu-item menu-item-type-taxonomy menu-item-object-category"><a href=/kubernetes-tutorials/>Kubernetes Tutorials</a></li></ul></li><li class="menu-item menu-item-type-post_type menu-item-object-page"><a href=https://github.com/chensoul target=_blank>About Me</a></li></ul></nav></div></header><div id=content class="site-content container clearfix"><section id=primary class="content-archive content-area post-content-area"><main id=main class=site-main role=main><article class="post type-post"><div class=post-inner-content><header class=entry-header><h2 class=entry-title><a href=https://blog.chensoul.cc/posts/2024/08/01/publishing-a-jar-to-maven-repository-with-github-action/ rel=bookmark title="Github Action 发布 Jar 到 Maven 中央仓库">Github Action 发布 Jar 到 Maven 中央仓库</a></h2><div class=entry-meta><span class=meta-date><time class="entry-date published" datetime=2024-08-01T00:00:00>2024-08-01
</time></span><span class=meta-author><span class="author vcard">chensoul</span>
</span><span class="tagcloud post-tags"><i class="fa fa-tags"></i>&nbsp;
<a class="tag-cloud-link widget__link widget__link--taglist" href=/tags/maven/ title=maven>maven</a></span></div></header><div class=entry-content><p>作为一名 Java 开发者,将自己的项目发布到 Maven 中央仓库是一个非常重要的步骤。这不仅可以让更多的开发者发现和使用您的项目,也可以提高项目的知名度和影响力。</p><p>在过去,发布 Jar 到 Maven 中央仓库通常需要手动完成一系列繁琐的步骤，比如：申请 JIRA 账号、创建 Sonatype JIRA Issure、上传 Jar 包、签名 Jar 包等。但是随着 Github Action 的出现，这个过程变得更加自动化和简单。</p><p>下面我将以一个简单的 Maven 项目为例，介绍如何使用 Github Action 实现自动发布 Jar 到 Maven 中央仓库。</p><h2 id=前提条件>前提条件</h2><ol><li>在 Github 创建一个 Maven 项目</li><li>安装 gpg 并创建 gpg 秘钥和公钥，参考 <a href=https://dzone.com/articles/how-to-publish-artifacts-to-maven-central target=_blank>How to Publish Artifacts to Maven Central</a></li><li>创建 OSSRH 账号，参考 <a href=https://central.sonatype.org/publish/generate-token/#generate-a-token-on-ossrh-sonatype-nexus-repository-manager-servers target=_blank>Generate a Token on OSSRH Sonatype Nexus Repository Manager servers</a></li></ol><h2 id=创建-maven-项目>创建 Maven 项目</h2><p>首先在Github上面创建项目：<a href=https://github.com/chensoul/maven-hello-world target=_blank>https://github.com/chensoul/maven-hello-world</a></p><p>增加两个 Maven 插件：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#f92672>&lt;plugin&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;groupId&gt;</span>org.apache.maven.plugins<span style=color:#f92672>&lt;/groupId&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;artifactId&gt;</span>maven-gpg-plugin<span style=color:#f92672>&lt;/artifactId&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;version&gt;</span>3.2.2<span style=color:#f92672>&lt;/version&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;executions&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;execution&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>&lt;goals&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;goal&gt;</span>sign<span style=color:#f92672>&lt;/goal&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>&lt;/goals&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>&lt;phase&gt;</span>verify<span style=color:#f92672>&lt;/phase&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;/execution&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;/executions&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;/plugin&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;plugin&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;groupId&gt;</span>org.sonatype.plugins<span style=color:#f92672>&lt;/groupId&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;artifactId&gt;</span>nexus-staging-maven-plugin<span style=color:#f92672>&lt;/artifactId&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;version&gt;</span>1.7.0<span style=color:#f92672>&lt;/version&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;extensions&gt;</span>true<span style=color:#f92672>&lt;/extensions&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;configuration&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;serverId&gt;</span>ossrh<span style=color:#f92672>&lt;/serverId&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;nexusUrl&gt;</span>https://s01.oss.sonatype.org/<span style=color:#f92672>&lt;/nexusUrl&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;autoReleaseAfterClose&gt;</span>true<span style=color:#f92672>&lt;/autoReleaseAfterClose&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;keepStagingRepositoryOnCloseRuleFailure&gt;</span>false<span style=color:#f92672>&lt;/keepStagingRepositoryOnCloseRuleFailure&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;/configuration&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;/plugin&gt;</span>
</span></span></code></pre></div><p>可以将上面的两个插件加入到 pom.xml 的 build 节点下面，也可以配置到 profile 节点下。<a href=https://github.com/chensoul/maven-hello-world target=_blank>https://github.com/chensoul/maven-hello-world</a> 项目中使用的是第二种方式，具体见 <a href=https://github.com/chensoul/chensoul-parent target=_blank>https://github.com/chensoul/chensoul-parent</a> 的 pom.xml 文件。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#f92672>&lt;profiles&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;profile&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>&lt;id&gt;</span>release<span style=color:#f92672>&lt;/id&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>&lt;build&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;plugins&gt;</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>&lt;plugin&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;groupId&gt;</span>org.apache.maven.plugins<span style=color:#f92672>&lt;/groupId&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;artifactId&gt;</span>maven-source-plugin<span style=color:#f92672>&lt;/artifactId&gt;</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>&lt;/plugin&gt;</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>&lt;plugin&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;groupId&gt;</span>org.apache.maven.plugins<span style=color:#f92672>&lt;/groupId&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;artifactId&gt;</span>maven-javadoc-plugin<span style=color:#f92672>&lt;/artifactId&gt;</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>&lt;/plugin&gt;</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>&lt;plugin&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;groupId&gt;</span>org.apache.maven.plugins<span style=color:#f92672>&lt;/groupId&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;artifactId&gt;</span>maven-enforcer-plugin<span style=color:#f92672>&lt;/artifactId&gt;</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>&lt;/plugin&gt;</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>&lt;plugin&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;groupId&gt;</span>pl.project13.maven<span style=color:#f92672>&lt;/groupId&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;artifactId&gt;</span>git-commit-id-plugin<span style=color:#f92672>&lt;/artifactId&gt;</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>&lt;/plugin&gt;</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>&lt;plugin&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;groupId&gt;</span>org.apache.maven.plugins<span style=color:#f92672>&lt;/groupId&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;artifactId&gt;</span>maven-release-plugin<span style=color:#f92672>&lt;/artifactId&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;version&gt;</span>${maven-release-plugin.version}<span style=color:#f92672>&lt;/version&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;configuration&gt;</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>&lt;scmCommentPrefix&gt;</span>[CI Skip]<span style=color:#f92672>&lt;/scmCommentPrefix&gt;</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>&lt;autoVersionSubmodules&gt;</span>true<span style=color:#f92672>&lt;/autoVersionSubmodules&gt;</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>&lt;useReleaseProfile&gt;</span>false<span style=color:#f92672>&lt;/useReleaseProfile&gt;</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>&lt;releaseProfiles&gt;</span>release<span style=color:#f92672>&lt;/releaseProfiles&gt;</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>&lt;goals&gt;</span>deploy<span style=color:#f92672>&lt;/goals&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;/configuration&gt;</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>&lt;/plugin&gt;</span>
</span></span><span style=display:flex><span>          <span style=color:#75715e>&lt;!-- https://blog.sonatype.com/2010/01/how-to-generate-pgp-signatures-with-maven/ --&gt;</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>&lt;plugin&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;groupId&gt;</span>org.apache.maven.plugins<span style=color:#f92672>&lt;/groupId&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;artifactId&gt;</span>maven-gpg-plugin<span style=color:#f92672>&lt;/artifactId&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;version&gt;</span>${maven-gpg-plugin.version}<span style=color:#f92672>&lt;/version&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;executions&gt;</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>&lt;execution&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>&lt;goals&gt;</span>
</span></span><span style=display:flex><span>                  <span style=color:#f92672>&lt;goal&gt;</span>sign<span style=color:#f92672>&lt;/goal&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>&lt;/goals&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>&lt;phase&gt;</span>verify<span style=color:#f92672>&lt;/phase&gt;</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>&lt;/execution&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;/executions&gt;</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>&lt;/plugin&gt;</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>&lt;plugin&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;groupId&gt;</span>org.sonatype.plugins<span style=color:#f92672>&lt;/groupId&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;artifactId&gt;</span>nexus-staging-maven-plugin<span style=color:#f92672>&lt;/artifactId&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;version&gt;</span>${nexus-staging-maven-plugin.version}<span style=color:#f92672>&lt;/version&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;extensions&gt;</span>true<span style=color:#f92672>&lt;/extensions&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;configuration&gt;</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>&lt;serverId&gt;</span>ossrh<span style=color:#f92672>&lt;/serverId&gt;</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>&lt;nexusUrl&gt;</span>https://s01.oss.sonatype.org/<span style=color:#f92672>&lt;/nexusUrl&gt;</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>&lt;autoReleaseAfterClose&gt;</span>true<span style=color:#f92672>&lt;/autoReleaseAfterClose&gt;</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>&lt;keepStagingRepositoryOnCloseRuleFailure&gt;</span>false<span style=color:#f92672>&lt;/keepStagingRepositoryOnCloseRuleFailure&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;/configuration&gt;</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>&lt;/plugin&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;/plugins&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>&lt;/build&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;/profile&gt;</span>
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;/profiles&gt;</span>
</span></span></code></pre></div><p>nexus-staging-maven-plugin 插件配置的 serverId 是 ossrh ，需要和 distributionManagement 中的配置一致：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#f92672>&lt;distributionManagement&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;snapshotRepository&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;id&gt;</span>ossrh<span style=color:#f92672>&lt;/id&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;url&gt;</span>https://s01.oss.sonatype.org/content/repositories/snapshots<span style=color:#f92672>&lt;/url&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;/snapshotRepository&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;repository&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;id&gt;</span>ossrh<span style=color:#f92672>&lt;/id&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;url&gt;</span>https://s01.oss.sonatype.org/service/local/staging/deploy/maven2/<span style=color:#f92672>&lt;/url&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;/repository&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;/distributionManagement&gt;</span>
</span></span></code></pre></div><p>您需要在 <a href=https://issues.sonatype.org/secure/Dashboard.jspa target=_blank>Sonatype JIRA</a> 上注册一个帐户并为此创建一个<a href="https://issues.sonatype.org/secure/CreateIssue.jspa?issuetype=21&amp;pid=10134" target=_blank>Issure</a>。</p><p>将您的 Sonatype JIRA 凭证添加到您的<code>~/.m2/settings.xml</code>文件中，如下所示：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#f92672>&lt;server&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;id&gt;</span>ossrh<span style=color:#f92672>&lt;/id&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;username&gt;</span>LSJkOqOi<span style=color:#f92672>&lt;/username&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;password&gt;</span>3oJOIO5+ah7LIcRSmDC2YDGjE9PRbgxoE2UbXjOrSzC1<span style=color:#f92672>&lt;/password&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;/server&gt;</span>
</span></span></code></pre></div><h2 id=安装-gpg-并创建公秘钥>安装 GPG 并创建公秘钥</h2><p>macos 上安装 gpg：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>brew install gpg
</span></span></code></pre></div><p>参考 <a href=https://central.sonatype.org/publish/requirements/gpg/#generating-a-key-pair target=_blank>Generating a Key Pair</a> 生成 GPG 密钥。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ gpg --gen-key
</span></span><span style=display:flex><span>gpg <span style=color:#f92672>(</span>GnuPG<span style=color:#f92672>)</span> 2.4.5; Copyright <span style=color:#f92672>(</span>C<span style=color:#f92672>)</span> <span style=color:#ae81ff>2024</span> g10 Code GmbH
</span></span><span style=display:flex><span>This is free software: you are free to change and redistribute it.
</span></span><span style=display:flex><span>There is NO WARRANTY, to the extent permitted by law.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>注意：使用 “gpg --full-generate-key” 以获得一个全功能的密钥生成对话框。
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>GnuPG 需要构建用户标识以辨认您的密钥。
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>真实姓名： chensoul
</span></span><span style=display:flex><span>电子邮件地址： ichensoul@gmail.com
</span></span><span style=display:flex><span>您选定了此用户标识：
</span></span><span style=display:flex><span>    “chensoul &lt;ichensoul@gmail.com&gt;”
</span></span></code></pre></div><p>按提示输入两次密码，这里我使用 chensoul 作为密码 。</p><p>查看生成的 key：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># gpg --list-secret-keys --keyid-format=long</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>keyboxd<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>---------
</span></span><span style=display:flex><span>sec   ed25519/93C5993B9F7B43EE 2024-05-08 <span style=color:#f92672>[</span>SC<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>有效至：2027-05-08<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>      C83119F1B90238633D766D4B93C5993B9F7B43EE
</span></span><span style=display:flex><span>uid                   <span style=color:#f92672>[</span> 绝对 <span style=color:#f92672>]</span> chensoul &lt;ichensoul@gmail.com&gt;
</span></span><span style=display:flex><span>ssb   cv25519/116B95FF0068A7E8 2024-05-08 <span style=color:#f92672>[</span>E<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>有效至：2027-05-08<span style=color:#f92672>]</span>
</span></span></code></pre></div><p>上传公开的 key：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># keyserver.ubuntu.com</span>
</span></span><span style=display:flex><span><span style=color:#75715e># keys.openpgp.org</span>
</span></span><span style=display:flex><span><span style=color:#75715e># pgp.mit.edu</span>
</span></span><span style=display:flex><span>gpg --keyserver keys.openpgp.org --send-keys C83119F1B90238633D766D4B93C5993B9F7B43EE
</span></span></code></pre></div><p>修改 <code>~/.m2/settings.xml</code> 文件，添加：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#f92672>&lt;server&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;id&gt;</span>gpg.passphrase<span style=color:#f92672>&lt;/id&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;passphrase&gt;&lt;PASSPHRASE_GPG&gt;&lt;/passphrase&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;/server&gt;</span>
</span></span></code></pre></div><p>将 <code>&lt;PASSPHRASE_GPG></code> 替换为创建 gpg key 时设置的密码。</p><h2 id=使用-maven-发布-jar>使用 Maven 发布 jar</h2><p>使用下面命令发布 jar 到 sonatype 仓库：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>mvn -P release clean deploy
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>mvn -P release clean deploy
</span></span></code></pre></div><p>如果当前项目的版本为快照版，则发布后的 jar 在 <a href=https://s01.oss.sonatype.org/content/repositories/snapshots/com/chensoul/maven-hello-world/ target=_blank>https://s01.oss.sonatype.org/content/repositories/snapshots/com/chensoul/maven-hello-world/</a></p><p>如果当前项目的版本为正式版，稍等几分钟，可以在以下仓库查看发布的 jar:</p><ul><li><a href=https://central.sonatype.com/artifact/com.chensoul/maven-hello-world target=_blank>https://central.sonatype.com/artifact/com.chensoul/maven-hello-world</a></li><li><a href=https://s01.oss.sonatype.org/service/local/repositories/releases/content/com/chensoul/maven-hello-world target=_blank>https://s01.oss.sonatype.org/service/local/repositories/releases/content/com/chensoul/maven-hello-world</a></li><li><a href=https://repo.maven.apache.org/maven2/com/chensoul/maven-hello-world target=_blank>https://repo.maven.apache.org/maven2/com/chensoul/maven-hello-world</a></li></ul><h2 id=配置github-actions>配置Github Actions</h2><p>使用 Github Actions 发布 jar 到 maven 仓库，目前发现有两个 action 可以实现该目的：</p><ul><li><p><a href=https://github.com/actions/setup-java target=_blank>actions/setup-java</a></p></li><li><p><a href=https://github.com/qcastel/github-actions-maven-release target=_blank>qcastel/github-actions-maven-release</a></p></li><li><p><a href=https://github.com/marketplace/actions/action-maven-publish target=_blank>action-maven-publish</a></p></li></ul><h3 id=actionssetup-java>actions/setup-java</h3><p>使用 <a href=https://github.com/actions/setup-java target=_blank>actions/setup-java</a> ，参考使用文档，在项目的 .github/workflows 目录下创建 maven-release.yml文件：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>name</span>: <span style=color:#ae81ff>Maven Release</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>on</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>push</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>branches</span>: [ <span style=color:#e6db74>&#34;main&#34;</span> ]
</span></span><span style=display:flex><span>    <span style=color:#f92672>tags</span>: [ <span style=color:#e6db74>&#34;*&#34;</span> ]
</span></span><span style=display:flex><span>  <span style=color:#f92672>release</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>types</span>: [ <span style=color:#ae81ff>created ]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>jobs</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>build</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>runs-on</span>: <span style=color:#ae81ff>ubuntu-latest</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>if</span>: <span style=color:#e6db74>&#34;!contains(github.event.head_commit.message, &#39;[CI Skip]&#39;)&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>steps</span>:
</span></span><span style=display:flex><span>      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Checkout</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>actions/checkout@v4</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Set up JDK 8</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>actions/setup-java@v4</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>with</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>distribution</span>: <span style=color:#e6db74>&#39;temurin&#39;</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>java-version</span>: <span style=color:#ae81ff>8</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>cache</span>: <span style=color:#ae81ff>maven</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>server-id</span>: <span style=color:#ae81ff>ossrh</span> <span style=color:#75715e># Value of the distributionManagement/repository/id field of the pom.xml</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>server-username</span>: <span style=color:#ae81ff>MAVEN_USERNAME</span> <span style=color:#75715e># 变量</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>server-password</span>: <span style=color:#ae81ff>MAVEN_TOKEN</span> <span style=color:#75715e># 变量</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>gpg-passphrase</span>: <span style=color:#ae81ff>GPG_PASSPHRASE</span> <span style=color:#75715e># 变量</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>gpg-private-key</span>: <span style=color:#ae81ff>${{ secrets.MAVEN_GPG_PRIVATE_KEY }}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Java Maven Release</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>run</span>: <span style=color:#ae81ff>mvn -ntp -B -U clean deploy -P release -DskipTests</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>env</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>MAVEN_USERNAME</span>: <span style=color:#ae81ff>${{ secrets.OSSRH_USERNAME }}</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>MAVEN_TOKEN</span>: <span style=color:#ae81ff>${{ secrets.OSSRH_TOKEN }}</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>GPG_PASSPHRASE</span>: <span style=color:#ae81ff>${{ secrets.MAVEN_GPG_PASSPHRASE }}</span>
</span></span></code></pre></div><p>根据上面的 yaml 文件，需要在当前项目的 Settings&ndash;>Secrets&ndash;>Actions 创建以下 Secrets：</p><ul><li><strong>OSSRH_TOKEN</strong>：您在 Sonatype 上的密码</li><li><strong>OSSRH_USERNAME</strong>：您在 Sonatype 上的用户名</li><li><strong>MAVEN_GPG_PRIVATE_KEY</strong>：用于签名 Jar 包的 GPG 密钥</li><li><strong>MAVEN_GPG_PASSPHRASE</strong>：用于签名的 GPG 密钥密码</li></ul><p><strong>MAVEN_GPG_PRIVATE_KEY</strong> 通过如下命令获取：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ gpg --list-keys
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>keyboxd<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>---------
</span></span><span style=display:flex><span>pub   ed25519 2024-05-08 <span style=color:#f92672>[</span>SC<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>有效至：2027-05-08<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>      C83119F1B90238633D766D4B93C5993B9F7B43EE
</span></span><span style=display:flex><span>uid             <span style=color:#f92672>[</span> 绝对 <span style=color:#f92672>]</span> chensoul &lt;ichensoul@gmail.com&gt;
</span></span><span style=display:flex><span>sub   cv25519 2024-05-08 <span style=color:#f92672>[</span>E<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>有效至：2027-05-08<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ gpg --armor --export-secret-keys C83119F1B90238633D766D4B93C5993B9F7B43EE
</span></span><span style=display:flex><span>-----BEGIN PGP PRIVATE KEY BLOCK-----
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>lIYEZjrnpBYJKwYBBAHaRw8BAQdAmMtUf7k2poUBYhlca7U7le2vGPEHgAtHZ1MH
</span></span><span style=display:flex><span>DGOSZR3+BwMCiYrT2G14W736nwBjZvOLsJKjxsSqVN9bRLATEg3veHW/59Jw4DaI
</span></span><span style=display:flex><span>QN5DX8ier7D2rXM9fkJfYyLg3wNVAcT7dmcQOVM5wkgL1B7EEz3/aLQeY2hlbnNv
</span></span><span style=display:flex><span>dWwgPGljaGVuc291bEBnbWFpbC5jb20+iJkEExYKAEEWIQTIMRnxuQI4Yz12bUuT
</span></span><span style=display:flex><span>xZk7n3tD7gUCZjrnpAIbAwUJBaOagAULCQgHAgIiAgYVCgkICwIEFgIDAQIeBwIX
</span></span><span style=display:flex><span>gAAKCRCTxZk7n3tD7sgGAQCBRsbdVDn1NuVYXOPEAKAFUFWgowb0tkH7w5VzWWD2
</span></span><span style=display:flex><span>hwD+IHR5JiegnI376upOLiUzQ5cZN8gJ3fn0oau5ELp1lQSciwRmOuekEgorBgEE
</span></span><span style=display:flex><span>AZdVAQUBAQdAnfkcIuOOyU+ihUX/Z8nU9634MbTG0OHfEZCbm9pgdH4DAQgH/gcD
</span></span><span style=display:flex><span>AqPKEqB6fGQq+u4+7gYGW2vgkeiTjWJCwVw8VJEwn53+gdQ0q7irfnOOqYNXJbye
</span></span><span style=display:flex><span>n2NM9IucSZpcVk8gKhJmc8hJR4uNifh0i820vEjyszeIfgQYFgoAJhYhBMgxGfG5
</span></span><span style=display:flex><span>AjhjPXZtS5PFmTufe0PuBQJmOuekAhsMBQkFo5qAAAoJEJPFmTufe0PubSkA/R6I
</span></span><span style=display:flex><span>/7+oavy/FP9r6PfV1oI5yiAy7RMue1BuIcbRMoabAPkBBQq/ms9DZ5GA25ZpSuOH
</span></span><span style=display:flex><span>S3ee7QZPNjtkA2s/eQsPAQ<span style=color:#f92672>==</span>
</span></span></code></pre></div><h3 id=qcastelgithub-actions-maven-release>qcastel/github-actions-maven-release</h3><p>使用 <a href=https://github.com/qcastel/github-actions-maven-release target=_blank>qcastel/github-actions-maven-release</a> ，参考使用文档，在项目的 .github/workflows 目录下创建 maven-release.yml文件：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>name</span>: <span style=color:#ae81ff>Maven Release</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>on</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>push</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>branches</span>: [ <span style=color:#e6db74>&#34;main&#34;</span> ]
</span></span><span style=display:flex><span>    <span style=color:#f92672>tags</span>: [ <span style=color:#e6db74>&#34;*&#34;</span> ]
</span></span><span style=display:flex><span>  <span style=color:#f92672>release</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>types</span>: [ <span style=color:#ae81ff>created ]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>jobs</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>build</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>runs-on</span>: <span style=color:#ae81ff>ubuntu-latest</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>if</span>: <span style=color:#e6db74>&#34;!contains(github.event.head_commit.message, &#39;[CI Skip]&#39;)&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>steps</span>:
</span></span><span style=display:flex><span>      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Checkout</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>actions/checkout@v4</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Java Maven Release</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>qcastel/github-actions-maven-release@master</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>env</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>JAVA_HOME</span>: <span style=color:#ae81ff>/usr/lib/jvm/java-1.8-openjdk/</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>with</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>git-release-bot-name</span>: <span style=color:#e6db74>&#34;release-bot&#34;</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>git-release-bot-email</span>: <span style=color:#e6db74>&#34;release-bot@chensoul.cc&#34;</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>release-branch-name</span>: <span style=color:#e6db74>&#34;main&#34;</span>
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>          <span style=color:#f92672>maven-args</span>: <span style=color:#e6db74>&#34;-ntp -B -U -P release&#34;</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>maven-servers</span>: <span style=color:#ae81ff>${{ secrets.MVN_REPO_SERVERS }}</span>
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>          <span style=color:#f92672>ssh-private-key</span>: <span style=color:#ae81ff>${{ secrets.SSH_PRIVATE_KEY }}</span>
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>          <span style=color:#f92672>gpg-enabled</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>gpg-key-id</span>: <span style=color:#ae81ff>${{ secrets.MAVEN_GPG_ID }}</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>gpg-key</span>: <span style=color:#ae81ff>${{ secrets.MAVEN_GPG_KEY }}</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>gpg-passphrase</span>: <span style=color:#ae81ff>${{ secrets.MAVEN_GPG_PASSPHRASE }}</span>
</span></span></code></pre></div><p>根据上面的 yaml 文件，需要在当前项目的 Settings&ndash;>Secrets&ndash;>Actions 创建以下 Secrets：</p><ul><li><strong>MVN_REPO_SERVERS</strong></li><li><strong>SSH_PRIVATE_KEY</strong></li><li><strong>MAVEN_GPG_ID</strong></li><li><strong>MAVEN_GPG_KEY</strong></li><li><strong>MAVEN_GPG_PASSPHRASE</strong></li></ul><p><strong>MVN_REPO_SERVERS</strong> 如下：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>[</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;id&#34;</span>: <span style=color:#e6db74>&#34;ossrh&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;username&#34;</span>: <span style=color:#e6db74>&#34;LSJkOqOi&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;password&#34;</span>: <span style=color:#e6db74>&#34;3oJOIO5+ah7LIcRSmDC2YDGjE9PRbgxoE2UbXjOrSzC1&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>}</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;id&#34;</span>: <span style=color:#e6db74>&#34;gpg.passphrase&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;passphrase&#34;</span>: <span style=color:#e6db74>&#34;chensoul&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>]</span>
</span></span></code></pre></div><p><strong>SSH_PRIVATE_KEY</strong> 通过下面命令获取：</p><p>1、在 docker 容器中生成</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>docker run -it qcastel/maven-release:latest  bash
</span></span></code></pre></div><p>ssh 公钥和秘钥</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ssh-keygen -b <span style=color:#ae81ff>2048</span> -t rsa -f ~/.ssh/id_rsa -q -N <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>echo -e <span style=color:#e6db74>&#34;Copy the following SSH private key and add it to your repo secrets under the name &#39;SSH_PRIVATE_KEY&#39;:&#34;</span>
</span></span><span style=display:flex><span>base64 ~/.ssh/id_rsa
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>echo -e <span style=color:#e6db74>&#34; &#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>echo -e <span style=color:#e6db74>&#34;Copy the encoded SSH public key and add it as one of your repo deploy keys with write access:&#34;</span>
</span></span><span style=display:flex><span>cat ~/.ssh/id_rsa.pub
</span></span></code></pre></div><p>输出内容如下：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>Copy the following SSH private key and add it to your repo secrets under the name <span style=color:#e6db74>&#39;SSH_PRIVATE_KEY&#39;</span>:
</span></span><span style=display:flex><span>LS0tLS1CRUdJTiBPUEVOU1NIIFBSSVZBVEUgS0VZLS0tLS0KYjNCbGJuTnphQzFyWlhrdGRqRUFB QUFBQkc1dmJtVUFBQUFFYm05dVpRQUFBQUFBQUFBQkFBQUJGd0FBQUFkemMyZ3RjbgpOaEFBQUFB d0VBQVFBQUFRRUExQUFBclFpZFNRS25pY3g5VmNaQVdtTlI1ZWY0Q2tSbEJCZTdVdk5QNGNMMlAv eDRReXJpCmdWcGV2Um8wVHE0eUptWFN2L3hnclByNk5CQmk0STlXRmp6Q2l0a3phcTg3OGwyNVdt UUt5cTUyang5TWJ0MmhCZzVrdUsKZ05pRGxvMWNaY1VpZHd4ak9sNzVlVHpWaHpoSGZ4ZnphZTZY N0QybE1jeFUrd2d3MFJHZlpITjUvRUZWQ3JHRUhKdHlGSQpReFd1VDY0c3RNMElrVjA3azBPRlQy SHhYNlB6OUpvRjhRRm9SZmVjU0RUM2tPRk5rTVVicDVTNkkxNWxtTjB0YnNHVGNsClYxWFpwWUkr NHRFWWphN1EwWnlWaVBCVUJnWnBuUlpQNFRmOEIwRzhsVDdqSlNPWDM0YkRFWkFoMVM4bnRCQzc3 aFUyMUIKWGJDZHV6ZlpXUUFBQThoN29jU3VlNkhFcmdBQUFBZHpjMmd0Y25OaEFBQUJBUURVQUFD dENKMUpBcWVKekgxVnhrQmFZMQpIbDUvZ0tSR1VFRjd0UzgwL2h3dlkvL0hoREt1S0JXbDY5R2pS T3JqSW1aZEsvL0dDcyt2bzBFR0xnajFZV1BNS0syVE5xCnJ6dnlYYmxhWkFyS3JuYVBIMHh1M2FF R0RtUzRxQTJJT1dqVnhseFNKM0RHTTZYdmw1UE5XSE9FZC9GL05wN3Bmc1BhVXgKekZUN0NERFJF WjlrYzNuOFFWVUtzWVFjbTNJVWhERmE1UHJpeTB6UWlSWFR1VFE0VlBZZkZmby9QMG1nWHhBV2hG OTV4SQpOUGVRNFUyUXhSdW5sTG9qWG1XWTNTMXV3Wk55VlhWZG1sZ2o3aTBSaU5ydERSbkpXSThG UUdCbW1kRmsvaE4vd0hRYnlWClB1TWxJNWZmaHNNUmtDSFZMeWUwRUx2dUZUYlVGZHNKMjdOOWxa QUFBQUF3RUFBUUFBQVFCSzBqMXExSEYraFJ0UVBRVzMKTWlNZ1E1RnlETzZ6NFBPdUFCb3k2b0Mw OHpRcDNSY3N6WVBubDFkOGNqVW4xNzhIWWtTQlViZGxGYWNjblBQb3dXM21wMApjWjdoS0JncHNy clB4djlJTUNpWlI2YXRkMUFXK0ZUYXNxcU5VdDBPVTVIYXNUcTZ2WHAvN1drcTZ0ZUp3OGtvQi9I MjN5CmhyVGs1eFJ1WnZPckxGcS9vdXBQeXhVS1M0SzRVOG5JYjBnZjVjT3RXeUlWZFdKQ05EdU9R ZW1sdDBRajN3RjZPWkNpcU8KRGxaMFd3MWwrRzJpUWZFLzM2ODR0UXpKemVKeFgybEJaN0tmQStP bEcyZENPeXZwY01Ic1J4TE5ITy85aWpqUmNXWUVtMgp4SDVYQmRkZldlKzBkYkxxZFhoWHJHTnpx QjlSbjBTWGZ1QVRnSzZENjBsSkFBQUFnUUN6VmhONUh1YXVvOExzVVR1dkNRCkNibVhnakhuS1hB NDBqV1pyVmlucEgvbmcxNkNudlE5UmJhb041am1JWURUZEJ3TVp4dXZSck9JUTloeUZnUDVCSHRL dTgKQlhvZ08ybERySDFVRzA4bzN6ZHNhUTJaaGp0aEE5TFlMcXpvYkVtSEpndkwxemJjRVBWMHJC cm1SMXArL0trN3Y5OHd0eQpPT2VnYXVqK0djUXdBQUFJRUE5ZklKc0t2SGdsQVp1eS9sMzJWS3Q4 cTN4UFl4SUlrMVJKczV4bDRJUGFTZ0xsR0pzVFgwCll2bll1THcrb2NCMlVaazRxUUlML3I5bTRt cVhEOTF6bXhxZTNUKzZqOHk0ODBvbS91UWRma3h6MWdNWkljdDlkR2Z3RE8KczRBckNPSkx0TVI4 WG53emxXM1VLZnJhTDFRUFZMVUs3OWpSM29kN2k2VmNWMlpnY0FBQUNCQU55cXRMZk85NUhkU3Mz RwpyMWYvOStVRUJjV0xMSnpHMEl2OEZtd3J6ci9ZbksrbXpmR2dMVHNPeUgwV1pMZkVnYlJkUGxC aVJmTjFXQk1oWHZKRWhaCkp4YTY1N0IxTUExano1eEE2OElCcEJxUlhvNWZ6QmdHNFg0UGVNZkQz dXR5M0NENVR4Y2sxL0c1L2krUXpXNFhlR2RLNkkKaml1OGg5TXo3YkUxZHUyZkFBQUFFWEp2YjNS QVlqa3dZelJtWWpKbE9HVmxBUT09Ci0tLS0tRU5EIE9QRU5TU0ggUFJJVkFURSBLRVktLS0tLQo<span style=color:#f92672>=</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Copy the encoded SSH public key and add it as one of your repo deploy keys with write access:
</span></span><span style=display:flex><span>ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDUAACtCJ1JAqeJzH1VxkBaY1Hl5/gKRGUEF7tS80/hwvY//HhDKuKBWl69GjROrjImZdK//GCs+vo0EGLgj1YWPMKK2TNqrzvyXblaZArKrnaPH0xu3aEGDmS4qA2IOWjVxlxSJ3DGM6Xvl5PNWHOEd/F/Np7pfsPaUxzFT7CDDREZ9kc3n8QVUKsYQcm3IUhDFa5Priy0zQiRXTuTQ4VPYfFfo/P0mgXxAWhF95xINPeQ4U2QxRunlLojXmWY3S1uwZNyVXVdmlgj7i0RiNrtDRnJWI8FQGBmmdFk/hN/wHQbyVPuMlI5ffhsMRkCHVLye0ELvuFTbUFdsJ27N9lZ root@b90c4fb2e8ee
</span></span></code></pre></div><p>2、或者直接使用本地的 ssh</p><p>macos 系统上执行命令：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>echo -e <span style=color:#e6db74>&#34;Copy the following SSH private key and add it to your repo secrets under the name &#39;SSH_PRIVATE_KEY&#39;:&#34;</span>
</span></span><span style=display:flex><span>base64 -i ~/.ssh/id_rsa
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>echo -e <span style=color:#e6db74>&#34; &#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>echo -e <span style=color:#e6db74>&#34;Copy the encoded SSH public key and add it as one of your repo deploy keys with write access:&#34;</span>
</span></span><span style=display:flex><span>cat ~/.ssh/id_rsa.pub
</span></span></code></pre></div><p>将私钥粘贴到 Secrets 中 <strong>SSH_PRIVATE_KEY</strong> 的值内，将公钥添加到你的 github 账号的 <a href=https://github.com/settings/ssh/new target=_blank>SSH keys</a> 中。</p><p>获取 <strong>MAVEN_GPG_ID</strong>：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ gpg --list-secret-keys --keyid-format LONG
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>keyboxd<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>---------
</span></span><span style=display:flex><span>sec   ed25519/93C5993B9F7B43EE 2024-05-08 <span style=color:#f92672>[</span>SC<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>有效至：2027-05-08<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>      C83119F1B90238633D766D4B93C5993B9F7B43EE
</span></span><span style=display:flex><span>uid                   <span style=color:#f92672>[</span> 绝对 <span style=color:#f92672>]</span> chensoul &lt;ichensoul@gmail.com&gt;
</span></span><span style=display:flex><span>ssb   cv25519/116B95FF0068A7E8 2024-05-08 <span style=color:#f92672>[</span>E<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>有效至：2027-05-08<span style=color:#f92672>]</span>
</span></span></code></pre></div><blockquote><p>这里 <strong>MAVEN_GPG_ID</strong> 对应 93C5993B9F7B43EE</p></blockquote><p>获取 <strong>MAVEN_GPG_KEY</strong>，运行下面命令，输入密码，即 <strong>MAVEN_GPG_PASSPHRASE</strong> 对应的内容</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>echo <span style=color:#e6db74>&#39;Public key to add in your bot github account:&#39;</span>
</span></span><span style=display:flex><span>gpg --armor --export 93C5993B9F7B43EE
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#39;Private key to add to the CI secrets under GITHUB_GPG_KEY:&#39;</span>
</span></span><span style=display:flex><span>gpg --export-secret-keys --armor 93C5993B9F7B43EE | base64
</span></span></code></pre></div><p>输出内容：</p><p>公钥：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>-----BEGIN PGP PUBLIC KEY BLOCK-----
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>mDMEZjrnpBYJKwYBBAHaRw8BAQdAmMtUf7k2poUBYhlca7U7le2vGPEHgAtHZ1MH
</span></span><span style=display:flex><span>DGOSZR20HmNoZW5zb3VsIDxpY2hlbnNvdWxAZ21haWwuY29tPoiZBBMWCgBBFiEE
</span></span><span style=display:flex><span>yDEZ8bkCOGM9dm1Lk8WZO597Q+4FAmY656QCGwMFCQWjmoAFCwkIBwICIgIGFQoJ
</span></span><span style=display:flex><span>CAsCBBYCAwECHgcCF4AACgkQk8WZO597Q+7IBgEAgUbG3VQ59TblWFzjxACgBVBV
</span></span><span style=display:flex><span>oKMG9LZB+8OVc1lg9ocA/iB0eSYnoJyN++rqTi4lM0OXGTfICd359KGruRC6dZUE
</span></span><span style=display:flex><span>uDgEZjrnpBIKKwYBBAGXVQEFAQEHQJ35HCLjjslPooVF/2fJ1Pet+DG0xtDh3xGQ
</span></span><span style=display:flex><span>m5vaYHR+AwEIB4h+BBgWCgAmFiEEyDEZ8bkCOGM9dm1Lk8WZO597Q+4FAmY656QC
</span></span><span style=display:flex><span>GwwFCQWjmoAACgkQk8WZO597Q+5tKQD9Hoj/v6hq/L8U/2vo99XWgjnKIDLtEy57
</span></span><span style=display:flex><span>UG4hxtEyhpsA+QEFCr+az0NnkYDblmlK44dLd57tBk82O2QDaz95Cw8B
</span></span><span style=display:flex><span><span style=color:#f92672>=</span>YFZg
</span></span><span style=display:flex><span>-----END PGP PUBLIC KEY BLOCK-----
</span></span></code></pre></div><p>私钥：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>LS0tLS1CRUdJTiBQR1AgUFJJVkFURSBLRVkgQkxPQ0stLS0tLQoKbElZRVpqcm5wQllKS3dZQkJBSGFSdzhCQVFkQW1NdFVmN2sycG9VQllobGNhN1U3bGUydkdQRUhnQXRIWjFNSApER09TWlIzK0J3TUNwOTJOaVVIQnU0VDZ3UHRFSWt1cGtTM2M0c21WOWZUUXRtRDM3bTJuOTlzbnRWNmllYU8vCi9TKzUvR2FyWDNMTUhoTmtkdnVpOHZSMk1hNDNhNFdzVmFpR1RiZWF6eHNHbVE1TGo4ZXUvTFFlWTJobGJuTnYKZFd3Z1BHbGphR1Z1YzI5MWJFQm5iV0ZwYkM1amIyMCtpSmtFRXhZS0FFRVdJUVRJTVJueHVRSTRZejEyYlV1VAp4Wms3bjN0RDdnVUNaanJucEFJYkF3VUpCYU9hZ0FVTENRZ0hBZ0lpQWdZVkNna0lDd0lFRmdJREFRSWVCd0lYCmdBQUtDUkNUeFprN24zdEQ3c2dHQVFDQlJzYmRWRG4xTnVWWVhPUEVBS0FGVUZXZ293YjB0a0g3dzVWeldXRDIKaHdEK0lIUjVKaWVnbkkzNzZ1cE9MaVV6UTVjWk44Z0ozZm4wb2F1NUVMcDFsUVNjaXdSbU91ZWtFZ29yQmdFRQpBWmRWQVFVQkFRZEFuZmtjSXVPT3lVK2loVVgvWjhuVTk2MzRNYlRHME9IZkVaQ2JtOXBnZEg0REFRZ0gvZ2NECkFtYllUMStNNjB6bStna1lyMk54Yys1U3hqYmd6bTA1ajFURW42TnUwVTUyUmRoMzJvTVRYU2ZIa2RlakdiVmkKMDNKemRkVnZ6Kzl6U2FzQVpMMVA1ZytBa0dGbTBHYVFLTldnOUVRQzVBK0lmZ1FZRmdvQUpoWWhCTWd4R2ZHNQpBamhqUFhadFM1UEZtVHVmZTBQdUJRSm1PdWVrQWhzTUJRa0ZvNXFBQUFvSkVKUEZtVHVmZTBQdWJTa0EvUjZJCi83K29hdnkvRlA5cjZQZl
</span></span></code></pre></div><p>将上面输出私钥的内容添加到 Secrets 中 <strong>MAVEN_GPG_KEY</strong> 的值里面，将公钥内容添加到你的 github 账号的 <a href=https://github.com/settings/gpg/new target=_blank>GPG keys</a> 中。</p><p>修改代码，提交到 github，会触发一个 github action ，查看日志，可以看到：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>Not using access token authentication, as no access token <span style=color:#f92672>(</span>via env GITREPO_ACCESS_TOKEN<span style=color:#f92672>)</span> defined or because an SSH key is defined and setup <span style=color:#f92672>(</span>via env SSH_PRIVATE_KEY<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Do mvn release:prepare with options  -DdevelopmentVersion<span style=color:#f92672>=</span><span style=color:#e6db74>${</span>parsedVersion.majorVersion<span style=color:#e6db74>}</span>.<span style=color:#e6db74>${</span>parsedVersion.minorVersion<span style=color:#e6db74>}</span>.<span style=color:#e6db74>${</span>parsedVersion.nextIncrementalVersion<span style=color:#e6db74>}</span>-SNAPSHOT and arguments -ntp -B -U -P release
</span></span></code></pre></div><p>从日志可以看到，qcastel/github-actions-maven-release 使用了 maven 的 maven-release-plugin 插件，会发布正式版的 jar 到 maven 中央仓库。为了 避免在开发阶段每次提交都发布一个正式版本到中央仓库，可以修改 release-branch-name 为 release 分支，即限定提交到指定分支时候，从触发 maven 发布。</p><p>可以添加下面参数，跳过 release:perform ，即不会发布 jar 到 maven 中央仓库，<strong>但是 maven-release-plugin 插件还是会修改项目的版本，并创建 tag。</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>with:
</span></span><span style=display:flex><span>    skip-perform: true
</span></span></code></pre></div><p>创建的 tag 名称格式为：项目名称-版本。tag 名称格式可以在 maven-release-plugin 插件中配置：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#f92672>&lt;plugin&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;groupId&gt;</span>org.apache.maven.plugins<span style=color:#f92672>&lt;/groupId&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;artifactId&gt;</span>maven-release-plugin<span style=color:#f92672>&lt;/artifactId&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;version&gt;</span>${maven-release-plugin.version}<span style=color:#f92672>&lt;/version&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;configuration&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;scmCommentPrefix&gt;</span>[CI Skip]<span style=color:#f92672>&lt;/scmCommentPrefix&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;autoVersionSubmodules&gt;</span>true<span style=color:#f92672>&lt;/autoVersionSubmodules&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;useReleaseProfile&gt;</span>false<span style=color:#f92672>&lt;/useReleaseProfile&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;releaseProfiles&gt;</span>release<span style=color:#f92672>&lt;/releaseProfiles&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;tagNameFormat&gt;</span>v@{version}<span style=color:#f92672>&lt;/tagNameFormat&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;goals&gt;</span>deploy<span style=color:#f92672>&lt;/goals&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;/configuration&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;/plugin&gt;</span>
</span></span></code></pre></div><h3 id=action-maven-publish>action-maven-publish</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>name</span>: <span style=color:#ae81ff>Release</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>on</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>push</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>tags</span>:
</span></span><span style=display:flex><span>      - <span style=color:#e6db74>&#39;v*&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>jobs</span>:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>release</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>runs-on</span>: <span style=color:#ae81ff>ubuntu-latest</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#f92672>steps</span>:
</span></span><span style=display:flex><span>    - <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>actions/checkout@v3</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Set up JDK 8</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>actions/setup-java@v4</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>with</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>java-version</span>: <span style=color:#e6db74>&#39;8&#39;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>distribution</span>: <span style=color:#e6db74>&#39;temurin&#39;</span>
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>    - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Build with Maven</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>run</span>: <span style=color:#ae81ff>mvn clean install</span>
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>    - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Publish to Maven Central</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>samuelmeuli/action-maven-publish@v1</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>with</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>gpg_private_key</span>: <span style=color:#ae81ff>${{ secrets.MAVEN_GPG_PRIVATE_KEY }}</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>gpg_passphrase</span>: <span style=color:#ae81ff>${{ secrets.MAVEN_GPG_PASSPHRASE }}</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>nexus_username</span>: <span style=color:#ae81ff>${{ secrets.OSSRH_USERNAME }}</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>nexus_password</span>: <span style=color:#ae81ff>${{ secrets.OSSRH_TOKEN }}</span>
</span></span></code></pre></div><h2 id=总结>总结</h2><p>如果使用 <a href=https://github.com/qcastel/github-actions-maven-release target=_blank>qcastel/github-actions-maven-release</a> ，maven-release-plugin 插件会修改版本，并且创建 tag ，但是并不会创建 github release。</p><p>使用 <a href=https://github.com/release-drafter/release-drafter target=_blank>https://github.com/release-drafter/release-drafter</a> 这个 actions 可以更加 pull request 自动创建 github releae，基于此，更倾向于使用 <a href=https://github.com/actions/setup-java target=_blank>actions/setup-java</a> 来发布 jar 到 Maven 仓库。</p></div><div><div style=font-weight:700>Share this post:</div><a class=social-link-item href="https://twitter.com/intent/tweet?text=Github%20Action%20%e5%8f%91%e5%b8%83%20Jar%20%e5%88%b0%20Maven%20%e4%b8%ad%e5%a4%ae%e4%bb%93%e5%ba%93 https%3a%2f%2fblog.chensoul.cc%2fposts%2f2024%2f08%2f01%2fpublishing-a-jar-to-maven-repository-with-github-action%2f" target=_blank rel="noopener noreferrer" title="Click to share on Twitter"><i class="fa-brands fa-square-twitter fa-2xl" style=color:#55acee></i>
</a><a class=social-link-item href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fblog.chensoul.cc%2fposts%2f2024%2f08%2f01%2fpublishing-a-jar-to-maven-repository-with-github-action%2f&title=Github%20Action%20%e5%8f%91%e5%b8%83%20Jar%20%e5%88%b0%20Maven%20%e4%b8%ad%e5%a4%ae%e4%bb%93%e5%ba%93" target=_blank rel="noopener noreferrer" title="Click to share on LinkedIn"><i class="fa-brands fa-linkedin fa-2xl" style=color:#007bb5></i>
</a><a class=social-link-item href="https://telegram.me/share/url?text=Github%20Action%20%e5%8f%91%e5%b8%83%20Jar%20%e5%88%b0%20Maven%20%e4%b8%ad%e5%a4%ae%e4%bb%93%e5%ba%93&amp;url=https%3a%2f%2fblog.chensoul.cc%2fposts%2f2024%2f08%2f01%2fpublishing-a-jar-to-maven-repository-with-github-action%2f" target=_blank rel="noopener noreferrer" title="Click to share on telegram"><i class="fa-brands fa-telegram fa-2xl" style=color:#007bb5></i>
</a><a class=social-link-item href="https://reddit.com/submit?url=https%3a%2f%2fblog.chensoul.cc%2fposts%2f2024%2f08%2f01%2fpublishing-a-jar-to-maven-repository-with-github-action%2f&title=Github%20Action%20%e5%8f%91%e5%b8%83%20Jar%20%e5%88%b0%20Maven%20%e4%b8%ad%e5%a4%ae%e4%bb%93%e5%ba%93" target=_blank rel="noopener noreferrer" title="Click to share on reddit"><i class="fa-brands fa-reddit fa-2xl" style=color:#007bb5></i>
</a><a class=social-link-item href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fblog.chensoul.cc%2fposts%2f2024%2f08%2f01%2fpublishing-a-jar-to-maven-repository-with-github-action%2f" target=_blank rel="noopener noreferrer" title="Click to share on facebook"><i class="fa-brands fa-facebook fa-2xl" style=color:#007bb5></i>
</a><a class=social-link-item href="https://api.whatsapp.com/send?text=Github%20Action%20%e5%8f%91%e5%b8%83%20Jar%20%e5%88%b0%20Maven%20%e4%b8%ad%e5%a4%ae%e4%bb%93%e5%ba%93%20-%20https%3a%2f%2fblog.chensoul.cc%2fposts%2f2024%2f08%2f01%2fpublishing-a-jar-to-maven-repository-with-github-action%2f" target=_blank rel="noopener noreferrer" title="Click to share on whatsapp"><i class="fa-brands fa-whatsapp fa-2xl" style=color:#007bb5></i></a></div></div></article><nav class="navigation post-navigation" role=navigation><h2 class=screen-reader-text>Post navigation</h2><div class=nav-links><div class=nav-previous><a href=/posts/2024/08/05/a-crash-course-on-domain-driven-design/ rel=next><span class=post-title>[译]领域驱动设计速成课程</span></a></div><div class=nav-next><a href=/posts/2024/07/24/what-is-new-in-jms-2-0/ rel=prev><span class=post-title>[译]JMS 2.0 中的新增功能</span></a></div></div></nav><h2>Related content</h2><ul><li><a href=/posts/2024/11/07/junit-5-migration/>[译]从JUnit4迁移到JUnit5：权威指南</a></li><li><a href=/tutorials/>Tutorials</a></li><li><a href=/posts/2024/08/27/activemq-source-code-broker-service/>ActiveMQ源码-BrokerService和PersistenceAdapter</a></li><li><a href=/posts/2024/08/27/thingsboard-code-source-compile/>ThingsBoard源码编译和Idea运行</a></li><li><a href=/posts/2024/08/09/debug-activemq-source-code/>ActiveMQ源码本地调试运行</a></li><li><a href=/posts/2024/07/24/what-is-new-in-jms-2-0/>[译]JMS 2.0 中的新增功能</a></li><li><a href=/posts/2024/07/24/jms20/>[译]JMS 2.0 中的新增功能（第一部分）- 易于使用</a></li><li><a href=/posts/2024/07/24/jms20/>[译]JMS 2.0 中的新增功能（第二部分）- 新的消息传送功能</a></li><li><a href=/posts/2024/07/24/jms20-means-less-code/>[译]JMS 2.0 的十个好处意味着可以减少代码编写量</a></li><li><a href=/posts/2024/07/23/jms-transactions-in-action/>[译]JMS 事务的实际应用</a></li></ul></main></section></div><div id=footer class=footer-wrap><footer id=colophon class="site-footer container clearfix" role=contentinfo><div id=footer-text class=site-info><span class=credit-link><a href=/ target=_blank rel="noopener noreferrer">ChenSoul</a>
Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreferrer">Hugo</a>
<a style=margin-left:20px href=/privacy_policy/ target=_blank rel="noopener noreferrer">Privacy Policy</a></span></div></footer></div></div><script type=text/javascript src=/main.min.js></script></body></html>